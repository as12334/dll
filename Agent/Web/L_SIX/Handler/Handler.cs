namespace Agent.Web.L_SIX.Handler
{
    using Agent.Web.Handler;
    using Agent.Web.WebBase;
    using log4net;
    using LotterySystem.Common;
    using LotterySystem.DBUtility;
    using LotterySystem.Model;
    using LotterySystem.WebPageBase;
    using System;
    using System.Collections;
    using System.Collections.Generic;
    using System.Data;
    using System.Linq;
    using System.Text;
    using System.Web;

    public class Handler : BaseHandler
    {
        private static ILog log = LogManager.GetLogger(MethodBase.GetCurrentMethod().DeclaringType);

        public void get_lmszszamount(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            string str2 = base.Permission_Ashx_ZJ(model, "po_1_1");
            string str3 = base.Permission_Ashx_DL(model, "po_5_1");
            string str4 = base.Permission_Ashx_DL(model, "po_5_2");
            if ((!string.IsNullOrEmpty(str2) || !string.IsNullOrEmpty(str3)) || !string.IsNullOrEmpty(str4))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "get_lmszszamount");
            LSRequest.qq("playid");
            string str5 = LSRequest.qq("pk");
            string s = LSRequest.qq("szsz");
            string str7 = LSRequest.qq("phaseid");
            string str8 = LSRequest.qq("oddsid");
            int num = 0;
            if (!string.IsNullOrEmpty(LSRequest.qq("oldId")))
            {
                num = Convert.ToInt32(LSRequest.qq("oldId"));
            }
            string.IsNullOrEmpty(str5);
            Dictionary<string, string> dictionary2 = new Dictionary<string, string>();
            string str9 = "";
            string str10 = model.get_u_type();
            string str11 = model.get_u_name();
            if ((model.get_u_type() == "fgs") && ((model.get_allow_view_report() == 1) && int.Parse(s).Equals(2)))
            {
                str10 = "zj";
                str11 = model.get_zjname().ToString();
                s = "1";
            }
            DataSet set = CallBLL.cz_bet_six_bll.GetSZSZ_LM("100", str10, str11, Convert.ToInt32(s), Convert.ToInt32(str7), Convert.ToInt32(str8), str5, str9, model.get_zjname(), num);
            if (((set != null) && (set.Tables.Count > 0)) && (set.Tables[0].Rows.Count > 0))
            {
                foreach (DataRow row in set.Tables[0].Rows)
                {
                    dictionary2.Add(row["item"].ToString(), string.Concat(new object[] { row["zh"], ",", row["p1"], ",", row["p2"] }));
                }
            }
            dictionary.Add("lm_szsz_amount", dictionary2);
            result.set_success(200);
            result.set_data(dictionary);
            strResult = JsonHandle.ObjectToJson(result);
        }

        public void get_lxlszszamount(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            string str2 = base.Permission_Ashx_ZJ(model, "po_1_1");
            string str3 = base.Permission_Ashx_DL(model, "po_5_1");
            string str4 = base.Permission_Ashx_DL(model, "po_5_2");
            if ((!string.IsNullOrEmpty(str2) || !string.IsNullOrEmpty(str3)) || !string.IsNullOrEmpty(str4))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "get_lxlszszamount");
            LSRequest.qq("playid");
            string str5 = LSRequest.qq("pk");
            string s = LSRequest.qq("szsz");
            string str7 = LSRequest.qq("phaseid");
            string str8 = LSRequest.qq("oddsid");
            int num = 0;
            if (!string.IsNullOrEmpty(LSRequest.qq("oldId")))
            {
                num = Convert.ToInt32(LSRequest.qq("oldId"));
            }
            Dictionary<string, string> dictionary2 = new Dictionary<string, string>();
            string str9 = "";
            string str10 = model.get_u_type();
            string str11 = model.get_u_name();
            if ((model.get_u_type() == "fgs") && ((model.get_allow_view_report() == 1) && int.Parse(s).Equals(2)))
            {
                str10 = "zj";
                str11 = model.get_zjname().ToString();
                s = "1";
            }
            DataSet set = CallBLL.cz_bet_six_bll.GetSZSZ_LM("100", str10, str11, Convert.ToInt32(s), Convert.ToInt32(str7), Convert.ToInt32(str8), str5, str9, model.get_zjname(), num);
            if (((set != null) && (set.Tables.Count > 0)) && (set.Tables[0].Rows.Count > 0))
            {
                foreach (DataRow row in set.Tables[0].Rows)
                {
                    dictionary2.Add(row["item"].ToString(), string.Concat(new object[] { row["zh"], ",", row["p1"], ",", row["p2"] }));
                }
            }
            dictionary.Add("lxl_szsz_amount", dictionary2);
            result.set_success(200);
            result.set_data(dictionary);
            strResult = JsonHandle.ObjectToJson(result);
        }

        public void get_newbetlist(HttpContext context, ref string strResult)
        {
            ReturnResult result = new ReturnResult();
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "get_newbetlist");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_1")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!context.Session["user_type"].ToString().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100035", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str4 = LSRequest.qq("top");
                string str5 = LSRequest.qq("amount");
                string str6 = LSRequest.qq("oldId");
                int num6 = 100;
                string str7 = num6.ToString();
                string compareTime = LSRequest.qq("oldTime");
                if (string.IsNullOrEmpty(str5))
                {
                    str5 = "0";
                }
                int num = 0;
                if (!string.IsNullOrEmpty(str6))
                {
                    num = Convert.ToInt32(str6);
                }
                int num2 = num;
                DataTable table = CallBLL.cz_bet_six_bll.GetNewBet(str4, str6, str7, str5);
                if (table != null)
                {
                    Dictionary<string, Dictionary<string, string>> dictionary2 = new Dictionary<string, Dictionary<string, string>>();
                    for (int i = 0; i < table.Rows.Count; i++)
                    {
                        Dictionary<string, string> dictionary3 = new Dictionary<string, string>();
                        DataRow row = table.Rows[i];
                        string str9 = row["u_name"].ToString();
                        int num4 = Convert.ToInt32(row["bet_id"].ToString());
                        if (num4 > num2)
                        {
                            num2 = num4;
                        }
                        if ((row["isLM"]).Equals("1"))
                        {
                            string str10 = "";
                            int num5 = 0;
                            if (!string.IsNullOrEmpty(row["unit_cnt"]) && (int.Parse(row["unit_cnt"].ToString()) > 0))
                            {
                                num5 = decimal.ToInt32(Convert.ToDecimal(row["amount"])) / int.Parse(row["unit_cnt"].ToString());
                            }
                            else
                            {
                                num5 = decimal.ToInt32(Convert.ToDecimal(row["amount"]));
                            }
                            if (!string.IsNullOrEmpty(row["unit_cnt"]) && (int.Parse(row["unit_cnt"].ToString()) > 0))
                            {
                                if ((row["sale_type"]).Equals("1"))
                                {
                                    str10 = "-" + string.Format("{0:F0}", row["amount"]);
                                }
                                else
                                {
                                    str10 = string.Format("<span>￥{0}</span>\x00d7<span>{1}</span>&nbsp;<br>{2}&nbsp;", num5, row["unit_cnt"].ToString(), string.Format("{0:F0}", row["amount"]));
                                }
                            }
                            else
                            {
                                str10 = num5.ToString();
                            }
                            dictionary3.Add("amounttext", str10);
                        }
                        if ((row["sale_type"]).Equals("1"))
                        {
                            if (model.get_u_type().Equals("zj") && model.get_u_name().ToLower().Equals(row["fgs_name"].ToString().ToLower()))
                            {
                                dictionary3.Add("amount", "-" + row["amount"].ToString());
                            }
                            else if (model.get_u_name().Equals(str9))
                            {
                                dictionary3.Add("amount", "-" + row["amount"].ToString());
                            }
                            else if ((row["sale_type"]).Equals("1"))
                            {
                                dictionary3.Add("amount", "-" + row["amount"].ToString());
                            }
                            else
                            {
                                dictionary3.Add("amount", row["amount"].ToString());
                            }
                        }
                        else
                        {
                            dictionary3.Add("amount", row["amount"].ToString());
                        }
                        dictionary3.Add("isdelete", row["isDelete"].ToString());
                        dictionary3.Add("szamount", row["ds"].ToString());
                        row["play_id"].ToString();
                        string str11 = row["odds_id"].ToString();
                        dictionary3.Add("ordernum", row["order_num"].ToString());
                        dictionary3.Add("phase", row["phase"].ToString());
                        dictionary3.Add("bettime", row["bet_time"].ToString());
                        dictionary3.Add("week", Utils.GetWeekByDate(Convert.ToDateTime(row["bet_time"].ToString())));
                        dictionary3.Add("lottery_type", row["lottery_type"].ToString());
                        dictionary3.Add("lottery_name", base.GetGameNameByID(row["lottery_type"].ToString()));
                        dictionary3.Add("islm", row["isLM"].ToString());
                        dictionary3.Add("lmtype", row["lm_type"].ToString());
                        dictionary3.Add("hyname", row["u_name"].ToString());
                        dictionary3.Add("dlname", row["dl_name"]);
                        dictionary3.Add("zdname", row["zd_name"]);
                        dictionary3.Add("gdname", row["gd_name"]);
                        dictionary3.Add("fgsname", row["fgs_name"]);
                        dictionary3.Add("hydrawback", row["hy_drawback"]);
                        dictionary3.Add("dldrawback", row["dl_drawback"]);
                        dictionary3.Add("zddrawback", row["zd_drawback"]);
                        dictionary3.Add("gddrawback", row["gd_drawback"]);
                        dictionary3.Add("fgsdrawback", row["fgs_drawback"]);
                        dictionary3.Add("zjdrawback", row["zj_drawback"]);
                        dictionary3.Add("dlrate", row["dl_rate"]);
                        dictionary3.Add("zdrate", row["zd_rate"]);
                        dictionary3.Add("gdrate", row["gd_rate"]);
                        dictionary3.Add("fgsrate", row["fgs_rate"]);
                        dictionary3.Add("zjrate", row["zj_rate"]);
                        dictionary3.Add("unitcnt", row["unit_cnt"]);
                        dictionary3.Add("pk", row["kind"].ToString());
                        if (row["fgs_name"].ToString().Equals(str))
                        {
                            dictionary3.Add("saletype", "2");
                        }
                        else if ((row["sale_type"]).Equals("1"))
                        {
                            dictionary3.Add("saletype", "1");
                        }
                        else
                        {
                            dictionary3.Add("saletype", "0");
                        }
                        string str12 = "";
                        if (!string.IsNullOrEmpty(row["unit_cnt"].ToString()) && (int.Parse(row["unit_cnt"].ToString()) > 1))
                        {
                            str12 = base.GroupShowHrefString(1, row["order_num"].ToString(), row["is_payment"].ToString(), "1", "1");
                        }
                        if (str11.Equals("92565"))
                        {
                            dictionary3.Add("playname", row["play_name"].ToString() + "【中】");
                            string str13 = row["odds_zj"].ToString().Split(new char[] { ',' })[0];
                            dictionary3.Add("odds", str13);
                            dictionary3.Add("betval", FunctionSix.GetSXLNameBySXid(row["bet_val"].ToString()));
                        }
                        else if (("92566".Equals(str11) || "92567".Equals(str11)) || ("92568".Equals(str11) || "92636".Equals(str11)))
                        {
                            string str14 = row["lm_type"].ToString();
                            dictionary3.Add("playname", row["play_name"].ToString() + ",連" + base.get_YearLian());
                            string str15 = row["odds_zj"].ToString().Split(new char[] { ',' })[0] + "," + row["odds_zj"].ToString().Split(new char[] { ',' })[1];
                            dictionary3.Add("odds", str15);
                            if (str14.Equals("0"))
                            {
                                string str16 = "";
                                str16 = str16 + string.Format("<br />【{0}組】 {1}", row["unit_cnt"].ToString(), str12) + string.Format("<br />{0}", FunctionSix.GetSXLNameBySXid(row["bet_val"].ToString()));
                                dictionary3.Add("betval", str16);
                                dictionary3.Add("betwt", FunctionSix.GetSXLWT(row["odds_id"].ToString(), row["odds_zj"].ToString(), row["bet_wt_zj"].ToString(), base.get_YearLianID()));
                            }
                            else if (str14.Equals("1"))
                            {
                                string str17 = "";
                                str17 = str17 + string.Format("<br />膽拖【{0}組】 {1}", row["unit_cnt"].ToString(), str12) + string.Format("<br />{0}<br />拖<br />{1}", FunctionSix.GetSXLNameBySXid(row["bet_val"].ToString().Split(new char[] { '|' })[0]), FunctionSix.GetSXLNameBySXid(row["bet_val"].ToString().Split(new char[] { '|' })[1]));
                                dictionary3.Add("betval", str17);
                                dictionary3.Add("betwt", FunctionSix.GetSXLWT(row["odds_id"].ToString(), row["odds_zj"].ToString(), row["bet_wt_zj"].ToString(), base.get_YearLianID()));
                            }
                        }
                        else if (("92569".Equals(str11) || "92570".Equals(str11)) || ("92571".Equals(str11) || "92637".Equals(str11)))
                        {
                            string str18 = row["lm_type"].ToString();
                            dictionary3.Add("playname", row["play_name"].ToString() + ",連0");
                            string str19 = row["odds_zj"].ToString().Split(new char[] { ',' })[0] + "," + row["odds_zj"].ToString().Split(new char[] { ',' })[1];
                            dictionary3.Add("odds", str19);
                            if (str18.Equals("0"))
                            {
                                string str20 = "";
                                str20 = str20 + string.Format("<br />【{0}組】 {1}", row["unit_cnt"].ToString(), str12) + string.Format("<br />{0}", FunctionSix.GetWSLNameBySXid(row["bet_val"].ToString()));
                                dictionary3.Add("betval", str20);
                                dictionary3.Add("betwt", FunctionSix.GetWSLWT(row["odds_id"].ToString(), row["odds_zj"].ToString(), row["bet_wt_zj"].ToString()));
                            }
                            else if (str18.Equals("1"))
                            {
                                string str21 = "";
                                str21 = str21 + string.Format("<br />膽拖【{0}組】 {1}", row["unit_cnt"].ToString(), str12) + string.Format("<br />{0}<br />拖<br />{1}", FunctionSix.GetWSLNameBySXid(row["bet_val"].ToString().Split(new char[] { '|' })[0]), FunctionSix.GetWSLNameBySXid(row["bet_val"].ToString().Split(new char[] { '|' })[1]));
                                dictionary3.Add("betval", str21);
                                dictionary3.Add("betwt", FunctionSix.GetWSLWT(row["odds_id"].ToString(), row["odds_zj"].ToString(), row["bet_wt_zj"].ToString()));
                            }
                        }
                        else if ((("92572,92588,92589,92590,92591,92592".IndexOf(str11) > -1) || ("92285,92286,92287,92288,92289,92575".IndexOf(str11) > -1)) || ("92638,92639,92640,92641,92642,92643".IndexOf(str11) > -1))
                        {
                            string str22 = "";
                            "92638,92639,92640,92641,92642,92643".IndexOf(str11);
                            string str23 = row["lm_type"].ToString();
                            string str24 = "";
                            if (str11.Equals("92286") || str11.Equals("92639"))
                            {
                                dictionary3.Add("category", str22);
                                dictionary3.Add("playname", row["play_name"].ToString() + ",中三");
                                str24 = row["odds_zj"].ToString().Split(new char[] { ',' })[0] + "," + row["odds_zj"].ToString().Split(new char[] { ',' })[1];
                            }
                            else if (str11.Equals("92288") || str11.Equals("92641"))
                            {
                                dictionary3.Add("category", str22);
                                dictionary3.Add("playname", "中特,中二");
                                str24 = row["odds_zj"].ToString().Split(new char[] { ',' })[0] + "," + row["odds_zj"].ToString().Split(new char[] { ',' })[1];
                            }
                            else
                            {
                                dictionary3.Add("category", str22);
                                dictionary3.Add("playname", row["play_name"].ToString());
                                str24 = row["odds_zj"].ToString();
                            }
                            dictionary3.Add("odds", str24);
                            int num7 = 0;
                            if (str23.Equals(num7.ToString()))
                            {
                                string str25 = "";
                                str25 = str25 + string.Format("<br />復式【{0}組】 {1}", row["unit_cnt"].ToString(), str12) + string.Format("<br />{0}", row["bet_val"].ToString());
                                dictionary3.Add("betval", str25);
                                dictionary3.Add("betwt", FunctionSix.GetLMWT(row["odds_id"].ToString(), row["odds_zj"].ToString(), row["bet_wt_zj"].ToString()));
                            }
                            else
                            {
                                int num8 = 1;
                                if (str23.Equals(num8.ToString()))
                                {
                                    string str26 = "";
                                    str26 = str26 + string.Format("<br />膽拖【{0}組】 {1}", row["unit_cnt"].ToString(), str12) + string.Format("<br />{0}<br />拖<br />{1}", row["bet_val"].ToString().Split(new char[] { '|' })[0], row["bet_val"].ToString().Split(new char[] { '|' })[1]);
                                    dictionary3.Add("betval", str26);
                                    dictionary3.Add("betwt", FunctionSix.GetLMWT(row["odds_id"].ToString(), row["odds_zj"].ToString(), row["bet_wt"].ToString()));
                                }
                                else
                                {
                                    num6 = 2;
                                    if (str23.Equals(num6.ToString()))
                                    {
                                        string str27 = "";
                                        str27 = str27 + string.Format("<br />生肖對碰【{0}組】 {1}", row["unit_cnt"].ToString(), str12) + string.Format("<br />{0}<br />對碰<br />{1}", row["bet_val"].ToString().Split(new char[] { '|' })[0], row["bet_val"].ToString().Split(new char[] { '|' })[1]);
                                        dictionary3.Add("betval", str27);
                                        dictionary3.Add("betwt", FunctionSix.GetLMWT(row["odds_id"].ToString(), row["odds_zj"].ToString(), row["bet_wt_zj"].ToString()));
                                    }
                                    else
                                    {
                                        num6 = 3;
                                        if (str23.Equals(num6.ToString()))
                                        {
                                            string str28 = "";
                                            str28 = str28 + string.Format("<br />尾數對碰【{0}組】 {1}", row["unit_cnt"].ToString(), str12) + string.Format("<br />{0}<br />對碰<br />{1}", row["bet_val"].ToString().Split(new char[] { '|' })[0], row["bet_val"].ToString().Split(new char[] { '|' })[1]);
                                            dictionary3.Add("betval", str28);
                                            dictionary3.Add("betwt", FunctionSix.GetLMWT(row["odds_id"].ToString(), row["odds_zj"].ToString(), row["bet_wt_zj"].ToString()));
                                        }
                                        else
                                        {
                                            num6 = 4;
                                            if (str23.Equals(num6.ToString()))
                                            {
                                                string str29 = "";
                                                str29 = str29 + string.Format("<br />混合對碰【{0}組】 {1}", row["unit_cnt"].ToString(), str12) + string.Format("<br />{0}<br />對碰<br />{1}", row["bet_val"].ToString().Split(new char[] { '|' })[0], row["bet_val"].ToString().Split(new char[] { '|' })[1]);
                                                dictionary3.Add("betval", str29);
                                                dictionary3.Add("betwt", FunctionSix.GetLMWT(row["odds_id"].ToString(), row["odds_zj"].ToString(), row["bet_wt_zj"].ToString()));
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        else
                        {
                            dictionary3.Add("playname", row["play_name"].ToString() + "【" + row["bet_val"].ToString() + "】");
                            dictionary3.Add("odds", row["odds_zj"].ToString());
                            dictionary3.Add("betval", row["bet_val"].ToString());
                        }
                        dictionary2.Add(num4.ToString(), dictionary3);
                    }
                    dictionary.Add("newbetlist", dictionary2);
                }
                new Dictionary<string, object>();
                dictionary.Add("maxidvalid", num2);
                DateTime now = DateTime.Now;
                List<object> list = base.GetAutoJPForTable(str7, compareTime, ref now);
                Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                if (list != null)
                {
                    dictionary4.Add("tipsList", list);
                }
                else
                {
                    dictionary4.Add("tipsList", new List<object>());
                }
                dictionary4.Add("timestamp", Utils.DateTimeToStamp(now));
                dictionary.Add("autoJP", dictionary4);
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
            }
        }

        public void get_oddsinfo(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            string str2 = base.Permission_Ashx_ZJ(model, "po_1_1");
            string str3 = base.Permission_Ashx_DL(model, "po_5_1");
            if (!string.IsNullOrEmpty(str2) || !string.IsNullOrEmpty(str3))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            string str4 = LSRequest.qq("playid");
            string playid = LSRequest.qq("checkplayid");
            LSRequest.qq("numsort");
            string s = LSRequest.qq("szsz");
            string str7 = LSRequest.qq("pk");
            string str8 = LSRequest.qq("playpage");
            string str9 = LSRequest.qq("isbh");
            LSRequest.qq("oddsid");
            int num = 0;
            if (!string.IsNullOrEmpty(LSRequest.qq("oldId")))
            {
                num = Convert.ToInt32(LSRequest.qq("oldId"));
            }
            int num2 = num;
            int num3 = num;
            if (string.IsNullOrEmpty(str4))
            {
                context.Response.End();
            }
            else if (context.Session["user_name"] == null)
            {
                context.Response.End();
            }
            else
            {
                string str10 = model.get_u_type().Trim().ToString();
                string str11 = model.get_u_name().ToString();
                string str12 = str7;
                if (string.IsNullOrEmpty(str12))
                {
                    str12 = "A";
                }
                ReturnResult result = new ReturnResult();
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "get_oddsinfo");
                dictionary.Add("playpage", str8);
                cz_phase_six _six = CallBLL.cz_phase_six_bll.IsDrawPhase();
                if (_six != null)
                {
                    ArrayList list = new ArrayList();
                    string str13 = _six.get_n1();
                    list.Add(str13);
                    str13 = _six.get_n2();
                    list.Add(str13);
                    str13 = _six.get_n3();
                    list.Add(str13);
                    str13 = _six.get_n4();
                    list.Add(str13);
                    str13 = _six.get_n5();
                    list.Add(str13);
                    str13 = _six.get_n6();
                    list.Add(str13);
                    str13 = _six.get_sn();
                    list.Add(str13);
                    string nm = string.Join(",", list.ToArray());
                    ArrayList list2 = new ArrayList();
                    list2.Add(base.GetZodiacId(_six.get_zodiac_n1()));
                    list2.Add(base.GetZodiacId(_six.get_zodiac_n2()));
                    list2.Add(base.GetZodiacId(_six.get_zodiac_n3()));
                    list2.Add(base.GetZodiacId(_six.get_zodiac_n4()));
                    list2.Add(base.GetZodiacId(_six.get_zodiac_n5()));
                    list2.Add(base.GetZodiacId(_six.get_zodiac_n6()));
                    list2.Add(base.GetZodiacId(_six.get_zodiac_sn()));
                    string zodiacList = string.Format("{0},{1},{2},{3},{4},{5},{6}", new object[] { _six.get_zodiac_n1(), _six.get_zodiac_n2(), _six.get_zodiac_n3(), _six.get_zodiac_n4(), _six.get_zodiac_n5(), _six.get_zodiac_n6(), _six.get_zodiac_sn() });
                    string str16 = base.Banlance(str4, nm, zodiacList);
                    if (str16 != "")
                    {
                        dictionary.Add("winnerID", str16);
                    }
                    else
                    {
                        if (str4 == "91030,91031,91032,91033,91034,91035,91036,91058,91059")
                        {
                            ArrayList list3 = new ArrayList();
                            foreach (string str17 in list)
                            {
                                string str18 = (int.Parse(str17) % 10).ToString();
                                if (str18 == "0")
                                {
                                    str18 = "10";
                                }
                                else
                                {
                                    str18 = "0" + str18;
                                }
                                list3.Add(str18);
                            }
                            string str19 = string.Join(",", list2.ToArray());
                            string str20 = string.Join(",", list3.ToArray());
                            str16 = str19 + "|" + str20 + "|" + _six.get_sn();
                        }
                        else
                        {
                            str16 = nm;
                        }
                        dictionary.Add("winnerID", str16);
                    }
                }
                DataSet set = CallBLL.cz_play_six_bll.Agent_GetPlay(str4, str10);
                if (set == null)
                {
                    context.Response.End();
                }
                else
                {
                    DataTable oddsDT = set.Tables["odds"];
                    DataTable table2 = set.Tables["aboveTable"];
                    if (oddsDT == null)
                    {
                        context.Response.End();
                    }
                    else
                    {
                        int? nullable;
                        cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                        cz_phase_six currentPhaseClose = CallBLL.cz_phase_six_bll.GetCurrentPhaseClose();
                        DateTime now = DateTime.Now;
                        string str21 = "n";
                        string str22 = "0";
                        string str23 = "";
                        DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                        DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                        TimeSpan span = Utils.DateDiff(time2, now);
                        TimeSpan span2 = Utils.DateDiff(time3, now);
                        string str24 = string.Concat(new object[] { (span.Days * 0x18) + span.Hours, ":", span.Minutes, ":", span.Seconds });
                        string str25 = string.Concat(new object[] { (span2.Days * 0x18) + span2.Hours, ":", span2.Minutes, ":", span2.Seconds });
                        if (time2 >= now)
                        {
                            str21 = "y";
                            str22 = "1";
                        }
                        if (time3 >= now)
                        {
                            str21 = "y";
                            str22 = "1";
                            str23 = str25;
                        }
                        if (currentPhase != null)
                        {
                            nullable = currentPhase.get_is_closed();
                            if (nullable.Equals(0))
                            {
                                if (time2 < now)
                                {
                                    CallBLL.cz_odds_six_bll.UpdateIsOpen(1, "91001,91002,91003,91004,91005,91007,91038");
                                }
                                if (time3 < now)
                                {
                                    CallBLL.cz_odds_six_bll.UpdateIsOpen(0, "");
                                }
                            }
                        }
                        string str26 = (currentPhase != null) ? currentPhase.get_phase() : "";
                        string str27 = (currentPhase != null) ? currentPhase.get_p_id().ToString() : "";
                        string str28 = (currentPhaseClose != null) ? currentPhaseClose.get_phase() : "";
                        string str29 = (currentPhaseClose != null) ? string.Format("{0},{1},{2},{3},{4},{5},{6}", new object[] { currentPhaseClose.get_n1(), currentPhaseClose.get_n2(), currentPhaseClose.get_n3(), currentPhaseClose.get_n4(), currentPhaseClose.get_n5(), currentPhaseClose.get_n6(), currentPhaseClose.get_sn() }) : "";
                        string str30 = (currentPhaseClose != null) ? string.Format("{0},{1},{2},{3},{4},{5},{6}", new object[] { currentPhaseClose.get_zodiac_n1(), currentPhaseClose.get_zodiac_n2(), currentPhaseClose.get_zodiac_n3(), currentPhaseClose.get_zodiac_n4(), currentPhaseClose.get_zodiac_n5(), currentPhaseClose.get_zodiac_n6(), currentPhaseClose.get_zodiac_sn() }) : "";
                        if (str26.Equals(str28))
                        {
                            str21 = "n";
                            str22 = "0";
                        }
                        dictionary.Add("openning", str21);
                        dictionary.Add("isopen", str22);
                        dictionary.Add("stop_time", str23);
                        dictionary.Add("nn", str26);
                        dictionary.Add("p_id", str27);
                        dictionary.Add("upopenphase", str28);
                        dictionary.Add("upopennumber", str29);
                        dictionary.Add("upopennumberzodiac", str30);
                        dictionary.Add("jeucode", base.get_JeuValidate());
                        Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                        Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                        string str31 = "";
                        string pl = "";
                        string maxpl = "";
                        string minpl = "";
                        string str35 = "";
                        DataTable table3 = null;
                        if (str8.Equals("lxl"))
                        {
                            table3 = this.GetWT_LXLWSL(oddsDT);
                        }
                        List<double> collection = new List<double>();
                        foreach (DataRow row in oddsDT.Rows)
                        {
                            str31 = row["odds_id"].ToString();
                            string str36 = row["current_odds"].ToString();
                            string str37 = row["max_odds"].ToString();
                            string str38 = row["min_odds"].ToString();
                            string diff = row[str12 + "_diff"].ToString().Trim();
                            if (str36 != "-")
                            {
                                try
                                {
                                    base.GetOdds_SIX_EX(str36, str37, str38, diff, ref pl, ref maxpl, ref minpl);
                                }
                                catch (Exception exception)
                                {
                                    string message = exception.Message;
                                }
                            }
                            else
                            {
                                pl = str36;
                                maxpl = str37;
                                minpl = str38;
                            }
                            str35 = row["is_open"].ToString();
                            Dictionary<string, string> dictionary4 = new Dictionary<string, string>();
                            if (str8.Equals("lxl"))
                            {
                                DataRow[] wtDataRow = table3.Select(string.Format(" odds_id={0}", str31));
                                if ((str31.Equals("92566") || str31.Equals("92567")) || (str31.Equals("92568") || str31.Equals("92636")))
                                {
                                    dictionary4 = this.GetWT_LXLWSL("lxltype", pl, maxpl, minpl, Convert.ToInt32(base.get_YearLianID()), wtDataRow);
                                    pl = dictionary4["pl"];
                                    maxpl = dictionary4["maxpl"];
                                    minpl = dictionary4["minpl"];
                                }
                                if ((str31.Equals("92569") || str31.Equals("92570")) || (str31.Equals("92571") || str31.Equals("92637")))
                                {
                                    dictionary4 = this.GetWT_LXLWSL("wsltype", pl, maxpl, minpl, Convert.ToInt32(base.get_YearLianID()), wtDataRow);
                                    pl = dictionary4["pl"];
                                    maxpl = dictionary4["maxpl"];
                                    minpl = dictionary4["minpl"];
                                }
                            }
                            nullable = model.get_six_op_odds();
                            if (nullable.Equals(1))
                            {
                                string str40 = pl;
                                if ((str31.Equals("92566") || str31.Equals("92567")) || (str31.Equals("92568") || str31.Equals("92636")))
                                {
                                    base.GetOdds_SIX_SXWSL(str31, ref pl, ref maxpl, ref minpl, Convert.ToInt32(base.get_YearLianID()), "lxltype");
                                }
                                else if ((str31.Equals("92569") || str31.Equals("92570")) || (str31.Equals("92571") || str31.Equals("92637")))
                                {
                                    base.GetOdds_SIX_SXWSL(str31, ref pl, ref maxpl, ref minpl, Convert.ToInt32(base.get_YearLianID()), "wsltype");
                                }
                                else
                                {
                                    base.GetOdds_SIX(str31, ref pl, ref maxpl, ref minpl);
                                }
                                dictionary3.Add("pl", pl);
                                dictionary3.Add("maxpl", str40);
                                dictionary3.Add("minpl", minpl);
                            }
                            else
                            {
                                dictionary3.Add("pl", pl);
                                dictionary3.Add("maxpl", maxpl);
                                dictionary3.Add("minpl", minpl);
                            }
                            dictionary3.Add("plx", new List<double>(collection));
                            if (str21.Equals("n") || str22.Equals("n"))
                            {
                                dictionary3.Add("is_open", "0");
                            }
                            else
                            {
                                dictionary3.Add("is_open", str35);
                            }
                            dictionary2.Add(str31, new Dictionary<string, object>(dictionary3));
                            dictionary3.Clear();
                            collection.Clear();
                        }
                        dictionary.Add("play_odds", dictionary2);
                        Dictionary<string, object> dictionary5 = new Dictionary<string, object>();
                        string str41 = "";
                        new Dictionary<string, object>();
                        bool flag = false;
                        if (str8.Equals("lm") || str8.Equals("lxl"))
                        {
                            flag = true;
                        }
                        string str42 = "";
                        if (model.get_u_type() == "fgs")
                        {
                            nullable = model.get_allow_view_report();
                            if (((nullable.GetValueOrDefault() == 1) && nullable.HasValue) && int.Parse(s).Equals(2))
                            {
                                str10 = "zj";
                                str11 = model.get_zjname().ToString();
                                s = "1";
                            }
                        }
                        DataSet set2 = CallBLL.cz_bet_six_bll.GetSZSZ(str10, str11, int.Parse(s), Convert.ToInt32(str27), str4, str42, model.get_zjname().ToString(), num, flag, str7);
                        if ((set2 != null) && (set2.Tables.Count > 0))
                        {
                            DataTable table4 = set2.Tables[0];
                            DataTable table5 = null;
                            if (str9.Equals("1"))
                            {
                                table5 = CallBLL.cz_bet_six_bll.GetBHSZZT(str11, str10, str27, str42, str4, model.get_zjname().ToString(), num, str7).Tables[0];
                            }
                            List<SzztObject> list5 = new List<SzztObject>();
                            foreach (DataRow row2 in table4.Rows)
                            {
                                double num4 = 0.0;
                                string str43 = row2["odds_id"].ToString();
                                int num5 = 0;
                                double num6 = 0.0;
                                double num7 = 0.0;
                                double num8 = 0.0;
                                if (!row2["bs"].ToString().Equals("0"))
                                {
                                    if (str9.Equals("1"))
                                    {
                                        foreach (DataRow row3 in table5.Select(string.Format("odds_id={0}", Convert.ToInt32(row2["odds_id"].ToString()))))
                                        {
                                            num4 = Convert.ToDouble(row3["szzt"].ToString());
                                        }
                                    }
                                    num5 = Convert.ToInt32(row2["bs"].ToString());
                                    num6 = Convert.ToDouble(row2["szzt"].ToString());
                                    num7 = Convert.ToDouble(row2["ky"].ToString());
                                    num8 = Convert.ToDouble(row2["ds"].ToString());
                                    if (!string.IsNullOrEmpty(row2["max_id"].ToString()) && (Convert.ToInt32(row2["max_id"]) > num3))
                                    {
                                        num3 = Convert.ToInt32(row2["max_id"]);
                                    }
                                }
                                SzztObject item = new SzztObject {
                                    oddsid = str43,
                                    bs = num5,
                                    szzt = double.Parse(num6.ToString()),
                                    ky = double.Parse(num7.ToString()),
                                    ds = double.Parse(num8.ToString()),
                                    bhszzt = double.Parse(num4.ToString())
                                };
                                list5.Add(item);
                            }
                            for (int i = 0; i < list5.Count; i++)
                            {
                                if (list5[i].bs.ToString() != "0")
                                {
                                    string[] strArray2 = new string[9];
                                    strArray2[0] = list5[i].bs.ToString();
                                    strArray2[1] = ",";
                                    nullable = null;
                                    strArray2[2] = Utils.GetMathRound(Convert.ToDouble(list5[i].szzt.ToString()), nullable);
                                    strArray2[3] = ",";
                                    nullable = null;
                                    strArray2[4] = Utils.GetMathRound(Convert.ToDouble(list5[i].ky.ToString()), nullable);
                                    strArray2[5] = ",";
                                    nullable = null;
                                    strArray2[6] = Utils.GetMathRound(Convert.ToDouble(list5[i].ds.ToString()), nullable);
                                    strArray2[7] = ",";
                                    nullable = null;
                                    strArray2[8] = Utils.GetMathRound(Convert.ToDouble(list5[i].bhszzt.ToString()), nullable);
                                    str41 = string.Concat(strArray2);
                                    dictionary5.Add(list5[i].oddsid.ToString(), str41);
                                }
                            }
                        }
                        dictionary.Add("szsz_amount", dictionary5);
                        if (str8.Equals("tmzx2"))
                        {
                            Dictionary<string, object> dictionary6 = new Dictionary<string, object>();
                            DataSet set4 = CallBLL.cz_bet_six_bll.GetSZSZCount(str10, str11, int.Parse(s), Convert.ToInt32(str27), "91001,91002,91003,91004,91005,91006,91007,91008,91030,91038,91041,91042,91043,91044,91045,91046,91047,91048,91049,91050,91051", str7);
                            if ((set4 != null) && (set4.Tables.Count > 0))
                            {
                                for (int j = 0; j < set4.Tables[0].Rows.Count; j++)
                                {
                                    dictionary6.Add(set4.Tables[0].Rows[j]["play_id"].ToString(), set4.Tables[0].Rows[j]["szzt"].ToString());
                                }
                            }
                            dictionary.Add("szsz_amount_count", dictionary6);
                        }
                        Dictionary<string, object> dictionary7 = new Dictionary<string, object>();
                        if (table2 != null)
                        {
                            foreach (DataRow row4 in table2.Rows)
                            {
                                dictionary7.Add(row4["play_id"].ToString(), "-" + row4["above_quota"].ToString());
                            }
                        }
                        dictionary.Add("abovevalid", dictionary7);
                        new Dictionary<string, object>();
                        dictionary.Add("maxidvalid", num3);
                        if (num2.Equals(0))
                        {
                            dictionary.Add("cleardata", "0");
                        }
                        else
                        {
                            dictionary.Add("cleardata", "1");
                        }
                        if ((str4.IndexOf("91030") > -1) && ((str8.Equals("lxl") || str8.Equals("tmzx2")) || ((str8.Equals("tmzx1") || str8.Equals("tmzx3")) || str8.Equals("tmzx2_2"))))
                        {
                            DataSet set5 = CallBLL.cz_bet_six_bll.GetSZSZ_LX(str10, str11, int.Parse(s), Convert.ToInt32(str27), "91030", str42, model.get_zjname().ToString(), num, str7);
                            if (((set5 != null) && (set5.Tables.Count > 0)) && (set5.Tables[0].Rows.Count > 0))
                            {
                                Dictionary<string, string> dictionary8 = new Dictionary<string, string>();
                                for (int k = 1; k < 13; k++)
                                {
                                    string key = k.ToString();
                                    string str45 = "0,0,0,0,0";
                                    if (k < 10)
                                    {
                                        key = "0" + k;
                                    }
                                    dictionary8.Add(key, str45);
                                }
                                for (int m = 1; m <= 12; m++)
                                {
                                    string str46 = m.ToString();
                                    if (m < 10)
                                    {
                                        str46 = "0" + m;
                                    }
                                    for (int num13 = 0; num13 < set5.Tables[0].Rows.Count; num13++)
                                    {
                                        int num14 = Convert.ToInt32(set5.Tables[0].Rows[num13]["bs"].ToString());
                                        string str47 = set5.Tables[0].Rows[num13]["bet_val"].ToString();
                                        double num15 = Convert.ToDouble(set5.Tables[0].Rows[num13]["szzt"].ToString());
                                        double num16 = Convert.ToDouble(set5.Tables[0].Rows[num13]["ky"].ToString());
                                        double num17 = Convert.ToDouble(set5.Tables[0].Rows[num13]["ds"].ToString());
                                        if (str47.IndexOf(str46) > -1)
                                        {
                                            string[] strArray = dictionary8[str46].Split(new char[] { ',' });
                                            dictionary8[str46] = string.Concat(new object[] { Convert.ToInt32(strArray[0]) + num14, ",", Convert.ToDouble(strArray[1]) + num15, ",", Convert.ToDouble(strArray[2]) + num16, ",", Convert.ToDouble(strArray[3]) + num17, ",0" });
                                        }
                                    }
                                }
                                if (dictionary8.Count > 0)
                                {
                                    dictionary.Add("szsz_lx_amount", dictionary8);
                                }
                                else
                                {
                                    dictionary.Add("szsz_lx_amount", "");
                                }
                                double num18 = 0.0;
                                double num19 = 0.0;
                                for (int n = 0; n < set5.Tables[0].Rows.Count; n++)
                                {
                                    num18 += Convert.ToDouble(set5.Tables[0].Rows[n]["szzt"].ToString());
                                    num19 += Convert.ToDouble(set5.Tables[0].Rows[n]["ds"].ToString());
                                }
                                dictionary.Add("szsz_lx_amount_count", num18 + "," + num19);
                            }
                        }
                        if (model.get_u_type().Trim().Equals("zj") && ((((playid.Equals("91016") || playid.Equals("91017")) || (playid.Equals("91018") || playid.Equals("91019"))) || ((playid.Equals("91020") || playid.Equals("91040")) || (playid.Equals("91060") || playid.Equals("91061")))) || ((playid.Equals("91062") || playid.Equals("91063")) || (playid.Equals("91064") || playid.Equals("91065")))))
                        {
                            dictionary.Add("wtnumbervalue", this.GetWT_LM(str12, playid));
                        }
                        if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && ((((playid.Equals("91016") || playid.Equals("91017")) || (playid.Equals("91018") || playid.Equals("91019"))) || ((playid.Equals("91020") || playid.Equals("91040")) || (playid.Equals("91060") || playid.Equals("91061")))) || ((playid.Equals("91062") || playid.Equals("91063")) || (playid.Equals("91064") || playid.Equals("91065")))))
                        {
                            dictionary.Add("wtnumbervalue", this.GetWT_LM_wt(model, context, str12, playid));
                        }
                        if (model.get_u_type().Trim().Equals("zj") && (((playid.Equals("91037") || playid.Equals("91047")) || (playid.Equals("91048") || playid.Equals("91049"))) || (playid.Equals("91050") || playid.Equals("91051"))))
                        {
                            dictionary.Add("wtnumbervalue", this.GetWT_BZ(str12, playid));
                        }
                        if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && (((playid.Equals("91037") || playid.Equals("91047")) || (playid.Equals("91048") || playid.Equals("91049"))) || (playid.Equals("91050") || playid.Equals("91051"))))
                        {
                            dictionary.Add("wtnumbervalue", this.GetWT_BZ_wt(model, context, str12, playid));
                        }
                        if (str8.Equals("lxl"))
                        {
                            string str49 = "91030";
                            if (model.get_u_type().Trim().Equals("zj") && str49.Equals("91030"))
                            {
                                dictionary.Add("wtnumbervalue", this.GetWT_LXYZ(str12, str49));
                            }
                            if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && str49.Equals("91030"))
                            {
                                dictionary.Add("wtnumbervalue", this.GetWT_LXYZ_wt(model, context, str12, str49));
                            }
                        }
                        if ((str8.Equals("tmzx2") || str8.Equals("tmzx2_2")) || str8.Equals("tmzx3"))
                        {
                            DataTable table6 = CallBLL.cz_bet_six_bll.GetGXMXSZSZ(str10, str11, int.Parse(s), Convert.ToInt32(str27), str7, str42, model.get_zjname().ToString());
                            Dictionary<string, double> dictionary9 = new Dictionary<string, double>();
                            if (table6 != null)
                            {
                                for (int num21 = 0; num21 < table6.Rows.Count; num21++)
                                {
                                    dictionary9.Add(table6.Rows[num21]["play_id"].ToString(), Convert.ToDouble(table6.Rows[num21]["szzt"]));
                                }
                                if (base.IsShowLM_B() == 1)
                                {
                                    double num22 = 0.0;
                                    double num23 = 0.0;
                                    dictionary9.TryGetValue("91016", out num22);
                                    dictionary9.TryGetValue("91060", out num23);
                                    double num24 = num22 + num23;
                                    dictionary9.Remove("91016");
                                    dictionary9.Remove("91060");
                                    dictionary9.Add("91016,91060", num24);
                                    double num25 = 0.0;
                                    double num26 = 0.0;
                                    dictionary9.TryGetValue("91017", out num25);
                                    dictionary9.TryGetValue("91061", out num26);
                                    double num27 = num25 + num26;
                                    dictionary9.Remove("91017");
                                    dictionary9.Remove("91061");
                                    dictionary9.Add("91017,91061", num27);
                                    double num28 = 0.0;
                                    double num29 = 0.0;
                                    dictionary9.TryGetValue("91018", out num28);
                                    dictionary9.TryGetValue("91062", out num29);
                                    double num30 = num28 + num29;
                                    dictionary9.Remove("91018");
                                    dictionary9.Remove("91062");
                                    dictionary9.Add("91018,91062", num30);
                                    double num31 = 0.0;
                                    double num32 = 0.0;
                                    dictionary9.TryGetValue("91019", out num31);
                                    dictionary9.TryGetValue("91063", out num32);
                                    double num33 = num31 + num32;
                                    dictionary9.Remove("91019");
                                    dictionary9.Remove("91063");
                                    dictionary9.Add("91019,91063", num33);
                                    double num34 = 0.0;
                                    double num35 = 0.0;
                                    dictionary9.TryGetValue("91020", out num34);
                                    dictionary9.TryGetValue("91064", out num35);
                                    double num36 = num34 + num35;
                                    dictionary9.Remove("91020");
                                    dictionary9.Remove("91064");
                                    dictionary9.Add("91020,91064", num36);
                                    double num37 = 0.0;
                                    double num38 = 0.0;
                                    dictionary9.TryGetValue("91040", out num37);
                                    dictionary9.TryGetValue("91065", out num38);
                                    double num39 = num37 + num38;
                                    dictionary9.Remove("91040");
                                    dictionary9.Remove("91065");
                                    dictionary9.Add("91040,91065", num39);
                                }
                            }
                            dictionary.Add("gxmx_szsz", dictionary9);
                        }
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                }
            }
        }

        public void get_oddsinfoex(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_1")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            string str3 = LSRequest.qq("number");
            LSRequest.qq("playpage");
            string str4 = LSRequest.qq("oddsid");
            string str5 = LSRequest.qq("s_user");
            if (string.IsNullOrEmpty(str4))
            {
                context.Response.End();
            }
            else if (context.Session["user_name"] == null)
            {
                context.Response.End();
            }
            else
            {
                new ReturnResult();
                cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str5);
                if (!user.get_flag().Equals(1))
                {
                    context.Response.End();
                }
                else
                {
                    DataTable table = this.GetNumberWTTable(str4, user.get_sqlconn(), user.get_salt().ToUpper());
                    string str6 = CallBLL.cz_autosale_six_ex_bll.GetPlay_ex(str4, str5, user.get_sqlconn(), user.get_six_kind(), user.get_salt().ToUpper(), table, str3, base.get_YearLianID());
                    if (string.IsNullOrEmpty(str6))
                    {
                        context.Response.End();
                    }
                    else
                    {
                        StringBuilder builder = new StringBuilder();
                        builder.Append("");
                        builder.Append("{");
                        builder.Append("\"success\": 200,");
                        builder.Append("\"type\": \"get_oddsinfoex\",");
                        builder.Append("\"data\": {");
                        builder.AppendFormat("\"pl\": \"{0}\",", str6);
                        builder.Append("\"is_open\": \"1\"");
                        builder.Append("},");
                        builder.Append("\"tipinfo\": \"\"");
                        builder.Append("}");
                        strResult = builder.ToString();
                    }
                }
            }
        }

        public void get_oddsinfoex_fast(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_1")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            LSRequest.qq("number");
            string str3 = LSRequest.qq("playpage");
            LSRequest.qq("oddsid");
            string str4 = LSRequest.qq("s_user");
            string str5 = "";
            if ((str3.Equals("tma") || str3.Equals("tmzx1")) || str3.Equals("tmzx2"))
            {
                str5 = "91001";
            }
            if (str3.Equals("tmb"))
            {
                str5 = "91002";
            }
            if (context.Session["user_name"] == null)
            {
                context.Response.End();
            }
            else
            {
                new ReturnResult();
                cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str4);
                if (!user.get_flag().Equals(1))
                {
                    context.Response.End();
                }
                else
                {
                    string str6 = CallBLL.cz_autosale_six_ex_bll.GetPlays_ex(str5, str4, user.get_sqlconn(), user.get_six_kind(), user.get_salt().ToUpper());
                    if (string.IsNullOrEmpty(str6))
                    {
                        context.Response.End();
                    }
                    else
                    {
                        StringBuilder builder = new StringBuilder();
                        builder.Append("");
                        builder.Append("{");
                        builder.Append("\"success\": 200,");
                        builder.Append("\"type\": \"get_oddsinfoex\",");
                        builder.Append("\"data\": {");
                        builder.AppendFormat("\"pl\": \"{0}\",", str6);
                        builder.Append("\"is_open\": \"1\"");
                        builder.Append("},");
                        builder.Append("\"tipinfo\": \"\"");
                        builder.Append("}");
                        strResult = builder.ToString();
                    }
                }
            }
        }

        public void get_opennumber(HttpContext context, ref string strResult)
        {
            if (context.Session["user_name"] == null)
            {
                context.Response.End();
            }
            else
            {
                context.Session["user_name"].ToString();
                ReturnResult result = new ReturnResult();
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "get_opennumber");
                cz_phase_six currentPhaseClose = CallBLL.cz_phase_six_bll.GetCurrentPhaseClose();
                Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                if (currentPhaseClose != null)
                {
                    string str = (currentPhaseClose != null) ? currentPhaseClose.get_phase() : "";
                    string str2 = (currentPhaseClose != null) ? string.Format("{0},{1},{2},{3},{4},{5},{6}", new object[] { currentPhaseClose.get_n1(), currentPhaseClose.get_n2(), currentPhaseClose.get_n3(), currentPhaseClose.get_n4(), currentPhaseClose.get_n5(), currentPhaseClose.get_n6(), currentPhaseClose.get_sn() }) : "";
                    string str3 = (currentPhaseClose != null) ? string.Format("{0},{1},{2},{3},{4},{5},{6}", new object[] { currentPhaseClose.get_zodiac_n1(), currentPhaseClose.get_zodiac_n2(), currentPhaseClose.get_zodiac_n3(), currentPhaseClose.get_zodiac_n4(), currentPhaseClose.get_zodiac_n5(), currentPhaseClose.get_zodiac_n6(), currentPhaseClose.get_zodiac_sn() }) : "";
                    dictionary2.Add("profit", "");
                    dictionary2.Add("upopenphase", str);
                    dictionary2.Add("upopennumber", str2);
                    dictionary2.Add("upopennumberzodiac", str3);
                    result.set_success(200);
                }
                cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                DateTime now = DateTime.Now;
                string str4 = "n";
                DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                if (time2 >= now)
                {
                    str4 = "y";
                }
                if (time3 >= now)
                {
                    str4 = "y";
                }
                if (currentPhase.get_is_closed().ToString().Equals("1") || str4.Equals("n"))
                {
                    dictionary2.Add("isopen", "n");
                }
                else
                {
                    dictionary2.Add("isopen", "y");
                }
                dictionary.Add("opennumber", dictionary2);
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
            }
        }

        private string getlongnum(string ss_str)
        {
            string[] strArray = ss_str.Split(new char[] { ',' });
            string str = "";
            foreach (string str2 in strArray)
            {
                str = str + this.getnum(str2) + ",";
            }
            return str.Substring(0, str.Length - 1);
        }

        private string getnum(string ss_num)
        {
            int num = 0;
            num = int.Parse(ss_num);
            if (num < 10)
            {
                return ("0" + num.ToString());
            }
            return num.ToString();
        }

        public DataTable GetNumberWTTable(string oddsid, string sqlconn, string salt)
        {
            DbHelperSQL_Ex.connectionString = string.Format(PubConstant.get_ConnectionStringExtend(), DESEncrypt.DecryptStringDES(sqlconn, salt));
            DataTable wT = null;
            string str = "";
            switch (oddsid)
            {
                case "92286":
                    str = "select * from cz_wt_3z2_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92285":
                    str = "select * from cz_wt_3qz_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92287":
                    str = "select * from cz_wt_2qz_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92288":
                    str = "select * from cz_wt_2zt_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92289":
                    str = "select * from cz_wt_tc_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92575":
                    str = "select * from cz_wt_4z1_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92638":
                    str = "select * from cz_wt_3qz_b_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92639":
                    str = "select * from cz_wt_3z2_b_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92640":
                    str = "select * from cz_wt_2qz_b_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92641":
                    str = "select * from cz_wt_2zt_b_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92642":
                    str = "select * from cz_wt_tc_b_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92643":
                    str = "select * from cz_wt_4z1_b_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92566":
                    wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT();
                    str = "select * from cz_wt_sxlwsl_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92567":
                    str = "select * from cz_wt_sxlwsl_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92568":
                    str = "select * from cz_wt_sxlwsl_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92636":
                    str = "select * from cz_wt_sxlwsl_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92569":
                    str = "select * from cz_wt_sxlwsl_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92570":
                    str = "select * from cz_wt_sxlwsl_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92571":
                    str = "select * from cz_wt_sxlwsl_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92637":
                    str = "select * from cz_wt_sxlwsl_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92572":
                    str = "select * from cz_wt_5bz_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92588":
                    str = "select * from cz_wt_6bz_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92589":
                    str = "select * from cz_wt_7bz_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92590":
                    str = "select * from cz_wt_8bz_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92591":
                    str = "select * from cz_wt_9bz_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];

                case "92592":
                    str = "select * from cz_wt_10bz_six order by number asc";
                    return DbHelperSQL_Ex.Query(str, null).Tables[0];
            }
            return wT;
        }

        public Dictionary<string, object> GetOddsByOddsIds(string odds_ids, string pk_kind)
        {
            DataTable oddsTableByOddsIds = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(odds_ids);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
            Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
            List<double> collection = new List<double>();
            string key = "";
            string str2 = "";
            string str3 = "";
            string str4 = "";
            string str5 = "";
            foreach (DataRow row in oddsTableByOddsIds.Rows)
            {
                key = row["odds_id"].ToString();
                string s = row["current_odds"].ToString();
                string str7 = row["max_odds"].ToString();
                string str8 = row["min_odds"].ToString();
                string str9 = row[pk_kind + "_diff"].ToString().Trim();
                if (s != "-")
                {
                    try
                    {
                        string[] strArray = row["current_odds"].ToString().Split(new char[] { ',' });
                        string[] strArray2 = row["max_odds"].ToString().Split(new char[] { ',' });
                        string[] strArray3 = row["min_odds"].ToString().Split(new char[] { ',' });
                        string[] strArray4 = row[pk_kind + "_diff"].ToString().Trim().Split(new char[] { ',' });
                        if (strArray.Length > 1)
                        {
                            if (strArray4.Length > 1)
                            {
                                str2 = ((double.Parse(strArray[0]) + double.Parse(strArray4[0]))).ToString() + "," + ((double.Parse(strArray[1]) + double.Parse(strArray4[1]))).ToString();
                                str3 = ((double.Parse(strArray2[0]) + double.Parse(strArray4[0]))).ToString() + "," + ((double.Parse(strArray2[1]) + double.Parse(strArray4[1]))).ToString();
                                str4 = ((double.Parse(strArray3[0]) + double.Parse(strArray4[0]))).ToString() + "," + ((double.Parse(strArray3[1]) + double.Parse(strArray4[1]))).ToString();
                            }
                            else
                            {
                                str2 = ((double.Parse(strArray[0]) + double.Parse(strArray4[0]))).ToString() + "," + ((double.Parse(strArray[1]) + double.Parse(strArray4[0]))).ToString();
                                str3 = ((double.Parse(strArray2[0]) + double.Parse(strArray4[0]))).ToString() + "," + ((double.Parse(strArray2[1]) + double.Parse(strArray4[0]))).ToString();
                                str4 = ((double.Parse(strArray3[0]) + double.Parse(strArray4[0]))).ToString() + "," + ((double.Parse(strArray3[1]) + double.Parse(strArray4[0]))).ToString();
                            }
                        }
                        else
                        {
                            str2 = (double.Parse(s) + double.Parse(str9)).ToString();
                            str3 = (double.Parse(str7) + double.Parse(str9)).ToString();
                            str4 = (double.Parse(str8) + double.Parse(str9)).ToString();
                        }
                    }
                    catch (Exception exception)
                    {
                        string message = exception.Message;
                    }
                }
                else
                {
                    str2 = s;
                    str3 = str7;
                    str4 = str8;
                }
                str5 = row["is_open"].ToString();
                dictionary3.Add("pl", str2);
                dictionary3.Add("maxpl", str3);
                dictionary3.Add("minpl", str4);
                dictionary3.Add("plx", new List<double>(collection));
                dictionary3.Add("is_open", str5);
                dictionary2.Add(key, new Dictionary<string, object>(dictionary3));
                dictionary3.Clear();
                collection.Clear();
            }
            dictionary.Add("play_odds", dictionary2);
            return dictionary;
        }

        public Dictionary<string, object> GetOddsByOddsIds_wt(agent_userinfo_session uModel, HttpContext context, string odds_ids, string pk_kind)
        {
            DataTable oddsTableByOddsIds = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(odds_ids);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
            Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
            List<double> collection = new List<double>();
            foreach (DataRow row in oddsTableByOddsIds.Rows)
            {
                double num = 0.0;
                double num2 = 0.0;
                double num3 = 0.0;
                string str = row["odds_id"].ToString();
                double num4 = double.Parse(row["current_odds"].ToString());
                double.Parse(row["max_odds"].ToString());
                double num5 = double.Parse(row["min_odds"].ToString());
                double num6 = double.Parse(row[pk_kind + "_diff"].ToString().Trim());
                double wtvalue = 0.0;
                base.GetOperate_SIX(str, ref wtvalue);
                num = double.Parse(((num4 + num6) + wtvalue).ToString());
                num2 = double.Parse((num4 + num6).ToString());
                num3 = double.Parse((((num4 - num5) + num6) + 1.0).ToString());
                string str2 = row["is_open"].ToString();
                dictionary3.Add("pl", num.ToString());
                dictionary3.Add("maxpl", num2.ToString());
                dictionary3.Add("minpl", num3.ToString());
                dictionary3.Add("plx", new List<double>(collection));
                dictionary3.Add("is_open", str2);
                dictionary2.Add(str, new Dictionary<string, object>(dictionary3));
                dictionary3.Clear();
                collection.Clear();
            }
            dictionary.Add("play_odds", dictionary2);
            return dictionary;
        }

        public Dictionary<string, string> GetWT_BZ(string pk, string playid)
        {
            cz_odds_six oddsByPlayID = CallBLL.cz_odds_six_bll.GetOddsByPlayID(Convert.ToInt32(playid));
            string s = "";
            string str2 = "";
            double num = 0.0;
            Dictionary<string, string> dictionary = new Dictionary<string, string>();
            DataTable wT = null;
            string str7 = playid;
            if (str7 != null)
            {
                if (!(str7 == "91037"))
                {
                    if (str7 == "91047")
                    {
                        wT = CallBLL.cz_wt_6bz_six_bll.GetWT();
                    }
                    else if (str7 == "91048")
                    {
                        wT = CallBLL.cz_wt_7bz_six_bll.GetWT();
                    }
                    else if (str7 == "91049")
                    {
                        wT = CallBLL.cz_wt_8bz_six_bll.GetWT();
                    }
                    else if (str7 == "91050")
                    {
                        wT = CallBLL.cz_wt_9bz_six_bll.GetWT();
                    }
                    else if (str7 == "91051")
                    {
                        wT = CallBLL.cz_wt_10bz_six_bll.GetWT();
                    }
                }
                else
                {
                    wT = CallBLL.cz_wt_5bz_six_bll.GetWT();
                }
            }
            foreach (DataRow row in wT.Rows)
            {
                string str3 = "";
                string str4 = "";
                string str5 = "";
                double num2 = Convert.ToDouble(row["wt_value"]);
                s = oddsByPlayID.get_current_odds();
                str2 = oddsByPlayID.get_max_odds();
                oddsByPlayID.get_min_odds();
                if (pk.Equals("A"))
                {
                    num = Convert.ToDouble(oddsByPlayID.get_a_diff());
                }
                else if (pk.Equals("B"))
                {
                    num = Convert.ToDouble(oddsByPlayID.get_b_diff());
                }
                else if (pk.Equals("C"))
                {
                    num = Convert.ToDouble(oddsByPlayID.get_c_diff());
                }
                str3 = ((double.Parse(s) + num) + num2).ToString();
                str4 = double.Parse(str2).ToString();
                str5 = "1";
                str3 = double.Parse(str3).ToString();
                string str6 = str3 + "," + str4 + "," + str5;
                dictionary.Add(row["number"].ToString(), str6);
            }
            return dictionary;
        }

        public Dictionary<string, string> GetWT_BZ_wt(agent_userinfo_session uModel, HttpContext context, string pk, string playid)
        {
            cz_odds_six oddsByPlayID = CallBLL.cz_odds_six_bll.GetOddsByPlayID(Convert.ToInt32(playid));
            string s = "";
            string str2 = "";
            string str3 = "";
            string str4 = "";
            Dictionary<string, string> dictionary = new Dictionary<string, string>();
            DataTable wT = null;
            string str9 = playid;
            if (str9 != null)
            {
                if (!(str9 == "91037"))
                {
                    if (str9 == "91047")
                    {
                        wT = CallBLL.cz_wt_6bz_six_bll.GetWT();
                    }
                    else if (str9 == "91048")
                    {
                        wT = CallBLL.cz_wt_7bz_six_bll.GetWT();
                    }
                    else if (str9 == "91049")
                    {
                        wT = CallBLL.cz_wt_8bz_six_bll.GetWT();
                    }
                    else if (str9 == "91050")
                    {
                        wT = CallBLL.cz_wt_9bz_six_bll.GetWT();
                    }
                    else if (str9 == "91051")
                    {
                        wT = CallBLL.cz_wt_10bz_six_bll.GetWT();
                    }
                }
                else
                {
                    wT = CallBLL.cz_wt_5bz_six_bll.GetWT();
                }
            }
            foreach (DataRow row in wT.Rows)
            {
                string pl = "";
                string maxpl = "";
                string minpl = "1";
                double num = Convert.ToDouble(row["wt_value"]);
                s = oddsByPlayID.get_current_odds();
                str2 = oddsByPlayID.get_max_odds();
                oddsByPlayID.get_min_odds();
                str3 = oddsByPlayID.get_b_diff();
                str4 = oddsByPlayID.get_c_diff();
                if (pk.ToUpper().Equals("B"))
                {
                    pl = ((double.Parse(s) + double.Parse(str3)) + num).ToString();
                    maxpl = (double.Parse(str2) + double.Parse(str3)).ToString();
                }
                else if (pk.ToUpper().Equals("C"))
                {
                    pl = ((double.Parse(s) + double.Parse(str4)) + num).ToString();
                    maxpl = (double.Parse(str2) + double.Parse(str4)).ToString();
                }
                else
                {
                    pl = (double.Parse(s) + num).ToString();
                    maxpl = double.Parse(str2).ToString();
                }
                base.GetOdds_SIX(oddsByPlayID.get_odds_id().ToString(), ref pl, ref maxpl, ref minpl);
                string str8 = pl + "," + maxpl + "," + minpl;
                dictionary.Add(row["number"].ToString(), str8);
            }
            return dictionary;
        }

        public Dictionary<string, string> GetWT_BZ_wt(agent_userinfo_session userModel, HttpContext context, string pk, string playid, string odds_id)
        {
            cz_odds_six oddsByPlayID = CallBLL.cz_odds_six_bll.GetOddsByPlayID(Convert.ToInt32(playid));
            string s = "";
            string str2 = "";
            string str3 = "";
            string str4 = "";
            Dictionary<string, string> dictionary = new Dictionary<string, string>();
            DataTable wT = null;
            string str10 = playid;
            if (str10 != null)
            {
                if (!(str10 == "91037"))
                {
                    if (str10 == "91047")
                    {
                        wT = CallBLL.cz_wt_6bz_six_bll.GetWT();
                    }
                    else if (str10 == "91048")
                    {
                        wT = CallBLL.cz_wt_7bz_six_bll.GetWT();
                    }
                    else if (str10 == "91049")
                    {
                        wT = CallBLL.cz_wt_8bz_six_bll.GetWT();
                    }
                    else if (str10 == "91050")
                    {
                        wT = CallBLL.cz_wt_9bz_six_bll.GetWT();
                    }
                    else if (str10 == "91051")
                    {
                        wT = CallBLL.cz_wt_10bz_six_bll.GetWT();
                    }
                }
                else
                {
                    wT = CallBLL.cz_wt_5bz_six_bll.GetWT();
                }
            }
            foreach (DataRow row in wT.Rows)
            {
                string pl = "";
                string maxpl = "";
                string minpl = "1";
                double num = Convert.ToDouble(row["wt_value"]);
                if (oddsByPlayID.get_current_odds().Split(new char[] { ',' }).Length > 1)
                {
                    s = oddsByPlayID.get_current_odds();
                    str2 = oddsByPlayID.get_max_odds();
                    oddsByPlayID.get_min_odds();
                    str3 = oddsByPlayID.get_b_diff();
                    str4 = oddsByPlayID.get_c_diff();
                    if (pk.ToUpper().Equals("B"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str3)) + num).ToString();
                        maxpl = (double.Parse(str2) + double.Parse(str3)).ToString();
                    }
                    else if (pk.ToUpper().Equals("C"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str4)) + num).ToString();
                        maxpl = (double.Parse(str2) + double.Parse(str4)).ToString();
                    }
                    else
                    {
                        pl = (double.Parse(s) + num).ToString();
                        maxpl = double.Parse(str2).ToString();
                    }
                    base.GetOdds_SIX(odds_id, ref pl, ref maxpl, ref minpl);
                    string str8 = pl + "," + maxpl + "," + minpl;
                    dictionary.Add(row["number"].ToString(), str8);
                }
                else
                {
                    s = oddsByPlayID.get_current_odds();
                    str2 = oddsByPlayID.get_max_odds();
                    oddsByPlayID.get_min_odds();
                    str3 = oddsByPlayID.get_b_diff();
                    str4 = oddsByPlayID.get_c_diff();
                    if (pk.ToUpper().Equals("B"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str3)) + num).ToString();
                        maxpl = (double.Parse(str2) + double.Parse(str3)).ToString();
                    }
                    else if (pk.ToLower().Equals("C"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str4)) + num).ToString();
                        maxpl = (double.Parse(str2) + double.Parse(str4)).ToString();
                    }
                    else
                    {
                        pl = (double.Parse(s) + num).ToString();
                        maxpl = double.Parse(str2).ToString();
                    }
                    base.GetOdds_SIX(odds_id, ref pl, ref maxpl, ref minpl);
                    string str9 = pl + "," + maxpl + "," + minpl;
                    dictionary.Add(row["number"].ToString(), str9);
                }
            }
            return dictionary;
        }

        public Dictionary<string, string> GetWT_LM(string pk, string playid)
        {
            cz_odds_six oddsByPlayID = CallBLL.cz_odds_six_bll.GetOddsByPlayID(Convert.ToInt32(playid));
            string s = "";
            string str2 = "";
            string str3 = "";
            string str4 = "";
            string str5 = "";
            string str6 = "";
            Dictionary<string, string> dictionary = new Dictionary<string, string>();
            DataTable wT = null;
            switch (playid)
            {
                case "91016":
                    wT = CallBLL.cz_wt_3qz_six_bll.GetWT();
                    break;

                case "91017":
                    wT = CallBLL.cz_wt_3z2_six_bll.GetWT();
                    break;

                case "91018":
                    wT = CallBLL.cz_wt_2qz_six_bll.GetWT();
                    break;

                case "91019":
                    wT = CallBLL.cz_wt_2zt_six_bll.GetWT();
                    break;

                case "91020":
                    wT = CallBLL.cz_wt_tc_six_bll.GetWT();
                    break;

                case "91040":
                    wT = CallBLL.cz_wt_4z1_six_bll.GetWT();
                    break;

                case "91060":
                    wT = CallBLL.cz_wt_3qz_b_six_bll.GetWT();
                    break;

                case "91061":
                    wT = CallBLL.cz_wt_3z2_b_six_bll.GetWT();
                    break;

                case "91062":
                    wT = CallBLL.cz_wt_2qz_b_six_bll.GetWT();
                    break;

                case "91063":
                    wT = CallBLL.cz_wt_2zt_b_six_bll.GetWT();
                    break;

                case "91064":
                    wT = CallBLL.cz_wt_tc_b_six_bll.GetWT();
                    break;

                case "91065":
                    wT = CallBLL.cz_wt_4z1_b_six_bll.GetWT();
                    break;
            }
            foreach (DataRow row in wT.Rows)
            {
                string str7 = "";
                string str8 = "";
                string str9 = "";
                string str10 = "";
                string str11 = "";
                string str12 = "";
                double num = Convert.ToDouble(row["wt_value"]);
                if (oddsByPlayID.get_current_odds().Split(new char[] { ',' }).Length > 1)
                {
                    s = oddsByPlayID.get_current_odds().Split(new char[] { ',' })[0];
                    str2 = oddsByPlayID.get_current_odds().Split(new char[] { ',' })[1];
                    string text1 = oddsByPlayID.get_max_odds().Split(new char[] { ',' })[0];
                    string text2 = oddsByPlayID.get_max_odds().Split(new char[] { ',' })[1];
                    string text3 = oddsByPlayID.get_min_odds().Split(new char[] { ',' })[0];
                    string text4 = oddsByPlayID.get_min_odds().Split(new char[] { ',' })[1];
                    str3 = oddsByPlayID.get_b_diff().Split(new char[] { ',' })[0];
                    str4 = oddsByPlayID.get_b_diff().Split(new char[] { ',' })[1];
                    str5 = oddsByPlayID.get_c_diff().Split(new char[] { ',' })[0];
                    str6 = oddsByPlayID.get_c_diff().Split(new char[] { ',' })[1];
                    str9 = double.Parse(s).ToString();
                    str11 = "1";
                    str10 = double.Parse(str2).ToString();
                    str12 = "1";
                    if (pk.ToUpper().Equals("B"))
                    {
                        str7 = ((decimal.Parse(s) + decimal.Parse(str3)) + decimal.Parse(num.ToString())).ToString();
                        str8 = ((decimal.Parse(str2) + decimal.Parse(str4)) + decimal.Parse(num.ToString())).ToString();
                    }
                    else if (pk.ToUpper().Equals("C"))
                    {
                        str7 = ((decimal.Parse(s) + decimal.Parse(str5)) + decimal.Parse(num.ToString())).ToString();
                        str8 = ((decimal.Parse(str2) + decimal.Parse(str6)) + decimal.Parse(num.ToString())).ToString();
                    }
                    else
                    {
                        str7 = (decimal.Parse(s) + decimal.Parse(num.ToString())).ToString();
                        str8 = (decimal.Parse(str2) + decimal.Parse(num.ToString())).ToString();
                    }
                    str7 = double.Parse(str7).ToString();
                    str8 = double.Parse(str8).ToString();
                    string str13 = str7 + "," + str9 + "," + str11 + "|" + str8 + "," + str10 + "," + str12;
                    dictionary.Add(row["number"].ToString(), str13);
                }
                else
                {
                    s = oddsByPlayID.get_current_odds();
                    oddsByPlayID.get_max_odds();
                    oddsByPlayID.get_min_odds();
                    str3 = oddsByPlayID.get_b_diff();
                    str5 = oddsByPlayID.get_c_diff();
                    str9 = double.Parse(s).ToString();
                    str11 = "1";
                    if (pk.ToUpper().Equals("B"))
                    {
                        str7 = ((decimal.Parse(s) + decimal.Parse(str3)) + decimal.Parse(num.ToString())).ToString();
                    }
                    else if (pk.ToUpper().Equals("C"))
                    {
                        str7 = ((decimal.Parse(s) + decimal.Parse(str5)) + decimal.Parse(num.ToString())).ToString();
                    }
                    else
                    {
                        str7 = (decimal.Parse(s) + decimal.Parse(num.ToString())).ToString();
                    }
                    str7 = double.Parse(str7).ToString();
                    string str14 = str7 + "," + str9 + "," + str11;
                    dictionary.Add(row["number"].ToString(), str14);
                }
            }
            return dictionary;
        }

        public Dictionary<string, string> GetWT_LM_wt(agent_userinfo_session uModel, HttpContext context, string pk, string playid)
        {
            cz_odds_six oddsByPlayID = CallBLL.cz_odds_six_bll.GetOddsByPlayID(Convert.ToInt32(playid));
            string s = "";
            string str2 = "";
            string str3 = "";
            string str4 = "";
            string str5 = "";
            string str6 = "";
            Dictionary<string, string> dictionary = new Dictionary<string, string>();
            DataTable wT = null;
            switch (playid)
            {
                case "91016":
                    wT = CallBLL.cz_wt_3qz_six_bll.GetWT();
                    break;

                case "91017":
                    wT = CallBLL.cz_wt_3z2_six_bll.GetWT();
                    break;

                case "91018":
                    wT = CallBLL.cz_wt_2qz_six_bll.GetWT();
                    break;

                case "91019":
                    wT = CallBLL.cz_wt_2zt_six_bll.GetWT();
                    break;

                case "91020":
                    wT = CallBLL.cz_wt_tc_six_bll.GetWT();
                    break;

                case "91040":
                    wT = CallBLL.cz_wt_4z1_six_bll.GetWT();
                    break;

                case "91060":
                    wT = CallBLL.cz_wt_3qz_b_six_bll.GetWT();
                    break;

                case "91061":
                    wT = CallBLL.cz_wt_3z2_b_six_bll.GetWT();
                    break;

                case "91062":
                    wT = CallBLL.cz_wt_2qz_b_six_bll.GetWT();
                    break;

                case "91063":
                    wT = CallBLL.cz_wt_2zt_b_six_bll.GetWT();
                    break;

                case "91064":
                    wT = CallBLL.cz_wt_tc_b_six_bll.GetWT();
                    break;

                case "91065":
                    wT = CallBLL.cz_wt_4z1_b_six_bll.GetWT();
                    break;
            }
            foreach (DataRow row in wT.Rows)
            {
                string pl = "";
                string str8 = "";
                string maxpl = "";
                string str10 = "";
                string minpl = "1";
                string str12 = "1";
                double num = Convert.ToDouble(row["wt_value"]);
                if (oddsByPlayID.get_current_odds().Split(new char[] { ',' }).Length > 1)
                {
                    s = oddsByPlayID.get_current_odds().Split(new char[] { ',' })[0];
                    str2 = oddsByPlayID.get_current_odds().Split(new char[] { ',' })[1];
                    string text1 = oddsByPlayID.get_max_odds().Split(new char[] { ',' })[0];
                    string text2 = oddsByPlayID.get_max_odds().Split(new char[] { ',' })[1];
                    string text3 = oddsByPlayID.get_min_odds().Split(new char[] { ',' })[0];
                    string text4 = oddsByPlayID.get_min_odds().Split(new char[] { ',' })[1];
                    str3 = oddsByPlayID.get_b_diff().Split(new char[] { ',' })[0];
                    str4 = oddsByPlayID.get_b_diff().Split(new char[] { ',' })[1];
                    str5 = oddsByPlayID.get_c_diff().Split(new char[] { ',' })[0];
                    str6 = oddsByPlayID.get_c_diff().Split(new char[] { ',' })[1];
                    if (pk.ToUpper().Equals("B"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str3)) + num).ToString();
                        maxpl = (double.Parse(s) + double.Parse(str3)).ToString();
                        str8 = ((double.Parse(str2) + double.Parse(str4)) + num).ToString();
                        str10 = (double.Parse(str2) + double.Parse(str4)).ToString();
                    }
                    else if (pk.ToUpper().Equals("C"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str5)) + num).ToString();
                        maxpl = (double.Parse(s) + double.Parse(str5)).ToString();
                        str8 = ((double.Parse(str2) + double.Parse(str6)) + num).ToString();
                        str10 = (double.Parse(str2) + double.Parse(str6)).ToString();
                    }
                    else
                    {
                        pl = (double.Parse(s) + num).ToString();
                        maxpl = double.Parse(s).ToString();
                        str8 = (double.Parse(str2) + num).ToString();
                        str10 = double.Parse(str2).ToString();
                    }
                    base.GetOdds_SIX_WT(oddsByPlayID.get_odds_id().ToString(), ref pl, ref maxpl, ref minpl, "0");
                    base.GetOdds_SIX_WT(oddsByPlayID.get_odds_id().ToString(), ref str8, ref str10, ref str12, "1");
                    string str13 = pl + "," + maxpl + "," + minpl + "|" + str8 + "," + str10 + "," + str12;
                    dictionary.Add(row["number"].ToString(), str13);
                }
                else
                {
                    s = oddsByPlayID.get_current_odds();
                    oddsByPlayID.get_max_odds();
                    oddsByPlayID.get_min_odds();
                    str3 = oddsByPlayID.get_b_diff();
                    str5 = oddsByPlayID.get_c_diff();
                    if (pk.ToUpper().Equals("B"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str3)) + num).ToString();
                        maxpl = (double.Parse(s) + double.Parse(str3)).ToString();
                    }
                    else if (pk.ToUpper().Equals("C"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str5)) + num).ToString();
                        maxpl = (double.Parse(s) + double.Parse(str5)).ToString();
                    }
                    else
                    {
                        pl = (double.Parse(s) + num).ToString();
                        maxpl = double.Parse(s).ToString();
                    }
                    base.GetOdds_SIX_WT(oddsByPlayID.get_odds_id().ToString(), ref pl, ref maxpl, ref minpl, "0");
                    string str14 = pl + "," + maxpl + "," + minpl;
                    dictionary.Add(row["number"].ToString(), str14);
                }
            }
            return dictionary;
        }

        public DataTable GetWT_LXLWSL(DataTable oddsDT)
        {
            string str = "";
            for (int i = 0; i < oddsDT.Rows.Count; i++)
            {
                if (i.Equals(0))
                {
                    str = str + oddsDT.Rows[i]["odds_id"];
                }
                else
                {
                    str = str + "," + oddsDT.Rows[i]["odds_id"];
                }
            }
            return CallBLL.cz_wt_sxlwsl_six_bll.GetWT(str);
        }

        public Dictionary<string, string> GetWT_LXLWSL(string lxlwslType, string pl, string maxpl, string minpl, int zodiacID, DataRow[] wtDataRow)
        {
            string str = pl.Split(new char[] { ',' })[0];
            string str2 = pl.Split(new char[] { ',' })[1];
            string str3 = maxpl.Split(new char[] { ',' })[0];
            string str4 = maxpl.Split(new char[] { ',' })[1];
            string s = minpl.Split(new char[] { ',' })[0];
            string str6 = minpl.Split(new char[] { ',' })[1];
            Dictionary<string, string> dictionary = new Dictionary<string, string>();
            if (lxlwslType.Equals("lxltype"))
            {
                string str7 = str;
                string str8 = str3;
                string str9 = s;
                int num = 1;
                for (int i = 0; i < 12; i++)
                {
                    if (num.Equals(zodiacID))
                    {
                        str7 = str7 + "," + str2;
                        str8 = str8 + "," + str4;
                        str9 = str9 + "," + str6;
                    }
                    else
                    {
                        string str10 = (Convert.ToDouble(str) + Convert.ToDouble(wtDataRow[i]["wt_value"])).ToString();
                        string str11 = str;
                        double.Parse(s).ToString();
                        str7 = str7 + "," + str10;
                        str8 = str8 + "," + str11;
                        str9 = str9 + ",1";
                    }
                    num++;
                }
                dictionary.Add("pl", str7);
                dictionary.Add("maxpl", str8);
                dictionary.Add("minpl", str9);
            }
            if (lxlwslType.Equals("wsltype"))
            {
                string str12 = str2;
                string str13 = str4;
                string str14 = str6;
                for (int j = 0; j < 9; j++)
                {
                    string str15 = (Convert.ToDouble(str) + Convert.ToDouble(wtDataRow[j]["wt_value"])).ToString();
                    string str16 = str;
                    double.Parse(s).ToString();
                    str12 = str12 + "," + str15;
                    str13 = str13 + "," + str16;
                    str14 = str14 + ",1";
                }
                str12 = str12 + "," + str;
                str13 = str13 + "," + str3;
                str14 = str14 + "," + s;
                dictionary.Add("pl", str12);
                dictionary.Add("maxpl", str13);
                dictionary.Add("minpl", str14);
            }
            return dictionary;
        }

        public Dictionary<string, string> GetWT_LXLWSL_wt(agent_userinfo_session uModel, HttpContext context, string odds_id, string lxlwslType, int zodiacID, DataRow[] wtDataRow, string pk)
        {
            double num = 0.0;
            double num2 = 0.0;
            base.GetOperate_SIX(odds_id, ref num, ref num2);
            cz_odds_six model = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(odds_id));
            double num3 = Convert.ToDouble(model.get_current_odds().Split(new char[] { ',' })[0]);
            double num4 = 0.0;
            if (model.get_current_odds().Split(new char[] { ',' }).Length > 1)
            {
                num4 = Convert.ToDouble(model.get_current_odds().Split(new char[] { ',' })[1]);
            }
            Convert.ToDouble(model.get_max_odds().Split(new char[] { ',' })[0]);
            if (model.get_max_odds().Split(new char[] { ',' }).Length > 1)
            {
                Convert.ToDouble(model.get_max_odds().Split(new char[] { ',' })[1]);
            }
            double num5 = Convert.ToDouble(model.get_min_odds().Split(new char[] { ',' })[0]);
            double num6 = 0.0;
            if (model.get_min_odds().Split(new char[] { ',' }).Length > 1)
            {
                num6 = Convert.ToDouble(model.get_min_odds().Split(new char[] { ',' })[1]);
            }
            string str = "0";
            double num7 = 0.0;
            double num8 = 0.0;
            if (pk.Equals("A"))
            {
                str = model.get_a_diff();
            }
            else if (pk.Equals("B"))
            {
                str = model.get_b_diff();
            }
            else if (pk.Equals("C"))
            {
                str = model.get_c_diff();
            }
            num7 = double.Parse(str.Split(new char[] { ',' })[0]);
            if (str.Split(new char[] { ',' }).Length > 1)
            {
                num8 = double.Parse(str.Split(new char[] { ',' })[1]);
            }
            double num9 = double.Parse(((num3 + num7) + num).ToString());
            double num10 = double.Parse(((num4 + num8) + num2).ToString());
            double num11 = double.Parse((num3 + num7).ToString());
            double num12 = double.Parse((num4 + num8).ToString());
            double num13 = double.Parse((((num3 - num5) + num7) + 1.0).ToString());
            double num14 = double.Parse((((num4 - num6) + num8) + 1.0).ToString());
            Dictionary<string, string> dictionary = new Dictionary<string, string>();
            if (lxlwslType.Equals("lxltype"))
            {
                string str2 = num9.ToString();
                string str3 = num11.ToString();
                string str4 = num13.ToString();
                int num15 = 1;
                for (int i = 0; i < 12; i++)
                {
                    if (num15.Equals(zodiacID))
                    {
                        str2 = str2 + "," + num10;
                        str3 = str3 + "," + num12;
                        str4 = str4 + "," + num14;
                    }
                    else
                    {
                        string str5 = (num9 + double.Parse(wtDataRow[i]["wt_value"].ToString())).ToString();
                        string str6 = (num11 + double.Parse(wtDataRow[i]["wt_value"].ToString())).ToString();
                        string str7 = (num13 + double.Parse(wtDataRow[i]["wt_value"].ToString())).ToString();
                        str2 = str2 + "," + str5;
                        str3 = str3 + "," + str6;
                        str4 = str4 + "," + str7;
                    }
                    num15++;
                }
                dictionary.Add("pl", str2);
                dictionary.Add("maxpl", str3);
                dictionary.Add("minpl", str4);
            }
            if (lxlwslType.Equals("wsltype"))
            {
                string str8 = num10.ToString();
                string str9 = num12.ToString();
                string str10 = num14.ToString();
                for (int j = 0; j < 9; j++)
                {
                    string str11 = "";
                    string str12 = "";
                    string str13 = "";
                    str11 = (num9 + double.Parse(wtDataRow[j]["wt_value"].ToString())).ToString();
                    str12 = num11.ToString();
                    str13 = (num11 + double.Parse(wtDataRow[j]["wt_value"].ToString())).ToString();
                    str8 = str8 + "," + str11;
                    str9 = str9 + "," + str12;
                    str10 = str10 + "," + str13;
                }
                str8 = str8 + "," + num9.ToString();
                str9 = str9 + "," + num11.ToString();
                str10 = str10 + "," + num13.ToString();
                dictionary.Add("pl", str8);
                dictionary.Add("maxpl", str9);
                dictionary.Add("minpl", str10);
            }
            return dictionary;
        }

        public Dictionary<string, string> GetWT_LXYZ(string pk, string playid)
        {
            cz_odds_six oddsByPlayID = CallBLL.cz_odds_six_bll.GetOddsByPlayID(Convert.ToInt32(playid));
            string s = "";
            string str2 = "";
            string str3 = "";
            string str4 = "";
            string str5 = "";
            string str6 = "";
            Dictionary<string, string> dictionary = new Dictionary<string, string>();
            foreach (DataRow row in CallBLL.cz_wt_6xyz_six_bll.GetWT().Rows)
            {
                string str7 = "";
                string str8 = "";
                string str9 = "";
                string str10 = "";
                string str11 = "";
                string str12 = "";
                double num = Convert.ToDouble(row["wt_value"]);
                if (oddsByPlayID.get_current_odds().Split(new char[] { ',' }).Length > 1)
                {
                    s = oddsByPlayID.get_current_odds().Split(new char[] { ',' })[0];
                    str2 = oddsByPlayID.get_current_odds().Split(new char[] { ',' })[1];
                    string text1 = oddsByPlayID.get_max_odds().Split(new char[] { ',' })[0];
                    string text2 = oddsByPlayID.get_max_odds().Split(new char[] { ',' })[1];
                    string text3 = oddsByPlayID.get_min_odds().Split(new char[] { ',' })[0];
                    string text4 = oddsByPlayID.get_min_odds().Split(new char[] { ',' })[1];
                    str3 = oddsByPlayID.get_b_diff().Split(new char[] { ',' })[0];
                    str4 = oddsByPlayID.get_b_diff().Split(new char[] { ',' })[1];
                    str5 = oddsByPlayID.get_c_diff().Split(new char[] { ',' })[0];
                    str6 = oddsByPlayID.get_c_diff().Split(new char[] { ',' })[1];
                    str9 = double.Parse(s).ToString();
                    str11 = "1";
                    str10 = double.Parse(str2).ToString();
                    str12 = "1";
                    if (pk.ToUpper().Equals("B"))
                    {
                        str7 = ((decimal.Parse(s) + decimal.Parse(str3)) + decimal.Parse(num.ToString())).ToString();
                        str8 = ((decimal.Parse(str2) + decimal.Parse(str4)) + decimal.Parse(num.ToString())).ToString();
                    }
                    else if (pk.ToUpper().Equals("C"))
                    {
                        str7 = ((decimal.Parse(s) + decimal.Parse(str5)) + decimal.Parse(num.ToString())).ToString();
                        str8 = ((decimal.Parse(str2) + decimal.Parse(str6)) + decimal.Parse(num.ToString())).ToString();
                    }
                    else
                    {
                        str7 = (decimal.Parse(s) + decimal.Parse(num.ToString())).ToString();
                        str8 = (decimal.Parse(str2) + decimal.Parse(num.ToString())).ToString();
                    }
                    str7 = double.Parse(str7).ToString();
                    str8 = double.Parse(str8).ToString();
                    string str13 = str7 + "," + str9 + "," + str11 + "|" + str8 + "," + str10 + "," + str12;
                    dictionary.Add(row["number"].ToString(), str13);
                }
                else
                {
                    s = oddsByPlayID.get_current_odds();
                    oddsByPlayID.get_max_odds();
                    oddsByPlayID.get_min_odds();
                    str3 = oddsByPlayID.get_b_diff();
                    str5 = oddsByPlayID.get_c_diff();
                    str9 = double.Parse(s).ToString();
                    str11 = "1";
                    if (pk.ToUpper().Equals("B"))
                    {
                        str7 = ((decimal.Parse(s) + decimal.Parse(str3)) + decimal.Parse(num.ToString())).ToString();
                    }
                    else if (pk.ToUpper().Equals("C"))
                    {
                        str7 = ((decimal.Parse(s) + decimal.Parse(str5)) + decimal.Parse(num.ToString())).ToString();
                    }
                    else
                    {
                        str7 = (decimal.Parse(s) + decimal.Parse(num.ToString())).ToString();
                    }
                    str7 = double.Parse(str7).ToString();
                    string str14 = str7 + "," + str9 + "," + str11;
                    dictionary.Add(row["number"].ToString(), str14);
                }
            }
            return dictionary;
        }

        public Dictionary<string, string> GetWT_LXYZ_wt(agent_userinfo_session uModel, HttpContext context, string pk, string playid)
        {
            cz_odds_six oddsByPlayID = CallBLL.cz_odds_six_bll.GetOddsByPlayID(Convert.ToInt32(playid));
            string s = "";
            string str2 = "";
            string str3 = "";
            string str4 = "";
            string str5 = "";
            string str6 = "";
            Dictionary<string, string> dictionary = new Dictionary<string, string>();
            foreach (DataRow row in CallBLL.cz_wt_6xyz_six_bll.GetWT().Rows)
            {
                string pl = "";
                string str8 = "";
                string maxpl = "";
                string str10 = "";
                string minpl = "1";
                string str12 = "1";
                double num = Convert.ToDouble(row["wt_value"]);
                if (oddsByPlayID.get_current_odds().Split(new char[] { ',' }).Length > 1)
                {
                    s = oddsByPlayID.get_current_odds().Split(new char[] { ',' })[0];
                    str2 = oddsByPlayID.get_current_odds().Split(new char[] { ',' })[1];
                    string text1 = oddsByPlayID.get_max_odds().Split(new char[] { ',' })[0];
                    string text2 = oddsByPlayID.get_max_odds().Split(new char[] { ',' })[1];
                    string text3 = oddsByPlayID.get_min_odds().Split(new char[] { ',' })[0];
                    string text4 = oddsByPlayID.get_min_odds().Split(new char[] { ',' })[1];
                    str3 = oddsByPlayID.get_b_diff().Split(new char[] { ',' })[0];
                    str4 = oddsByPlayID.get_b_diff().Split(new char[] { ',' })[1];
                    str5 = oddsByPlayID.get_c_diff().Split(new char[] { ',' })[0];
                    str6 = oddsByPlayID.get_c_diff().Split(new char[] { ',' })[1];
                    if (pk.ToUpper().Equals("B"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str3)) + num).ToString();
                        maxpl = (double.Parse(s) + double.Parse(str3)).ToString();
                        str8 = ((double.Parse(str2) + double.Parse(str4)) + num).ToString();
                        str10 = (double.Parse(str2) + double.Parse(str4)).ToString();
                    }
                    else if (pk.ToUpper().Equals("C"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str5)) + num).ToString();
                        maxpl = (double.Parse(s) + double.Parse(str5)).ToString();
                        str8 = ((double.Parse(str2) + double.Parse(str6)) + num).ToString();
                        str10 = (double.Parse(str2) + double.Parse(str6)).ToString();
                    }
                    else
                    {
                        pl = (double.Parse(s) + num).ToString();
                        maxpl = double.Parse(s).ToString();
                        str8 = (double.Parse(str2) + num).ToString();
                        str10 = double.Parse(str2).ToString();
                    }
                    base.GetOdds_SIX_WT(oddsByPlayID.get_odds_id().ToString(), ref pl, ref maxpl, ref minpl, "0");
                    base.GetOdds_SIX_WT(oddsByPlayID.get_odds_id().ToString(), ref str8, ref str10, ref str12, "1");
                    string str13 = pl + "," + maxpl + "," + minpl + "|" + str8 + "," + str10 + "," + str12;
                    dictionary.Add(row["number"].ToString(), str13);
                }
                else
                {
                    s = oddsByPlayID.get_current_odds();
                    oddsByPlayID.get_max_odds();
                    oddsByPlayID.get_min_odds();
                    str3 = oddsByPlayID.get_b_diff();
                    str5 = oddsByPlayID.get_c_diff();
                    if (pk.ToUpper().Equals("B"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str3)) + num).ToString();
                        maxpl = (double.Parse(s) + double.Parse(str3)).ToString();
                    }
                    else if (pk.ToUpper().Equals("C"))
                    {
                        pl = ((double.Parse(s) + double.Parse(str5)) + num).ToString();
                        maxpl = (double.Parse(s) + double.Parse(str5)).ToString();
                    }
                    else
                    {
                        pl = (double.Parse(s) + num).ToString();
                        maxpl = double.Parse(s).ToString();
                    }
                    base.GetOdds_SIX_WT(oddsByPlayID.get_odds_id().ToString(), ref pl, ref maxpl, ref minpl, "0");
                    string str14 = pl + "," + maxpl + "," + minpl;
                    dictionary.Add(row["number"].ToString(), str14);
                }
            }
            return dictionary;
        }

        private bool IsOpenPhase()
        {
            cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
            DateTime now = DateTime.Now;
            string str = "n";
            DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
            DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
            if (time2 >= now)
            {
                str = "y";
            }
            if (time3 >= now)
            {
                str = "y";
            }
            return (!currentPhase.get_is_closed().ToString().Equals("1") && !str.Equals("n"));
        }

        public void operate_adds(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                string str4 = LSRequest.qq("oddsid");
                LSRequest.qq("phaseid");
                string str5 = LSRequest.qq("pk");
                string str6 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                if (string.IsNullOrEmpty(str5))
                {
                    str5 = "A";
                }
                else
                {
                    str5 = str5.ToUpper();
                }
                if ((!str5.Equals("A") && !str5.Equals("B")) && !str5.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    cz_odds_six oldModel = null;
                    cz_odds_six _six2 = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                    {
                        oldModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (oldModel == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (base.IsChildSync())
                        {
                            _six2 = CallBLL.cz_odds_six_bll.ZK_GetModel(Convert.ToInt32(str4), base.IsChildSystem().get_conn());
                        }
                    }
                    if (!str3.Equals("1") && !str3.Equals("2"))
                    {
                        if (str3.Equals("3"))
                        {
                            double num10 = double.Parse(oldModel.get_current_odds());
                            double num11 = Convert.ToDouble(oldModel.get_max_odds());
                            double num12 = Convert.ToDouble(oldModel.get_min_odds());
                            double num13 = 0.0;
                            if (str5.Equals("A"))
                            {
                                num13 = Convert.ToDouble(oldModel.get_a_diff());
                            }
                            else if (str5.Equals("B"))
                            {
                                num13 = Convert.ToDouble(oldModel.get_b_diff());
                            }
                            else if (str5.Equals("C"))
                            {
                                num13 = Convert.ToDouble(oldModel.get_c_diff());
                            }
                            s = (double.Parse(s) - num13).ToString();
                            if (Convert.ToDouble(s) < num12)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num12));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else if (Convert.ToDouble(s) > num11)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num10));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else if ((_six2 != null) && (double.Parse(s) > double.Parse(_six2.get_current_odds())))
                            {
                                string str10 = _six2.get_current_odds();
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str10));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else if (CallBLL.cz_odds_six_bll.UpdateCurrentOdds(Convert.ToInt32(str4), Convert.ToDouble(s), str3) > 0)
                            {
                                cz_odds_six newModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                                base.tm_log(oldModel, newModel, str3);
                                double num15 = Convert.ToDouble(newModel.get_current_odds());
                                double num16 = Convert.ToDouble(newModel.get_max_odds());
                                double num17 = Convert.ToDouble(newModel.get_min_odds());
                                double num18 = 0.0;
                                if (str5.Equals("A"))
                                {
                                    num18 = Convert.ToDouble(newModel.get_a_diff());
                                }
                                else if (str5.Equals("B"))
                                {
                                    num18 = Convert.ToDouble(newModel.get_b_diff());
                                }
                                else if (str5.Equals("C"))
                                {
                                    num18 = Convert.ToDouble(newModel.get_c_diff());
                                }
                                num15 = double.Parse((num15 + num18).ToString());
                                string str11 = newModel.get_is_open().ToString();
                                Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                                Dictionary<string, object> dictionary5 = new Dictionary<string, object>();
                                dictionary5.Add("pl", num15);
                                dictionary5.Add("maxpl", num16);
                                dictionary5.Add("minpl", num17);
                                dictionary5.Add("plx", new List<double>());
                                if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                                {
                                    str11 = "0";
                                }
                                dictionary5.Add("is_open", str11);
                                dictionary4.Add(str4, new Dictionary<string, object>(dictionary5));
                                dictionary.Add("play_odds", dictionary4);
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                        }
                    }
                    else
                    {
                        double num2 = Convert.ToDouble(oldModel.get_current_odds());
                        double num3 = Convert.ToDouble(oldModel.get_max_odds());
                        double num4 = Convert.ToDouble(oldModel.get_min_odds());
                        if (string.IsNullOrEmpty(str6))
                        {
                            str6 = "0.01";
                        }
                        string str12 = str3;
                        if (str12 != null)
                        {
                            if (!(str12 == "1"))
                            {
                                if (str12 == "2")
                                {
                                    num2 = double.Parse((num2 + -Convert.ToDouble(str6)).ToString());
                                }
                            }
                            else
                            {
                                num2 = double.Parse((num2 + Convert.ToDouble(str6)).ToString());
                            }
                        }
                        if (num2 < num4)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num4));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else if (num2 > num3)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num3));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else if ((_six2 != null) && (num2 > double.Parse(_six2.get_current_odds())))
                        {
                            string str8 = _six2.get_current_odds();
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str8));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else if (CallBLL.cz_odds_six_bll.UpdateCurrentOdds(Convert.ToInt32(str4), str3.Equals("1") ? Convert.ToDouble(str6) : -Convert.ToDouble(str6), str3) > 0)
                        {
                            cz_odds_six _six3 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                            base.tm_log(oldModel, _six3, str3);
                            double num6 = Convert.ToDouble(_six3.get_current_odds());
                            double num7 = Convert.ToDouble(_six3.get_max_odds());
                            double num8 = Convert.ToDouble(_six3.get_min_odds());
                            double num9 = 0.0;
                            if (str5.Equals("A"))
                            {
                                num9 = Convert.ToDouble(_six3.get_a_diff());
                            }
                            else if (str5.Equals("B"))
                            {
                                num9 = Convert.ToDouble(_six3.get_b_diff());
                            }
                            else if (str5.Equals("C"))
                            {
                                num9 = Convert.ToDouble(_six3.get_c_diff());
                            }
                            num6 = double.Parse((num6 + num9).ToString());
                            string str9 = _six3.get_is_open().ToString();
                            Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                            Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                            dictionary3.Add("pl", num6.ToString());
                            dictionary3.Add("maxpl", num7.ToString());
                            dictionary3.Add("minpl", num8.ToString());
                            dictionary3.Add("plx", new List<double>());
                            if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                            {
                                str9 = "0";
                            }
                            dictionary3.Add("is_open", str9);
                            dictionary2.Add(str4, new Dictionary<string, object>(dictionary3));
                            dictionary.Add("play_odds", dictionary2);
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                    }
                }
            }
        }

        public void operate_adds_BZ(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                string playid = "";
                string str18 = str4;
                if (str18 != null)
                {
                    if (!(str18 == "92572"))
                    {
                        if (str18 == "92588")
                        {
                            playid = "91047";
                        }
                        else if (str18 == "92589")
                        {
                            playid = "91048";
                        }
                        else if (str18 == "92590")
                        {
                            playid = "91049";
                        }
                        else if (str18 == "92591")
                        {
                            playid = "91050";
                        }
                        else if (str18 == "92592")
                        {
                            playid = "91051";
                        }
                    }
                    else
                    {
                        playid = "91037";
                    }
                }
                string str6 = LSRequest.qq("number");
                string str7 = LSRequest.qq("oddsindex");
                LSRequest.qq("phaseid");
                string str8 = LSRequest.qq("pk");
                string str9 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                if (string.IsNullOrEmpty(str8))
                {
                    str8 = "A";
                }
                else
                {
                    str8 = str8.ToUpper();
                }
                if ((!str8.Equals("A") && !str8.Equals("B")) && !str8.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    DataTable table2;
                    DataTable table3;
                    double num34;
                    decimal num35;
                    cz_odds_six oldModel = null;
                    cz_odds_six _six2 = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                    {
                        oldModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (oldModel == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (base.IsChildSync())
                        {
                            _six2 = CallBLL.cz_odds_six_bll.ZK_GetModel(Convert.ToInt32(str4), base.IsChildSystem().get_conn());
                        }
                    }
                    DataTable wTs = null;
                    str18 = playid;
                    if (str18 != null)
                    {
                        if (!(str18 == "91037"))
                        {
                            if (str18 == "91047")
                            {
                                wTs = CallBLL.cz_wt_6bz_six_bll.GetWTs();
                            }
                            else if (str18 == "91048")
                            {
                                wTs = CallBLL.cz_wt_7bz_six_bll.GetWTs();
                            }
                            else if (str18 == "91049")
                            {
                                wTs = CallBLL.cz_wt_8bz_six_bll.GetWTs();
                            }
                            else if (str18 == "91050")
                            {
                                wTs = CallBLL.cz_wt_9bz_six_bll.GetWTs();
                            }
                            else if (str18 == "91051")
                            {
                                wTs = CallBLL.cz_wt_10bz_six_bll.GetWTs();
                            }
                        }
                        else
                        {
                            wTs = CallBLL.cz_wt_5bz_six_bll.GetWTs();
                        }
                    }
                    if ((!str3.Equals("1") && !str3.Equals("2")) || !string.IsNullOrEmpty(str6))
                    {
                        if (str3.Equals("3") && string.IsNullOrEmpty(str6))
                        {
                            double num12 = Convert.ToDouble(oldModel.get_current_odds());
                            double num13 = Convert.ToDouble(oldModel.get_max_odds());
                            double num14 = Convert.ToDouble(oldModel.get_min_odds());
                            double num15 = 0.0;
                            if (str8.Equals("A"))
                            {
                                num15 = Convert.ToDouble(oldModel.get_a_diff());
                            }
                            else if (str8.Equals("B"))
                            {
                                num15 = Convert.ToDouble(oldModel.get_b_diff());
                            }
                            else if (str8.Equals("C"))
                            {
                                num15 = Convert.ToDouble(oldModel.get_c_diff());
                            }
                            num34 = double.Parse(s) - num15;
                            s = num34.ToString();
                            if (Convert.ToDouble(s) < num14)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num14));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (Convert.ToDouble(s) > num13)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num13));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            Dictionary<int, double> dictionary5 = null;
                            if (wTs != null)
                            {
                                dictionary5 = new Dictionary<int, double>();
                                foreach (DataRow row2 in wTs.Rows)
                                {
                                    double.Parse(row2["wt_value"].ToString());
                                    double num16 = num12 - Math.Abs(double.Parse(row2["wt_value"].ToString()));
                                    decimal num17 = 0M;
                                    if (double.Parse(s) > num16)
                                    {
                                        num17 = decimal.Parse(s.ToString()) - decimal.Parse(num16.ToString());
                                    }
                                    num35 = -num17;
                                    dictionary5.Add(int.Parse(row2["number"].ToString()), double.Parse(num35.ToString()));
                                }
                            }
                            if ((_six2 != null) && (double.Parse(s) > double.Parse(_six2.get_current_odds())))
                            {
                                string str13 = _six2.get_current_odds();
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str13));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsBZ(Convert.ToInt32(str4), s, str3, dictionary5) > 0)
                            {
                                base.CheckZKChildWT(str4);
                                cz_odds_six newModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                                base.bz_group_log(oldModel, newModel, str3);
                                double num19 = Convert.ToDouble(newModel.get_current_odds());
                                double num20 = Convert.ToDouble(newModel.get_max_odds());
                                double num21 = Convert.ToDouble(newModel.get_min_odds());
                                double num22 = 0.0;
                                if (str8.Equals("A"))
                                {
                                    num22 = Convert.ToDouble(newModel.get_a_diff());
                                }
                                else if (str8.Equals("B"))
                                {
                                    num22 = Convert.ToDouble(newModel.get_b_diff());
                                }
                                else if (str8.Equals("C"))
                                {
                                    num22 = Convert.ToDouble(newModel.get_c_diff());
                                }
                                num34 = num19 + num22;
                                num19 = double.Parse(num34.ToString());
                                string str14 = newModel.get_is_open().ToString();
                                Dictionary<string, object> dictionary6 = new Dictionary<string, object>();
                                Dictionary<string, object> dictionary7 = new Dictionary<string, object>();
                                dictionary7.Add("pl", num19.ToString());
                                dictionary7.Add("maxpl", num20.ToString());
                                dictionary7.Add("minpl", num21.ToString());
                                dictionary7.Add("plx", new List<double>());
                                if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                                {
                                    str14 = "0";
                                }
                                dictionary7.Add("is_open", str14);
                                dictionary6.Add(str4, new Dictionary<string, object>(dictionary7));
                                dictionary.Add("play_odds", dictionary6);
                                if (model.get_u_type().Trim().Equals("zj") && (((playid.Equals("91037") || playid.Equals("91047")) || (playid.Equals("91048") || playid.Equals("91049"))) || (playid.Equals("91050") || playid.Equals("91051"))))
                                {
                                    dictionary.Add("wtnumbervalue", this.GetWT_BZ(str8, playid));
                                }
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if ((!str3.Equals("1") && !str3.Equals("2")) || string.IsNullOrEmpty(str6))
                        {
                            if (str3.Equals("3") && !string.IsNullOrEmpty(str6))
                            {
                                DataTable wT = null;
                                DataTable table5 = null;
                                cz_admin_subsystem _subsystem3 = null;
                                if (base.IsChildSync())
                                {
                                    _subsystem3 = base.IsChildSystem();
                                }
                                str18 = playid;
                                if (str18 != null)
                                {
                                    if (!(str18 == "91037"))
                                    {
                                        if (str18 == "91047")
                                        {
                                            wT = CallBLL.cz_wt_6bz_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table5 = CallBLL.cz_wt_6bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                        }
                                        else if (str18 == "91048")
                                        {
                                            wT = CallBLL.cz_wt_7bz_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table5 = CallBLL.cz_wt_7bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                        }
                                        else if (str18 == "91049")
                                        {
                                            wT = CallBLL.cz_wt_8bz_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table5 = CallBLL.cz_wt_8bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                        }
                                        else if (str18 == "91050")
                                        {
                                            wT = CallBLL.cz_wt_9bz_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table5 = CallBLL.cz_wt_9bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                        }
                                        else if (str18 == "91051")
                                        {
                                            wT = CallBLL.cz_wt_10bz_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table5 = CallBLL.cz_wt_10bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                        }
                                    }
                                    else
                                    {
                                        wT = CallBLL.cz_wt_5bz_six_bll.GetWT(Convert.ToInt32(str6));
                                        if (base.IsChildSync())
                                        {
                                            table5 = CallBLL.cz_wt_5bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                        }
                                    }
                                }
                                double num29 = Convert.ToDouble(wT.Rows[0]["wt_value"]);
                                double num30 = Convert.ToDouble(oldModel.get_current_odds());
                                double num31 = Convert.ToDouble(oldModel.get_max_odds());
                                Convert.ToDouble(oldModel.get_min_odds());
                                double num32 = 0.0;
                                if (str8.Equals("A"))
                                {
                                    num32 = Convert.ToDouble(oldModel.get_a_diff());
                                }
                                else if (str8.Equals("B"))
                                {
                                    num32 = Convert.ToDouble(oldModel.get_b_diff());
                                }
                                else if (str8.Equals("C"))
                                {
                                    num32 = Convert.ToDouble(oldModel.get_c_diff());
                                }
                                string str16 = "";
                                if (str7.Equals("0"))
                                {
                                    num34 = double.Parse(s) - num32;
                                    s = num34.ToString();
                                    if (Convert.ToDouble(s) > num31)
                                    {
                                        s = num30.ToString();
                                    }
                                    if (Convert.ToDouble(s) > num30)
                                    {
                                        s = num30.ToString();
                                    }
                                    if (Math.Abs((double) (Convert.ToDouble(s) - num30)) > (num30 - 1.0))
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    num34 = Convert.ToDouble(s) - num30;
                                    str16 = num34.ToString();
                                }
                                if (base.IsChildSync())
                                {
                                    double num33 = 0.0;
                                    if (table5 != null)
                                    {
                                        num33 = Convert.ToDouble(table5.Rows[0]["wt_value"]);
                                    }
                                    num34 = double.Parse(_six2.get_current_odds()) + num33;
                                    string str17 = double.Parse(num34.ToString("N6")).ToString();
                                    if (double.Parse(Convert.ToDouble(str16).ToString("N6")) > num33)
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str17));
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                str18 = playid;
                                if (str18 != null)
                                {
                                    if (!(str18 == "91037"))
                                    {
                                        if (str18 == "91047")
                                        {
                                            CallBLL.cz_wt_6bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str16).ToString("N6")));
                                        }
                                        else if (str18 == "91048")
                                        {
                                            CallBLL.cz_wt_7bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str16).ToString("N6")));
                                        }
                                        else if (str18 == "91049")
                                        {
                                            CallBLL.cz_wt_8bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str16).ToString("N6")));
                                        }
                                        else if (str18 == "91050")
                                        {
                                            CallBLL.cz_wt_9bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str16).ToString("N6")));
                                        }
                                        else if (str18 == "91051")
                                        {
                                            CallBLL.cz_wt_10bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str16).ToString("N6")));
                                        }
                                    }
                                    else
                                    {
                                        CallBLL.cz_wt_5bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str16).ToString("N6")));
                                    }
                                }
                                base.CheckZKChildWT(str4);
                                base.bz_number_log(oldModel, num29, Convert.ToDouble(str16), str6, str3);
                                if (model.get_u_type().Trim().Equals("zj") && (((playid.Equals("91037") || playid.Equals("91047")) || (playid.Equals("91048") || playid.Equals("91049"))) || (playid.Equals("91050") || playid.Equals("91051"))))
                                {
                                    dictionary.Add("wtnumbervalue", this.GetWT_BZ(str8, playid));
                                }
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            return;
                        }
                        table2 = null;
                        table3 = null;
                        cz_admin_subsystem _subsystem2 = null;
                        if (base.IsChildSync())
                        {
                            _subsystem2 = base.IsChildSystem();
                        }
                        str18 = playid;
                        if (str18 != null)
                        {
                            if (!(str18 == "91037"))
                            {
                                if (str18 == "91047")
                                {
                                    table2 = CallBLL.cz_wt_6bz_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table3 = CallBLL.cz_wt_6bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                }
                                else if (str18 == "91048")
                                {
                                    table2 = CallBLL.cz_wt_7bz_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table3 = CallBLL.cz_wt_7bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                }
                                else if (str18 == "91049")
                                {
                                    table2 = CallBLL.cz_wt_8bz_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table3 = CallBLL.cz_wt_8bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                }
                                else if (str18 == "91050")
                                {
                                    table2 = CallBLL.cz_wt_9bz_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table3 = CallBLL.cz_wt_9bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                }
                                else if (str18 == "91051")
                                {
                                    table2 = CallBLL.cz_wt_10bz_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table3 = CallBLL.cz_wt_10bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                }
                            }
                            else
                            {
                                table2 = CallBLL.cz_wt_5bz_six_bll.GetWT(Convert.ToInt32(str6));
                                if (base.IsChildSync())
                                {
                                    table3 = CallBLL.cz_wt_5bz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                }
                            }
                        }
                    }
                    else
                    {
                        double num = Convert.ToDouble(oldModel.get_current_odds());
                        double num2 = num;
                        double num3 = Convert.ToDouble(oldModel.get_max_odds());
                        double num4 = Convert.ToDouble(oldModel.get_min_odds());
                        if (string.IsNullOrEmpty(str9))
                        {
                            str9 = "0.01";
                        }
                        str18 = str3;
                        if (str18 != null)
                        {
                            if (!(str18 == "1"))
                            {
                                if (str18 == "2")
                                {
                                    num34 = num2 + -Convert.ToDouble(str9);
                                    num2 = double.Parse(num34.ToString());
                                }
                            }
                            else
                            {
                                num34 = num2 + Convert.ToDouble(str9);
                                num2 = double.Parse(num34.ToString());
                            }
                        }
                        if (num2 < num4)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num4));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (num2 > num3)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num3));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        Dictionary<int, double> dictionary2 = null;
                        if (wTs != null)
                        {
                            dictionary2 = new Dictionary<int, double>();
                            foreach (DataRow row in wTs.Rows)
                            {
                                double.Parse(row["wt_value"].ToString());
                                double num5 = num - Math.Abs(double.Parse(row["wt_value"].ToString()));
                                decimal num6 = 0M;
                                if (double.Parse(num2.ToString("N6")) > num5)
                                {
                                    num6 = decimal.Parse(num2.ToString()) - decimal.Parse(num5.ToString());
                                }
                                num35 = -num6;
                                dictionary2.Add(int.Parse(row["number"].ToString()), double.Parse(num35.ToString()));
                            }
                        }
                        if ((_six2 != null) && (num2 > double.Parse(_six2.get_current_odds())))
                        {
                            string str11 = _six2.get_current_odds();
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str11));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsBZ(Convert.ToInt32(str4), num2.ToString(), str3, dictionary2) > 0)
                        {
                            base.CheckZKChildWT(str4);
                            cz_odds_six _six3 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                            base.bz_group_log(oldModel, _six3, str3);
                            double num8 = Convert.ToDouble(_six3.get_current_odds());
                            double num9 = Convert.ToDouble(_six3.get_max_odds());
                            double num10 = Convert.ToDouble(_six3.get_min_odds());
                            double num11 = 0.0;
                            if (str8.Equals("A"))
                            {
                                num11 = Convert.ToDouble(_six3.get_a_diff());
                            }
                            else if (str8.Equals("B"))
                            {
                                num11 = Convert.ToDouble(_six3.get_b_diff());
                            }
                            else if (str8.Equals("C"))
                            {
                                num11 = Convert.ToDouble(_six3.get_c_diff());
                            }
                            num34 = num8 + num11;
                            num8 = double.Parse(num34.ToString());
                            string str12 = _six3.get_is_open().ToString();
                            Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                            Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                            dictionary4.Add("pl", num8.ToString());
                            dictionary4.Add("maxpl", num9.ToString());
                            dictionary4.Add("minpl", num10.ToString());
                            dictionary4.Add("plx", new List<double>());
                            if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                            {
                                str12 = "0";
                            }
                            dictionary4.Add("is_open", str12);
                            dictionary3.Add(str4, new Dictionary<string, object>(dictionary4));
                            dictionary.Add("play_odds", dictionary3);
                            if (model.get_u_type().Trim().Equals("zj") && (((playid.Equals("91037") || playid.Equals("91047")) || (playid.Equals("91048") || playid.Equals("91049"))) || (playid.Equals("91050") || playid.Equals("91051"))))
                            {
                                dictionary.Add("wtnumbervalue", this.GetWT_BZ(str8, playid));
                            }
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        result.set_success(400);
                        result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    double oldWT = Convert.ToDouble(table2.Rows[0]["wt_value"]);
                    double num24 = double.Parse(oldModel.get_current_odds());
                    double num25 = num24;
                    double num26 = double.Parse(oldModel.get_max_odds());
                    double.Parse(oldModel.get_min_odds());
                    if (str8.Equals("A"))
                    {
                        Convert.ToDouble(oldModel.get_a_diff());
                    }
                    else if (str8.Equals("B"))
                    {
                        Convert.ToDouble(oldModel.get_b_diff());
                    }
                    else if (str8.Equals("C"))
                    {
                        Convert.ToDouble(oldModel.get_c_diff());
                    }
                    if (string.IsNullOrEmpty(str9))
                    {
                        str9 = "0.01";
                    }
                    double num27 = 0.0;
                    str18 = str3;
                    if (str18 != null)
                    {
                        if (!(str18 == "1"))
                        {
                            if (str18 == "2")
                            {
                                num34 = num25 + (-Convert.ToDouble(str9) + oldWT);
                                num25 = double.Parse(num34.ToString());
                                num34 = oldWT + -Convert.ToDouble(str9);
                                num27 = double.Parse(num34.ToString());
                            }
                        }
                        else
                        {
                            num34 = num25 + (Convert.ToDouble(str9) + oldWT);
                            num25 = double.Parse(num34.ToString());
                            num34 = oldWT + Convert.ToDouble(str9);
                            num27 = double.Parse(num34.ToString());
                        }
                    }
                    if (Math.Abs(Convert.ToDouble(num27)) > (num24 - 1.0))
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else if (num25 > num26)
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num26));
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else if (num25 > num24)
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100033", "MessageHint"), num24));
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        if (base.IsChildSync())
                        {
                            double num28 = 0.0;
                            if (table3 != null)
                            {
                                num28 = Convert.ToDouble(table3.Rows[0]["wt_value"]);
                            }
                            num34 = double.Parse(_six2.get_current_odds()) + num28;
                            string str15 = double.Parse(num34.ToString("N6")).ToString();
                            if (double.Parse(num27.ToString("N6")) > num28)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str15));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        str18 = playid;
                        if (str18 != null)
                        {
                            if (!(str18 == "91037"))
                            {
                                if (str18 == "91047")
                                {
                                    CallBLL.cz_wt_6bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num27.ToString("N6")));
                                }
                                else if (str18 == "91048")
                                {
                                    CallBLL.cz_wt_7bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num27.ToString("N6")));
                                }
                                else if (str18 == "91049")
                                {
                                    CallBLL.cz_wt_8bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num27.ToString("N6")));
                                }
                                else if (str18 == "91050")
                                {
                                    CallBLL.cz_wt_9bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num27.ToString("N6")));
                                }
                                else if (str18 == "91051")
                                {
                                    CallBLL.cz_wt_10bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num27.ToString("N6")));
                                }
                            }
                            else
                            {
                                CallBLL.cz_wt_5bz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num27.ToString("N6")));
                            }
                        }
                        base.CheckZKChildWT(str4);
                        base.bz_number_log(oldModel, oldWT, num27, str6, str3);
                        if (model.get_u_type().Trim().Equals("zj") && (((playid.Equals("91037") || playid.Equals("91047")) || (playid.Equals("91048") || playid.Equals("91049"))) || (playid.Equals("91050") || playid.Equals("91051"))))
                        {
                            dictionary.Add("wtnumbervalue", this.GetWT_BZ(str8, playid));
                        }
                        result.set_data(dictionary);
                        result.set_success(200);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                }
            }
        }

        public void operate_adds_BZ_wt(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_six_op_odds().Equals(1))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("fgs") || !model.get_six_op_odds().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                string str4 = LSRequest.qq("oddsid");
                LSRequest.qq("phaseid");
                string str5 = LSRequest.qq("pk");
                string str6 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                string playid = "";
                string str12 = str4;
                if (str12 != null)
                {
                    if (!(str12 == "92572"))
                    {
                        if (str12 == "92588")
                        {
                            playid = "91047";
                        }
                        else if (str12 == "92589")
                        {
                            playid = "91048";
                        }
                        else if (str12 == "92590")
                        {
                            playid = "91049";
                        }
                        else if (str12 == "92591")
                        {
                            playid = "91050";
                        }
                        else if (str12 == "92592")
                        {
                            playid = "91051";
                        }
                    }
                    else
                    {
                        playid = "91037";
                    }
                }
                if (string.IsNullOrEmpty(str5))
                {
                    str5 = "A";
                }
                else
                {
                    str5 = str5.ToUpper();
                }
                if ((!str5.Equals("A") && !str5.Equals("B")) && !str5.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    double num33;
                    int num34;
                    cz_odds_six _six = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                    {
                        _six = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (_six == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    DataTable minWTValue = null;
                    str12 = playid;
                    if (str12 != null)
                    {
                        if (!(str12 == "91037"))
                        {
                            if (str12 == "91047")
                            {
                                minWTValue = CallBLL.cz_wt_6bz_six_bll.GetMinWTValue();
                            }
                            else if (str12 == "91048")
                            {
                                minWTValue = CallBLL.cz_wt_7bz_six_bll.GetMinWTValue();
                            }
                            else if (str12 == "91049")
                            {
                                minWTValue = CallBLL.cz_wt_8bz_six_bll.GetMinWTValue();
                            }
                            else if (str12 == "91050")
                            {
                                minWTValue = CallBLL.cz_wt_9bz_six_bll.GetMinWTValue();
                            }
                            else if (str12 == "91051")
                            {
                                minWTValue = CallBLL.cz_wt_10bz_six_bll.GetMinWTValue();
                            }
                        }
                        else
                        {
                            minWTValue = CallBLL.cz_wt_5bz_six_bll.GetMinWTValue();
                        }
                    }
                    double num = double.Parse(minWTValue.Rows[0]["wt_value"].ToString());
                    string str9 = minWTValue.Rows[0]["number"].ToString();
                    if (int.Parse(str9) < 10)
                    {
                        str9 = "0" + str9;
                    }
                    if (!str3.Equals("1") && !str3.Equals("2"))
                    {
                        if (str3.Equals("3"))
                        {
                            double num17 = double.Parse(_six.get_current_odds());
                            double num18 = Convert.ToDouble(_six.get_max_odds());
                            double num19 = Convert.ToDouble(_six.get_min_odds());
                            double num20 = 0.0;
                            if (str5.Equals("A"))
                            {
                                num20 = double.Parse(_six.get_a_diff());
                            }
                            else if (str5.Equals("B"))
                            {
                                num20 = double.Parse(_six.get_b_diff());
                            }
                            else if (str5.Equals("C"))
                            {
                                num20 = double.Parse(_six.get_c_diff());
                            }
                            double wtvalue = 0.0;
                            base.GetOperate_SIX(str4, ref wtvalue);
                            double num22 = num17;
                            double num23 = num19;
                            num33 = num17 + wtvalue;
                            double num24 = double.Parse(num33.ToString());
                            num33 = num17 + num20;
                            double num25 = double.Parse(num33.ToString());
                            num33 = (num22 - num23) + 1.0;
                            double num26 = double.Parse(num33.ToString());
                            num33 = double.Parse(s) - num20;
                            double num27 = double.Parse(num33.ToString());
                            decimal num28 = 0M;
                            if (Convert.ToDouble(num27) < num23)
                            {
                                result.set_success(400);
                                num33 = num23 + num20;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num33.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else if (Convert.ToDouble(num27) > num22)
                            {
                                result.set_success(400);
                                num33 = num22 + num20;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num33.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else if (Convert.ToDouble(num27) < num26)
                            {
                                result.set_success(400);
                                num33 = num26 + num20;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num33.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                num33 = num27 + num;
                                if (double.Parse(num33.ToString()) < num26)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100063", "MessageHint"), str9, num26));
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                else
                                {
                                    num28 = decimal.Parse((decimal.Parse(num27.ToString()) - decimal.Parse(num22.ToString())).ToString());
                                    DataTable oddsWTbyFGS = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                                    num34 = 100;
                                    base.Add_FgsOddsWT_Lock(num34.ToString(), str, str4);
                                    int num29 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOdds(Convert.ToInt32(str4), num28, str3, str);
                                    num34 = 100;
                                    base.Del_FgsOddsWT_Lock(num34.ToString(), str, str4);
                                    if (num29 > 0)
                                    {
                                        wtvalue = 0.0;
                                        CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                        FileCacheHelper.UpdateFGSWTFile(100);
                                        base.GetOperate_SIX(str4, ref wtvalue);
                                        cz_odds_six _six4 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                                        base.fgs_opt_six_log(oddsWTbyFGS, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                        double num30 = Convert.ToDouble(_six4.get_current_odds());
                                        Convert.ToDouble(_six4.get_max_odds());
                                        double num31 = Convert.ToDouble(_six4.get_min_odds());
                                        double num32 = 0.0;
                                        if (str5.Equals("A"))
                                        {
                                            num32 = Convert.ToDouble(_six4.get_a_diff());
                                        }
                                        else if (str5.Equals("B"))
                                        {
                                            num32 = Convert.ToDouble(_six4.get_b_diff());
                                        }
                                        else if (str5.Equals("C"))
                                        {
                                            num32 = Convert.ToDouble(_six4.get_c_diff());
                                        }
                                        num33 = (num30 + num32) + wtvalue;
                                        num24 = double.Parse(num33.ToString());
                                        num33 = num30 + num32;
                                        num25 = double.Parse(num33.ToString());
                                        num33 = ((num30 - num31) + num32) + 1.0;
                                        num26 = double.Parse(num33.ToString());
                                        string str11 = _six4.get_is_open().ToString();
                                        Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                                        Dictionary<string, object> dictionary5 = new Dictionary<string, object>();
                                        dictionary5.Add("pl", num24.ToString());
                                        dictionary5.Add("maxpl", num25.ToString());
                                        dictionary5.Add("minpl", num26.ToString());
                                        dictionary5.Add("plx", new List<double>());
                                        if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                                        {
                                            str11 = "0";
                                        }
                                        dictionary5.Add("is_open", str11);
                                        dictionary4.Add(str4, new Dictionary<string, object>(dictionary5));
                                        dictionary.Add("play_odds", dictionary4);
                                        if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && (((playid.Equals("91037") || playid.Equals("91047")) || (playid.Equals("91048") || playid.Equals("91049"))) || (playid.Equals("91050") || playid.Equals("91051"))))
                                        {
                                            dictionary.Add("wtnumbervalue", this.GetWT_BZ_wt(model, context, str5, playid, str4));
                                        }
                                        result.set_data(dictionary);
                                        result.set_success(200);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                    else
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                }
                            }
                        }
                    }
                    else
                    {
                        double num2 = double.Parse(_six.get_current_odds());
                        double num3 = Convert.ToDouble(_six.get_max_odds());
                        double num4 = Convert.ToDouble(_six.get_min_odds());
                        double num5 = 0.0;
                        if (str5.Equals("A"))
                        {
                            num5 = double.Parse(_six.get_a_diff());
                        }
                        else if (str5.Equals("B"))
                        {
                            num5 = double.Parse(_six.get_b_diff());
                        }
                        else if (str5.Equals("C"))
                        {
                            num5 = double.Parse(_six.get_c_diff());
                        }
                        double num6 = 0.0;
                        base.GetOperate_SIX(str4, ref num6);
                        double num7 = num2;
                        double num8 = num4;
                        num33 = num2 + num6;
                        double num9 = double.Parse(num33.ToString());
                        num33 = num2 + num5;
                        double num10 = double.Parse(num33.ToString());
                        num33 = (num7 - num8) + 1.0;
                        double num11 = double.Parse(num33.ToString());
                        double num12 = 0.0;
                        str12 = str3;
                        if (str12 != null)
                        {
                            if (!(str12 == "1"))
                            {
                                if (str12 == "2")
                                {
                                    num33 = num9 + -Convert.ToDouble(str6);
                                    num12 = double.Parse(num33.ToString());
                                }
                            }
                            else
                            {
                                num33 = num9 + Convert.ToDouble(str6);
                                num12 = double.Parse(num33.ToString());
                            }
                        }
                        if (!str3.Equals("1") && (num12 < num8))
                        {
                            result.set_success(400);
                            num33 = num8 + num5;
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num33.ToString())));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else if (!str3.Equals("2") && (num12 > num7))
                        {
                            result.set_success(400);
                            num33 = num7 + num5;
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num33.ToString())));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else if (num12 < num11)
                        {
                            result.set_success(400);
                            num33 = num11 + num5;
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num33.ToString())));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            num33 = num12 + num;
                            if (double.Parse(num33.ToString()) < num11)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100063", "MessageHint"), str9, num11));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                DataTable table2 = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                                num34 = 100;
                                base.Add_FgsOddsWT_Lock(num34.ToString(), str, str4);
                                int num13 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOdds(Convert.ToInt32(str4), str3.Equals("1") ? Convert.ToDecimal(str6) : -Convert.ToDecimal(str6), str3, str);
                                base.Del_FgsOddsWT_Lock(100.ToString(), str, str4);
                                if (num13 > 0)
                                {
                                    base.fgs_opt_six_log(table2, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                    num6 = 0.0;
                                    CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                    FileCacheHelper.UpdateFGSWTFile(100);
                                    base.GetOperate_SIX(str4, ref num6);
                                    cz_odds_six _six2 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                                    double num14 = Convert.ToDouble(_six2.get_current_odds());
                                    Convert.ToDouble(_six2.get_max_odds());
                                    double num15 = Convert.ToDouble(_six2.get_min_odds());
                                    double num16 = 0.0;
                                    if (str5.Equals("A"))
                                    {
                                        num16 = Convert.ToDouble(_six2.get_a_diff());
                                    }
                                    else if (str5.Equals("B"))
                                    {
                                        num16 = Convert.ToDouble(_six2.get_b_diff());
                                    }
                                    else if (str5.Equals("C"))
                                    {
                                        num16 = Convert.ToDouble(_six2.get_c_diff());
                                    }
                                    num33 = (num14 + num16) + num6;
                                    num9 = double.Parse(num33.ToString());
                                    num33 = num14 + num16;
                                    num10 = double.Parse(num33.ToString());
                                    num11 = double.Parse((((num14 - num15) + num16) + 1.0).ToString());
                                    string str10 = _six2.get_is_open().ToString();
                                    Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                                    Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                                    dictionary3.Add("pl", num9.ToString());
                                    dictionary3.Add("maxpl", num10.ToString());
                                    dictionary3.Add("minpl", num11.ToString());
                                    dictionary3.Add("plx", new List<double>());
                                    if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                                    {
                                        str10 = "0";
                                    }
                                    dictionary3.Add("is_open", str10);
                                    dictionary2.Add(str4, new Dictionary<string, object>(dictionary3));
                                    dictionary.Add("play_odds", dictionary2);
                                    if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && (((playid.Equals("91037") || playid.Equals("91047")) || (playid.Equals("91048") || playid.Equals("91049"))) || (playid.Equals("91050") || playid.Equals("91051"))))
                                    {
                                        dictionary.Add("wtnumbervalue", this.GetWT_BZ_wt(model, context, str5, playid, str4));
                                    }
                                    result.set_data(dictionary);
                                    result.set_success(200);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                else
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                            }
                        }
                    }
                }
            }
        }

        public void operate_adds_LM(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                string playid = "";
                switch (str4)
                {
                    case "92285":
                        playid = "91016";
                        break;

                    case "92286":
                        playid = "91017";
                        break;

                    case "92287":
                        playid = "91018";
                        break;

                    case "92288":
                        playid = "91019";
                        break;

                    case "92289":
                        playid = "91020";
                        break;

                    case "92575":
                        playid = "91040";
                        break;

                    case "92638":
                        playid = "91060";
                        break;

                    case "92639":
                        playid = "91061";
                        break;

                    case "92640":
                        playid = "91062";
                        break;

                    case "92641":
                        playid = "91063";
                        break;

                    case "92642":
                        playid = "91064";
                        break;

                    case "92643":
                        playid = "91065";
                        break;
                }
                string str6 = LSRequest.qq("number");
                string str7 = LSRequest.qq("oddsindex");
                if (string.IsNullOrEmpty(str7))
                {
                    str7 = "0";
                }
                LSRequest.qq("phaseid");
                string str8 = LSRequest.qq("pk");
                string str9 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                if (string.IsNullOrEmpty(str8))
                {
                    str8 = "A";
                }
                else
                {
                    str8 = str8.ToUpper();
                }
                if ((!str8.Equals("A") && !str8.Equals("B")) && !str8.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    string[] strArray10;
                    double num24;
                    double num25;
                    double num26;
                    double num27;
                    double num28;
                    double num29;
                    double num30;
                    double num31;
                    string[] strArray13;
                    string str25;
                    double num67;
                    decimal num68;
                    cz_odds_six oldModel = null;
                    cz_odds_six _six2 = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                    {
                        oldModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (oldModel == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (base.IsChildSync())
                        {
                            _six2 = CallBLL.cz_odds_six_bll.ZK_GetModel(Convert.ToInt32(str4), base.IsChildSystem().get_conn());
                        }
                    }
                    DataTable wTs = null;
                    switch (playid)
                    {
                        case "91016":
                            wTs = CallBLL.cz_wt_3qz_six_bll.GetWTs();
                            break;

                        case "91017":
                            wTs = CallBLL.cz_wt_3z2_six_bll.GetWTs();
                            break;

                        case "91018":
                            wTs = CallBLL.cz_wt_2qz_six_bll.GetWTs();
                            break;

                        case "91019":
                            wTs = CallBLL.cz_wt_2zt_six_bll.GetWTs();
                            break;

                        case "91020":
                            wTs = CallBLL.cz_wt_tc_six_bll.GetWTs();
                            break;

                        case "91040":
                            wTs = CallBLL.cz_wt_4z1_six_bll.GetWTs();
                            break;

                        case "91060":
                            wTs = CallBLL.cz_wt_3qz_b_six_bll.GetWTs();
                            break;

                        case "91061":
                            wTs = CallBLL.cz_wt_3z2_b_six_bll.GetWTs();
                            break;

                        case "91062":
                            wTs = CallBLL.cz_wt_2qz_b_six_bll.GetWTs();
                            break;

                        case "91063":
                            wTs = CallBLL.cz_wt_2zt_b_six_bll.GetWTs();
                            break;

                        case "91064":
                            wTs = CallBLL.cz_wt_tc_b_six_bll.GetWTs();
                            break;

                        case "91065":
                            wTs = CallBLL.cz_wt_4z1_b_six_bll.GetWTs();
                            break;
                    }
                    if ((!str3.Equals("1") && !str3.Equals("2")) || !string.IsNullOrEmpty(str6))
                    {
                        if (!str3.Equals("3") || !string.IsNullOrEmpty(str6))
                        {
                            if ((!str3.Equals("1") && !str3.Equals("2")) || string.IsNullOrEmpty(str6))
                            {
                                if (str3.Equals("3") && !string.IsNullOrEmpty(str6))
                                {
                                    DataTable wT = null;
                                    DataTable table6 = null;
                                    cz_odds_six _six8 = null;
                                    DataTable table7 = null;
                                    cz_admin_subsystem _subsystem3 = null;
                                    if (base.IsChildSync())
                                    {
                                        _subsystem3 = base.IsChildSystem();
                                    }
                                    string str19 = "";
                                    string str20 = "";
                                    if ((base.IsShowLM_B() == 1) && (("92285,92286,92287,92288,92289,92575".IndexOf(str4) > -1) || ("92638,92639,92640,92641,92642,92643".IndexOf(str4) > -1)))
                                    {
                                        Utils.Six_LM_AB(str4, ref str19, ref str20);
                                        _six8 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str19));
                                    }
                                    switch (playid)
                                    {
                                        case "91016":
                                            wT = CallBLL.cz_wt_3qz_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_3qz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_3qz_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91017":
                                            wT = CallBLL.cz_wt_3z2_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_3z2_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_3z2_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91018":
                                            wT = CallBLL.cz_wt_2qz_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_2qz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_2qz_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91019":
                                            wT = CallBLL.cz_wt_2zt_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_2zt_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_2zt_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91020":
                                            wT = CallBLL.cz_wt_tc_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_tc_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_tc_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91040":
                                            wT = CallBLL.cz_wt_4z1_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_4z1_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_4z1_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91060":
                                            wT = CallBLL.cz_wt_3qz_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_3qz_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_3qz_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91061":
                                            wT = CallBLL.cz_wt_3z2_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_3z2_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_3z2_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91062":
                                            wT = CallBLL.cz_wt_2qz_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_2qz_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_2qz_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91063":
                                            wT = CallBLL.cz_wt_2zt_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_2zt_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_2zt_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91064":
                                            wT = CallBLL.cz_wt_tc_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_tc_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_tc_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;

                                        case "91065":
                                            wT = CallBLL.cz_wt_4z1_b_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table7 = CallBLL.cz_wt_4z1_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                            if (!string.IsNullOrEmpty(str20))
                                            {
                                                table6 = CallBLL.cz_wt_4z1_six_bll.GetWT(Convert.ToInt32(str6));
                                            }
                                            break;
                                    }
                                    double num56 = Convert.ToDouble(wT.Rows[0]["wt_value"]);
                                    double num57 = 0.0;
                                    if (!string.IsNullOrEmpty(str20))
                                    {
                                        num57 = Convert.ToDouble(table6.Rows[0]["wt_value"]);
                                    }
                                    string[] strArray23 = oldModel.get_current_odds().Split(new char[] { ',' });
                                    string[] strArray24 = oldModel.get_max_odds().Split(new char[] { ',' });
                                    string[] strArray25 = oldModel.get_min_odds().Split(new char[] { ',' });
                                    double num58 = Convert.ToDouble(strArray23[0]);
                                    double num59 = (strArray23.Length > 1) ? Convert.ToDouble(strArray23[1]) : Convert.ToDouble(strArray23[0]);
                                    double num60 = Convert.ToDouble(strArray24[0]);
                                    double num61 = (strArray24.Length > 1) ? Convert.ToDouble(strArray24[1]) : Convert.ToDouble(strArray24[0]);
                                    Convert.ToDouble(strArray25[0]);
                                    if (strArray25.Length <= 1)
                                    {
                                        Convert.ToDouble(strArray25[0]);
                                    }
                                    else
                                    {
                                        Convert.ToDouble(strArray25[1]);
                                    }
                                    double num62 = 0.0;
                                    double num63 = 0.0;
                                    string[] strArray26 = null;
                                    str25 = str8;
                                    if (str25 != null)
                                    {
                                        if (!(str25 == "A"))
                                        {
                                            if (str25 == "B")
                                            {
                                                strArray26 = oldModel.get_b_diff().Split(new char[] { ',' });
                                            }
                                            else if (str25 == "C")
                                            {
                                                strArray26 = oldModel.get_c_diff().Split(new char[] { ',' });
                                            }
                                        }
                                        else
                                        {
                                            strArray26 = oldModel.get_a_diff().Split(new char[] { ',' });
                                        }
                                    }
                                    num62 = double.Parse(strArray26[0]);
                                    if (strArray26.Length > 1)
                                    {
                                        num63 = double.Parse(strArray26[1]);
                                    }
                                    string str21 = "";
                                    if (str7.Equals("0"))
                                    {
                                        num67 = double.Parse(s) - num62;
                                        s = num67.ToString();
                                        if (Convert.ToDouble(s) > num60)
                                        {
                                            s = num58.ToString();
                                        }
                                        if (Convert.ToDouble(s) > num58)
                                        {
                                            s = num58.ToString();
                                        }
                                        if (Math.Abs((double) (Convert.ToDouble(s) - num58)) > (num58 - 1.0))
                                        {
                                            result.set_success(400);
                                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        num67 = Convert.ToDouble(s) - num58;
                                        str21 = num67.ToString();
                                    }
                                    if (str7.Equals("1"))
                                    {
                                        num67 = double.Parse(s) - num63;
                                        s = num67.ToString();
                                        if (Convert.ToDouble(s) > num61)
                                        {
                                            s = num59.ToString();
                                        }
                                        if (Convert.ToDouble(s) > num59)
                                        {
                                            s = num59.ToString();
                                        }
                                        if (Math.Abs((double) (Convert.ToDouble(s) - num59)) > (num59 - 1.0))
                                        {
                                            result.set_success(400);
                                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        num67 = Convert.ToDouble(s) - num59;
                                        str21 = num67.ToString();
                                    }
                                    if (base.IsChildSync())
                                    {
                                        double num64 = 0.0;
                                        if (table7 != null)
                                        {
                                            num64 = Convert.ToDouble(table7.Rows[0]["wt_value"]);
                                        }
                                        string str22 = _six2.get_current_odds();
                                        if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                        {
                                            num67 = double.Parse(str22.Split(new char[] { ',' })[0]) + num64;
                                            string str23 = num67.ToString("N6");
                                            num67 = double.Parse(str22.Split(new char[] { ',' })[1]) + num64;
                                            string str24 = num67.ToString("N6");
                                            str22 = double.Parse(str23) + "," + double.Parse(str24);
                                        }
                                        else
                                        {
                                            num67 = double.Parse(str22) + num64;
                                            str22 = double.Parse(num67.ToString("N6")).ToString();
                                        }
                                        if (double.Parse(Convert.ToDouble(str21).ToString("N6")) > num64)
                                        {
                                            result.set_success(400);
                                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str22));
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    int num65 = 0;
                                    switch (playid)
                                    {
                                        case "91016":
                                            num65 = CallBLL.cz_wt_3qz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91017":
                                            num65 = CallBLL.cz_wt_3z2_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91018":
                                            num65 = CallBLL.cz_wt_2qz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91019":
                                            num65 = CallBLL.cz_wt_2zt_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91020":
                                            num65 = CallBLL.cz_wt_tc_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91040":
                                            num65 = CallBLL.cz_wt_4z1_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91060":
                                            num65 = CallBLL.cz_wt_3qz_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91061":
                                            num65 = CallBLL.cz_wt_3z2_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91062":
                                            num65 = CallBLL.cz_wt_2qz_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91063":
                                            num65 = CallBLL.cz_wt_2zt_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91064":
                                            num65 = CallBLL.cz_wt_tc_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;

                                        case "91065":
                                            num65 = CallBLL.cz_wt_4z1_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(Convert.ToDouble(str21).ToString("N6")));
                                            break;
                                    }
                                    base.CheckZKChildWT(str4);
                                    base.lm_number_log(oldModel, num56, Convert.ToDouble(str21), str6, str3);
                                    if ((base.IsShowLM_B() == 1) && (("92285,92286,92287,92288,92289,92575".IndexOf(str4) > -1) || ("92638,92639,92640,92641,92642,92643".IndexOf(str4) > -1)))
                                    {
                                        base.lm_number_log_ab(_six8, num57, Convert.ToDouble(str21), str6, str3);
                                    }
                                    if ((model.get_u_type().Trim().Equals("zj") && !num65.Equals(0)) && ((((playid.Equals("91016") || playid.Equals("91017")) || (playid.Equals("91018") || playid.Equals("91019"))) || ((playid.Equals("91020") || playid.Equals("91040")) || (playid.Equals("91060") || playid.Equals("91061")))) || ((playid.Equals("91062") || playid.Equals("91063")) || (playid.Equals("91064") || playid.Equals("91065")))))
                                    {
                                        dictionary.Add("wtnumbervalue", this.GetWT_LM(str8, playid));
                                    }
                                    result.set_data(dictionary);
                                    result.set_success(200);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                return;
                            }
                            DataTable table2 = null;
                            DataTable table3 = null;
                            cz_odds_six _six7 = null;
                            DataTable table4 = null;
                            cz_admin_subsystem _subsystem2 = null;
                            if (base.IsChildSync())
                            {
                                _subsystem2 = base.IsChildSystem();
                            }
                            string str14 = "";
                            string str15 = "";
                            if ((base.IsShowLM_B() == 1) && (("92285,92286,92287,92288,92289,92575".IndexOf(str4) > -1) || ("92638,92639,92640,92641,92642,92643".IndexOf(str4) > -1)))
                            {
                                Utils.Six_LM_AB(str4, ref str14, ref str15);
                                _six7 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str14));
                            }
                            switch (playid)
                            {
                                case "91016":
                                    table2 = CallBLL.cz_wt_3qz_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_3qz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_3qz_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91017":
                                    table2 = CallBLL.cz_wt_3z2_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_3z2_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_3z2_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91018":
                                    table2 = CallBLL.cz_wt_2qz_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_2qz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_2qz_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91019":
                                    table2 = CallBLL.cz_wt_2zt_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_2zt_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_2zt_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91020":
                                    table2 = CallBLL.cz_wt_tc_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_tc_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_tc_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91040":
                                    table2 = CallBLL.cz_wt_4z1_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_4z1_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_4z1_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91060":
                                    table2 = CallBLL.cz_wt_3qz_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_3qz_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_3qz_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91061":
                                    table2 = CallBLL.cz_wt_3z2_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_3z2_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_3z2_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91062":
                                    table2 = CallBLL.cz_wt_2qz_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_2qz_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_2qz_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91063":
                                    table2 = CallBLL.cz_wt_2zt_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_2zt_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_2zt_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91064":
                                    table2 = CallBLL.cz_wt_tc_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_tc_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_tc_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;

                                case "91065":
                                    table2 = CallBLL.cz_wt_4z1_b_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table4 = CallBLL.cz_wt_4z1_b_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                    if (!string.IsNullOrEmpty(str15))
                                    {
                                        table3 = CallBLL.cz_wt_4z1_six_bll.GetWT(Convert.ToInt32(str6));
                                    }
                                    break;
                            }
                            double oldWT = Convert.ToDouble(table2.Rows[0]["wt_value"]);
                            double num46 = 0.0;
                            if (!string.IsNullOrEmpty(str15))
                            {
                                num46 = Convert.ToDouble(table3.Rows[0]["wt_value"]);
                            }
                            double num47 = 0.0;
                            double num48 = 0.0;
                            double num49 = 0.0;
                            double num50 = 0.0;
                            double num51 = 0.0;
                            double num52 = 0.0;
                            string[] strArray18 = null;
                            str25 = str8;
                            if (str25 != null)
                            {
                                if (!(str25 == "A"))
                                {
                                    if (str25 == "B")
                                    {
                                        strArray18 = oldModel.get_b_diff().Split(new char[] { ',' });
                                    }
                                    else if (str25 == "C")
                                    {
                                        strArray18 = oldModel.get_c_diff().Split(new char[] { ',' });
                                    }
                                }
                                else
                                {
                                    strArray18 = oldModel.get_a_diff().Split(new char[] { ',' });
                                }
                            }
                            double.Parse(strArray18[0]);
                            if (strArray18.Length > 1)
                            {
                                double.Parse(strArray18[1]);
                            }
                            string[] strArray19 = oldModel.get_current_odds().Split(new char[] { ',' });
                            string[] strArray20 = strArray19;
                            string[] strArray21 = oldModel.get_max_odds().Split(new char[] { ',' });
                            string[] strArray22 = oldModel.get_min_odds().Split(new char[] { ',' });
                            num47 = Convert.ToDouble(strArray19[0]);
                            num48 = Convert.ToDouble(strArray20[0]);
                            num49 = Convert.ToDouble(strArray21[0]);
                            Convert.ToDouble(strArray22[0]);
                            if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num50 = Convert.ToDouble(strArray19[1]);
                                num51 = Convert.ToDouble(strArray20[1]);
                                num52 = Convert.ToDouble(strArray21[1]);
                                Convert.ToDouble(strArray22[1]);
                            }
                            if (string.IsNullOrEmpty(str9))
                            {
                                str9 = "0.01";
                            }
                            double num53 = 0.0;
                            str25 = str3;
                            if (str25 != null)
                            {
                                if (!(str25 == "1"))
                                {
                                    if (str25 == "2")
                                    {
                                        num67 = num48 + (-Convert.ToDouble(str9) + oldWT);
                                        num48 = double.Parse(num67.ToString());
                                        if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                        {
                                            num67 = num51 + (-Convert.ToDouble(str9) + oldWT);
                                            num51 = double.Parse(num67.ToString());
                                        }
                                        num67 = oldWT + -Convert.ToDouble(str9);
                                        num53 = double.Parse(num67.ToString());
                                    }
                                }
                                else
                                {
                                    num67 = num48 + (Convert.ToDouble(str9) + oldWT);
                                    num48 = double.Parse(num67.ToString());
                                    if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                    {
                                        num67 = num51 + (Convert.ToDouble(str9) + oldWT);
                                        num51 = double.Parse(num67.ToString());
                                    }
                                    num67 = oldWT + Convert.ToDouble(str9);
                                    num53 = double.Parse(num67.ToString());
                                }
                            }
                            if (Math.Abs(Convert.ToDouble(num53)) > (num47 - 1.0))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num48 > num49)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num49));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num48 > num47)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100033", "MessageHint"), num47));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                if (Math.Abs(Convert.ToDouble(num53)) > (num50 - 1.0))
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (num51 > num52)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num52));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (num51 > num50)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100033", "MessageHint"), num50));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                            }
                            if (base.IsChildSync())
                            {
                                double num54 = 0.0;
                                if (table4 != null)
                                {
                                    num54 = Convert.ToDouble(table4.Rows[0]["wt_value"]);
                                }
                                string str16 = _six2.get_current_odds();
                                if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                {
                                    num67 = double.Parse(str16.Split(new char[] { ',' })[0]) + num54;
                                    string str17 = num67.ToString("N6");
                                    num67 = double.Parse(str16.Split(new char[] { ',' })[1]) + num54;
                                    string str18 = num67.ToString("N6");
                                    str16 = double.Parse(str17) + "," + double.Parse(str18);
                                }
                                else
                                {
                                    num67 = double.Parse(str16) + num54;
                                    str16 = double.Parse(num67.ToString("N6")).ToString();
                                }
                                if (double.Parse(num53.ToString("N6")) > num54)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str16));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                            }
                            int num55 = 0;
                            switch (playid)
                            {
                                case "91016":
                                    num55 = CallBLL.cz_wt_3qz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91017":
                                    num55 = CallBLL.cz_wt_3z2_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91018":
                                    num55 = CallBLL.cz_wt_2qz_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91019":
                                    num55 = CallBLL.cz_wt_2zt_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91020":
                                    num55 = CallBLL.cz_wt_tc_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91040":
                                    num55 = CallBLL.cz_wt_4z1_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91060":
                                    num55 = CallBLL.cz_wt_3qz_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91061":
                                    num55 = CallBLL.cz_wt_3z2_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91062":
                                    num55 = CallBLL.cz_wt_2qz_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91063":
                                    num55 = CallBLL.cz_wt_2zt_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91064":
                                    num55 = CallBLL.cz_wt_tc_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;

                                case "91065":
                                    num55 = CallBLL.cz_wt_4z1_b_six_bll.SetWT(Convert.ToInt32(str6), double.Parse(num53.ToString("N6")));
                                    break;
                            }
                            base.CheckZKChildWT(str4);
                            base.lm_number_log(oldModel, oldWT, num53, str6, str3);
                            if ((base.IsShowLM_B() == 1) && (("92285,92286,92287,92288,92289,92575".IndexOf(str4) > -1) || ("92638,92639,92640,92641,92642,92643".IndexOf(str4) > -1)))
                            {
                                base.lm_number_log_ab(_six7, num46, num53, str6, str3);
                            }
                            if ((model.get_u_type().Trim().Equals("zj") && !num55.Equals(0)) && ((((playid.Equals("91016") || playid.Equals("91017")) || (playid.Equals("91018") || playid.Equals("91019"))) || ((playid.Equals("91020") || playid.Equals("91040")) || (playid.Equals("91060") || playid.Equals("91061")))) || ((playid.Equals("91062") || playid.Equals("91063")) || (playid.Equals("91064") || playid.Equals("91065")))))
                            {
                                dictionary.Add("wtnumbervalue", this.GetWT_LM(str8, playid));
                            }
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        strArray10 = oldModel.get_current_odds().Split(new char[] { ',' });
                        string[] strArray11 = oldModel.get_max_odds().Split(new char[] { ',' });
                        string[] strArray12 = oldModel.get_min_odds().Split(new char[] { ',' });
                        num24 = Convert.ToDouble(strArray10[0]);
                        num25 = (strArray10.Length > 1) ? Convert.ToDouble(strArray10[1]) : Convert.ToDouble(strArray10[0]);
                        num26 = Convert.ToDouble(strArray11[0]);
                        num27 = (strArray11.Length > 1) ? Convert.ToDouble(strArray11[1]) : Convert.ToDouble(strArray11[0]);
                        num28 = Convert.ToDouble(strArray12[0]);
                        num29 = (strArray12.Length > 1) ? Convert.ToDouble(strArray12[1]) : Convert.ToDouble(strArray12[0]);
                        num30 = 0.0;
                        num31 = 0.0;
                        strArray13 = null;
                        str25 = str8;
                        if (str25 != null)
                        {
                            if (!(str25 == "A"))
                            {
                                if (str25 == "B")
                                {
                                    strArray13 = oldModel.get_b_diff().Split(new char[] { ',' });
                                }
                                else if (str25 == "C")
                                {
                                    strArray13 = oldModel.get_c_diff().Split(new char[] { ',' });
                                }
                            }
                            else
                            {
                                strArray13 = oldModel.get_a_diff().Split(new char[] { ',' });
                            }
                        }
                    }
                    else
                    {
                        double num = 0.0;
                        double num2 = 0.0;
                        double num3 = 0.0;
                        double num4 = 0.0;
                        double num5 = 0.0;
                        double num6 = 0.0;
                        double num7 = 0.0;
                        double num8 = 0.0;
                        double num9 = 0.0;
                        double num10 = 0.0;
                        string[] strArray = null;
                        str25 = str8;
                        if (str25 != null)
                        {
                            if (!(str25 == "A"))
                            {
                                if (str25 == "B")
                                {
                                    strArray = oldModel.get_b_diff().Split(new char[] { ',' });
                                }
                                else if (str25 == "C")
                                {
                                    strArray = oldModel.get_c_diff().Split(new char[] { ',' });
                                }
                            }
                            else
                            {
                                strArray = oldModel.get_a_diff().Split(new char[] { ',' });
                            }
                        }
                        num9 = double.Parse(strArray[0]);
                        if (strArray.Length > 1)
                        {
                            num10 = double.Parse(strArray[1]);
                        }
                        string[] strArray2 = oldModel.get_current_odds().Split(new char[] { ',' });
                        string[] strArray3 = strArray2;
                        string[] strArray4 = oldModel.get_max_odds().Split(new char[] { ',' });
                        string[] strArray5 = oldModel.get_min_odds().Split(new char[] { ',' });
                        num = Convert.ToDouble(strArray2[0]);
                        num2 = Convert.ToDouble(strArray3[0]);
                        num3 = Convert.ToDouble(strArray4[0]);
                        num4 = Convert.ToDouble(strArray5[0]);
                        if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num5 = Convert.ToDouble(strArray2[1]);
                            num6 = Convert.ToDouble(strArray3[1]);
                            num7 = Convert.ToDouble(strArray4[1]);
                            num8 = Convert.ToDouble(strArray5[1]);
                        }
                        if (string.IsNullOrEmpty(str9))
                        {
                            str9 = "0.01";
                        }
                        num67 = num + num9;
                        num = double.Parse(num67.ToString());
                        if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num67 = num5 + num10;
                            num5 = double.Parse(num67.ToString());
                        }
                        str25 = str3;
                        if (str25 != null)
                        {
                            if (!(str25 == "1"))
                            {
                                if (str25 == "2")
                                {
                                    if (str7.Equals("0"))
                                    {
                                        num67 = num2 + -Convert.ToDouble(str9);
                                        num2 = double.Parse(num67.ToString());
                                    }
                                    if (str7.Equals("1"))
                                    {
                                        num67 = num6 + -Convert.ToDouble(str9);
                                        num6 = double.Parse(num67.ToString());
                                    }
                                }
                            }
                            else
                            {
                                if (str7.Equals("0"))
                                {
                                    num67 = num2 + Convert.ToDouble(str9);
                                    num2 = double.Parse(num67.ToString());
                                }
                                if (str7.Equals("1"))
                                {
                                    num67 = num6 + Convert.ToDouble(str9);
                                    num6 = double.Parse(num67.ToString());
                                }
                            }
                        }
                        if (num2 < num4)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num4));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if ((oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1) && (num6 < num8))
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num8));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (num2 > num3)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num3));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if ((oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1) && (num6 > num7))
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num7));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        Dictionary<int, double> dictionary2 = null;
                        if (wTs != null)
                        {
                            dictionary2 = new Dictionary<int, double>();
                            foreach (DataRow row in wTs.Rows)
                            {
                                double.Parse(row["wt_value"].ToString());
                                double num11 = num - Math.Abs(double.Parse(row["wt_value"].ToString()));
                                decimal num12 = 0M;
                                if (double.Parse(num2.ToString("N6")) > num11)
                                {
                                    num12 = decimal.Parse(num2.ToString()) - decimal.Parse(num11.ToString());
                                }
                                num68 = -num12;
                                dictionary2.Add(int.Parse(row["number"].ToString()), double.Parse(num68.ToString()));
                            }
                        }
                        if (_six2 != null)
                        {
                            double num13 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]);
                            double num14 = 0.0;
                            if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num14 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[1]);
                            }
                            if (str7.Equals("0") && (num2 > num13))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num13));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (str7.Equals("1") && (num6 > num14))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num14));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsLM(Convert.ToInt32(str4), (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num2 + "," + num6) : num2.ToString(), str3, dictionary2) <= 0)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        base.CheckZKChildWT(str4);
                        base.lm_group_log(oldModel, oldModel.get_current_odds(), (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num2 + "," + num6) : num2.ToString(), str3);
                        this.operate_adds_LM_AB(str3, str4, oldModel.get_current_odds(), (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num2 + "," + num6) : num2.ToString(), str6);
                        cz_odds_six _six3 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        string[] strArray6 = _six3.get_current_odds().Split(new char[] { ',' });
                        string[] strArray7 = _six3.get_max_odds().Split(new char[] { ',' });
                        string[] strArray8 = _six3.get_min_odds().Split(new char[] { ',' });
                        double num16 = Convert.ToDouble(strArray6[0]);
                        double num17 = (strArray6.Length > 1) ? Convert.ToDouble(strArray6[1]) : num16;
                        double num18 = Convert.ToDouble(strArray7[0]);
                        double num19 = (strArray7.Length > 1) ? Convert.ToDouble(strArray7[1]) : num18;
                        double num20 = Convert.ToDouble(strArray8[0]);
                        double num21 = (strArray8.Length > 1) ? Convert.ToDouble(strArray8[1]) : num20;
                        string[] strArray9 = null;
                        double num22 = 0.0;
                        double num23 = 0.0;
                        str25 = str8;
                        if (str25 != null)
                        {
                            if (!(str25 == "A"))
                            {
                                if (str25 == "B")
                                {
                                    strArray9 = _six3.get_b_diff().Split(new char[] { ',' });
                                }
                                else if (str25 == "C")
                                {
                                    strArray9 = _six3.get_c_diff().Split(new char[] { ',' });
                                }
                            }
                            else
                            {
                                strArray9 = _six3.get_a_diff().Split(new char[] { ',' });
                            }
                        }
                        num22 = Convert.ToDouble(strArray9[0]);
                        num23 = (strArray9.Length > 1) ? Convert.ToDouble(strArray9[0]) : num22;
                        num67 = num16 + num22;
                        num16 = double.Parse(num67.ToString());
                        if (strArray6.Length > 1)
                        {
                            num67 = num17 + num23;
                            num17 = double.Parse(num67.ToString());
                        }
                        string str11 = _six3.get_is_open().ToString();
                        Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                        Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                        dictionary4.Add("pl", (strArray6.Length > 1) ? (num16 + "," + num17) : num16.ToString());
                        dictionary4.Add("maxpl", (strArray7.Length > 1) ? (num18 + "," + num19) : num18.ToString());
                        dictionary4.Add("minpl", (strArray8.Length > 1) ? (num20 + "," + num21) : num20.ToString());
                        dictionary4.Add("plx", new List<double>());
                        if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                        {
                            str11 = "0";
                        }
                        dictionary4.Add("is_open", str11);
                        dictionary3.Add(str4, new Dictionary<string, object>(dictionary4));
                        dictionary.Add("play_odds", dictionary3);
                        if (model.get_u_type().Trim().Equals("zj") && ((((playid.Equals("91016") || playid.Equals("91017")) || (playid.Equals("91018") || playid.Equals("91019"))) || ((playid.Equals("91020") || playid.Equals("91040")) || (playid.Equals("91060") || playid.Equals("91061")))) || ((playid.Equals("91062") || playid.Equals("91063")) || (playid.Equals("91064") || playid.Equals("91065")))))
                        {
                            dictionary.Add("wtnumbervalue", this.GetWT_LM(str8, playid));
                        }
                        result.set_data(dictionary);
                        result.set_success(200);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    num30 = double.Parse(strArray13[0]);
                    if (strArray13.Length > 1)
                    {
                        num31 = double.Parse(strArray13[1]);
                    }
                    string str12 = "";
                    if (str7.Equals("0"))
                    {
                        num67 = double.Parse(s) - num30;
                        s = num67.ToString();
                        if (Convert.ToDouble(s) < num28)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num28));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (Convert.ToDouble(s) > num26)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num26));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (strArray10.Length > 1)
                        {
                            str12 = s + "," + num25;
                        }
                        else
                        {
                            str12 = s;
                        }
                    }
                    if (str7.Equals("1"))
                    {
                        num67 = double.Parse(s) - num31;
                        s = num67.ToString();
                        if (Convert.ToDouble(s) < num29)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num29));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (Convert.ToDouble(s) > num27)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num27));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (strArray10.Length > 1)
                        {
                            str12 = num24 + "," + s;
                        }
                    }
                    Dictionary<int, double> dictionary5 = null;
                    if (wTs != null)
                    {
                        dictionary5 = new Dictionary<int, double>();
                        foreach (DataRow row2 in wTs.Rows)
                        {
                            double.Parse(row2["wt_value"].ToString());
                            double num32 = num24 - Math.Abs(double.Parse(row2["wt_value"].ToString()));
                            decimal num33 = 0M;
                            if (double.Parse(s) > num32)
                            {
                                num33 = decimal.Parse(s.ToString()) - decimal.Parse(num32.ToString());
                            }
                            num68 = -num33;
                            dictionary5.Add(int.Parse(row2["number"].ToString()), double.Parse(num68.ToString()));
                        }
                    }
                    if (_six2 != null)
                    {
                        double num34 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]);
                        double num35 = 0.0;
                        if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num35 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[1]);
                        }
                        if (str7.Equals("0") && (double.Parse(str12.Split(new char[] { ',' })[0]) > num34))
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num34));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (str7.Equals("1") && (double.Parse(str12.Split(new char[] { ',' })[1]) > num35))
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num35));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsLM(Convert.ToInt32(str4), str12, str3, dictionary5) <= 0)
                    {
                        result.set_success(400);
                        result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        base.CheckZKChildWT(str4);
                        base.lm_group_log(oldModel, oldModel.get_current_odds(), str12, str3);
                        this.operate_adds_LM_AB(str3, str4, oldModel.get_current_odds(), str12, str6);
                        cz_odds_six _six5 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        string[] strArray14 = _six5.get_current_odds().Split(new char[] { ',' });
                        string[] strArray15 = _six5.get_max_odds().Split(new char[] { ',' });
                        string[] strArray16 = _six5.get_min_odds().Split(new char[] { ',' });
                        double num37 = Convert.ToDouble(strArray14[0]);
                        double num38 = (strArray14.Length > 1) ? Convert.ToDouble(strArray14[1]) : num37;
                        double num39 = Convert.ToDouble(strArray15[0]);
                        double num40 = (strArray15.Length > 1) ? Convert.ToDouble(strArray15[1]) : num39;
                        double num41 = Convert.ToDouble(strArray16[0]);
                        double num42 = (strArray16.Length > 1) ? Convert.ToDouble(strArray16[1]) : num41;
                        string[] strArray17 = null;
                        double num43 = 0.0;
                        double num44 = 0.0;
                        str25 = str8;
                        if (str25 != null)
                        {
                            if (!(str25 == "A"))
                            {
                                if (str25 == "B")
                                {
                                    strArray17 = _six5.get_b_diff().Split(new char[] { ',' });
                                }
                                else if (str25 == "C")
                                {
                                    strArray17 = _six5.get_c_diff().Split(new char[] { ',' });
                                }
                            }
                            else
                            {
                                strArray17 = _six5.get_a_diff().Split(new char[] { ',' });
                            }
                        }
                        num43 = Convert.ToDouble(strArray17[0]);
                        num44 = (strArray17.Length > 1) ? Convert.ToDouble(strArray17[0]) : num43;
                        num67 = num37 + num43;
                        num37 = double.Parse(num67.ToString());
                        if (strArray14.Length > 1)
                        {
                            num38 = double.Parse((num38 + num44).ToString());
                        }
                        string str13 = _six5.get_is_open().ToString();
                        Dictionary<string, object> dictionary6 = new Dictionary<string, object>();
                        Dictionary<string, object> dictionary7 = new Dictionary<string, object>();
                        dictionary7.Add("pl", (strArray14.Length > 1) ? (num37 + "," + num38) : num37.ToString());
                        dictionary7.Add("maxpl", (strArray15.Length > 1) ? (num39 + "," + num40) : num39.ToString());
                        dictionary7.Add("minpl", (strArray16.Length > 1) ? (num41 + "," + num42) : num41.ToString());
                        dictionary7.Add("plx", new List<double>());
                        if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                        {
                            str13 = "0";
                        }
                        dictionary7.Add("is_open", str13);
                        dictionary6.Add(str4, new Dictionary<string, object>(dictionary7));
                        dictionary.Add("play_odds", dictionary6);
                        if (model.get_u_type().Trim().Equals("zj") && ((((playid.Equals("91016") || playid.Equals("91017")) || (playid.Equals("91018") || playid.Equals("91019"))) || ((playid.Equals("91020") || playid.Equals("91040")) || (playid.Equals("91060") || playid.Equals("91061")))) || ((playid.Equals("91062") || playid.Equals("91063")) || (playid.Equals("91064") || playid.Equals("91065")))))
                        {
                            dictionary.Add("wtnumbervalue", this.GetWT_LM(str8, playid));
                        }
                        result.set_data(dictionary);
                        result.set_success(200);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                }
            }
        }

        private void operate_adds_LM_AB(string optype, string c_odds_id, string old_odds, string new_odds, string number)
        {
            if (base.IsShowLM_B() == 1)
            {
                string str = "A";
                string str2 = "";
                string str3 = "";
                Utils.Six_LM_AB(c_odds_id, ref str3, ref str2);
                double num = 0.0;
                double num2 = 0.0;
                double num3 = 0.0;
                double num4 = 0.0;
                double num5 = 0.0;
                double num6 = 0.0;
                num = Convert.ToDouble(old_odds.Split(new char[] { ',' })[0]);
                num3 = Convert.ToDouble(new_odds.Split(new char[] { ',' })[0]);
                if (old_odds.Split(new char[] { ',' }).Length > 1)
                {
                    num2 = Convert.ToDouble(old_odds.Split(new char[] { ',' })[1]);
                    num4 = Convert.ToDouble(new_odds.Split(new char[] { ',' })[1]);
                }
                num5 = num3 - num;
                num6 = num4 - num2;
                cz_odds_six model = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str3));
                cz_odds_six _six2 = null;
                if (base.IsChildSync())
                {
                    _six2 = CallBLL.cz_odds_six_bll.ZK_GetModel(Convert.ToInt32(str3), base.IsChildSystem().get_conn());
                }
                DataTable wTs = null;
                switch (str2)
                {
                    case "91016":
                        wTs = CallBLL.cz_wt_3qz_six_bll.GetWTs();
                        break;

                    case "91017":
                        wTs = CallBLL.cz_wt_3z2_six_bll.GetWTs();
                        break;

                    case "91018":
                        wTs = CallBLL.cz_wt_2qz_six_bll.GetWTs();
                        break;

                    case "91019":
                        wTs = CallBLL.cz_wt_2zt_six_bll.GetWTs();
                        break;

                    case "91020":
                        wTs = CallBLL.cz_wt_tc_six_bll.GetWTs();
                        break;

                    case "91040":
                        wTs = CallBLL.cz_wt_4z1_six_bll.GetWTs();
                        break;

                    case "91060":
                        wTs = CallBLL.cz_wt_3qz_b_six_bll.GetWTs();
                        break;

                    case "91061":
                        wTs = CallBLL.cz_wt_3z2_b_six_bll.GetWTs();
                        break;

                    case "91062":
                        wTs = CallBLL.cz_wt_2qz_b_six_bll.GetWTs();
                        break;

                    case "91063":
                        wTs = CallBLL.cz_wt_2zt_b_six_bll.GetWTs();
                        break;

                    case "91064":
                        wTs = CallBLL.cz_wt_tc_b_six_bll.GetWTs();
                        break;

                    case "91065":
                        wTs = CallBLL.cz_wt_4z1_b_six_bll.GetWTs();
                        break;
                }
                if ((optype.Equals("1") || optype.Equals("2")) || optype.Equals("3"))
                {
                    double num7 = 0.0;
                    double num8 = 0.0;
                    double num9 = 0.0;
                    double num10 = 0.0;
                    double num11 = 0.0;
                    double num12 = 0.0;
                    double num13 = 0.0;
                    double num14 = 0.0;
                    double num15 = 0.0;
                    double num16 = 0.0;
                    string[] strArray = null;
                    string str5 = str;
                    if (str5 != null)
                    {
                        if (!(str5 == "A"))
                        {
                            if (str5 == "B")
                            {
                                strArray = model.get_b_diff().Split(new char[] { ',' });
                            }
                            else if (str5 == "C")
                            {
                                strArray = model.get_c_diff().Split(new char[] { ',' });
                            }
                        }
                        else
                        {
                            strArray = model.get_a_diff().Split(new char[] { ',' });
                        }
                    }
                    num15 = double.Parse(strArray[0]);
                    if (strArray.Length > 1)
                    {
                        num16 = double.Parse(strArray[1]);
                    }
                    string[] strArray2 = model.get_current_odds().Split(new char[] { ',' });
                    string[] strArray3 = strArray2;
                    string[] strArray4 = model.get_max_odds().Split(new char[] { ',' });
                    string[] strArray5 = model.get_min_odds().Split(new char[] { ',' });
                    num7 = Convert.ToDouble(strArray2[0]);
                    num8 = Convert.ToDouble(strArray3[0]);
                    num9 = Convert.ToDouble(strArray4[0]);
                    num10 = Convert.ToDouble(strArray5[0]);
                    if (model.get_current_odds().Split(new char[] { ',' }).Length > 1)
                    {
                        num11 = Convert.ToDouble(strArray2[1]);
                        num12 = Convert.ToDouble(strArray3[1]);
                        num13 = Convert.ToDouble(strArray4[1]);
                        num14 = Convert.ToDouble(strArray5[1]);
                    }
                    if (num5 > 0.0)
                    {
                        num8 = double.Parse((num8 + num5).ToString());
                        if (strArray4.Length > 1)
                        {
                            num12 = double.Parse((num12 + num6).ToString());
                        }
                    }
                    else
                    {
                        num8 = double.Parse((num8 - Math.Abs(num5)).ToString());
                        if (strArray4.Length > 1)
                        {
                            num12 = double.Parse((num12 - Math.Abs(num6)).ToString());
                        }
                    }
                    num7 = double.Parse((num7 + num15).ToString());
                    if (model.get_current_odds().Split(new char[] { ',' }).Length > 1)
                    {
                        num11 = double.Parse((num11 + num16).ToString());
                    }
                    if (num8 < num10)
                    {
                        num8 = num10;
                    }
                    if ((model.get_current_odds().Split(new char[] { ',' }).Length > 1) && (num12 < num14))
                    {
                        num12 = num14;
                    }
                    if (num8 > num9)
                    {
                        num8 = num9;
                    }
                    if ((model.get_current_odds().Split(new char[] { ',' }).Length > 1) && (num12 > num13))
                    {
                        num12 = num13;
                    }
                    Dictionary<int, double> dictionary = null;
                    if (wTs != null)
                    {
                        dictionary = new Dictionary<int, double>();
                        foreach (DataRow row in wTs.Rows)
                        {
                            double.Parse(row["wt_value"].ToString());
                            double num17 = num7 - Math.Abs(double.Parse(row["wt_value"].ToString()));
                            decimal num18 = 0M;
                            if (double.Parse(num8.ToString("N6")) > num17)
                            {
                                num18 = decimal.Parse(num8.ToString()) - decimal.Parse(num17.ToString());
                            }
                            decimal num29 = -num18;
                            dictionary.Add(int.Parse(row["number"].ToString()), double.Parse(num29.ToString()));
                        }
                    }
                    if (_six2 != null)
                    {
                        double num19 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]);
                        double num20 = 0.0;
                        if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num20 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[1]);
                        }
                        if (num8 > num19)
                        {
                            num8 = num19;
                        }
                        if (num12 > num20)
                        {
                            num12 = num20;
                        }
                    }
                    if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsLM(Convert.ToInt32(str3), (model.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num8 + "," + num12) : num8.ToString(), optype, dictionary) > 0)
                    {
                        base.CheckZKChildWT(str3);
                        base.lm_group_log_ab(model, model.get_current_odds(), (model.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num8 + "," + num12) : num8.ToString(), optype);
                    }
                }
            }
        }

        public void operate_adds_LM_wt(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_six_op_odds().Equals(1))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("fgs") || !model.get_six_op_odds().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                string playid = "";
                switch (str4)
                {
                    case "92285":
                        playid = "91016";
                        break;

                    case "92286":
                        playid = "91017";
                        break;

                    case "92287":
                        playid = "91018";
                        break;

                    case "92288":
                        playid = "91019";
                        break;

                    case "92289":
                        playid = "91020";
                        break;

                    case "92575":
                        playid = "91040";
                        break;

                    case "92638":
                        playid = "91060";
                        break;

                    case "92639":
                        playid = "91061";
                        break;

                    case "92640":
                        playid = "91062";
                        break;

                    case "92641":
                        playid = "91063";
                        break;

                    case "92642":
                        playid = "91064";
                        break;

                    case "92643":
                        playid = "91065";
                        break;
                }
                LSRequest.qq("number");
                string str6 = LSRequest.qq("oddsindex");
                if (string.IsNullOrEmpty(str6))
                {
                    str6 = "0";
                }
                LSRequest.qq("phaseid");
                string str7 = LSRequest.qq("pk");
                string str8 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                if (string.IsNullOrEmpty(str7))
                {
                    str7 = "A";
                }
                else
                {
                    str7 = str7.ToUpper();
                }
                if ((!str7.Equals("A") && !str7.Equals("B")) && !str7.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    int num60;
                    double num61;
                    cz_odds_six _six = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                    {
                        _six = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (_six == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    DataTable minWTValue = null;
                    switch (playid)
                    {
                        case "91016":
                            minWTValue = CallBLL.cz_wt_3qz_six_bll.GetMinWTValue();
                            break;

                        case "91017":
                            minWTValue = CallBLL.cz_wt_3z2_six_bll.GetMinWTValue();
                            break;

                        case "91018":
                            minWTValue = CallBLL.cz_wt_2qz_six_bll.GetMinWTValue();
                            break;

                        case "91019":
                            minWTValue = CallBLL.cz_wt_2zt_six_bll.GetMinWTValue();
                            break;

                        case "91020":
                            minWTValue = CallBLL.cz_wt_tc_six_bll.GetMinWTValue();
                            break;

                        case "91040":
                            minWTValue = CallBLL.cz_wt_4z1_six_bll.GetMinWTValue();
                            break;

                        case "91060":
                            minWTValue = CallBLL.cz_wt_3qz_b_six_bll.GetMinWTValue();
                            break;

                        case "91061":
                            minWTValue = CallBLL.cz_wt_3z2_b_six_bll.GetMinWTValue();
                            break;

                        case "91062":
                            minWTValue = CallBLL.cz_wt_2qz_b_six_bll.GetMinWTValue();
                            break;

                        case "91063":
                            minWTValue = CallBLL.cz_wt_2zt_b_six_bll.GetMinWTValue();
                            break;

                        case "91064":
                            minWTValue = CallBLL.cz_wt_tc_b_six_bll.GetMinWTValue();
                            break;

                        case "91065":
                            minWTValue = CallBLL.cz_wt_4z1_b_six_bll.GetMinWTValue();
                            break;
                    }
                    double.Parse(minWTValue.Rows[0]["wt_value"].ToString());
                    string str10 = minWTValue.Rows[0]["number"].ToString();
                    if (int.Parse(str10) < 10)
                    {
                        str10 = "0" + str10;
                    }
                    if (!str3.Equals("1") && !str3.Equals("2"))
                    {
                        if (str3.Equals("3"))
                        {
                            double num30 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[0]);
                            double num31 = 0.0;
                            if (_six.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num31 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[1]);
                            }
                            double num32 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[0]);
                            double num33 = 0.0;
                            if (_six.get_max_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num33 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[1]);
                            }
                            double num34 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[0]);
                            double num35 = 0.0;
                            if (_six.get_min_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num35 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[1]);
                            }
                            string str14 = "0";
                            if (str7.Equals("A"))
                            {
                                str14 = _six.get_a_diff();
                            }
                            else if (str7.Equals("B"))
                            {
                                str14 = _six.get_b_diff();
                            }
                            else if (str7.Equals("C"))
                            {
                                str14 = _six.get_c_diff();
                            }
                            double num36 = double.Parse(str14.Split(new char[] { ',' })[0]);
                            double num37 = 0.0;
                            if (str14.Split(new char[] { ',' }).Length > 1)
                            {
                                num37 = double.Parse(str14.Split(new char[] { ',' })[1]);
                            }
                            double num38 = 0.0;
                            double num39 = 0.0;
                            base.GetOperate_SIX(str4, ref num38, ref num39);
                            double num40 = num30;
                            double num41 = num31;
                            double num42 = num34;
                            double num43 = num35;
                            num61 = num30 + num38;
                            double num44 = double.Parse(num61.ToString());
                            num61 = num31 + num39;
                            double num45 = double.Parse(num61.ToString());
                            num61 = num30 + num36;
                            double num46 = double.Parse(num61.ToString());
                            num61 = num31 + num37;
                            double num47 = double.Parse(num61.ToString());
                            num61 = (num40 - num42) + 1.0;
                            double num48 = double.Parse(num61.ToString());
                            num61 = (num41 - num43) + 1.0;
                            double num49 = double.Parse(num61.ToString());
                            num61 = double.Parse(s) - num36;
                            double num50 = double.Parse(num61.ToString());
                            num61 = double.Parse(s) - num37;
                            double num51 = double.Parse(num61.ToString());
                            decimal num52 = 0M;
                            if (str6.Equals("0"))
                            {
                                if (Convert.ToDouble(num50) < num42)
                                {
                                    result.set_success(400);
                                    num61 = num42 + num36;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num50) > num40)
                                {
                                    result.set_success(400);
                                    num61 = num40 + num36;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num50) < num48)
                                {
                                    result.set_success(400);
                                    num61 = num48 + num36;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                decimal num62 = decimal.Parse(num50.ToString()) - decimal.Parse(num40.ToString());
                                num52 = decimal.Parse(num62.ToString());
                            }
                            else
                            {
                                if (Convert.ToDouble(num51) < num43)
                                {
                                    result.set_success(400);
                                    num61 = num43 + num37;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num51) > num41)
                                {
                                    result.set_success(400);
                                    num61 = num41 + num37;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num51) < num49)
                                {
                                    result.set_success(400);
                                    num61 = num49 + num37;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                num52 = decimal.Parse((decimal.Parse(num51.ToString()) - decimal.Parse(num41.ToString())).ToString());
                            }
                            DataTable oddsWTbyFGS = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                            num60 = 100;
                            base.Add_FgsOddsWT_Lock(num60.ToString(), str, str4);
                            int num53 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOddsLM(Convert.ToInt32(str4), num52, str3, str, str6);
                            num60 = 100;
                            base.Del_FgsOddsWT_Lock(num60.ToString(), str, str4);
                            if (num53 > 0)
                            {
                                base.fgs_opt_six_log(oddsWTbyFGS, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                num38 = 0.0;
                                num39 = 0.0;
                                CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                FileCacheHelper.UpdateFGSWTFile(100);
                                base.GetOperate_SIX(str4, ref num38, ref num39);
                                cz_odds_six _six4 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                                double num54 = Convert.ToDouble(_six4.get_current_odds().Split(new char[] { ',' })[0]);
                                double num55 = 0.0;
                                if (_six4.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                {
                                    num55 = Convert.ToDouble(_six4.get_current_odds().Split(new char[] { ',' })[1]);
                                }
                                Convert.ToDouble(_six4.get_max_odds().Split(new char[] { ',' })[0]);
                                if (_six4.get_max_odds().Split(new char[] { ',' }).Length > 1)
                                {
                                    Convert.ToDouble(_six4.get_max_odds().Split(new char[] { ',' })[1]);
                                }
                                double num56 = Convert.ToDouble(_six4.get_min_odds().Split(new char[] { ',' })[0]);
                                double num57 = 0.0;
                                if (_six4.get_min_odds().Split(new char[] { ',' }).Length > 1)
                                {
                                    num57 = Convert.ToDouble(_six4.get_min_odds().Split(new char[] { ',' })[1]);
                                }
                                string str15 = "0";
                                double num58 = 0.0;
                                double num59 = 0.0;
                                if (str7.Equals("A"))
                                {
                                    str15 = _six4.get_a_diff();
                                }
                                else if (str7.Equals("B"))
                                {
                                    str15 = _six4.get_b_diff();
                                }
                                else if (str7.Equals("C"))
                                {
                                    str15 = _six4.get_c_diff();
                                }
                                num58 = double.Parse(str15.Split(new char[] { ',' })[0]);
                                if (str15.Split(new char[] { ',' }).Length > 1)
                                {
                                    num59 = double.Parse(str15.Split(new char[] { ',' })[1]);
                                }
                                num61 = (num54 + num58) + num38;
                                num44 = double.Parse(num61.ToString());
                                num61 = (num55 + num59) + num39;
                                num45 = double.Parse(num61.ToString());
                                num61 = num54 + num58;
                                num46 = double.Parse(num61.ToString());
                                num61 = num55 + num59;
                                num47 = double.Parse(num61.ToString());
                                num61 = ((num54 - num56) + num58) + 1.0;
                                num48 = double.Parse(num61.ToString());
                                num61 = ((num55 - num57) + num59) + 1.0;
                                num49 = double.Parse(num61.ToString());
                                string str16 = _six4.get_is_open().ToString();
                                Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                                Dictionary<string, object> dictionary5 = new Dictionary<string, object>();
                                dictionary5.Add("pl", (_six4.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num44.ToString() + "," + num45.ToString()) : num44.ToString());
                                dictionary5.Add("maxpl", (_six4.get_max_odds().Split(new char[] { ',' }).Length > 1) ? (num46.ToString() + "," + num47.ToString()) : num46.ToString());
                                dictionary5.Add("minpl", (_six4.get_min_odds().Split(new char[] { ',' }).Length > 1) ? (num48.ToString() + "," + num49.ToString()) : num48.ToString());
                                dictionary5.Add("plx", new List<double>());
                                if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                                {
                                    str16 = "0";
                                }
                                dictionary5.Add("is_open", str16);
                                dictionary4.Add(str4, new Dictionary<string, object>(dictionary5));
                                dictionary.Add("play_odds", dictionary4);
                                if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && ((((playid.Equals("91016") || playid.Equals("91017")) || (playid.Equals("91018") || playid.Equals("91019"))) || ((playid.Equals("91020") || playid.Equals("91040")) || (playid.Equals("91060") || playid.Equals("91061")))) || ((playid.Equals("91062") || playid.Equals("91063")) || (playid.Equals("91064") || playid.Equals("91065")))))
                                {
                                    dictionary.Add("wtnumbervalue", this.GetWT_LM_wt(model, context, str7, playid));
                                }
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                        }
                    }
                    else
                    {
                        double num = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[0]);
                        double num2 = 0.0;
                        if (_six.get_current_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num2 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[1]);
                        }
                        double num3 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[0]);
                        double num4 = 0.0;
                        if (_six.get_max_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num4 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[1]);
                        }
                        double num5 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[0]);
                        double num6 = 0.0;
                        if (_six.get_min_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num6 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[1]);
                        }
                        string str11 = "0";
                        if (str7.Equals("A"))
                        {
                            str11 = _six.get_a_diff();
                        }
                        else if (str7.Equals("B"))
                        {
                            str11 = _six.get_b_diff();
                        }
                        else if (str7.Equals("C"))
                        {
                            str11 = _six.get_c_diff();
                        }
                        double num7 = double.Parse(str11.Split(new char[] { ',' })[0]);
                        double num8 = 0.0;
                        if (str11.Split(new char[] { ',' }).Length > 1)
                        {
                            num8 = double.Parse(str11.Split(new char[] { ',' })[1]);
                        }
                        double num9 = 0.0;
                        double num10 = 0.0;
                        base.GetOperate_SIX(str4, ref num9, ref num10);
                        double num11 = num;
                        double num12 = num2;
                        double num13 = num5;
                        double num14 = num6;
                        num61 = num + num9;
                        double num15 = double.Parse(num61.ToString());
                        num61 = num2 + num10;
                        double num16 = double.Parse(num61.ToString());
                        num61 = num + num7;
                        double num17 = double.Parse(num61.ToString());
                        num61 = num2 + num8;
                        double num18 = double.Parse(num61.ToString());
                        num61 = (num11 - num13) + 1.0;
                        double num19 = double.Parse(num61.ToString());
                        num61 = (num12 - num14) + 1.0;
                        double num20 = double.Parse(num61.ToString());
                        double num21 = 0.0;
                        double num22 = 0.0;
                        string str17 = str3;
                        if (str17 != null)
                        {
                            if (!(str17 == "1"))
                            {
                                if (str17 == "2")
                                {
                                    num61 = num15 + -Convert.ToDouble(str8);
                                    num21 = double.Parse(num61.ToString());
                                    num61 = num16 + -Convert.ToDouble(str8);
                                    num22 = double.Parse(num61.ToString());
                                }
                            }
                            else
                            {
                                num61 = num15 + Convert.ToDouble(str8);
                                num21 = double.Parse(num61.ToString());
                                num61 = num16 + Convert.ToDouble(str8);
                                num22 = double.Parse(num61.ToString());
                            }
                        }
                        if (str6.Equals("0"))
                        {
                            if (!str3.Equals("1") && (num21 < num13))
                            {
                                result.set_success(400);
                                num61 = num13 + num7;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (!str3.Equals("2") && (num21 > num11))
                            {
                                result.set_success(400);
                                num61 = num11 + num7;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num21 < num19)
                            {
                                result.set_success(400);
                                num61 = num19 + num7;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        else
                        {
                            if (!str3.Equals("1") && (num22 < num14))
                            {
                                result.set_success(400);
                                num61 = num14 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (!str3.Equals("2") && (num22 > num12))
                            {
                                result.set_success(400);
                                num61 = num12 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num22 < num20)
                            {
                                result.set_success(400);
                                num61 = num20 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num61.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        DataTable table2 = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                        num60 = 100;
                        base.Add_FgsOddsWT_Lock(num60.ToString(), str, str4);
                        int num23 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOddsLM(Convert.ToInt32(str4), str3.Equals("1") ? Convert.ToDecimal(str8) : -Convert.ToDecimal(str8), str3, str, str6);
                        base.Del_FgsOddsWT_Lock(100.ToString(), str, str4);
                        if (num23 > 0)
                        {
                            base.fgs_opt_six_log(table2, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                            num9 = 0.0;
                            num10 = 0.0;
                            CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                            FileCacheHelper.UpdateFGSWTFile(100);
                            base.GetOperate_SIX(str4, ref num9, ref num10);
                            cz_odds_six _six2 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                            double num24 = Convert.ToDouble(_six2.get_current_odds().Split(new char[] { ',' })[0]);
                            double num25 = 0.0;
                            if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num25 = Convert.ToDouble(_six2.get_current_odds().Split(new char[] { ',' })[1]);
                            }
                            Convert.ToDouble(_six2.get_max_odds().Split(new char[] { ',' })[0]);
                            if (_six2.get_max_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                Convert.ToDouble(_six2.get_max_odds().Split(new char[] { ',' })[1]);
                            }
                            double num26 = Convert.ToDouble(_six2.get_min_odds().Split(new char[] { ',' })[0]);
                            double num27 = 0.0;
                            if (_six2.get_min_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num27 = Convert.ToDouble(_six2.get_min_odds().Split(new char[] { ',' })[1]);
                            }
                            string str12 = "0";
                            double num28 = 0.0;
                            double num29 = 0.0;
                            if (str7.Equals("A"))
                            {
                                str12 = _six2.get_a_diff();
                            }
                            else if (str7.Equals("B"))
                            {
                                str12 = _six2.get_b_diff();
                            }
                            else if (str7.Equals("C"))
                            {
                                str12 = _six2.get_c_diff();
                            }
                            num28 = double.Parse(str12.Split(new char[] { ',' })[0]);
                            if (str12.Split(new char[] { ',' }).Length > 1)
                            {
                                num29 = double.Parse(str12.Split(new char[] { ',' })[1]);
                            }
                            num61 = (num24 + num28) + num9;
                            num15 = double.Parse(num61.ToString());
                            num61 = (num25 + num29) + num10;
                            num16 = double.Parse(num61.ToString());
                            num61 = num24 + num28;
                            num17 = double.Parse(num61.ToString());
                            num61 = num25 + num29;
                            num18 = double.Parse(num61.ToString());
                            num61 = ((num24 - num26) + num28) + 1.0;
                            num19 = double.Parse(num61.ToString());
                            num20 = double.Parse((((num25 - num27) + num29) + 1.0).ToString());
                            string str13 = _six2.get_is_open().ToString();
                            Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                            Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                            dictionary3.Add("pl", (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num15.ToString() + "," + num16.ToString()) : num15.ToString());
                            dictionary3.Add("maxpl", (_six2.get_max_odds().Split(new char[] { ',' }).Length > 1) ? (num17.ToString() + "," + num18.ToString()) : num17.ToString());
                            dictionary3.Add("minpl", (_six2.get_min_odds().Split(new char[] { ',' }).Length > 1) ? (num19.ToString() + "," + num20.ToString()) : num19.ToString());
                            dictionary3.Add("plx", new List<double>());
                            if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                            {
                                str13 = "0";
                            }
                            dictionary3.Add("is_open", str13);
                            dictionary2.Add(str4, new Dictionary<string, object>(dictionary3));
                            dictionary.Add("play_odds", dictionary2);
                            if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && ((((playid.Equals("91016") || playid.Equals("91017")) || (playid.Equals("91018") || playid.Equals("91019"))) || ((playid.Equals("91020") || playid.Equals("91040")) || (playid.Equals("91060") || playid.Equals("91061")))) || ((playid.Equals("91062") || playid.Equals("91063")) || (playid.Equals("91064") || playid.Equals("91065")))))
                            {
                                dictionary.Add("wtnumbervalue", this.GetWT_LM_wt(model, context, str7, playid));
                            }
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                    }
                }
            }
        }

        public void operate_adds_LXL(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                LSRequest.qq("number");
                string str5 = LSRequest.qq("oddsindex");
                LSRequest.qq("phaseid");
                string str6 = LSRequest.qq("pk");
                string str7 = LSRequest.qq("wtvalue");
                string str8 = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                if (string.IsNullOrEmpty(str6))
                {
                    str6 = "A";
                }
                else
                {
                    str6 = str6.ToUpper();
                }
                if ((!str6.Equals("A") && !str6.Equals("B")) && !str6.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    double num28;
                    double num29;
                    double num30;
                    double num31;
                    double num32;
                    double num33;
                    double num34;
                    double num35;
                    double num36;
                    double num37;
                    string str18;
                    double num54;
                    decimal num56;
                    cz_odds_six oldModel = null;
                    cz_odds_six _six2 = null;
                    DataTable table = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                    {
                        oldModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (oldModel == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (base.IsChildSync())
                        {
                            cz_admin_subsystem _subsystem = base.IsChildSystem();
                            _six2 = CallBLL.cz_odds_six_bll.ZK_GetModel(Convert.ToInt32(str4), _subsystem.get_conn());
                            table = CallBLL.cz_odds_six_bll.ZK_SXLWSL_WT(Convert.ToInt32(str4), _subsystem.get_conn());
                        }
                    }
                    DataTable minWTValue = CallBLL.cz_wt_sxlwsl_six_bll.GetMinWTValue(int.Parse(str4));
                    double.Parse(minWTValue.Rows[0]["wt_value"].ToString());
                    string s = minWTValue.Rows[0]["number"].ToString();
                    if (int.Parse(s) < 10)
                    {
                        s = "0" + s;
                    }
                    DataTable wTs = CallBLL.cz_wt_sxlwsl_six_bll.GetWTs(str4);
                    if (!str3.Equals("1") && !str3.Equals("2"))
                    {
                        if (!str3.Equals("3"))
                        {
                            return;
                        }
                        DataTable wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(Convert.ToInt32(str5), Convert.ToInt32(str4));
                        num28 = 0.0;
                        if ((wT != null) && (wT.Rows.Count > 0))
                        {
                            num28 = Convert.ToDouble(wT.Rows[0]["wt_value"].ToString());
                        }
                        num29 = 0.0;
                        num29 = Convert.ToDouble(str8);
                        num30 = 0.0;
                        num31 = 0.0;
                        num32 = 0.0;
                        num33 = 0.0;
                        num34 = 0.0;
                        num35 = 0.0;
                        num36 = 0.0;
                        num37 = 0.0;
                        string[] strArray5 = oldModel.get_current_odds().Split(new char[] { ',' });
                        string[] strArray6 = strArray5;
                        string[] strArray7 = oldModel.get_max_odds().Split(new char[] { ',' });
                        string[] strArray8 = oldModel.get_min_odds().Split(new char[] { ',' });
                        num30 = Convert.ToDouble(strArray5[0]);
                        Convert.ToDouble(strArray6[0]);
                        num31 = Convert.ToDouble(strArray7[0]);
                        num32 = Convert.ToDouble(strArray8[0]);
                        num33 = Convert.ToDouble(strArray5[1]);
                        Convert.ToDouble(strArray6[1]);
                        num34 = Convert.ToDouble(strArray7[1]);
                        num35 = Convert.ToDouble(strArray8[1]);
                        str18 = str6;
                        if (str18 != null)
                        {
                            if (!(str18 == "A"))
                            {
                                if (str18 == "B")
                                {
                                    num36 = Convert.ToInt32(oldModel.get_b_diff().Split(new char[] { ',' })[0]);
                                    if (oldModel.get_b_diff().Split(new char[] { ',' }).Length > 1)
                                    {
                                        num37 = double.Parse(oldModel.get_b_diff().Split(new char[] { ',' })[1]);
                                    }
                                }
                                else if (str18 == "C")
                                {
                                    num36 = double.Parse(oldModel.get_c_diff().Split(new char[] { ',' })[0]);
                                    if (oldModel.get_c_diff().Split(new char[] { ',' }).Length > 1)
                                    {
                                        num37 = double.Parse(oldModel.get_c_diff().Split(new char[] { ',' })[1]);
                                    }
                                }
                            }
                            else
                            {
                                num36 = double.Parse(oldModel.get_a_diff().Split(new char[] { ',' })[0]);
                                if (oldModel.get_a_diff().Split(new char[] { ',' }).Length > 1)
                                {
                                    num37 = double.Parse(oldModel.get_a_diff().Split(new char[] { ',' })[1]);
                                }
                            }
                        }
                    }
                    else
                    {
                        DataTable table4 = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(Convert.ToInt32(str5), Convert.ToInt32(str4));
                        double oldWT = 0.0;
                        if ((table4 != null) && (table4.Rows.Count > 0))
                        {
                            oldWT = Convert.ToDouble(table4.Rows[0]["wt_value"].ToString());
                            table4.Rows[0]["number"].ToString();
                        }
                        double num2 = 0.0;
                        double num3 = 0.0;
                        double num4 = 0.0;
                        double num5 = 0.0;
                        double num6 = 0.0;
                        double num7 = 0.0;
                        double num8 = 0.0;
                        double num9 = 0.0;
                        string[] strArray = oldModel.get_current_odds().Split(new char[] { ',' });
                        string[] strArray2 = strArray;
                        string[] strArray3 = oldModel.get_max_odds().Split(new char[] { ',' });
                        string[] strArray4 = oldModel.get_min_odds().Split(new char[] { ',' });
                        num2 = Convert.ToDouble(strArray[0]);
                        num3 = Convert.ToDouble(strArray2[0]);
                        num4 = Convert.ToDouble(strArray3[0]);
                        num5 = Convert.ToDouble(strArray4[0]);
                        num6 = Convert.ToDouble(strArray[1]);
                        num7 = Convert.ToDouble(strArray2[1]);
                        num8 = Convert.ToDouble(strArray3[1]);
                        num9 = Convert.ToDouble(strArray4[1]);
                        if (string.IsNullOrEmpty(str7))
                        {
                            str7 = "0.01";
                        }
                        str18 = str6;
                        if (str18 != null)
                        {
                            if (!(str18 == "A"))
                            {
                                if (str18 == "B")
                                {
                                    double.Parse(oldModel.get_b_diff().Split(new char[] { ',' })[0]);
                                    if (oldModel.get_b_diff().Split(new char[] { ',' }).Length > 1)
                                    {
                                        double.Parse(oldModel.get_b_diff().Split(new char[] { ',' })[1]);
                                    }
                                }
                                else if (str18 == "C")
                                {
                                    double.Parse(oldModel.get_c_diff().Split(new char[] { ',' })[0]);
                                    if (oldModel.get_c_diff().Split(new char[] { ',' }).Length > 1)
                                    {
                                        double.Parse(oldModel.get_c_diff().Split(new char[] { ',' })[1]);
                                    }
                                }
                            }
                            else
                            {
                                double.Parse(oldModel.get_a_diff().Split(new char[] { ',' })[0]);
                                if (oldModel.get_a_diff().Split(new char[] { ',' }).Length > 1)
                                {
                                    double.Parse(oldModel.get_a_diff().Split(new char[] { ',' })[1]);
                                }
                            }
                        }
                        double num10 = 0.0;
                        str18 = str3;
                        if (str18 != null)
                        {
                            if (!(str18 == "1"))
                            {
                                if (str18 == "2")
                                {
                                    num54 = num3 + (-Convert.ToDouble(str7) + oldWT);
                                    num3 = double.Parse(num54.ToString());
                                    num54 = num7 + (-Convert.ToDouble(str7) + oldWT);
                                    num7 = double.Parse(num54.ToString());
                                    num54 = oldWT + -Convert.ToDouble(str7);
                                    num10 = double.Parse(num54.ToString());
                                }
                            }
                            else
                            {
                                num54 = num3 + (Convert.ToDouble(str7) + oldWT);
                                num3 = double.Parse(num54.ToString());
                                num54 = num7 + (Convert.ToDouble(str7) + oldWT);
                                num7 = double.Parse(num54.ToString());
                                num54 = oldWT + Convert.ToDouble(str7);
                                num10 = double.Parse(num54.ToString());
                            }
                        }
                        if ((str5 == "0") && (str5 != Convert.ToInt32(base.get_YearLianID()).ToString()))
                        {
                            if (num3 < num5)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num5));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num10 < (1.0 - num5))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num2 + (1.0 - num5)));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num3 > num4)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num4));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        else if (str5 == Convert.ToInt32(base.get_YearLianID()).ToString())
                        {
                            if (num7 < num9)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num9));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num10 < (1.0 - num9))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num6 + (1.0 - num9)));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num7 > num8)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num8));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        else
                        {
                            if (Math.Abs(Convert.ToDouble(num10)) > (num2 - 1.0))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num3 > num4)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num4));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num3 > num2)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100033", "MessageHint"), num2));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        int num11 = 0;
                        if (str5 == "0")
                        {
                            Dictionary<int, double> dictionary2 = null;
                            if (wTs != null)
                            {
                                dictionary2 = new Dictionary<int, double>();
                                foreach (DataRow row in wTs.Rows)
                                {
                                    double.Parse(row["wt_value"].ToString());
                                    double num12 = num2 - Math.Abs(double.Parse(row["wt_value"].ToString()));
                                    decimal num13 = 0M;
                                    if (double.Parse(num3.ToString("N6")) > num12)
                                    {
                                        num13 = decimal.Parse(num3.ToString()) - decimal.Parse(num12.ToString());
                                    }
                                    num56 = -num13;
                                    dictionary2.Add(int.Parse(row["number"].ToString()), double.Parse(num56.ToString()));
                                }
                            }
                            num54 = num2 + num10;
                            string str10 = double.Parse(num54.ToString()) + "," + num6;
                            if ((_six2 != null) && (double.Parse(str10.Split(new char[] { ',' })[0]) > double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0])))
                            {
                                string str11 = _six2.get_current_odds().Split(new char[] { ',' })[0];
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str11));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (double.Parse(str10.Split(new char[] { ',' })[0]) < num5)
                            {
                                str10 = num5 + "," + num6;
                            }
                            num11 = CallBLL.cz_odds_six_bll.UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), str10, dictionary2);
                            Dictionary<int, double> dictionary3 = new Dictionary<int, double>();
                            if (_six2 != null)
                            {
                                for (int i = 0; i < table.Rows.Count; i++)
                                {
                                    if (!table.Rows[i]["number"].ToString().Equals(base.get_YearLianID()))
                                    {
                                        double num15 = double.Parse(table.Rows[i]["wt_value"].ToString());
                                        int num16 = int.Parse(table.Rows[i]["number"].ToString());
                                        double num17 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]) + num15;
                                        double num18 = 0.0;
                                        if (wTs != null)
                                        {
                                            DataRow[] rowArray = wTs.Select(string.Format(" number={0} ", num16));
                                            if (rowArray.Length > 0)
                                            {
                                                num18 = double.Parse(rowArray[0]["wt_value"].ToString());
                                                if (str3.Equals("1"))
                                                {
                                                    num18 += double.Parse(str7);
                                                }
                                                if (str3.Equals("2"))
                                                {
                                                    num18 += -double.Parse(str7);
                                                }
                                            }
                                        }
                                        double num19 = double.Parse(double.Parse(str10.Split(new char[] { ',' })[0]).ToString("N6")) + num18;
                                        if ((num19 > double.Parse(num17.ToString("N6"))) && (double.Parse(num18.ToString("N6")) > double.Parse(num15.ToString("N6"))))
                                        {
                                            double num20 = num17 - double.Parse(str10.Split(new char[] { ',' })[0]);
                                            dictionary3.Add(num16, double.Parse(num20.ToString("N6").ToString()));
                                        }
                                    }
                                }
                                if (dictionary3.Count > 0)
                                {
                                    base.IsChildSystem();
                                    CallBLL.cz_odds_six_bll.Child_UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), dictionary3);
                                }
                            }
                            base.CheckZKChildWT(str4);
                            base.sxlws_group_log(oldModel, oldModel.get_current_odds(), str10, str3, true);
                        }
                        else if (str5.Equals(Convert.ToInt32(base.get_YearLianID()).ToString()))
                        {
                            Dictionary<int, double> dictionary4 = null;
                            num54 = num6 + num10;
                            string str12 = num2 + "," + double.Parse(num54.ToString());
                            if ((_six2 != null) && (double.Parse(str12.Split(new char[] { ',' })[1]) > double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[1])))
                            {
                                string str13 = _six2.get_current_odds().Split(new char[] { ',' })[1];
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str13));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (double.Parse(str12.Split(new char[] { ',' })[1]) < num9)
                            {
                                str12 = num2 + "," + num9;
                            }
                            num11 = CallBLL.cz_odds_six_bll.UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), str12, dictionary4);
                            base.CheckZKChildWT(str4);
                            base.sxlws_group_log(oldModel, oldModel.get_current_odds(), str12, str3, true);
                        }
                        else
                        {
                            new Dictionary<int, double>();
                            if (_six2 != null)
                            {
                                for (int j = 0; j < table.Rows.Count; j++)
                                {
                                    if (!table.Rows[j]["number"].ToString().Equals(base.get_YearLianID()))
                                    {
                                        double num22 = double.Parse(table.Rows[j]["wt_value"].ToString());
                                        int num23 = int.Parse(table.Rows[j]["number"].ToString());
                                        double num24 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]) + num22;
                                        double num25 = 0.0;
                                        double num26 = 0.0;
                                        if (wTs != null)
                                        {
                                            DataRow[] rowArray2 = wTs.Select(string.Format(" number={0} ", num23));
                                            if (rowArray2.Length > 0)
                                            {
                                                num25 = double.Parse(rowArray2[0]["wt_value"].ToString());
                                                num26 = double.Parse(rowArray2[0]["wt_value"].ToString());
                                                if (str3.Equals("1"))
                                                {
                                                    num25 += double.Parse(str7);
                                                }
                                                if (str3.Equals("2"))
                                                {
                                                    num25 += -double.Parse(str7);
                                                }
                                            }
                                        }
                                        double num27 = double.Parse(num2.ToString("N6")) + num25;
                                        double.Parse(num2.ToString("N6"));
                                        if ((num27 > double.Parse(num24.ToString("N6"))) && (double.Parse(num25.ToString("N6")) > double.Parse(num22.ToString("N6"))))
                                        {
                                            result.set_success(400);
                                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num24));
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                }
                            }
                            num11 = CallBLL.cz_wt_sxlwsl_six_bll.SetWT(Convert.ToInt32(str5), Convert.ToInt32(str4), double.Parse(num10.ToString("N6")));
                            base.CheckZKChildWT(str4);
                            base.sxlws_number_log(oldModel, oldWT, double.Parse(num10.ToString("N6")), str5, str3, true);
                        }
                        if ((model.get_u_type().Trim().Equals("zj") && !num11.Equals(0)) && ((str4.Equals("92566") || str4.Equals("92567")) || (str4.Equals("92568") || str4.Equals("92636"))))
                        {
                            DataRow[] wtDataRow = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(str4).Select(string.Format(" odds_id={0} ", str4));
                            cz_odds_six _six3 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                            Dictionary<string, object> dictionary5 = new Dictionary<string, object>();
                            if (str6.Equals("A"))
                            {
                                _six3.get_a_diff();
                            }
                            if (str6.Equals("B"))
                            {
                                _six3.get_b_diff();
                            }
                            if (str6.Equals("C"))
                            {
                                _six3.get_c_diff();
                            }
                            dictionary5.Add(str4.ToString(), this.GetWT_LXLWSL("lxltype", _six3.get_current_odds(), _six3.get_max_odds(), _six3.get_min_odds(), Convert.ToInt32(base.get_YearLianID()), wtDataRow));
                            dictionary.Add("play_odds", dictionary5);
                        }
                        result.set_data(dictionary);
                        result.set_success(200);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if ((str5 == "0") && (str5 != Convert.ToInt32(base.get_YearLianID()).ToString()))
                    {
                        num54 = num29 - num36;
                        num29 = double.Parse(num54.ToString());
                        if (num29 < num32)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num32));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if ((Convert.ToDouble(str8) - num30) < (1.0 - num32))
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num30 + (1.0 - num32)));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (num29 > num31)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num31));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    else if (str5 == Convert.ToInt32(base.get_YearLianID()).ToString())
                    {
                        num29 = double.Parse((num29 - num37).ToString());
                        if (num29 < num35)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num35));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if ((Convert.ToDouble(str8) - num33) < (1.0 - num35))
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num33 + (1.0 - num35)));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (num29 > num34)
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num34));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    else
                    {
                        if (num29 > num30)
                        {
                            str8 = num30.ToString();
                            num29 = num30;
                        }
                        if (Math.Abs((double) (Convert.ToDouble(str8) - num30)) > (num30 - 1.0))
                        {
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    int num38 = 0;
                    if (str5 == "0")
                    {
                        Dictionary<int, double> dictionary6 = null;
                        if (wTs != null)
                        {
                            dictionary6 = new Dictionary<int, double>();
                            foreach (DataRow row2 in wTs.Rows)
                            {
                                double.Parse(row2["wt_value"].ToString());
                                double num39 = num30 - Math.Abs(double.Parse(row2["wt_value"].ToString()));
                                decimal num40 = 0M;
                                if (double.Parse(str8) > num39)
                                {
                                    num40 = decimal.Parse(str8.ToString()) - decimal.Parse(num39.ToString());
                                }
                                num56 = -num40;
                                dictionary6.Add(int.Parse(row2["number"].ToString()), double.Parse(num56.ToString()));
                            }
                        }
                        string str14 = num29 + "," + num33;
                        if ((_six2 != null) && (double.Parse(str14.Split(new char[] { ',' })[0]) > double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0])))
                        {
                            string str15 = _six2.get_current_odds().Split(new char[] { ',' })[0];
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str15));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        num38 = CallBLL.cz_odds_six_bll.UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), str14, dictionary6);
                        CallBLL.cz_odds_six_bll.UpdateCurrentOddsLXLWSLClear(Convert.ToInt32(str4), str14);
                        Dictionary<int, double> dictionary7 = new Dictionary<int, double>();
                        if (_six2 != null)
                        {
                            for (int k = 0; k < table.Rows.Count; k++)
                            {
                                if (!table.Rows[k]["number"].ToString().Equals(base.get_YearLianID()))
                                {
                                    double num42 = double.Parse(table.Rows[k]["wt_value"].ToString());
                                    int num43 = int.Parse(table.Rows[k]["number"].ToString());
                                    double num44 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]) + num42;
                                    double num45 = 0.0;
                                    if (wTs != null)
                                    {
                                        DataRow[] rowArray4 = wTs.Select(string.Format(" number={0} ", num43));
                                        if (rowArray4.Length > 0)
                                        {
                                            num45 = double.Parse(rowArray4[0]["wt_value"].ToString());
                                        }
                                    }
                                    double num46 = double.Parse(double.Parse(str14.Split(new char[] { ',' })[0]).ToString("N6")) + num45;
                                    if ((num46 > double.Parse(num44.ToString("N6"))) && (double.Parse(num45.ToString("N6")) > double.Parse(num42.ToString("N6"))))
                                    {
                                        double num47 = num44 - double.Parse(str14.Split(new char[] { ',' })[0]);
                                        dictionary7.Add(num43, double.Parse(num47.ToString("N6").ToString()));
                                    }
                                }
                            }
                            if (dictionary7.Count > 0)
                            {
                                base.IsChildSystem();
                                CallBLL.cz_odds_six_bll.Child_UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), dictionary7);
                            }
                        }
                        base.CheckZKChildWT(str4);
                        base.sxlws_group_log(oldModel, oldModel.get_current_odds(), str14, str3, true);
                    }
                    else if (str5.Equals(Convert.ToInt32(base.get_YearLianID()).ToString()))
                    {
                        Dictionary<int, double> dictionary8 = null;
                        string str16 = num30 + "," + num29;
                        if ((_six2 != null) && (double.Parse(str16.Split(new char[] { ',' })[1]) > double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[1])))
                        {
                            string str17 = _six2.get_current_odds().Split(new char[] { ',' })[1];
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str17));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        num38 = CallBLL.cz_odds_six_bll.UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), str16, dictionary8);
                        base.CheckZKChildWT(str4);
                        base.sxlws_group_log(oldModel, oldModel.get_current_odds(), str16, str3, true);
                    }
                    else
                    {
                        double num48 = num29 - num30;
                        new Dictionary<int, double>();
                        if (_six2 != null)
                        {
                            for (int m = 0; m < table.Rows.Count; m++)
                            {
                                if (!table.Rows[m]["number"].ToString().Equals(base.get_YearLianID()))
                                {
                                    double num50 = double.Parse(table.Rows[m]["wt_value"].ToString());
                                    int num51 = int.Parse(table.Rows[m]["number"].ToString());
                                    double num52 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]) + num50;
                                    if (wTs != null)
                                    {
                                        DataRow[] rowArray5 = wTs.Select(string.Format(" number={0} ", num51));
                                        if (rowArray5.Length > 0)
                                        {
                                            double.Parse(rowArray5[0]["wt_value"].ToString());
                                        }
                                    }
                                    if (double.Parse(double.Parse(str8).ToString("N6")) > double.Parse(num52.ToString("N6")))
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num52));
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                            }
                        }
                        num38 = CallBLL.cz_wt_sxlwsl_six_bll.SetWT(Convert.ToInt32(str5), Convert.ToInt32(str4), double.Parse(num48.ToString("N6")));
                        base.CheckZKChildWT(str4);
                        base.sxlws_number_log(oldModel, num28, double.Parse(num48.ToString("N6")), str5, str3, true);
                    }
                    if ((model.get_u_type().Trim().Equals("zj") && !num38.Equals(0)) && ((str4.Equals("92566") || str4.Equals("92567")) || (str4.Equals("92568") || str4.Equals("92636"))))
                    {
                        DataRow[] rowArray6 = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(str4).Select(string.Format(" odds_id={0} ", str4));
                        cz_odds_six _six4 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (str6.Equals("A"))
                        {
                            _six4.get_a_diff();
                        }
                        if (str6.Equals("B"))
                        {
                            _six4.get_b_diff();
                        }
                        if (str6.Equals("C"))
                        {
                            _six4.get_c_diff();
                        }
                        Dictionary<string, object> dictionary9 = new Dictionary<string, object>();
                        dictionary9.Add(str4.ToString(), this.GetWT_LXLWSL("lxltype", _six4.get_current_odds(), _six4.get_max_odds(), _six4.get_min_odds(), Convert.ToInt32(base.get_YearLianID()), rowArray6));
                        dictionary.Add("play_odds", dictionary9);
                    }
                    result.set_data(dictionary);
                    result.set_success(200);
                    strResult = JsonHandle.ObjectToJson(result);
                }
            }
        }

        public void operate_adds_LXYZ(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                string playid = "91030";
                string str6 = LSRequest.qq("number");
                string str7 = LSRequest.qq("oddsindex");
                if (string.IsNullOrEmpty(str7))
                {
                    str7 = "0";
                }
                if (!string.IsNullOrEmpty(str6) && ((int.Parse(str6) < 1) || (int.Parse(str6) > 12)))
                {
                    context.Response.End();
                }
                LSRequest.qq("phaseid");
                string str8 = LSRequest.qq("pk");
                string str9 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                if (string.IsNullOrEmpty(str8))
                {
                    str8 = "A";
                }
                else
                {
                    str8 = str8.ToUpper();
                }
                if ((!str8.Equals("A") && !str8.Equals("B")) && !str8.Equals("C"))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    Dictionary<string, object> dictionary = new Dictionary<string, object>();
                    dictionary.Add("type", "operate_adds");
                    result.set_data(dictionary);
                    if (string.IsNullOrEmpty(str4))
                    {
                        result.set_success(400);
                        result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        string[] strArray10;
                        double num24;
                        double num25;
                        double num26;
                        double num27;
                        double num28;
                        double num29;
                        double num30;
                        double num31;
                        string[] strArray13;
                        string str21;
                        double num64;
                        decimal num65;
                        cz_odds_six oldModel = null;
                        cz_odds_six _six2 = null;
                        if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                        {
                            oldModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                            if (oldModel == null)
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (base.IsChildSync())
                            {
                                _six2 = CallBLL.cz_odds_six_bll.ZK_GetModel(Convert.ToInt32(str4), base.IsChildSystem().get_conn());
                            }
                        }
                        DataTable wTs = null;
                        if (((str21 = playid) != null) && (str21 == "91030"))
                        {
                            wTs = CallBLL.cz_wt_6xyz_six_bll.GetWTs();
                        }
                        if ((!str3.Equals("1") && !str3.Equals("2")) || !string.IsNullOrEmpty(str6))
                        {
                            if (!str3.Equals("3") || !string.IsNullOrEmpty(str6))
                            {
                                if ((!str3.Equals("1") && !str3.Equals("2")) || string.IsNullOrEmpty(str6))
                                {
                                    if (str3.Equals("3") && !string.IsNullOrEmpty(str6))
                                    {
                                        DataTable wT = null;
                                        DataTable table5 = null;
                                        cz_admin_subsystem _subsystem3 = null;
                                        if (base.IsChildSync())
                                        {
                                            _subsystem3 = base.IsChildSystem();
                                        }
                                        if (((str21 = playid) != null) && (str21 == "91030"))
                                        {
                                            wT = CallBLL.cz_wt_6xyz_six_bll.GetWT(Convert.ToInt32(str6));
                                            if (base.IsChildSync())
                                            {
                                                table5 = CallBLL.cz_wt_6xyz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem3.get_conn());
                                            }
                                        }
                                        double num55 = Convert.ToDouble(wT.Rows[0]["wt_value"]);
                                        string[] strArray23 = oldModel.get_current_odds().Split(new char[] { ',' });
                                        string[] strArray24 = oldModel.get_max_odds().Split(new char[] { ',' });
                                        string[] strArray25 = oldModel.get_min_odds().Split(new char[] { ',' });
                                        double num56 = Convert.ToDouble(strArray23[0]);
                                        double num57 = (strArray23.Length > 1) ? Convert.ToDouble(strArray23[1]) : Convert.ToDouble(strArray23[0]);
                                        double num58 = Convert.ToDouble(strArray24[0]);
                                        double num59 = (strArray24.Length > 1) ? Convert.ToDouble(strArray24[1]) : Convert.ToDouble(strArray24[0]);
                                        Convert.ToDouble(strArray25[0]);
                                        if (strArray25.Length <= 1)
                                        {
                                            Convert.ToDouble(strArray25[0]);
                                        }
                                        else
                                        {
                                            Convert.ToDouble(strArray25[1]);
                                        }
                                        double num60 = 0.0;
                                        double num61 = 0.0;
                                        string[] strArray26 = null;
                                        str21 = str8;
                                        if (str21 != null)
                                        {
                                            if (!(str21 == "A"))
                                            {
                                                if (str21 == "B")
                                                {
                                                    strArray26 = oldModel.get_b_diff().Split(new char[] { ',' });
                                                }
                                                else if (str21 == "C")
                                                {
                                                    strArray26 = oldModel.get_c_diff().Split(new char[] { ',' });
                                                }
                                            }
                                            else
                                            {
                                                strArray26 = oldModel.get_a_diff().Split(new char[] { ',' });
                                            }
                                        }
                                        num60 = double.Parse(strArray26[0]);
                                        if (strArray26.Length > 1)
                                        {
                                            num61 = double.Parse(strArray26[1]);
                                        }
                                        string str17 = "";
                                        if (str7.Equals("0"))
                                        {
                                            num64 = double.Parse(s) - num60;
                                            s = num64.ToString();
                                            if (Convert.ToDouble(s) > num58)
                                            {
                                                s = num56.ToString();
                                            }
                                            if (Convert.ToDouble(s) > num56)
                                            {
                                                s = num56.ToString();
                                            }
                                            if (Math.Abs((double) (Convert.ToDouble(s) - num56)) > (num56 - 1.0))
                                            {
                                                result.set_success(400);
                                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            num64 = Convert.ToDouble(s) - num56;
                                            str17 = num64.ToString();
                                        }
                                        if (str7.Equals("1"))
                                        {
                                            num64 = double.Parse(s) - num61;
                                            s = num64.ToString();
                                            if (Convert.ToDouble(s) > num59)
                                            {
                                                s = num57.ToString();
                                            }
                                            if (Convert.ToDouble(s) > num57)
                                            {
                                                s = num57.ToString();
                                            }
                                            if (Math.Abs((double) (Convert.ToDouble(s) - num57)) > (num57 - 1.0))
                                            {
                                                result.set_success(400);
                                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            num64 = Convert.ToDouble(s) - num57;
                                            str17 = num64.ToString();
                                        }
                                        if (base.IsChildSync())
                                        {
                                            double num62 = 0.0;
                                            if (table5 != null)
                                            {
                                                num62 = Convert.ToDouble(table5.Rows[0]["wt_value"]);
                                            }
                                            string str18 = _six2.get_current_odds();
                                            if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                            {
                                                num64 = double.Parse(str18.Split(new char[] { ',' })[0]) + num62;
                                                string str19 = num64.ToString("N6");
                                                num64 = double.Parse(str18.Split(new char[] { ',' })[1]) + num62;
                                                string str20 = num64.ToString("N6");
                                                str18 = double.Parse(str19) + "," + double.Parse(str20);
                                            }
                                            else
                                            {
                                                num64 = double.Parse(str18) + num62;
                                                str18 = double.Parse(num64.ToString("N6")).ToString();
                                            }
                                            if (double.Parse(Convert.ToDouble(str17).ToString("N6")) > num62)
                                            {
                                                result.set_success(400);
                                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str18));
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                        }
                                        int num63 = 0;
                                        if (((str21 = playid) != null) && (str21 == "91030"))
                                        {
                                            num63 = CallBLL.cz_wt_6xyz_six_bll.SetWT(Convert.ToInt32(str6), Convert.ToDouble(str17));
                                        }
                                        base.CheckZKChildWT(str4);
                                        base.lxyz_number_log(oldModel, num55, Convert.ToDouble(str17), str6, str3);
                                        if ((model.get_u_type().Trim().Equals("zj") && !num63.Equals(0)) && playid.Equals("91030"))
                                        {
                                            dictionary.Add("wtnumbervalue", this.GetWT_LXYZ(str8, playid));
                                        }
                                        result.set_data(dictionary);
                                        result.set_success(200);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                    return;
                                }
                                DataTable table2 = null;
                                DataTable table3 = null;
                                cz_admin_subsystem _subsystem2 = null;
                                if (base.IsChildSync())
                                {
                                    _subsystem2 = base.IsChildSystem();
                                }
                                if (((str21 = playid) != null) && (str21 == "91030"))
                                {
                                    table2 = CallBLL.cz_wt_6xyz_six_bll.GetWT(Convert.ToInt32(str6));
                                    if (base.IsChildSync())
                                    {
                                        table3 = CallBLL.cz_wt_6xyz_six_bll.ZK_GetWT(Convert.ToInt32(str6), _subsystem2.get_conn());
                                    }
                                }
                                double oldWT = Convert.ToDouble(table2.Rows[0]["wt_value"]);
                                double num46 = 0.0;
                                double num47 = 0.0;
                                double num48 = 0.0;
                                double num49 = 0.0;
                                double num50 = 0.0;
                                double num51 = 0.0;
                                string[] strArray18 = null;
                                str21 = str8;
                                if (str21 != null)
                                {
                                    if (!(str21 == "A"))
                                    {
                                        if (str21 == "B")
                                        {
                                            strArray18 = oldModel.get_b_diff().Split(new char[] { ',' });
                                        }
                                        else if (str21 == "C")
                                        {
                                            strArray18 = oldModel.get_c_diff().Split(new char[] { ',' });
                                        }
                                    }
                                    else
                                    {
                                        strArray18 = oldModel.get_a_diff().Split(new char[] { ',' });
                                    }
                                }
                                double.Parse(strArray18[0]);
                                if (strArray18.Length > 1)
                                {
                                    double.Parse(strArray18[1]);
                                }
                                string[] strArray19 = oldModel.get_current_odds().Split(new char[] { ',' });
                                string[] strArray20 = strArray19;
                                string[] strArray21 = oldModel.get_max_odds().Split(new char[] { ',' });
                                string[] strArray22 = oldModel.get_min_odds().Split(new char[] { ',' });
                                num46 = Convert.ToDouble(strArray19[0]);
                                num47 = Convert.ToDouble(strArray20[0]);
                                num48 = Convert.ToDouble(strArray21[0]);
                                Convert.ToDouble(strArray22[0]);
                                if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                {
                                    num49 = Convert.ToDouble(strArray19[1]);
                                    num50 = Convert.ToDouble(strArray20[1]);
                                    num51 = Convert.ToDouble(strArray21[1]);
                                    Convert.ToDouble(strArray22[1]);
                                }
                                if (string.IsNullOrEmpty(str9))
                                {
                                    str9 = "0.01";
                                }
                                double num52 = 0.0;
                                str21 = str3;
                                if (str21 != null)
                                {
                                    if (!(str21 == "1"))
                                    {
                                        if (str21 == "2")
                                        {
                                            num64 = num47 + (-Convert.ToDouble(str9) + oldWT);
                                            num47 = double.Parse(num64.ToString());
                                            if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                            {
                                                num64 = num50 + (-Convert.ToDouble(str9) + oldWT);
                                                num50 = double.Parse(num64.ToString());
                                            }
                                            num64 = oldWT + -Convert.ToDouble(str9);
                                            num52 = double.Parse(num64.ToString());
                                        }
                                    }
                                    else
                                    {
                                        num64 = num47 + (Convert.ToDouble(str9) + oldWT);
                                        num47 = double.Parse(num64.ToString());
                                        if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                        {
                                            num64 = num50 + (Convert.ToDouble(str9) + oldWT);
                                            num50 = double.Parse(num64.ToString());
                                        }
                                        num64 = oldWT + Convert.ToDouble(str9);
                                        num52 = double.Parse(num64.ToString());
                                    }
                                }
                                if (Math.Abs(Convert.ToDouble(num52)) > (num46 - 1.0))
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (num47 > num48)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num48));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (num47 > num46)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100033", "MessageHint"), num46));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                {
                                    if (Math.Abs(Convert.ToDouble(num52)) > (num49 - 1.0))
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (num50 > num51)
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num51));
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (num50 > num49)
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100033", "MessageHint"), num49));
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                if (base.IsChildSync())
                                {
                                    double num53 = 0.0;
                                    if (table3 != null)
                                    {
                                        num53 = Convert.ToDouble(table3.Rows[0]["wt_value"]);
                                    }
                                    string str14 = _six2.get_current_odds();
                                    if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                    {
                                        num64 = double.Parse(str14.Split(new char[] { ',' })[0]) + num53;
                                        string str15 = num64.ToString("N6");
                                        num64 = double.Parse(str14.Split(new char[] { ',' })[1]) + num53;
                                        string str16 = num64.ToString("N6");
                                        str14 = double.Parse(str15) + "," + double.Parse(str16);
                                    }
                                    else
                                    {
                                        num64 = double.Parse(str14) + num53;
                                        str14 = double.Parse(num64.ToString("N6")).ToString();
                                    }
                                    if (double.Parse(num52.ToString("N6")) > num53)
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str14));
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                int num54 = 0;
                                if (((str21 = playid) != null) && (str21 == "91030"))
                                {
                                    num54 = CallBLL.cz_wt_6xyz_six_bll.SetWT(Convert.ToInt32(str6), Convert.ToDouble(num52.ToString()));
                                }
                                base.CheckZKChildWT(str4);
                                base.lxyz_number_log(oldModel, oldWT, num52, str6, str3);
                                if ((model.get_u_type().Trim().Equals("zj") && !num54.Equals(0)) && playid.Equals("91030"))
                                {
                                    dictionary.Add("wtnumbervalue", this.GetWT_LXYZ(str8, playid));
                                }
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            strArray10 = oldModel.get_current_odds().Split(new char[] { ',' });
                            string[] strArray11 = oldModel.get_max_odds().Split(new char[] { ',' });
                            string[] strArray12 = oldModel.get_min_odds().Split(new char[] { ',' });
                            num24 = Convert.ToDouble(strArray10[0]);
                            num25 = (strArray10.Length > 1) ? Convert.ToDouble(strArray10[1]) : Convert.ToDouble(strArray10[0]);
                            num26 = Convert.ToDouble(strArray11[0]);
                            num27 = (strArray11.Length > 1) ? Convert.ToDouble(strArray11[1]) : Convert.ToDouble(strArray11[0]);
                            num28 = Convert.ToDouble(strArray12[0]);
                            num29 = (strArray12.Length > 1) ? Convert.ToDouble(strArray12[1]) : Convert.ToDouble(strArray12[0]);
                            num30 = 0.0;
                            num31 = 0.0;
                            strArray13 = null;
                            str21 = str8;
                            if (str21 != null)
                            {
                                if (!(str21 == "A"))
                                {
                                    if (str21 == "B")
                                    {
                                        strArray13 = oldModel.get_b_diff().Split(new char[] { ',' });
                                    }
                                    else if (str21 == "C")
                                    {
                                        strArray13 = oldModel.get_c_diff().Split(new char[] { ',' });
                                    }
                                }
                                else
                                {
                                    strArray13 = oldModel.get_a_diff().Split(new char[] { ',' });
                                }
                            }
                        }
                        else
                        {
                            double num = 0.0;
                            double num2 = 0.0;
                            double num3 = 0.0;
                            double num4 = 0.0;
                            double num5 = 0.0;
                            double num6 = 0.0;
                            double num7 = 0.0;
                            double num8 = 0.0;
                            double num9 = 0.0;
                            double num10 = 0.0;
                            string[] strArray = null;
                            str21 = str8;
                            if (str21 != null)
                            {
                                if (!(str21 == "A"))
                                {
                                    if (str21 == "B")
                                    {
                                        strArray = oldModel.get_b_diff().Split(new char[] { ',' });
                                    }
                                    else if (str21 == "C")
                                    {
                                        strArray = oldModel.get_c_diff().Split(new char[] { ',' });
                                    }
                                }
                                else
                                {
                                    strArray = oldModel.get_a_diff().Split(new char[] { ',' });
                                }
                            }
                            num9 = double.Parse(strArray[0]);
                            if (strArray.Length > 1)
                            {
                                num10 = double.Parse(strArray[1]);
                            }
                            string[] strArray2 = oldModel.get_current_odds().Split(new char[] { ',' });
                            string[] strArray3 = strArray2;
                            string[] strArray4 = oldModel.get_max_odds().Split(new char[] { ',' });
                            string[] strArray5 = oldModel.get_min_odds().Split(new char[] { ',' });
                            num = Convert.ToDouble(strArray2[0]);
                            num2 = Convert.ToDouble(strArray3[0]);
                            num3 = Convert.ToDouble(strArray4[0]);
                            num4 = Convert.ToDouble(strArray5[0]);
                            if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num5 = Convert.ToDouble(strArray2[1]);
                                num6 = Convert.ToDouble(strArray3[1]);
                                num7 = Convert.ToDouble(strArray4[1]);
                                num8 = Convert.ToDouble(strArray5[1]);
                            }
                            if (string.IsNullOrEmpty(str9))
                            {
                                str9 = "0.01";
                            }
                            num64 = num + num9;
                            num = double.Parse(num64.ToString());
                            if (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num64 = num5 + num10;
                                num5 = double.Parse(num64.ToString());
                            }
                            str21 = str3;
                            if (str21 != null)
                            {
                                if (!(str21 == "1"))
                                {
                                    if (str21 == "2")
                                    {
                                        if (str7.Equals("0"))
                                        {
                                            num64 = num2 + -Convert.ToDouble(str9);
                                            num2 = double.Parse(num64.ToString());
                                        }
                                        if (str7.Equals("1"))
                                        {
                                            num64 = num6 + -Convert.ToDouble(str9);
                                            num6 = double.Parse(num64.ToString());
                                        }
                                    }
                                }
                                else
                                {
                                    if (str7.Equals("0"))
                                    {
                                        num64 = num2 + Convert.ToDouble(str9);
                                        num2 = double.Parse(num64.ToString());
                                    }
                                    if (str7.Equals("1"))
                                    {
                                        num64 = num6 + Convert.ToDouble(str9);
                                        num6 = double.Parse(num64.ToString());
                                    }
                                }
                            }
                            if (num2 < num4)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num4));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if ((oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1) && (num6 < num8))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num8));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num2 > num3)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num3));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if ((oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1) && (num6 > num7))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num7));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            Dictionary<int, double> dictionary2 = null;
                            if (wTs != null)
                            {
                                dictionary2 = new Dictionary<int, double>();
                                foreach (DataRow row in wTs.Rows)
                                {
                                    double.Parse(row["wt_value"].ToString());
                                    double num11 = num - Math.Abs(double.Parse(row["wt_value"].ToString()));
                                    decimal num12 = 0M;
                                    if (double.Parse(num2.ToString("N6")) > num11)
                                    {
                                        num12 = decimal.Parse(num2.ToString()) - decimal.Parse(num11.ToString());
                                    }
                                    num65 = -num12;
                                    dictionary2.Add(int.Parse(row["number"].ToString()), double.Parse(num65.ToString()));
                                }
                            }
                            if (_six2 != null)
                            {
                                double num13 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]);
                                double num14 = 0.0;
                                if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                {
                                    num14 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[1]);
                                }
                                if (str7.Equals("0") && (num2 > num13))
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num13));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (str7.Equals("1") && (num6 > num14))
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num14));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                            }
                            if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsLM(Convert.ToInt32(str4), (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num2 + "," + num6) : num2.ToString(), str3, dictionary2) <= 0)
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            base.CheckZKChildWT(str4);
                            base.lm_group_log(oldModel, oldModel.get_current_odds(), (oldModel.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num2 + "," + num6) : num2.ToString(), str3);
                            cz_odds_six _six3 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                            string[] strArray6 = _six3.get_current_odds().Split(new char[] { ',' });
                            string[] strArray7 = _six3.get_max_odds().Split(new char[] { ',' });
                            string[] strArray8 = _six3.get_min_odds().Split(new char[] { ',' });
                            double num16 = Convert.ToDouble(strArray6[0]);
                            double num17 = (strArray6.Length > 1) ? Convert.ToDouble(strArray6[1]) : num16;
                            double num18 = Convert.ToDouble(strArray7[0]);
                            double num19 = (strArray7.Length > 1) ? Convert.ToDouble(strArray7[1]) : num18;
                            double num20 = Convert.ToDouble(strArray8[0]);
                            double num21 = (strArray8.Length > 1) ? Convert.ToDouble(strArray8[1]) : num20;
                            string[] strArray9 = null;
                            double num22 = 0.0;
                            double num23 = 0.0;
                            str21 = str8;
                            if (str21 != null)
                            {
                                if (!(str21 == "A"))
                                {
                                    if (str21 == "B")
                                    {
                                        strArray9 = _six3.get_b_diff().Split(new char[] { ',' });
                                    }
                                    else if (str21 == "C")
                                    {
                                        strArray9 = _six3.get_c_diff().Split(new char[] { ',' });
                                    }
                                }
                                else
                                {
                                    strArray9 = _six3.get_a_diff().Split(new char[] { ',' });
                                }
                            }
                            num22 = Convert.ToDouble(strArray9[0]);
                            num23 = (strArray9.Length > 1) ? Convert.ToDouble(strArray9[0]) : num22;
                            num64 = num16 + num22;
                            num16 = double.Parse(num64.ToString());
                            if (strArray6.Length > 1)
                            {
                                num64 = num17 + num23;
                                num17 = double.Parse(num64.ToString());
                            }
                            string str11 = _six3.get_is_open().ToString();
                            Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                            Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                            dictionary4.Add("pl", (strArray6.Length > 1) ? (num16 + "," + num17) : num16.ToString());
                            dictionary4.Add("maxpl", (strArray7.Length > 1) ? (num18 + "," + num19) : num18.ToString());
                            dictionary4.Add("minpl", (strArray8.Length > 1) ? (num20 + "," + num21) : num20.ToString());
                            dictionary4.Add("plx", new List<double>());
                            if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                            {
                                str11 = "0";
                            }
                            dictionary4.Add("is_open", str11);
                            dictionary3.Add(str4, new Dictionary<string, object>(dictionary4));
                            dictionary.Add("play_odds", dictionary3);
                            if (model.get_u_type().Trim().Equals("zj") && playid.Equals("91030"))
                            {
                                dictionary.Add("wtnumbervalue", this.GetWT_LXYZ(str8, playid));
                            }
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        num30 = double.Parse(strArray13[0]);
                        if (strArray13.Length > 1)
                        {
                            num31 = double.Parse(strArray13[1]);
                        }
                        string str12 = "";
                        if (str7.Equals("0"))
                        {
                            num64 = double.Parse(s) - num30;
                            s = num64.ToString();
                            if (Convert.ToDouble(s) < num28)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num28));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (Convert.ToDouble(s) > num26)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num26));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (strArray10.Length > 1)
                            {
                                str12 = s + "," + num25;
                            }
                            else
                            {
                                str12 = s;
                            }
                        }
                        if (str7.Equals("1"))
                        {
                            num64 = double.Parse(s) - num31;
                            s = num64.ToString();
                            if (Convert.ToDouble(s) < num29)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num29));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (Convert.ToDouble(s) > num27)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num27));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (strArray10.Length > 1)
                            {
                                str12 = num24 + "," + s;
                            }
                        }
                        Dictionary<int, double> dictionary5 = null;
                        if (wTs != null)
                        {
                            dictionary5 = new Dictionary<int, double>();
                            foreach (DataRow row2 in wTs.Rows)
                            {
                                double.Parse(row2["wt_value"].ToString());
                                double num32 = num24 - Math.Abs(double.Parse(row2["wt_value"].ToString()));
                                decimal num33 = 0M;
                                if (double.Parse(s) > num32)
                                {
                                    num33 = decimal.Parse(s.ToString()) - decimal.Parse(num32.ToString());
                                }
                                num65 = -num33;
                                dictionary5.Add(int.Parse(row2["number"].ToString()), double.Parse(num65.ToString()));
                            }
                        }
                        if (_six2 != null)
                        {
                            double num34 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]);
                            double num35 = 0.0;
                            if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num35 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[1]);
                            }
                            if (str7.Equals("0") && (double.Parse(str12.Split(new char[] { ',' })[0]) > num34))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num34));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (str7.Equals("1") && (double.Parse(str12.Split(new char[] { ',' })[1]) > num35))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num35));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsLM(Convert.ToInt32(str4), str12, str3, dictionary5) <= 0)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            base.CheckZKChildWT(str4);
                            base.lm_group_log(oldModel, oldModel.get_current_odds(), str12, str3);
                            cz_odds_six _six5 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                            string[] strArray14 = _six5.get_current_odds().Split(new char[] { ',' });
                            string[] strArray15 = _six5.get_max_odds().Split(new char[] { ',' });
                            string[] strArray16 = _six5.get_min_odds().Split(new char[] { ',' });
                            double num37 = Convert.ToDouble(strArray14[0]);
                            double num38 = (strArray14.Length > 1) ? Convert.ToDouble(strArray14[1]) : num37;
                            double num39 = Convert.ToDouble(strArray15[0]);
                            double num40 = (strArray15.Length > 1) ? Convert.ToDouble(strArray15[1]) : num39;
                            double num41 = Convert.ToDouble(strArray16[0]);
                            double num42 = (strArray16.Length > 1) ? Convert.ToDouble(strArray16[1]) : num41;
                            string[] strArray17 = null;
                            double num43 = 0.0;
                            double num44 = 0.0;
                            str21 = str8;
                            if (str21 != null)
                            {
                                if (!(str21 == "A"))
                                {
                                    if (str21 == "B")
                                    {
                                        strArray17 = _six5.get_b_diff().Split(new char[] { ',' });
                                    }
                                    else if (str21 == "C")
                                    {
                                        strArray17 = _six5.get_c_diff().Split(new char[] { ',' });
                                    }
                                }
                                else
                                {
                                    strArray17 = _six5.get_a_diff().Split(new char[] { ',' });
                                }
                            }
                            num43 = Convert.ToDouble(strArray17[0]);
                            num44 = (strArray17.Length > 1) ? Convert.ToDouble(strArray17[0]) : num43;
                            num64 = num37 + num43;
                            num37 = double.Parse(num64.ToString());
                            if (strArray14.Length > 1)
                            {
                                num38 = double.Parse((num38 + num44).ToString());
                            }
                            string str13 = _six5.get_is_open().ToString();
                            Dictionary<string, object> dictionary6 = new Dictionary<string, object>();
                            Dictionary<string, object> dictionary7 = new Dictionary<string, object>();
                            dictionary7.Add("pl", (strArray14.Length > 1) ? (num37 + "," + num38) : num37.ToString());
                            dictionary7.Add("maxpl", (strArray15.Length > 1) ? (num39 + "," + num40) : num39.ToString());
                            dictionary7.Add("minpl", (strArray16.Length > 1) ? (num41 + "," + num42) : num41.ToString());
                            dictionary7.Add("plx", new List<double>());
                            if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                            {
                                str13 = "0";
                            }
                            dictionary7.Add("is_open", str13);
                            dictionary6.Add(str4, new Dictionary<string, object>(dictionary7));
                            dictionary.Add("play_odds", dictionary6);
                            if (model.get_u_type().Trim().Equals("zj") && playid.Equals("91030"))
                            {
                                dictionary.Add("wtnumbervalue", this.GetWT_LXYZ(str8, playid));
                            }
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                    }
                }
            }
        }

        public void operate_adds_LXYZ_wt(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_six_op_odds().Equals(1))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("fgs") || !model.get_six_op_odds().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str17;
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                string playid = "";
                if (((str17 = str4) != null) && (str17 == "92565"))
                {
                    playid = "91030";
                }
                LSRequest.qq("number");
                string str6 = LSRequest.qq("oddsindex");
                if (string.IsNullOrEmpty(str6))
                {
                    str6 = "0";
                }
                LSRequest.qq("phaseid");
                string str7 = LSRequest.qq("pk");
                string str8 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                if (string.IsNullOrEmpty(str7))
                {
                    str7 = "A";
                }
                else
                {
                    str7 = str7.ToUpper();
                }
                if ((!str7.Equals("A") && !str7.Equals("B")) && !str7.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    double num60;
                    int num61;
                    cz_odds_six _six = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                    {
                        _six = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (_six == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    DataTable minWTValue = null;
                    if (((str17 = playid) != null) && (str17 == "91030"))
                    {
                        minWTValue = CallBLL.cz_wt_6xyz_six_bll.GetMinWTValue();
                    }
                    double.Parse(minWTValue.Rows[0]["wt_value"].ToString());
                    string str10 = minWTValue.Rows[0]["number"].ToString();
                    if (int.Parse(str10) < 10)
                    {
                        str10 = "0" + str10;
                    }
                    if (!str3.Equals("1") && !str3.Equals("2"))
                    {
                        if (str3.Equals("3"))
                        {
                            double num30 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[0]);
                            double num31 = 0.0;
                            if (_six.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num31 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[1]);
                            }
                            double num32 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[0]);
                            double num33 = 0.0;
                            if (_six.get_max_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num33 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[1]);
                            }
                            double num34 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[0]);
                            double num35 = 0.0;
                            if (_six.get_min_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num35 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[1]);
                            }
                            string str14 = "0";
                            if (str7.Equals("A"))
                            {
                                str14 = _six.get_a_diff();
                            }
                            else if (str7.Equals("B"))
                            {
                                str14 = _six.get_b_diff();
                            }
                            else if (str7.Equals("C"))
                            {
                                str14 = _six.get_c_diff();
                            }
                            double num36 = double.Parse(str14.Split(new char[] { ',' })[0]);
                            double num37 = 0.0;
                            if (str14.Split(new char[] { ',' }).Length > 1)
                            {
                                num37 = double.Parse(str14.Split(new char[] { ',' })[1]);
                            }
                            double num38 = 0.0;
                            double num39 = 0.0;
                            base.GetOperate_SIX(str4, ref num38, ref num39);
                            double num40 = num30;
                            double num41 = num31;
                            double num42 = num34;
                            double num43 = num35;
                            num60 = num30 + num38;
                            double num44 = double.Parse(num60.ToString());
                            num60 = num31 + num39;
                            double num45 = double.Parse(num60.ToString());
                            num60 = num30 + num36;
                            double num46 = double.Parse(num60.ToString());
                            num60 = num31 + num37;
                            double num47 = double.Parse(num60.ToString());
                            num60 = (num40 - num42) + 1.0;
                            double num48 = double.Parse(num60.ToString());
                            num60 = (num41 - num43) + 1.0;
                            double num49 = double.Parse(num60.ToString());
                            num60 = double.Parse(s) - num36;
                            double num50 = double.Parse(num60.ToString());
                            num60 = double.Parse(s) - num37;
                            double num51 = double.Parse(num60.ToString());
                            decimal num52 = 0M;
                            if (str6.Equals("0"))
                            {
                                if (Convert.ToDouble(num50) < num42)
                                {
                                    result.set_success(400);
                                    num60 = num42 + num36;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num50) > num40)
                                {
                                    result.set_success(400);
                                    num60 = num40 + num36;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num50) < num48)
                                {
                                    result.set_success(400);
                                    num60 = num48 + num36;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                decimal num62 = decimal.Parse(num50.ToString()) - decimal.Parse(num40.ToString());
                                num52 = decimal.Parse(num62.ToString());
                            }
                            else
                            {
                                if (Convert.ToDouble(num51) < num43)
                                {
                                    result.set_success(400);
                                    num60 = num43 + num37;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num51) > num41)
                                {
                                    result.set_success(400);
                                    num60 = num41 + num37;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num51) < num49)
                                {
                                    result.set_success(400);
                                    num60 = num49 + num37;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                num52 = decimal.Parse((decimal.Parse(num51.ToString()) - decimal.Parse(num41.ToString())).ToString());
                            }
                            DataTable oddsWTbyFGS = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                            num61 = 100;
                            base.Add_FgsOddsWT_Lock(num61.ToString(), str, str4);
                            int num53 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOddsLM(Convert.ToInt32(str4), num52, str3, str, str6);
                            num61 = 100;
                            base.Del_FgsOddsWT_Lock(num61.ToString(), str, str4);
                            if (num53 > 0)
                            {
                                base.fgs_opt_six_log(oddsWTbyFGS, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                num38 = 0.0;
                                num39 = 0.0;
                                CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                FileCacheHelper.UpdateFGSWTFile(100);
                                base.GetOperate_SIX(str4, ref num38, ref num39);
                                cz_odds_six _six4 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                                double num54 = Convert.ToDouble(_six4.get_current_odds().Split(new char[] { ',' })[0]);
                                double num55 = 0.0;
                                if (_six4.get_current_odds().Split(new char[] { ',' }).Length > 1)
                                {
                                    num55 = Convert.ToDouble(_six4.get_current_odds().Split(new char[] { ',' })[1]);
                                }
                                Convert.ToDouble(_six4.get_max_odds().Split(new char[] { ',' })[0]);
                                if (_six4.get_max_odds().Split(new char[] { ',' }).Length > 1)
                                {
                                    Convert.ToDouble(_six4.get_max_odds().Split(new char[] { ',' })[1]);
                                }
                                double num56 = Convert.ToDouble(_six4.get_min_odds().Split(new char[] { ',' })[0]);
                                double num57 = 0.0;
                                if (_six4.get_min_odds().Split(new char[] { ',' }).Length > 1)
                                {
                                    num57 = Convert.ToDouble(_six4.get_min_odds().Split(new char[] { ',' })[1]);
                                }
                                string str15 = "0";
                                double num58 = 0.0;
                                double num59 = 0.0;
                                if (str7.Equals("A"))
                                {
                                    str15 = _six4.get_a_diff();
                                }
                                else if (str7.Equals("B"))
                                {
                                    str15 = _six4.get_b_diff();
                                }
                                else if (str7.Equals("C"))
                                {
                                    str15 = _six4.get_c_diff();
                                }
                                num58 = double.Parse(str15.Split(new char[] { ',' })[0]);
                                if (str15.Split(new char[] { ',' }).Length > 1)
                                {
                                    num59 = double.Parse(str15.Split(new char[] { ',' })[1]);
                                }
                                num60 = (num54 + num58) + num38;
                                num44 = double.Parse(num60.ToString());
                                num60 = (num55 + num59) + num39;
                                num45 = double.Parse(num60.ToString());
                                num60 = num54 + num58;
                                num46 = double.Parse(num60.ToString());
                                num60 = num55 + num59;
                                num47 = double.Parse(num60.ToString());
                                num60 = ((num54 - num56) + num58) + 1.0;
                                num48 = double.Parse(num60.ToString());
                                num60 = ((num55 - num57) + num59) + 1.0;
                                num49 = double.Parse(num60.ToString());
                                string str16 = _six4.get_is_open().ToString();
                                Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                                Dictionary<string, object> dictionary5 = new Dictionary<string, object>();
                                dictionary5.Add("pl", (_six4.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num44.ToString() + "," + num45.ToString()) : num44.ToString());
                                dictionary5.Add("maxpl", (_six4.get_max_odds().Split(new char[] { ',' }).Length > 1) ? (num46.ToString() + "," + num47.ToString()) : num46.ToString());
                                dictionary5.Add("minpl", (_six4.get_min_odds().Split(new char[] { ',' }).Length > 1) ? (num48.ToString() + "," + num49.ToString()) : num48.ToString());
                                dictionary5.Add("plx", new List<double>());
                                if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                                {
                                    str16 = "0";
                                }
                                dictionary5.Add("is_open", str16);
                                dictionary4.Add(str4, new Dictionary<string, object>(dictionary5));
                                dictionary.Add("play_odds", dictionary4);
                                if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && playid.Equals("91030"))
                                {
                                    dictionary.Add("wtnumbervalue", this.GetWT_LXYZ_wt(model, context, str7, playid));
                                }
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                        }
                    }
                    else
                    {
                        double num = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[0]);
                        double num2 = 0.0;
                        if (_six.get_current_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num2 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[1]);
                        }
                        double num3 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[0]);
                        double num4 = 0.0;
                        if (_six.get_max_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num4 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[1]);
                        }
                        double num5 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[0]);
                        double num6 = 0.0;
                        if (_six.get_min_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num6 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[1]);
                        }
                        string str11 = "0";
                        if (str7.Equals("A"))
                        {
                            str11 = _six.get_a_diff();
                        }
                        else if (str7.Equals("B"))
                        {
                            str11 = _six.get_b_diff();
                        }
                        else if (str7.Equals("C"))
                        {
                            str11 = _six.get_c_diff();
                        }
                        double num7 = double.Parse(str11.Split(new char[] { ',' })[0]);
                        double num8 = 0.0;
                        if (str11.Split(new char[] { ',' }).Length > 1)
                        {
                            num8 = double.Parse(str11.Split(new char[] { ',' })[1]);
                        }
                        double num9 = 0.0;
                        double num10 = 0.0;
                        base.GetOperate_SIX(str4, ref num9, ref num10);
                        double num11 = num;
                        double num12 = num2;
                        double num13 = num5;
                        double num14 = num6;
                        num60 = num + num9;
                        double num15 = double.Parse(num60.ToString());
                        num60 = num2 + num10;
                        double num16 = double.Parse(num60.ToString());
                        num60 = num + num7;
                        double num17 = double.Parse(num60.ToString());
                        num60 = num2 + num8;
                        double num18 = double.Parse(num60.ToString());
                        num60 = (num11 - num13) + 1.0;
                        double num19 = double.Parse(num60.ToString());
                        num60 = (num12 - num14) + 1.0;
                        double num20 = double.Parse(num60.ToString());
                        double num21 = 0.0;
                        double num22 = 0.0;
                        str17 = str3;
                        if (str17 != null)
                        {
                            if (!(str17 == "1"))
                            {
                                if (str17 == "2")
                                {
                                    num60 = num15 + -Convert.ToDouble(str8);
                                    num21 = double.Parse(num60.ToString());
                                    num60 = num16 + -Convert.ToDouble(str8);
                                    num22 = double.Parse(num60.ToString());
                                }
                            }
                            else
                            {
                                num60 = num15 + Convert.ToDouble(str8);
                                num21 = double.Parse(num60.ToString());
                                num60 = num16 + Convert.ToDouble(str8);
                                num22 = double.Parse(num60.ToString());
                            }
                        }
                        if (str6.Equals("0"))
                        {
                            if (!str3.Equals("1") && (num21 < num13))
                            {
                                result.set_success(400);
                                num60 = num13 + num7;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (!str3.Equals("2") && (num21 > num11))
                            {
                                result.set_success(400);
                                num60 = num11 + num7;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num21 < num19)
                            {
                                result.set_success(400);
                                num60 = num19 + num7;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        else
                        {
                            if (!str3.Equals("1") && (num22 < num14))
                            {
                                result.set_success(400);
                                num60 = num14 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (!str3.Equals("2") && (num22 > num12))
                            {
                                result.set_success(400);
                                num60 = num12 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num22 < num20)
                            {
                                result.set_success(400);
                                num60 = num20 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num60.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        DataTable table2 = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                        num61 = 100;
                        base.Add_FgsOddsWT_Lock(num61.ToString(), str, str4);
                        int num23 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOddsLM(Convert.ToInt32(str4), str3.Equals("1") ? Convert.ToDecimal(str8) : -Convert.ToDecimal(str8), str3, str, str6);
                        base.Del_FgsOddsWT_Lock(100.ToString(), str, str4);
                        if (num23 > 0)
                        {
                            base.fgs_opt_six_log(table2, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                            num9 = 0.0;
                            num10 = 0.0;
                            CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                            FileCacheHelper.UpdateFGSWTFile(100);
                            base.GetOperate_SIX(str4, ref num9, ref num10);
                            cz_odds_six _six2 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                            double num24 = Convert.ToDouble(_six2.get_current_odds().Split(new char[] { ',' })[0]);
                            double num25 = 0.0;
                            if (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num25 = Convert.ToDouble(_six2.get_current_odds().Split(new char[] { ',' })[1]);
                            }
                            Convert.ToDouble(_six2.get_max_odds().Split(new char[] { ',' })[0]);
                            if (_six2.get_max_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                Convert.ToDouble(_six2.get_max_odds().Split(new char[] { ',' })[1]);
                            }
                            double num26 = Convert.ToDouble(_six2.get_min_odds().Split(new char[] { ',' })[0]);
                            double num27 = 0.0;
                            if (_six2.get_min_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num27 = Convert.ToDouble(_six2.get_min_odds().Split(new char[] { ',' })[1]);
                            }
                            string str12 = "0";
                            double num28 = 0.0;
                            double num29 = 0.0;
                            if (str7.Equals("A"))
                            {
                                str12 = _six2.get_a_diff();
                            }
                            else if (str7.Equals("B"))
                            {
                                str12 = _six2.get_b_diff();
                            }
                            else if (str7.Equals("C"))
                            {
                                str12 = _six2.get_c_diff();
                            }
                            num28 = double.Parse(str12.Split(new char[] { ',' })[0]);
                            if (str12.Split(new char[] { ',' }).Length > 1)
                            {
                                num29 = double.Parse(str12.Split(new char[] { ',' })[1]);
                            }
                            num60 = (num24 + num28) + num9;
                            num15 = double.Parse(num60.ToString());
                            num60 = (num25 + num29) + num10;
                            num16 = double.Parse(num60.ToString());
                            num60 = num24 + num28;
                            num17 = double.Parse(num60.ToString());
                            num60 = num25 + num29;
                            num18 = double.Parse(num60.ToString());
                            num60 = ((num24 - num26) + num28) + 1.0;
                            num19 = double.Parse(num60.ToString());
                            num20 = double.Parse((((num25 - num27) + num29) + 1.0).ToString());
                            string str13 = _six2.get_is_open().ToString();
                            Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                            Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                            dictionary3.Add("pl", (_six2.get_current_odds().Split(new char[] { ',' }).Length > 1) ? (num15.ToString() + "," + num16.ToString()) : num15.ToString());
                            dictionary3.Add("maxpl", (_six2.get_max_odds().Split(new char[] { ',' }).Length > 1) ? (num17.ToString() + "," + num18.ToString()) : num17.ToString());
                            dictionary3.Add("minpl", (_six2.get_min_odds().Split(new char[] { ',' }).Length > 1) ? (num19.ToString() + "," + num20.ToString()) : num19.ToString());
                            dictionary3.Add("plx", new List<double>());
                            if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                            {
                                str13 = "0";
                            }
                            dictionary3.Add("is_open", str13);
                            dictionary2.Add(str4, new Dictionary<string, object>(dictionary3));
                            dictionary.Add("play_odds", dictionary2);
                            if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && playid.Equals("91030"))
                            {
                                dictionary.Add("wtnumbervalue", this.GetWT_LXYZ_wt(model, context, str7, playid));
                            }
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                    }
                }
            }
        }

        public void operate_adds_SXL_wt(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_six_op_odds().Equals(1))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("fgs") || !model.get_six_op_odds().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                string str5 = LSRequest.qq("oddsindex");
                if (string.IsNullOrEmpty(str5))
                {
                    str5 = "0";
                }
                LSRequest.qq("phaseid");
                string str6 = LSRequest.qq("pk");
                string str7 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                if (string.IsNullOrEmpty(str6))
                {
                    str6 = "A";
                }
                else
                {
                    str6 = str6.ToUpper();
                }
                if ((!str6.Equals("A") && !str6.Equals("B")) && !str6.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    double num43;
                    int num44;
                    cz_odds_six _six = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || str3.Equals("3"))
                    {
                        _six = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (_six == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    DataTable minWTValue = CallBLL.cz_wt_sxlwsl_six_bll.GetMinWTValue(int.Parse(str4));
                    double num = double.Parse(minWTValue.Rows[0]["wt_value"].ToString());
                    string str9 = minWTValue.Rows[0]["number"].ToString();
                    if (int.Parse(str9) < 10)
                    {
                        str9 = "0" + str9;
                    }
                    if (!str3.Equals("1") && !str3.Equals("2"))
                    {
                        if (str3.Equals("3"))
                        {
                            double num23 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[0]);
                            double num24 = 0.0;
                            if (_six.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num24 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[1]);
                            }
                            double num25 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[0]);
                            double num26 = 0.0;
                            if (_six.get_max_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num26 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[1]);
                            }
                            double num27 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[0]);
                            double num28 = 0.0;
                            if (_six.get_min_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num28 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[1]);
                            }
                            string str12 = "0";
                            if (str6.Equals("A"))
                            {
                                str12 = _six.get_a_diff();
                            }
                            else if (str6.Equals("B"))
                            {
                                str12 = _six.get_b_diff();
                            }
                            else if (str6.Equals("C"))
                            {
                                str12 = _six.get_c_diff();
                            }
                            double num29 = double.Parse(str12.Split(new char[] { ',' })[0]);
                            double num30 = 0.0;
                            if (str12.Split(new char[] { ',' }).Length > 1)
                            {
                                num30 = double.Parse(str12.Split(new char[] { ',' })[1]);
                            }
                            double num31 = 0.0;
                            double num32 = 0.0;
                            base.GetOperate_SIX(str4, ref num31, ref num32);
                            double num33 = num23;
                            double num34 = num24;
                            double num35 = num27;
                            double num36 = num28;
                            num43 = num23 + num31;
                            double.Parse(num43.ToString());
                            num43 = num24 + num32;
                            double.Parse(num43.ToString());
                            num43 = num23 + num29;
                            double.Parse(num43.ToString());
                            num43 = num24 + num30;
                            double.Parse(num43.ToString());
                            num43 = (num33 - num35) + 1.0;
                            double num37 = double.Parse(num43.ToString());
                            num43 = (num34 - num36) + 1.0;
                            double num38 = double.Parse(num43.ToString());
                            num43 = double.Parse(s) - num29;
                            double num39 = double.Parse(num43.ToString());
                            num43 = double.Parse(s) - num30;
                            double num40 = double.Parse(num43.ToString());
                            decimal num41 = 0M;
                            if (!str5.Equals(Convert.ToInt32(base.get_YearLianID()).ToString()))
                            {
                                if (Convert.ToDouble(num39) < num35)
                                {
                                    result.set_success(400);
                                    num43 = num35 + num29;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num39) > num33)
                                {
                                    result.set_success(400);
                                    num43 = num33 + num29;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num39) < num37)
                                {
                                    result.set_success(400);
                                    num43 = num37 + num29;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                num43 = num39 + num;
                                if (double.Parse(num43.ToString()) < num37)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100063", "MessageHint"), str9, num37));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                decimal num45 = decimal.Parse(num39.ToString()) - decimal.Parse(num33.ToString());
                                num41 = decimal.Parse(num45.ToString());
                            }
                            else
                            {
                                if (Convert.ToDouble(num40) < num36)
                                {
                                    result.set_success(400);
                                    num43 = num36 + num30;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num40) > num34)
                                {
                                    result.set_success(400);
                                    num43 = num34 + num30;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num40) < num38)
                                {
                                    result.set_success(400);
                                    num43 = num38 + num30;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                num43 = num40 + num;
                                if (double.Parse(num43.ToString()) < num38)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100063", "MessageHint"), str9, num38));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                num41 = decimal.Parse((decimal.Parse(num40.ToString()) - decimal.Parse(num34.ToString())).ToString());
                            }
                            string str13 = "0";
                            if (str5.Equals(Convert.ToInt32(base.get_YearLianID()).ToString()))
                            {
                                str13 = "1";
                            }
                            DataTable oddsWTbyFGS = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                            num44 = 100;
                            base.Add_FgsOddsWT_Lock(num44.ToString(), str, str4);
                            int num42 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOddsSXLWSL(Convert.ToInt32(str4), num41, str3, str, str13);
                            num44 = 100;
                            base.Del_FgsOddsWT_Lock(num44.ToString(), str, str4);
                            if (num42 > 0)
                            {
                                base.fgs_opt_six_log(oddsWTbyFGS, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                FileCacheHelper.UpdateFGSWTFile(100);
                                if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && ((str4.Equals("92566") || str4.Equals("92567")) || (str4.Equals("92568") || str4.Equals("92636"))))
                                {
                                    DataRow[] wtDataRow = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(str4).Select(string.Format(" odds_id={0} ", str4));
                                    Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                                    Dictionary<string, string> dictionary5 = this.GetWT_LXLWSL_wt(model, context, str4, "lxltype", Convert.ToInt32(base.get_YearLianID()), wtDataRow, str6);
                                    dictionary4.Add(str4.ToString(), dictionary5);
                                    dictionary.Add("play_odds", dictionary4);
                                }
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                        }
                    }
                    else
                    {
                        double num2 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[0]);
                        double num3 = 0.0;
                        if (_six.get_current_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num3 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[1]);
                        }
                        double num4 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[0]);
                        double num5 = 0.0;
                        if (_six.get_max_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num5 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[1]);
                        }
                        double num6 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[0]);
                        double num7 = 0.0;
                        if (_six.get_min_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num7 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[1]);
                        }
                        string str10 = "0";
                        if (str6.Equals("A"))
                        {
                            str10 = _six.get_a_diff();
                        }
                        else if (str6.Equals("B"))
                        {
                            str10 = _six.get_b_diff();
                        }
                        else if (str6.Equals("C"))
                        {
                            str10 = _six.get_c_diff();
                        }
                        double num8 = double.Parse(str10.Split(new char[] { ',' })[0]);
                        double num9 = 0.0;
                        if (str10.Split(new char[] { ',' }).Length > 1)
                        {
                            num9 = double.Parse(str10.Split(new char[] { ',' })[1]);
                        }
                        double num10 = 0.0;
                        double num11 = 0.0;
                        base.GetOperate_SIX(str4, ref num10, ref num11);
                        double num12 = num2;
                        double num13 = num3;
                        double num14 = num6;
                        double num15 = num7;
                        num43 = num2 + num10;
                        double num16 = double.Parse(num43.ToString());
                        num43 = num3 + num11;
                        double num17 = double.Parse(num43.ToString());
                        num43 = num2 + num8;
                        double.Parse(num43.ToString());
                        num43 = num3 + num9;
                        double.Parse(num43.ToString());
                        num43 = (num12 - num14) + 1.0;
                        double num18 = double.Parse(num43.ToString());
                        num43 = (num13 - num15) + 1.0;
                        double num19 = double.Parse(num43.ToString());
                        double num20 = 0.0;
                        double num21 = 0.0;
                        string str14 = str3;
                        if (str14 != null)
                        {
                            if (!(str14 == "1"))
                            {
                                if (str14 == "2")
                                {
                                    if (str5.Equals(Convert.ToInt32(base.get_YearLianID()).ToString()))
                                    {
                                        num43 = num17 + -Convert.ToDouble(str7);
                                        num21 = double.Parse(num43.ToString());
                                    }
                                    else
                                    {
                                        num43 = num16 + -Convert.ToDouble(str7);
                                        num20 = double.Parse(num43.ToString());
                                    }
                                }
                            }
                            else if (str5.Equals(Convert.ToInt32(base.get_YearLianID()).ToString()))
                            {
                                num43 = num17 + Convert.ToDouble(str7);
                                num21 = double.Parse(num43.ToString());
                            }
                            else
                            {
                                num43 = num16 + Convert.ToDouble(str7);
                                num20 = double.Parse(num43.ToString());
                            }
                        }
                        if (!str5.Equals(Convert.ToInt32(base.get_YearLianID()).ToString()))
                        {
                            if (!str3.Equals("1") && (num20 < num14))
                            {
                                result.set_success(400);
                                num43 = num14 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (!str3.Equals("2") && (num20 > num12))
                            {
                                result.set_success(400);
                                num43 = num12 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num20 < num18)
                            {
                                result.set_success(400);
                                num43 = num18 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            num43 = num20 + num;
                            if (double.Parse(num43.ToString()) < num18)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100063", "MessageHint"), str9, num18));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        else
                        {
                            if (!str3.Equals("1") && (num21 < num15))
                            {
                                result.set_success(400);
                                num43 = num15 + num9;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (!str3.Equals("2") && (num21 > num13))
                            {
                                result.set_success(400);
                                num43 = num13 + num9;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num21 < num19)
                            {
                                result.set_success(400);
                                num43 = num19 + num9;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            num43 = num21 + num;
                            if (double.Parse(num43.ToString()) < num19)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100063", "MessageHint"), str9, num19));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        string str11 = "0";
                        if (str5.Equals(Convert.ToInt32(base.get_YearLianID()).ToString()))
                        {
                            str11 = "1";
                        }
                        DataTable table2 = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                        num44 = 100;
                        base.Add_FgsOddsWT_Lock(num44.ToString(), str, str4);
                        int num22 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOddsSXLWSL(Convert.ToInt32(str4), str3.Equals("1") ? Convert.ToDecimal(str7) : -Convert.ToDecimal(str7), str3, str, str11);
                        base.Del_FgsOddsWT_Lock(100.ToString(), str, str4);
                        if (num22 > 0)
                        {
                            base.fgs_opt_six_log(table2, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                            CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                            FileCacheHelper.UpdateFGSWTFile(100);
                            if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && ((str4.Equals("92566") || str4.Equals("92567")) || (str4.Equals("92568") || str4.Equals("92636"))))
                            {
                                DataRow[] rowArray = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(str4).Select(string.Format(" odds_id={0} ", str4));
                                Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                                Dictionary<string, string> dictionary3 = this.GetWT_LXLWSL_wt(model, context, str4, "lxltype", Convert.ToInt32(base.get_YearLianID()), rowArray, str6);
                                dictionary2.Add(str4.ToString(), dictionary3);
                                dictionary.Add("play_odds", dictionary2);
                            }
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                    }
                }
            }
        }

        public void operate_adds_TMAB(HttpContext context, ref string strResult)
        {
            cz_odds_six _six8;
            double num31;
            double num35;
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            string str3 = LSRequest.qq("optype");
            string str4 = LSRequest.qq("oddsid");
            LSRequest.qq("phaseid");
            string str5 = LSRequest.qq("pk");
            string str6 = LSRequest.qq("wtvalue");
            string s = LSRequest.qq("inputvalue");
            LSRequest.qq("isopen");
            string str8 = LSRequest.qq("playpage");
            if (string.IsNullOrEmpty(str5))
            {
                str5 = "A";
            }
            else
            {
                str5 = str5.ToUpper();
            }
            if ((!str5.Equals("A") && !str5.Equals("B")) && !str5.Equals("C"))
            {
                context.Response.End();
            }
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "operate_adds");
            result.set_data(dictionary);
            if (string.IsNullOrEmpty(str4))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            cz_odds_six oldModel = null;
            cz_odds_six _six2 = null;
            cz_odds_six _six3 = null;
            cz_odds_six _six4 = null;
            int num = 0;
            int num2 = 0;
            if ((Convert.ToInt32(str4) >= 0x16761) && (Convert.ToInt32(str4) <= 0x16791))
            {
                num = Convert.ToInt32(str4);
                num2 = Convert.ToInt32(str4) + 0x31;
            }
            else if ((Convert.ToInt32(str4) >= 0x16792) && (Convert.ToInt32(str4) <= 0x167c2))
            {
                num = Convert.ToInt32(str4) - 0x31;
                num2 = Convert.ToInt32(str4);
            }
            else
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
            {
                oldModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(num));
                _six2 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(num2));
                if ((oldModel == null) || (_six2 == null))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                    return;
                }
                if (base.IsChildSync())
                {
                    cz_admin_subsystem _subsystem = base.IsChildSystem();
                    _six3 = CallBLL.cz_odds_six_bll.ZK_GetModel(Convert.ToInt32(num), _subsystem.get_conn());
                    _six4 = CallBLL.cz_odds_six_bll.ZK_GetModel(Convert.ToInt32(num2), _subsystem.get_conn());
                }
            }
            cz_system_set_six _six5 = CallBLL.cz_system_set_six_bll.GetModel(1);
            if (!str3.Equals("1") && !str3.Equals("2"))
            {
                if (!str3.Equals("3"))
                {
                    return;
                }
                double num19 = Convert.ToDouble(_six5.get_ev_0());
                double num20 = Convert.ToDouble(oldModel.get_current_odds());
                double num21 = Convert.ToDouble(oldModel.get_max_odds());
                double num22 = Convert.ToDouble(oldModel.get_min_odds());
                double num23 = 0.0;
                if (str5.Equals("A"))
                {
                    num23 = Convert.ToDouble(oldModel.get_a_diff());
                }
                else if (str5.Equals("B"))
                {
                    num23 = Convert.ToDouble(oldModel.get_b_diff());
                }
                else if (str5.Equals("C"))
                {
                    num23 = Convert.ToDouble(oldModel.get_c_diff());
                }
                double num24 = Convert.ToDouble(_six2.get_current_odds());
                double num25 = Convert.ToDouble(_six2.get_max_odds());
                double num26 = Convert.ToDouble(_six2.get_min_odds());
                double num27 = 0.0;
                if (str5.Equals("A"))
                {
                    num27 = Convert.ToDouble(_six2.get_a_diff());
                }
                else if (str5.Equals("B"))
                {
                    num27 = Convert.ToDouble(_six2.get_b_diff());
                }
                else if (str5.Equals("C"))
                {
                    num27 = Convert.ToDouble(_six2.get_c_diff());
                }
                num35 = double.Parse(s) - num23;
                double num28 = double.Parse(num35.ToString());
                num35 = double.Parse(s) - num27;
                double num29 = double.Parse(num35.ToString());
                if ((Convert.ToInt32(str4) >= 0x16761) && (Convert.ToInt32(str4) <= 0x16791))
                {
                    if (Convert.ToDouble(num28) < num22)
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num22));
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (Convert.ToDouble(num28) > num21)
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num21));
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    num35 = num29 + num19;
                    num29 = double.Parse(num35.ToString());
                    if (num29 < Convert.ToDouble(num26))
                    {
                        num29 = Convert.ToDouble(_six2.get_min_odds());
                    }
                    else if (num29 > Convert.ToDouble(num25))
                    {
                        num29 = Convert.ToDouble(_six2.get_max_odds());
                    }
                }
                else
                {
                    if (Convert.ToDouble(num29) < num26)
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num26));
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (Convert.ToDouble(num29) > num25)
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num25));
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    num35 = num28 - num19;
                    num28 = double.Parse(num35.ToString());
                    if (num28 < Convert.ToDouble(num22))
                    {
                        num28 = Convert.ToDouble(oldModel.get_min_odds());
                    }
                    else if (num28 > Convert.ToDouble(num21))
                    {
                        num28 = Convert.ToDouble(oldModel.get_max_odds());
                    }
                }
                if ((_six3 != null) || (_six4 != null))
                {
                    if (int.Parse(str4) <= 0x16791)
                    {
                        if (num28 > double.Parse(_six3.get_current_odds()))
                        {
                            string str12 = "";
                            str12 = _six3.get_current_odds();
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str12));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (num29 > double.Parse(_six4.get_current_odds()))
                        {
                            num29 = double.Parse(_six4.get_current_odds());
                        }
                    }
                    if ((int.Parse(str4) > 0x16791) && (int.Parse(str4) <= 0x167c2))
                    {
                        if (num29 > double.Parse(_six4.get_current_odds()))
                        {
                            string str13 = "";
                            str13 = _six4.get_current_odds();
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str13));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (num28 > double.Parse(_six3.get_current_odds()))
                        {
                            num28 = double.Parse(_six3.get_current_odds());
                        }
                    }
                }
                if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsTMAB(num, num2, num28, num29, str3) <= 0)
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                    return;
                }
                _six8 = null;
                if (str8.Equals("tmb"))
                {
                    _six8 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(num2));
                    try
                    {
                        base.tm_log(_six2, _six8, str3);
                        base.tm_log(oldModel, CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(num)), str3);
                        goto Label_0FB7;
                    }
                    catch
                    {
                        goto Label_0FB7;
                    }
                }
                _six8 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(num));
                try
                {
                    base.tm_log(oldModel, _six8, str3);
                    base.tm_log(_six2, CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(num2)), str3);
                }
                catch
                {
                }
            }
            else
            {
                double num3 = Convert.ToDouble(_six5.get_ev_0());
                double num4 = Convert.ToDouble(oldModel.get_current_odds());
                double num5 = num4;
                double num6 = Convert.ToDouble(oldModel.get_max_odds());
                double num7 = Convert.ToDouble(oldModel.get_min_odds());
                double num8 = Convert.ToDouble(_six2.get_current_odds());
                double num9 = num8;
                double num10 = Convert.ToDouble(_six2.get_max_odds());
                double num11 = Convert.ToDouble(_six2.get_min_odds());
                if (string.IsNullOrEmpty(str6))
                {
                    str6 = "0.01";
                }
                string str15 = str3;
                if (str15 != null)
                {
                    if (!(str15 == "1"))
                    {
                        if (str15 == "2")
                        {
                            num35 = num5 + -Convert.ToDouble(str6);
                            num5 = double.Parse(num35.ToString());
                            num35 = num9 + -Convert.ToDouble(str6);
                            num9 = double.Parse(num35.ToString());
                        }
                    }
                    else
                    {
                        num35 = num5 + Convert.ToDouble(str6);
                        num5 = double.Parse(num35.ToString());
                        num35 = num9 + Convert.ToDouble(str6);
                        num9 = double.Parse(num35.ToString());
                    }
                }
                double num12 = 0.0;
                double num13 = 0.0;
                if ((str8.Equals("tma") || str8.Equals("tmab")) || (str8.Equals("tmzx1") || str8.Equals("tmzx2")))
                {
                    if (num5 < num7)
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num7));
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (num5 > num6)
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num6));
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (str3.Equals("1"))
                    {
                        num12 = Convert.ToDouble(str6);
                        num13 = Convert.ToDouble(str6);
                    }
                    else
                    {
                        num12 = -Convert.ToDouble(str6);
                        num13 = -Convert.ToDouble(str6);
                    }
                    if (num9 < num11)
                    {
                        num13 = 0.0;
                    }
                    if (num9 > num10)
                    {
                        num13 = 0.0;
                    }
                }
                else if (str8.Equals("tmb"))
                {
                    if (num9 < num11)
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num11));
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (num9 > num10)
                    {
                        result.set_success(400);
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num10));
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (str3.Equals("1"))
                    {
                        num12 = Convert.ToDouble(str6);
                        num13 = Convert.ToDouble(str6);
                    }
                    else
                    {
                        num12 = -Convert.ToDouble(str6);
                        num13 = -Convert.ToDouble(str6);
                    }
                    if (num5 < num7)
                    {
                        num12 = 0.0;
                    }
                    if (num5 > num6)
                    {
                        num12 = 0.0;
                    }
                }
                if ((Convert.ToInt32(str4) >= 0x16761) && (Convert.ToInt32(str4) <= 0x16791))
                {
                    num35 = num4 + num12;
                    num12 = double.Parse(num35.ToString());
                    num35 = num12 + num3;
                    num13 = double.Parse(num35.ToString());
                }
                else if ((Convert.ToInt32(str4) >= 0x16792) && (Convert.ToInt32(str4) <= 0x167c2))
                {
                    num35 = num8 + num13;
                    num13 = double.Parse(num35.ToString());
                    num35 = num13 - num3;
                    num12 = double.Parse(num35.ToString());
                }
                if (num12 < num7)
                {
                    num12 = num7;
                }
                if (num12 > num6)
                {
                    num12 = num6;
                }
                if (num13 < num11)
                {
                    num13 = num11;
                }
                if (num13 > num10)
                {
                    num13 = num10;
                }
                if ((_six3 != null) || (_six4 != null))
                {
                    if (int.Parse(str4) <= 0x16791)
                    {
                        if (num12 > double.Parse(_six3.get_current_odds()))
                        {
                            string str9 = "";
                            str9 = _six3.get_current_odds();
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str9));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (num13 > double.Parse(_six4.get_current_odds()))
                        {
                            num13 = double.Parse(_six4.get_current_odds());
                        }
                    }
                    if ((int.Parse(str4) > 0x16791) && (int.Parse(str4) <= 0x167c2))
                    {
                        if (num13 > double.Parse(_six4.get_current_odds()))
                        {
                            string str10 = "";
                            str10 = _six4.get_current_odds();
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str10));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (num12 > double.Parse(_six3.get_current_odds()))
                        {
                            num12 = double.Parse(_six3.get_current_odds());
                        }
                    }
                }
                if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsTMAB(num, num2, num12, num13, str3) > 0)
                {
                    cz_odds_six newModel = null;
                    if (str8.Equals("tmb"))
                    {
                        newModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(num2));
                        try
                        {
                            base.tm_log(_six2, newModel, str3);
                            base.tm_log(oldModel, CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(num)), str3);
                        }
                        catch
                        {
                        }
                    }
                    else
                    {
                        newModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(num));
                        try
                        {
                            base.tm_log(oldModel, newModel, str3);
                            base.tm_log(_six2, CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(num2)), str3);
                        }
                        catch
                        {
                        }
                    }
                    double num15 = Convert.ToDouble(newModel.get_current_odds());
                    double num16 = Convert.ToDouble(newModel.get_max_odds());
                    double num17 = Convert.ToDouble(newModel.get_min_odds());
                    double num18 = 0.0;
                    if (str5.Equals("A"))
                    {
                        num18 = Convert.ToDouble(newModel.get_a_diff());
                    }
                    else if (str5.Equals("B"))
                    {
                        num18 = Convert.ToDouble(newModel.get_b_diff());
                    }
                    else if (str5.Equals("C"))
                    {
                        num18 = Convert.ToDouble(newModel.get_c_diff());
                    }
                    num15 = double.Parse((num15 + num18).ToString());
                    string str11 = newModel.get_is_open().ToString();
                    Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                    Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                    dictionary3.Add("pl", num15.ToString());
                    dictionary3.Add("maxpl", num16.ToString());
                    dictionary3.Add("minpl", num17.ToString());
                    dictionary3.Add("plx", new List<double>());
                    if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                    {
                        str11 = "0";
                    }
                    dictionary3.Add("is_open", str11);
                    dictionary2.Add(str4, new Dictionary<string, object>(dictionary3));
                    dictionary.Add("play_odds", dictionary2);
                    result.set_data(dictionary);
                    result.set_success(200);
                    strResult = JsonHandle.ObjectToJson(result);
                    return;
                }
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
        Label_0FB7:
            num31 = Convert.ToDouble(_six8.get_current_odds());
            double num32 = Convert.ToDouble(_six8.get_max_odds());
            double num33 = Convert.ToDouble(_six8.get_min_odds());
            double num34 = 0.0;
            if (str5.Equals("A"))
            {
                num34 = Convert.ToDouble(_six8.get_a_diff());
            }
            else if (str5.Equals("B"))
            {
                num34 = Convert.ToDouble(_six8.get_b_diff());
            }
            else if (str5.Equals("C"))
            {
                num34 = Convert.ToDouble(_six8.get_c_diff());
            }
            num31 = double.Parse((num31 + num34).ToString());
            string str14 = _six8.get_is_open().ToString();
            Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
            Dictionary<string, object> dictionary5 = new Dictionary<string, object>();
            dictionary5.Add("pl", num31);
            dictionary5.Add("maxpl", num32);
            dictionary5.Add("minpl", num33);
            dictionary5.Add("plx", new List<double>());
            if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
            {
                str14 = "0";
            }
            dictionary5.Add("is_open", str14);
            dictionary4.Add(str4, new Dictionary<string, object>(dictionary5));
            dictionary.Add("play_odds", dictionary4);
            result.set_data(dictionary);
            result.set_success(200);
            strResult = JsonHandle.ObjectToJson(result);
        }

        public void operate_adds_TMAB_wt(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_six_op_odds().Equals(1))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("fgs") || !model.get_six_op_odds().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                string str4 = LSRequest.qq("oddsid");
                LSRequest.qq("phaseid");
                string str5 = LSRequest.qq("pk");
                string str6 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                if (string.IsNullOrEmpty(str5))
                {
                    str5 = "A";
                }
                else
                {
                    str5 = str5.ToUpper();
                }
                if ((!str5.Equals("A") && !str5.Equals("B")) && !str5.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    double num31;
                    int num36;
                    cz_odds_six _six = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                    {
                        _six = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (_six == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    if (!str3.Equals("1") && !str3.Equals("2"))
                    {
                        if (str3.Equals("3"))
                        {
                            double num16 = double.Parse(_six.get_current_odds());
                            double num17 = Convert.ToDouble(_six.get_max_odds());
                            double num18 = Convert.ToDouble(_six.get_min_odds());
                            double num19 = 0.0;
                            if (str5.Equals("A"))
                            {
                                num19 = Convert.ToDouble(_six.get_a_diff());
                            }
                            else if (str5.Equals("B"))
                            {
                                num19 = Convert.ToDouble(_six.get_b_diff());
                            }
                            else if (str5.Equals("C"))
                            {
                                num19 = Convert.ToDouble(_six.get_c_diff());
                            }
                            base.GetFgsWTTable(100);
                            double wtvalue = 0.0;
                            base.GetOperate_SIX(str4, ref wtvalue);
                            double num21 = num16;
                            double num22 = num18;
                            num31 = num16 + wtvalue;
                            double num23 = double.Parse(num31.ToString());
                            num31 = num16 + num19;
                            double num24 = double.Parse(num31.ToString());
                            num31 = (num21 - num22) + 1.0;
                            double num25 = double.Parse(num31.ToString());
                            num31 = double.Parse(s) - num19;
                            s = num31.ToString();
                            if (Convert.ToDouble(s) < num22)
                            {
                                result.set_success(400);
                                num31 = num22 + num19;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else if (Convert.ToDouble(s) > num21)
                            {
                                result.set_success(400);
                                num31 = num21 + num19;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else if (Convert.ToDouble(s) < num25)
                            {
                                result.set_success(400);
                                num31 = num25 + num19;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                decimal num26 = decimal.Parse((decimal.Parse(s) - decimal.Parse(num21.ToString())).ToString());
                                DataTable oddsWTbyFGS = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                                num36 = 100;
                                base.Add_FgsOddsWT_Lock(num36.ToString(), str, str4);
                                int num27 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOddsTMAB(Convert.ToInt32(str4), num26, str3, str);
                                num36 = 100;
                                base.Del_FgsOddsWT_Lock(num36.ToString(), str, str4);
                                if (num27 > 0)
                                {
                                    wtvalue = 0.0;
                                    CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                    FileCacheHelper.UpdateFGSWTFile(100);
                                    base.GetOperate_SIX(str4, ref wtvalue);
                                    cz_odds_six _six4 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                                    base.fgs_opt_six_log(oddsWTbyFGS, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                    double num28 = Convert.ToDouble(_six4.get_current_odds());
                                    Convert.ToDouble(_six4.get_max_odds());
                                    double num29 = Convert.ToDouble(_six4.get_min_odds());
                                    double num30 = 0.0;
                                    if (str5.Equals("A"))
                                    {
                                        num30 = Convert.ToDouble(_six4.get_a_diff());
                                    }
                                    else if (str5.Equals("B"))
                                    {
                                        num30 = Convert.ToDouble(_six4.get_b_diff());
                                    }
                                    else if (str5.Equals("C"))
                                    {
                                        num30 = Convert.ToDouble(_six4.get_c_diff());
                                    }
                                    num31 = (num28 + num30) + wtvalue;
                                    num23 = double.Parse(num31.ToString());
                                    num31 = num28 + num30;
                                    num24 = double.Parse(num31.ToString());
                                    num31 = ((num28 - num29) + num30) + 1.0;
                                    num25 = double.Parse(num31.ToString());
                                    string str9 = _six4.get_is_open().ToString();
                                    Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                                    Dictionary<string, object> dictionary5 = new Dictionary<string, object>();
                                    dictionary5.Add("pl", num23.ToString());
                                    dictionary5.Add("maxpl", num24.ToString());
                                    dictionary5.Add("minpl", num25.ToString());
                                    dictionary5.Add("plx", new List<double>());
                                    if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                                    {
                                        str9 = "0";
                                    }
                                    dictionary5.Add("is_open", str9);
                                    dictionary4.Add(str4, new Dictionary<string, object>(dictionary5));
                                    dictionary.Add("play_odds", dictionary4);
                                    result.set_data(dictionary);
                                    result.set_success(200);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                else
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                            }
                        }
                    }
                    else
                    {
                        double num = double.Parse(_six.get_current_odds());
                        double num2 = Convert.ToDouble(_six.get_max_odds());
                        double num3 = Convert.ToDouble(_six.get_min_odds());
                        double num4 = 0.0;
                        if (str5.Equals("A"))
                        {
                            num4 = Convert.ToDouble(_six.get_a_diff());
                        }
                        else if (str5.Equals("B"))
                        {
                            num4 = Convert.ToDouble(_six.get_b_diff());
                        }
                        else if (str5.Equals("C"))
                        {
                            num4 = Convert.ToDouble(_six.get_c_diff());
                        }
                        base.GetFgsWTTable(100);
                        double num5 = 0.0;
                        base.GetOperate_SIX(str4, ref num5);
                        double num6 = num;
                        double num7 = num3;
                        num31 = num + num5;
                        double num8 = double.Parse(num31.ToString());
                        double num9 = double.Parse((num + num4).ToString());
                        double num10 = double.Parse(((num6 - num7) + 1.0).ToString());
                        double num11 = 0.0;
                        string str10 = str3;
                        if (str10 != null)
                        {
                            if (!(str10 == "1"))
                            {
                                if (str10 == "2")
                                {
                                    num11 = double.Parse((num8 + -Convert.ToDouble(str6)).ToString());
                                }
                            }
                            else
                            {
                                num11 = double.Parse((num8 + Convert.ToDouble(str6)).ToString());
                            }
                        }
                        if (!str3.Equals("1") && (num11 < num7))
                        {
                            result.set_success(400);
                            num31 = num7 + num4;
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else if (num11 > num6)
                        {
                            result.set_success(400);
                            num31 = num6 + num4;
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else if (num11 < num10)
                        {
                            result.set_success(400);
                            num31 = num10 + num4;
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            DataTable table = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                            num36 = 100;
                            base.Add_FgsOddsWT_Lock(num36.ToString(), str, str4);
                            int num12 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOddsTMAB(Convert.ToInt32(str4), str3.Equals("1") ? Convert.ToDecimal(str6) : -Convert.ToDecimal(str6), str3, str);
                            base.Del_FgsOddsWT_Lock(100.ToString(), str, str4);
                            if (num12 > 0)
                            {
                                num5 = 0.0;
                                CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                FileCacheHelper.UpdateFGSWTFile(100);
                                base.GetOperate_SIX(str4, ref num5);
                                base.fgs_opt_six_log(table, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                cz_odds_six _six2 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                                double num13 = Convert.ToDouble(_six2.get_current_odds());
                                Convert.ToDouble(_six2.get_max_odds());
                                double num14 = Convert.ToDouble(_six2.get_min_odds());
                                double num15 = 0.0;
                                if (str5.Equals("A"))
                                {
                                    num15 = Convert.ToDouble(_six2.get_a_diff());
                                }
                                else if (str5.Equals("B"))
                                {
                                    num15 = Convert.ToDouble(_six2.get_b_diff());
                                }
                                else if (str5.Equals("C"))
                                {
                                    num15 = Convert.ToDouble(_six2.get_c_diff());
                                }
                                num31 = (num13 + num15) + num5;
                                num8 = double.Parse(num31.ToString());
                                num31 = num13 + num15;
                                num9 = double.Parse(num31.ToString());
                                num10 = double.Parse((((num13 - num14) + num15) + 1.0).ToString());
                                string str8 = _six2.get_is_open().ToString();
                                Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                                Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                                dictionary3.Add("pl", num8.ToString());
                                dictionary3.Add("maxpl", num9.ToString());
                                dictionary3.Add("minpl", num10.ToString());
                                dictionary3.Add("plx", new List<double>());
                                if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                                {
                                    str8 = "0";
                                }
                                dictionary3.Add("is_open", str8);
                                dictionary2.Add(str4, new Dictionary<string, object>(dictionary3));
                                dictionary.Add("play_odds", dictionary2);
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                        }
                    }
                }
            }
        }

        public void operate_adds_WSL(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                LSRequest.qq("number");
                string str5 = LSRequest.qq("oddsindex");
                LSRequest.qq("phaseid");
                string str6 = LSRequest.qq("pk");
                string str7 = LSRequest.qq("wtvalue");
                string str8 = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                if (string.IsNullOrEmpty(str6))
                {
                    str6 = "A";
                }
                else
                {
                    str6 = str6.ToUpper();
                }
                if ((!str6.Equals("A") && !str6.Equals("B")) && !str6.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    double num28;
                    double num29;
                    double num30;
                    double num31;
                    double num32;
                    double num33;
                    double num34;
                    double num35;
                    double num36;
                    double num37;
                    string str19;
                    double num54;
                    decimal num55;
                    cz_odds_six oldModel = null;
                    cz_odds_six _six2 = null;
                    DataTable table = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                    {
                        oldModel = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (oldModel == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (base.IsChildSync())
                        {
                            cz_admin_subsystem _subsystem = base.IsChildSystem();
                            _six2 = CallBLL.cz_odds_six_bll.ZK_GetModel(Convert.ToInt32(str4), _subsystem.get_conn());
                            table = CallBLL.cz_odds_six_bll.ZK_SXLWSL_WT(Convert.ToInt32(str4), _subsystem.get_conn());
                        }
                    }
                    DataTable wTs = CallBLL.cz_wt_sxlwsl_six_bll.GetWTs(str4);
                    if (!str3.Equals("1") && !str3.Equals("2"))
                    {
                        if (!str3.Equals("3"))
                        {
                            return;
                        }
                        DataTable wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(Convert.ToInt32(str5), Convert.ToInt32(str4));
                        num28 = 0.0;
                        if ((wT != null) && (wT.Rows.Count > 0))
                        {
                            num28 = Convert.ToDouble(wT.Rows[0]["wt_value"].ToString());
                        }
                        num29 = 0.0;
                        num29 = Convert.ToDouble(str8);
                        num30 = 0.0;
                        num31 = 0.0;
                        num32 = 0.0;
                        num33 = 0.0;
                        num34 = 0.0;
                        num35 = 0.0;
                        num36 = 0.0;
                        num37 = 0.0;
                        string[] strArray5 = oldModel.get_current_odds().Split(new char[] { ',' });
                        string[] strArray6 = strArray5;
                        string[] strArray7 = oldModel.get_max_odds().Split(new char[] { ',' });
                        string[] strArray8 = oldModel.get_min_odds().Split(new char[] { ',' });
                        num30 = Convert.ToDouble(strArray5[0]);
                        Convert.ToDouble(strArray6[0]);
                        num31 = Convert.ToDouble(strArray7[0]);
                        num32 = Convert.ToDouble(strArray8[0]);
                        num33 = Convert.ToDouble(strArray5[1]);
                        Convert.ToDouble(strArray6[1]);
                        num34 = Convert.ToDouble(strArray7[1]);
                        num35 = Convert.ToDouble(strArray8[1]);
                        str19 = str6;
                        if (str19 != null)
                        {
                            if (!(str19 == "A"))
                            {
                                if (str19 == "B")
                                {
                                    num36 = Convert.ToInt32(oldModel.get_b_diff().Split(new char[] { ',' })[0]);
                                    if (oldModel.get_b_diff().Split(new char[] { ',' }).Length > 1)
                                    {
                                        num37 = Convert.ToInt32(oldModel.get_b_diff().Split(new char[] { ',' })[1]);
                                    }
                                }
                                else if (str19 == "C")
                                {
                                    num36 = Convert.ToInt32(oldModel.get_c_diff().Split(new char[] { ',' })[0]);
                                    if (oldModel.get_c_diff().Split(new char[] { ',' }).Length > 1)
                                    {
                                        num37 = Convert.ToInt32(oldModel.get_c_diff().Split(new char[] { ',' })[1]);
                                    }
                                }
                            }
                            else
                            {
                                num36 = Convert.ToInt32(oldModel.get_a_diff().Split(new char[] { ',' })[0]);
                                if (oldModel.get_a_diff().Split(new char[] { ',' }).Length > 1)
                                {
                                    num37 = Convert.ToInt32(oldModel.get_a_diff().Split(new char[] { ',' })[1]);
                                }
                            }
                        }
                    }
                    else
                    {
                        DataTable table3 = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(Convert.ToInt32(str5), Convert.ToInt32(str4));
                        double oldWT = 0.0;
                        if ((table3 != null) && (table3.Rows.Count > 0))
                        {
                            oldWT = Convert.ToDouble(table3.Rows[0]["wt_value"].ToString());
                        }
                        double num2 = 0.0;
                        double num3 = 0.0;
                        double num4 = 0.0;
                        double num5 = 0.0;
                        double num6 = 0.0;
                        double num7 = 0.0;
                        double num8 = 0.0;
                        double num9 = 0.0;
                        string[] strArray = oldModel.get_current_odds().Split(new char[] { ',' });
                        string[] strArray2 = strArray;
                        string[] strArray3 = oldModel.get_max_odds().Split(new char[] { ',' });
                        string[] strArray4 = oldModel.get_min_odds().Split(new char[] { ',' });
                        num2 = Convert.ToDouble(strArray[0]);
                        num3 = Convert.ToDouble(strArray2[0]);
                        num4 = Convert.ToDouble(strArray3[0]);
                        num5 = Convert.ToDouble(strArray4[0]);
                        num6 = Convert.ToDouble(strArray[1]);
                        num7 = Convert.ToDouble(strArray2[1]);
                        num8 = Convert.ToDouble(strArray3[1]);
                        num9 = Convert.ToDouble(strArray4[1]);
                        if (string.IsNullOrEmpty(str7))
                        {
                            str7 = "0.01";
                        }
                        str19 = str6;
                        if (str19 != null)
                        {
                            if (!(str19 == "A"))
                            {
                                if (str19 == "B")
                                {
                                    Convert.ToInt32(oldModel.get_b_diff().Split(new char[] { ',' })[0]);
                                    if (oldModel.get_b_diff().Split(new char[] { ',' }).Length > 1)
                                    {
                                        Convert.ToInt32(oldModel.get_b_diff().Split(new char[] { ',' })[1]);
                                    }
                                }
                                else if (str19 == "C")
                                {
                                    Convert.ToInt32(oldModel.get_c_diff().Split(new char[] { ',' })[0]);
                                    if (oldModel.get_c_diff().Split(new char[] { ',' }).Length > 1)
                                    {
                                        Convert.ToInt32(oldModel.get_c_diff().Split(new char[] { ',' })[1]);
                                    }
                                }
                            }
                            else
                            {
                                Convert.ToInt32(oldModel.get_a_diff().Split(new char[] { ',' })[0]);
                                if (oldModel.get_a_diff().Split(new char[] { ',' }).Length > 1)
                                {
                                    Convert.ToInt32(oldModel.get_a_diff().Split(new char[] { ',' })[1]);
                                }
                            }
                        }
                        double num10 = 0.0;
                        str19 = str3;
                        if (str19 != null)
                        {
                            if (!(str19 == "1"))
                            {
                                if (str19 == "2")
                                {
                                    num54 = num3 + (-Convert.ToDouble(str7) + oldWT);
                                    num3 = double.Parse(num54.ToString());
                                    num54 = num7 + (-Convert.ToDouble(str7) + oldWT);
                                    num7 = double.Parse(num54.ToString());
                                    num54 = oldWT + -Convert.ToDouble(str7);
                                    num10 = double.Parse(num54.ToString());
                                }
                            }
                            else
                            {
                                num54 = num3 + (Convert.ToDouble(str7) + oldWT);
                                num3 = double.Parse(num54.ToString());
                                num54 = num7 + (Convert.ToDouble(str7) + oldWT);
                                num7 = double.Parse(num54.ToString());
                                num54 = oldWT + Convert.ToDouble(str7);
                                num10 = double.Parse(num54.ToString());
                            }
                        }
                        switch (str5)
                        {
                            case "10":
                            {
                                if (num3 < num5)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num5));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (num10 < (1.0 - num5))
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num2 + (1.0 - num5)));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (num3 > num4)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num4));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                DataTable minWTValue = CallBLL.cz_wt_sxlwsl_six_bll.GetMinWTValue(int.Parse(str4));
                                double.Parse(minWTValue.Rows[0]["wt_value"].ToString());
                                string s = minWTValue.Rows[0]["number"].ToString();
                                if (int.Parse(s) < 10)
                                {
                                    s = "0" + s;
                                }
                                break;
                            }
                            case "0":
                                if (num7 < num9)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num9));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (num10 < (1.0 - num9))
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num6 + (1.0 - num9)));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (num7 > num8)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num8));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                break;

                            default:
                                if (Math.Abs(Convert.ToDouble(num10)) > (num2 - 1.0))
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (num3 > num4)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num4));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (num3 > num2)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100033", "MessageHint"), num2));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                break;
                        }
                        int num11 = 0;
                        if (str5 == "10")
                        {
                            Dictionary<int, double> dictionary2 = null;
                            if (wTs != null)
                            {
                                dictionary2 = new Dictionary<int, double>();
                                foreach (DataRow row in wTs.Rows)
                                {
                                    double.Parse(row["wt_value"].ToString());
                                    double num12 = num2 - Math.Abs(double.Parse(row["wt_value"].ToString()));
                                    decimal num13 = 0M;
                                    if (double.Parse(num3.ToString("N6")) > num12)
                                    {
                                        num13 = decimal.Parse(num3.ToString()) - decimal.Parse(num12.ToString());
                                    }
                                    num55 = -num13;
                                    dictionary2.Add(int.Parse(row["number"].ToString()), double.Parse(num55.ToString()));
                                }
                            }
                            string str10 = (num2 + num10) + "," + num6;
                            if ((_six2 != null) && (double.Parse(str10.Split(new char[] { ',' })[0]) > double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0])))
                            {
                                string str11 = _six2.get_current_odds().Split(new char[] { ',' })[0];
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str11));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            num11 = CallBLL.cz_odds_six_bll.UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), str10, dictionary2);
                            Dictionary<int, double> dictionary3 = new Dictionary<int, double>();
                            if (_six2 != null)
                            {
                                for (int i = 0; i < table.Rows.Count; i++)
                                {
                                    double num15 = double.Parse(table.Rows[i]["wt_value"].ToString());
                                    int num16 = int.Parse(table.Rows[i]["number"].ToString());
                                    double num17 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]) + num15;
                                    double num18 = 0.0;
                                    if (wTs != null)
                                    {
                                        DataRow[] rowArray = wTs.Select(string.Format(" number={0} ", num16));
                                        if (rowArray.Length > 0)
                                        {
                                            num18 = double.Parse(rowArray[0]["wt_value"].ToString());
                                            if (str3.Equals("1"))
                                            {
                                                num18 += double.Parse(str7);
                                            }
                                            if (str3.Equals("2"))
                                            {
                                                num18 += -double.Parse(str7);
                                            }
                                        }
                                    }
                                    double num19 = double.Parse(double.Parse(str10.Split(new char[] { ',' })[0]).ToString("N6")) + num18;
                                    if ((num19 > double.Parse(num17.ToString("N6"))) && (double.Parse(num18.ToString("N6")) > double.Parse(num15.ToString("N6"))))
                                    {
                                        double num20 = num17 - double.Parse(str10.Split(new char[] { ',' })[0]);
                                        dictionary3.Add(num16, double.Parse(num20.ToString("N6").ToString()));
                                    }
                                }
                                if (dictionary3.Count > 0)
                                {
                                    base.IsChildSystem();
                                    CallBLL.cz_odds_six_bll.Child_UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), dictionary3);
                                }
                            }
                            base.CheckZKChildWT(str4);
                            base.sxlws_group_log(oldModel, oldModel.get_current_odds(), str10, str3, false);
                        }
                        else if (str5.Equals("0"))
                        {
                            Dictionary<int, double> dictionary4 = null;
                            string str12 = num2 + "," + (num6 + num10);
                            if ((_six2 != null) && (double.Parse(str12.Split(new char[] { ',' })[1]) > double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[1])))
                            {
                                string str13 = _six2.get_current_odds().Split(new char[] { ',' })[1];
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str13));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            num11 = CallBLL.cz_odds_six_bll.UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), str12, dictionary4);
                            base.CheckZKChildWT(str4);
                            base.sxlws_group_log(oldModel, oldModel.get_current_odds(), str12, str3, false);
                        }
                        else
                        {
                            new Dictionary<int, double>();
                            if (_six2 != null)
                            {
                                for (int j = 0; j < table.Rows.Count; j++)
                                {
                                    double num22 = double.Parse(table.Rows[j]["wt_value"].ToString());
                                    int num23 = int.Parse(table.Rows[j]["number"].ToString());
                                    double num24 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]) + num22;
                                    double num25 = 0.0;
                                    double num26 = 0.0;
                                    if (wTs != null)
                                    {
                                        DataRow[] rowArray2 = wTs.Select(string.Format(" number={0} ", num23));
                                        if (rowArray2.Length > 0)
                                        {
                                            num25 = double.Parse(rowArray2[0]["wt_value"].ToString());
                                            num26 = double.Parse(rowArray2[0]["wt_value"].ToString());
                                            if (str3.Equals("1"))
                                            {
                                                num25 += double.Parse(str7);
                                            }
                                            if (str3.Equals("2"))
                                            {
                                                num25 += -double.Parse(str7);
                                            }
                                        }
                                    }
                                    double num27 = double.Parse(num2.ToString("N6")) + num25;
                                    double.Parse(num2.ToString("N6"));
                                    if ((num27 > double.Parse(num24.ToString("N6"))) && (double.Parse(num25.ToString("N6")) > double.Parse(num22.ToString("N6"))))
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num24));
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                            }
                            num11 = CallBLL.cz_wt_sxlwsl_six_bll.SetWT(Convert.ToInt32(str5), Convert.ToInt32(str4), double.Parse(num10.ToString("N6")));
                            base.CheckZKChildWT(str4);
                            base.sxlws_number_log(oldModel, oldWT, double.Parse(num10.ToString("N6")), str5, str3, false);
                        }
                        if ((model.get_u_type().Trim().Equals("zj") && !num11.Equals(0)) && ((str4.Equals("92569") || str4.Equals("92570")) || (str4.Equals("92571") || str4.Equals("92637"))))
                        {
                            DataRow[] wtDataRow = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(str4).Select(string.Format(" odds_id={0} ", str4));
                            cz_odds_six _six3 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                            Dictionary<string, object> dictionary5 = new Dictionary<string, object>();
                            if (str6.Equals("A"))
                            {
                                _six3.get_a_diff();
                            }
                            if (str6.Equals("B"))
                            {
                                _six3.get_b_diff();
                            }
                            if (str6.Equals("C"))
                            {
                                _six3.get_c_diff();
                            }
                            dictionary5.Add(str4.ToString(), this.GetWT_LXLWSL("wsltype", _six3.get_current_odds(), _six3.get_max_odds(), _six3.get_min_odds(), Convert.ToInt32(base.get_YearLianID()), wtDataRow));
                            dictionary.Add("play_odds", dictionary5);
                        }
                        result.set_data(dictionary);
                        result.set_success(200);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    switch (str5)
                    {
                        case "10":
                        {
                            num54 = num29 - num36;
                            num29 = double.Parse(num54.ToString());
                            if (num29 < num32)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num32));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if ((Convert.ToDouble(str8) - num30) < (1.0 - num32))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num30 + (1.0 - num32)));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num29 > num31)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100033", "MessageHint"), num31));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            DataTable table6 = CallBLL.cz_wt_sxlwsl_six_bll.GetMinWTValue(int.Parse(str4));
                            double.Parse(table6.Rows[0]["wt_value"].ToString());
                            string str14 = table6.Rows[0]["number"].ToString();
                            if (int.Parse(str14) < 10)
                            {
                                str14 = "0" + str14;
                            }
                            break;
                        }
                        case "0":
                            num54 = num29 - num37;
                            num29 = double.Parse(num54.ToString());
                            if (num29 < num35)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num35));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if ((Convert.ToDouble(str8) - num33) < (1.0 - num35))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), num33 + (1.0 - num35)));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num29 > num34)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100010", "MessageHint"), num34));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            break;

                        default:
                            num29 = double.Parse((num29 - num37).ToString());
                            if (Math.Abs((double) (Convert.ToDouble(str8) - num30)) > (num30 - 1.0))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100012", "MessageHint"), 1));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num29 > num30)
                            {
                                str8 = num30.ToString();
                                num29 = num30;
                            }
                            break;
                    }
                    int num38 = 0;
                    if (str5 == "10")
                    {
                        Dictionary<int, double> dictionary6 = null;
                        if (wTs != null)
                        {
                            dictionary6 = new Dictionary<int, double>();
                            foreach (DataRow row2 in wTs.Rows)
                            {
                                double.Parse(row2["wt_value"].ToString());
                                double num39 = num30 - Math.Abs(double.Parse(row2["wt_value"].ToString()));
                                decimal num40 = 0M;
                                if (double.Parse(str8) > num39)
                                {
                                    num40 = decimal.Parse(str8.ToString()) - decimal.Parse(num39.ToString());
                                }
                                num55 = -num40;
                                dictionary6.Add(int.Parse(row2["number"].ToString()), double.Parse(num55.ToString()));
                            }
                        }
                        string str15 = num29 + "," + num33;
                        if ((_six2 != null) && (double.Parse(str15.Split(new char[] { ',' })[0]) > double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0])))
                        {
                            string str16 = _six2.get_current_odds().Split(new char[] { ',' })[0];
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str16));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        num38 = CallBLL.cz_odds_six_bll.UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), str15, dictionary6);
                        Dictionary<int, double> dictionary7 = new Dictionary<int, double>();
                        if (_six2 != null)
                        {
                            for (int k = 0; k < table.Rows.Count; k++)
                            {
                                double num42 = double.Parse(table.Rows[k]["wt_value"].ToString());
                                int num43 = int.Parse(table.Rows[k]["number"].ToString());
                                double num44 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]) + num42;
                                double num45 = 0.0;
                                if (wTs != null)
                                {
                                    DataRow[] rowArray4 = wTs.Select(string.Format(" number={0} ", num43));
                                    if (rowArray4.Length > 0)
                                    {
                                        num45 = double.Parse(rowArray4[0]["wt_value"].ToString());
                                    }
                                }
                                double num46 = double.Parse(double.Parse(str15.Split(new char[] { ',' })[0]).ToString("N6")) + num45;
                                if ((num46 > double.Parse(num44.ToString("N6"))) && (double.Parse(num45.ToString("N6")) > double.Parse(num42.ToString("N6"))))
                                {
                                    double num47 = num44 - double.Parse(str15.Split(new char[] { ',' })[0]);
                                    dictionary7.Add(num43, double.Parse(num47.ToString("N6").ToString()));
                                }
                            }
                            if (dictionary7.Count > 0)
                            {
                                base.IsChildSystem();
                                CallBLL.cz_odds_six_bll.Child_UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), dictionary7);
                            }
                        }
                        CallBLL.cz_odds_six_bll.UpdateCurrentOddsLXLWSLClear(Convert.ToInt32(str4), str15);
                        base.CheckZKChildWT(str4);
                        base.sxlws_group_log(oldModel, oldModel.get_current_odds(), str15, str3, false);
                    }
                    else if (str5.Equals("0"))
                    {
                        Dictionary<int, double> dictionary8 = null;
                        string str17 = num30 + "," + num29;
                        if ((_six2 != null) && (double.Parse(str17.Split(new char[] { ',' })[1]) > double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[1])))
                        {
                            string str18 = _six2.get_current_odds().Split(new char[] { ',' })[1];
                            result.set_success(400);
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), str18));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        num38 = CallBLL.cz_odds_six_bll.UpdateCurrentOddsLXLWSL(Convert.ToInt32(str4), str17, dictionary8);
                        base.CheckZKChildWT(str4);
                        base.sxlws_group_log(oldModel, oldModel.get_current_odds(), str17, str3, false);
                    }
                    else
                    {
                        double num48 = num29 - num30;
                        new Dictionary<int, double>();
                        if (_six2 != null)
                        {
                            for (int m = 0; m < table.Rows.Count; m++)
                            {
                                double num50 = double.Parse(table.Rows[m]["wt_value"].ToString());
                                int num51 = int.Parse(table.Rows[m]["number"].ToString());
                                double num52 = double.Parse(_six2.get_current_odds().Split(new char[] { ',' })[0]) + num50;
                                if (wTs != null)
                                {
                                    DataRow[] rowArray5 = wTs.Select(string.Format(" number={0} ", num51));
                                    if (rowArray5.Length > 0)
                                    {
                                        double.Parse(rowArray5[0]["wt_value"].ToString());
                                    }
                                }
                                if (double.Parse(double.Parse(str8).ToString("N6")) > double.Parse(num52.ToString("N6")))
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100081", "MessageHint"), num52));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                            }
                        }
                        num38 = CallBLL.cz_wt_sxlwsl_six_bll.SetWT(Convert.ToInt32(str5), Convert.ToInt32(str4), double.Parse(num48.ToString("N6")));
                        base.CheckZKChildWT(str4);
                        base.sxlws_number_log(oldModel, num28, double.Parse(num48.ToString("N6")), str5, str3, false);
                    }
                    if ((model.get_u_type().Trim().Equals("zj") && !num38.Equals(0)) && ((str4.Equals("92569") || str4.Equals("92570")) || (str4.Equals("92571") || str4.Equals("92637"))))
                    {
                        DataRow[] rowArray6 = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(str4).Select(string.Format(" odds_id={0} ", str4));
                        cz_odds_six _six4 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (str6.Equals("A"))
                        {
                            _six4.get_a_diff();
                        }
                        if (str6.Equals("B"))
                        {
                            _six4.get_b_diff();
                        }
                        if (str6.Equals("C"))
                        {
                            _six4.get_c_diff();
                        }
                        Dictionary<string, object> dictionary9 = new Dictionary<string, object>();
                        dictionary9.Add(str4.ToString(), this.GetWT_LXLWSL("wsltype", _six4.get_current_odds(), _six4.get_max_odds(), _six4.get_min_odds(), Convert.ToInt32(base.get_YearLianID()), rowArray6));
                        dictionary.Add("play_odds", dictionary9);
                    }
                    result.set_data(dictionary);
                    result.set_success(200);
                    strResult = JsonHandle.ObjectToJson(result);
                }
            }
        }

        public void operate_adds_WSL_wt(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_six_op_odds().Equals(1))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("fgs") || !model.get_six_op_odds().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                string str5 = LSRequest.qq("oddsindex");
                if (string.IsNullOrEmpty(str5))
                {
                    str5 = "0";
                }
                LSRequest.qq("phaseid");
                string str6 = LSRequest.qq("pk");
                string str7 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                if (string.IsNullOrEmpty(str6))
                {
                    str6 = "A";
                }
                else
                {
                    str6 = str6.ToUpper();
                }
                if ((!str6.Equals("A") && !str6.Equals("B")) && !str6.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    double num43;
                    int num44;
                    cz_odds_six _six = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || str3.Equals("3"))
                    {
                        _six = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (_six == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    DataTable minWTValue = CallBLL.cz_wt_sxlwsl_six_bll.GetMinWTValue(int.Parse(str4));
                    double num = double.Parse(minWTValue.Rows[0]["wt_value"].ToString());
                    string str9 = minWTValue.Rows[0]["number"].ToString();
                    if (int.Parse(str9) < 10)
                    {
                        str9 = "0" + str9;
                    }
                    if (!str3.Equals("1") && !str3.Equals("2"))
                    {
                        if (str3.Equals("3"))
                        {
                            double num23 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[0]);
                            double num24 = 0.0;
                            if (_six.get_current_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num24 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[1]);
                            }
                            double num25 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[0]);
                            double num26 = 0.0;
                            if (_six.get_max_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num26 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[1]);
                            }
                            double num27 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[0]);
                            double num28 = 0.0;
                            if (_six.get_min_odds().Split(new char[] { ',' }).Length > 1)
                            {
                                num28 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[1]);
                            }
                            string str12 = "0";
                            if (str6.Equals("A"))
                            {
                                str12 = _six.get_a_diff();
                            }
                            else if (str6.Equals("B"))
                            {
                                str12 = _six.get_b_diff();
                            }
                            else if (str6.Equals("C"))
                            {
                                str12 = _six.get_c_diff();
                            }
                            double num29 = double.Parse(str12.Split(new char[] { ',' })[0]);
                            double num30 = 0.0;
                            if (str12.Split(new char[] { ',' }).Length > 1)
                            {
                                num30 = double.Parse(str12.Split(new char[] { ',' })[1]);
                            }
                            double num31 = 0.0;
                            double num32 = 0.0;
                            base.GetOperate_SIX(str4, ref num31, ref num32);
                            double num33 = num23;
                            double num34 = num24;
                            double num35 = num27;
                            double num36 = num28;
                            num43 = num23 + num31;
                            double.Parse(num43.ToString());
                            num43 = num24 + num32;
                            double.Parse(num43.ToString());
                            num43 = num23 + num29;
                            double.Parse(num43.ToString());
                            num43 = num24 + num30;
                            double.Parse(num43.ToString());
                            num43 = (num33 - num35) + 1.0;
                            double num37 = double.Parse(num43.ToString());
                            num43 = (num34 - num36) + 1.0;
                            double num38 = double.Parse(num43.ToString());
                            num43 = double.Parse(s) - num29;
                            double num39 = double.Parse(num43.ToString());
                            num43 = double.Parse(s) - num30;
                            double num40 = double.Parse(num43.ToString());
                            decimal num41 = 0M;
                            if (!str5.Equals("0"))
                            {
                                if (Convert.ToDouble(num39) < num35)
                                {
                                    result.set_success(400);
                                    num43 = num35 + num29;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num39) > num33)
                                {
                                    result.set_success(400);
                                    num43 = num33 + num29;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num39) < num37)
                                {
                                    result.set_success(400);
                                    num43 = num37 + num29;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                num43 = num39 + num;
                                if (double.Parse(num43.ToString()) < num37)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100063", "MessageHint"), str9, num37));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                decimal num45 = decimal.Parse(num39.ToString()) - decimal.Parse(num33.ToString());
                                num41 = decimal.Parse(num45.ToString());
                            }
                            else
                            {
                                if (Convert.ToDouble(num40) < num36)
                                {
                                    result.set_success(400);
                                    num43 = num36 + num30;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num40) > num34)
                                {
                                    result.set_success(400);
                                    num43 = num34 + num30;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                if (Convert.ToDouble(num40) < num38)
                                {
                                    result.set_success(400);
                                    num43 = num38 + num30;
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                num43 = num40 + num;
                                if (double.Parse(num43.ToString()) < num38)
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100063", "MessageHint"), str9, num38));
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                num41 = decimal.Parse((decimal.Parse(num40.ToString()) - decimal.Parse(num34.ToString())).ToString());
                            }
                            string str13 = "0";
                            if (str5.Equals("0"))
                            {
                                str13 = "1";
                            }
                            DataTable oddsWTbyFGS = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                            num44 = 100;
                            base.Add_FgsOddsWT_Lock(num44.ToString(), str, str4);
                            int num42 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOddsSXLWSL(Convert.ToInt32(str4), num41, str3, str, str13);
                            num44 = 100;
                            base.Del_FgsOddsWT_Lock(num44.ToString(), str, str4);
                            if (num42 > 0)
                            {
                                base.fgs_opt_six_log(oddsWTbyFGS, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                FileCacheHelper.UpdateFGSWTFile(100);
                                if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && ((str4.Equals("92569") || str4.Equals("92570")) || (str4.Equals("92571") || str4.Equals("92637"))))
                                {
                                    DataRow[] wtDataRow = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(str4).Select(string.Format(" odds_id={0} ", str4));
                                    Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                                    Dictionary<string, string> dictionary5 = this.GetWT_LXLWSL_wt(model, context, str4, "wsltype", Convert.ToInt32(base.get_YearLianID()), wtDataRow, str6);
                                    dictionary4.Add(str4.ToString(), dictionary5);
                                    dictionary.Add("play_odds", dictionary4);
                                }
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                        }
                    }
                    else
                    {
                        double num2 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[0]);
                        double num3 = 0.0;
                        if (_six.get_current_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num3 = double.Parse(_six.get_current_odds().Split(new char[] { ',' })[1]);
                        }
                        double num4 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[0]);
                        double num5 = 0.0;
                        if (_six.get_max_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num5 = Convert.ToDouble(_six.get_max_odds().Split(new char[] { ',' })[1]);
                        }
                        double num6 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[0]);
                        double num7 = 0.0;
                        if (_six.get_min_odds().Split(new char[] { ',' }).Length > 1)
                        {
                            num7 = Convert.ToDouble(_six.get_min_odds().Split(new char[] { ',' })[1]);
                        }
                        string str10 = "0";
                        if (str6.Equals("A"))
                        {
                            str10 = _six.get_a_diff();
                        }
                        else if (str6.Equals("B"))
                        {
                            str10 = _six.get_b_diff();
                        }
                        else if (str6.Equals("C"))
                        {
                            str10 = _six.get_c_diff();
                        }
                        double num8 = double.Parse(str10.Split(new char[] { ',' })[0]);
                        double num9 = 0.0;
                        if (str10.Split(new char[] { ',' }).Length > 1)
                        {
                            num9 = double.Parse(str10.Split(new char[] { ',' })[1]);
                        }
                        double num10 = 0.0;
                        double num11 = 0.0;
                        base.GetOperate_SIX(str4, ref num10, ref num11);
                        double num12 = num2;
                        double num13 = num3;
                        double num14 = num6;
                        double num15 = num7;
                        num43 = num2 + num10;
                        double num16 = double.Parse(num43.ToString());
                        num43 = num3 + num11;
                        double num17 = double.Parse(num43.ToString());
                        num43 = num2 + num8;
                        double.Parse(num43.ToString());
                        num43 = num3 + num9;
                        double.Parse(num43.ToString());
                        num43 = (num12 - num14) + 1.0;
                        double num18 = double.Parse(num43.ToString());
                        num43 = (num13 - num15) + 1.0;
                        double num19 = double.Parse(num43.ToString());
                        double num20 = 0.0;
                        double num21 = 0.0;
                        string str14 = str3;
                        if (str14 != null)
                        {
                            if (!(str14 == "1"))
                            {
                                if (str14 == "2")
                                {
                                    if (str5.Equals("0"))
                                    {
                                        num43 = num17 + -Convert.ToDouble(str7);
                                        num21 = double.Parse(num43.ToString());
                                    }
                                    else
                                    {
                                        num43 = num16 + -Convert.ToDouble(str7);
                                        num20 = double.Parse(num43.ToString());
                                    }
                                }
                            }
                            else if (str5.Equals("0"))
                            {
                                num43 = num17 + Convert.ToDouble(str7);
                                num21 = double.Parse(num43.ToString());
                            }
                            else
                            {
                                num43 = num16 + Convert.ToDouble(str7);
                                num20 = double.Parse(num43.ToString());
                            }
                        }
                        if (!str5.Equals("0"))
                        {
                            if (!str3.Equals("1") && (num20 < num14))
                            {
                                result.set_success(400);
                                num43 = num14 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (!str3.Equals("2") && (num20 > num12))
                            {
                                result.set_success(400);
                                num43 = num12 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num20 < num18)
                            {
                                result.set_success(400);
                                num43 = num18 + num8;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            num43 = num20 + num;
                            if (double.Parse(num43.ToString()) < num18)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100063", "MessageHint"), str9, num18));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        else
                        {
                            if (!str3.Equals("1") && (num21 < num15))
                            {
                                result.set_success(400);
                                num43 = num15 + num9;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (!str3.Equals("2") && (num21 > num13))
                            {
                                result.set_success(400);
                                num43 = num13 + num9;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (num21 < num19)
                            {
                                result.set_success(400);
                                num43 = num19 + num9;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num43.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            num43 = num21 + num;
                            if (double.Parse(num43.ToString()) < num19)
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100063", "MessageHint"), str9, num19));
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        string str11 = "0";
                        if (str5.Equals("0"))
                        {
                            str11 = "1";
                        }
                        DataTable table2 = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                        num44 = 100;
                        base.Add_FgsOddsWT_Lock(num44.ToString(), str, str4);
                        int num22 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOddsSXLWSL(Convert.ToInt32(str4), str3.Equals("1") ? Convert.ToDecimal(str7) : -Convert.ToDecimal(str7), str3, str, str11);
                        base.Del_FgsOddsWT_Lock(100.ToString(), str, str4);
                        if (num22 > 0)
                        {
                            base.fgs_opt_six_log(table2, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                            CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                            FileCacheHelper.UpdateFGSWTFile(100);
                            if ((model.get_u_type().Trim().Equals("fgs") && model.get_six_op_odds().Equals(1)) && ((str4.Equals("92569") || str4.Equals("92570")) || (str4.Equals("92571") || str4.Equals("92637"))))
                            {
                                DataRow[] rowArray = CallBLL.cz_wt_sxlwsl_six_bll.GetWT(str4).Select(string.Format(" odds_id={0} ", str4));
                                Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                                Dictionary<string, string> dictionary3 = this.GetWT_LXLWSL_wt(model, context, str4, "wsltype", Convert.ToInt32(base.get_YearLianID()), rowArray, str6);
                                dictionary2.Add(str4.ToString(), dictionary3);
                                dictionary.Add("play_odds", dictionary2);
                            }
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                    }
                }
            }
        }

        public void operate_adds_wt(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_six_op_odds().Equals(1))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("fgs") || !model.get_six_op_odds().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                string str4 = LSRequest.qq("oddsid");
                LSRequest.qq("phaseid");
                string str5 = LSRequest.qq("pk");
                string str6 = LSRequest.qq("wtvalue");
                string s = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                if (string.IsNullOrEmpty(str5))
                {
                    str5 = "A";
                }
                else
                {
                    str5 = str5.ToUpper();
                }
                if ((!str5.Equals("A") && !str5.Equals("B")) && !str5.Equals("C"))
                {
                    context.Response.End();
                }
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    double num31;
                    int num36;
                    cz_odds_six _six = null;
                    if ((str3.Equals("1") || str3.Equals("2")) || (str3.Equals("3") || str3.Equals("4")))
                    {
                        _six = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                        if (_six == null)
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    if (!str3.Equals("1") && !str3.Equals("2"))
                    {
                        if (str3.Equals("3"))
                        {
                            double num16 = double.Parse(_six.get_current_odds());
                            double num17 = Convert.ToDouble(_six.get_max_odds());
                            double num18 = Convert.ToDouble(_six.get_min_odds());
                            double num19 = 0.0;
                            if (str5.Equals("A"))
                            {
                                num19 = Convert.ToDouble(_six.get_a_diff());
                            }
                            else if (str5.Equals("B"))
                            {
                                num19 = Convert.ToDouble(_six.get_b_diff());
                            }
                            else if (str5.Equals("C"))
                            {
                                num19 = Convert.ToDouble(_six.get_c_diff());
                            }
                            base.GetFgsWTTable(100);
                            double wtvalue = 0.0;
                            base.GetOperate_SIX(str4, ref wtvalue);
                            double num21 = num16;
                            double num22 = num18;
                            num31 = num16 + wtvalue;
                            double num23 = double.Parse(num31.ToString());
                            num31 = num16 + num19;
                            double num24 = double.Parse(num31.ToString());
                            num31 = (num21 - num22) + 1.0;
                            double num25 = double.Parse(num31.ToString());
                            num31 = double.Parse(s) - num19;
                            s = num31.ToString();
                            if (Convert.ToDouble(s) < num22)
                            {
                                result.set_success(400);
                                num31 = num22 + num19;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else if (Convert.ToDouble(s) > num21)
                            {
                                result.set_success(400);
                                num31 = num21 + num19;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else if (Convert.ToDouble(s) < num25)
                            {
                                result.set_success(400);
                                num31 = num25 + num19;
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                decimal num26 = decimal.Parse((decimal.Parse(s) - decimal.Parse(num21.ToString())).ToString());
                                DataTable oddsWTbyFGS = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                                num36 = 100;
                                base.Add_FgsOddsWT_Lock(num36.ToString(), str, str4);
                                int num27 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOdds(Convert.ToInt32(str4), num26, str3, str);
                                num36 = 100;
                                base.Del_FgsOddsWT_Lock(num36.ToString(), str, str4);
                                if (num27 > 0)
                                {
                                    wtvalue = 0.0;
                                    CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                    FileCacheHelper.UpdateFGSWTFile(100);
                                    base.GetOperate_SIX(str4, ref wtvalue);
                                    cz_odds_six _six4 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                                    base.fgs_opt_six_log(oddsWTbyFGS, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                    double num28 = Convert.ToDouble(_six4.get_current_odds());
                                    Convert.ToDouble(_six4.get_max_odds());
                                    double num29 = Convert.ToDouble(_six4.get_min_odds());
                                    double num30 = 0.0;
                                    if (str5.Equals("A"))
                                    {
                                        num30 = Convert.ToDouble(_six4.get_a_diff());
                                    }
                                    else if (str5.Equals("B"))
                                    {
                                        num30 = Convert.ToDouble(_six4.get_b_diff());
                                    }
                                    else if (str5.Equals("C"))
                                    {
                                        num30 = Convert.ToDouble(_six4.get_c_diff());
                                    }
                                    num31 = (num28 + num30) + wtvalue;
                                    num23 = double.Parse(num31.ToString());
                                    num31 = num28 + num30;
                                    num24 = double.Parse(num31.ToString());
                                    num31 = ((num28 - num29) + num30) + 1.0;
                                    num25 = double.Parse(num31.ToString());
                                    string str9 = _six4.get_is_open().ToString();
                                    Dictionary<string, object> dictionary4 = new Dictionary<string, object>();
                                    Dictionary<string, object> dictionary5 = new Dictionary<string, object>();
                                    dictionary5.Add("pl", num23.ToString());
                                    dictionary5.Add("maxpl", num24.ToString());
                                    dictionary5.Add("minpl", num25.ToString());
                                    dictionary5.Add("plx", new List<double>());
                                    if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                                    {
                                        str9 = "0";
                                    }
                                    dictionary5.Add("is_open", str9);
                                    dictionary4.Add(str4, new Dictionary<string, object>(dictionary5));
                                    dictionary.Add("play_odds", dictionary4);
                                    result.set_data(dictionary);
                                    result.set_success(200);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                else
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                            }
                        }
                    }
                    else
                    {
                        double num = double.Parse(_six.get_current_odds());
                        double num2 = Convert.ToDouble(_six.get_max_odds());
                        double num3 = Convert.ToDouble(_six.get_min_odds());
                        double num4 = 0.0;
                        if (str5.Equals("A"))
                        {
                            num4 = Convert.ToDouble(_six.get_a_diff());
                        }
                        else if (str5.Equals("B"))
                        {
                            num4 = Convert.ToDouble(_six.get_b_diff());
                        }
                        else if (str5.Equals("C"))
                        {
                            num4 = Convert.ToDouble(_six.get_c_diff());
                        }
                        base.GetFgsWTTable(100);
                        double num5 = 0.0;
                        base.GetOperate_SIX(str4, ref num5);
                        double num6 = num;
                        double num7 = num3;
                        num31 = num + num5;
                        double num8 = double.Parse(num31.ToString());
                        double num9 = double.Parse((num + num4).ToString());
                        double num10 = double.Parse(((num6 - num7) + 1.0).ToString());
                        double num11 = 0.0;
                        string str10 = str3;
                        if (str10 != null)
                        {
                            if (!(str10 == "1"))
                            {
                                if (str10 == "2")
                                {
                                    num11 = double.Parse((num8 + -Convert.ToDouble(str6)).ToString());
                                }
                            }
                            else
                            {
                                num11 = double.Parse((num8 + Convert.ToDouble(str6)).ToString());
                            }
                        }
                        if (!str3.Equals("1") && (num11 < num7))
                        {
                            result.set_success(400);
                            num31 = num7 + num4;
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else if (num11 > num6)
                        {
                            result.set_success(400);
                            num31 = num6 + num4;
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100055", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else if (num11 < num10)
                        {
                            result.set_success(400);
                            num31 = num10 + num4;
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100023", "MessageHint"), _six.get_play_name() + "【" + _six.get_put_amount() + "】", double.Parse(num31.ToString())));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            DataTable table = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                            num36 = 100;
                            base.Add_FgsOddsWT_Lock(num36.ToString(), str, str4);
                            int num12 = CallBLL.cz_odds_wt_six_bll.UpdateFgsWTOdds(Convert.ToInt32(str4), str3.Equals("1") ? Convert.ToDecimal(str6) : -Convert.ToDecimal(str6), str3, str);
                            base.Del_FgsOddsWT_Lock(100.ToString(), str, str4);
                            if (num12 > 0)
                            {
                                num5 = 0.0;
                                CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                FileCacheHelper.UpdateFGSWTFile(100);
                                base.GetOperate_SIX(str4, ref num5);
                                base.fgs_opt_six_log(table, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                cz_odds_six _six2 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str4));
                                double num13 = Convert.ToDouble(_six2.get_current_odds());
                                Convert.ToDouble(_six2.get_max_odds());
                                double num14 = Convert.ToDouble(_six2.get_min_odds());
                                double num15 = 0.0;
                                if (str5.Equals("A"))
                                {
                                    num15 = Convert.ToDouble(_six2.get_a_diff());
                                }
                                else if (str5.Equals("B"))
                                {
                                    num15 = Convert.ToDouble(_six2.get_b_diff());
                                }
                                else if (str5.Equals("C"))
                                {
                                    num15 = Convert.ToDouble(_six2.get_c_diff());
                                }
                                num31 = (num13 + num15) + num5;
                                num8 = double.Parse(num31.ToString());
                                num31 = num13 + num15;
                                num9 = double.Parse(num31.ToString());
                                num10 = double.Parse((((num13 - num14) + num15) + 1.0).ToString());
                                string str8 = _six2.get_is_open().ToString();
                                Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                                Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                                dictionary3.Add("pl", num8.ToString());
                                dictionary3.Add("maxpl", num9.ToString());
                                dictionary3.Add("minpl", num10.ToString());
                                dictionary3.Add("plx", new List<double>());
                                if (CallBLL.cz_phase_six_bll.GetCurrentPhase().get_is_closed().Equals(1))
                                {
                                    str8 = "0";
                                }
                                dictionary3.Add("is_open", str8);
                                dictionary2.Add(str4, new Dictionary<string, object>(dictionary3));
                                dictionary.Add("play_odds", dictionary2);
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100011", "MessageHint"));
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                        }
                    }
                }
            }
        }

        public void operate_CloseOpen(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_closeopen");
                result.set_data(dictionary);
                string str3 = LSRequest.qq("optype");
                string playid = LSRequest.qq("playid");
                string oddsid = LSRequest.qq("oddsid");
                LSRequest.qq("phaseid");
                string str6 = LSRequest.qq("isopen");
                LSRequest.qq("pk");
                if (str3.Equals("65"))
                {
                    playid = "91001,91002,91003,91004,91005,91006,91007,91030,91038,91039";
                }
                int num = CallBLL.cz_odds_six_bll.CloseOpenOdds(str3, playid, oddsid, str6);
                result.set_success(200);
                if (num == 0)
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100034", "MessageHint"));
                }
                else
                {
                    base.openclose_log(oddsid, str3, str6, LSRequest.qq("playpage"), playid);
                }
                strResult = JsonHandle.ObjectToJson(result);
            }
        }

        public override void ProcessRequest(HttpContext context)
        {
            base.checkLoginByHandler(0);
            string str = context.Session["user_name"].ToString();
            string str2 = context.Session["user_type"].ToString();
            agent_userinfo_session _session = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            string str3 = LSRequest.qq("action");
            string strResult = "";
            if (!string.IsNullOrEmpty(str3))
            {
                switch (str3)
                {
                    case "get_oddsinfo":
                        this.get_oddsinfo(context, ref strResult);
                        break;

                    case "get_oddsinfoex":
                        if (_session.get_u_type().Equals("zj"))
                        {
                            if (!LSRequest.qq("fast").Equals("2"))
                            {
                                this.get_oddsinfoex(context, ref strResult);
                                break;
                            }
                            this.get_oddsinfoex_fast(context, ref strResult);
                        }
                        break;

                    case "get_szszlmbh":
                        this.get_lmszszamount(context, ref strResult);
                        break;

                    case "get_szszlxlbh":
                        this.get_lxlszszamount(context, ref strResult);
                        break;

                    case "operate_adds":
                    {
                        if (this.IsOpenPhase())
                        {
                            string str6 = LSRequest.qq("optype");
                            if (str2.ToLower().Equals("fgs"))
                            {
                                if (!base.IsFGSWT_Opt(100))
                                {
                                    ReturnResult result2 = new ReturnResult();
                                    result2.set_success(400);
                                    result2.set_tipinfo(PageBase.GetMessageByCache("u100095", "MessageHint"));
                                    strResult = JsonHandle.ObjectToJson(result2);
                                    this.Session.Abandon();
                                }
                                else
                                {
                                    string str7 = LSRequest.qq("pk");
                                    if (_session.get_six_kind().Equals("0"))
                                    {
                                        if (string.IsNullOrEmpty(str7))
                                        {
                                            str7 = "A";
                                        }
                                        else
                                        {
                                            str7 = str7.ToUpper();
                                        }
                                    }
                                    if (!_session.get_six_kind().Equals("0"))
                                    {
                                        str7 = str7.ToUpper();
                                        if (!str7.Equals(_session.get_six_kind().ToUpper()))
                                        {
                                            ReturnResult result3 = new ReturnResult();
                                            result3.set_success(400);
                                            result3.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100077", "MessageHint"), str7.ToUpper()));
                                            strResult = JsonHandle.ObjectToJson(result3);
                                            break;
                                        }
                                    }
                                    if ((str6.Equals("5") || str6.Equals("6")) || str6.Equals("7"))
                                    {
                                        this.ShortcutBarOperate_adds_wt(context, ref strResult);
                                    }
                                    else
                                    {
                                        int num = Convert.ToInt32(LSRequest.qq("oddsid"));
                                        LSRequest.qq("playpage");
                                        if ((num >= 0x16761) && (num <= 0x167c2))
                                        {
                                            this.operate_adds_TMAB_wt(context, ref strResult);
                                        }
                                        else if ((((num.Equals(0x1687d) || num.Equals(0x1687e)) || (num.Equals(0x1687f) || num.Equals(0x16880))) || ((num.Equals(0x16881) || num.Equals(0x1699f)) || (num.Equals(0x169de) || num.Equals(0x169df)))) || ((num.Equals(0x169e0) || num.Equals(0x169e1)) || (num.Equals(0x169e2) || num.Equals(0x169e3))))
                                        {
                                            this.operate_adds_LM_wt(context, ref strResult);
                                        }
                                        else if (((num.Equals(0x1699c) || num.Equals(0x169ac)) || (num.Equals(0x169ad) || num.Equals(0x169ae))) || (num.Equals(0x169af) || num.Equals(0x169b0)))
                                        {
                                            this.operate_adds_BZ_wt(context, ref strResult);
                                        }
                                        else if ((num.Equals(0x16996) || num.Equals(0x16997)) || (num.Equals(0x16998) || num.Equals(0x169dc)))
                                        {
                                            this.operate_adds_SXL_wt(context, ref strResult);
                                        }
                                        else if ((num.Equals(0x16999) || num.Equals(0x1699a)) || (num.Equals(0x1699b) || num.Equals(0x169dd)))
                                        {
                                            this.operate_adds_WSL_wt(context, ref strResult);
                                        }
                                        else if (num.Equals(0x16995))
                                        {
                                            this.operate_adds_LXYZ_wt(context, ref strResult);
                                        }
                                        else
                                        {
                                            this.operate_adds_wt(context, ref strResult);
                                        }
                                    }
                                }
                            }
                            else
                            {
                                string str8 = LSRequest.qq("pk");
                                if (string.IsNullOrEmpty(str8))
                                {
                                    str8 = "A";
                                }
                                if (!str8.ToUpper().Equals("A"))
                                {
                                    ReturnResult result4 = new ReturnResult();
                                    result4.set_success(400);
                                    result4.set_tipinfo(PageBase.GetMessageByCache("u100049", "MessageHint"));
                                    strResult = JsonHandle.ObjectToJson(result4);
                                }
                                else if ((str6.Equals("5") || str6.Equals("6")) || str6.Equals("7"))
                                {
                                    this.ShortcutBarOperate_adds(context, ref strResult);
                                }
                                else
                                {
                                    int num2 = Convert.ToInt32(LSRequest.qq("oddsid"));
                                    LSRequest.qq("playpage");
                                    if ((num2 >= 0x16761) && (num2 <= 0x167c2))
                                    {
                                        this.operate_adds_TMAB(context, ref strResult);
                                    }
                                    else if ((((num2.Equals(0x1687d) || num2.Equals(0x1687e)) || (num2.Equals(0x1687f) || num2.Equals(0x16880))) || ((num2.Equals(0x16881) || num2.Equals(0x1699f)) || (num2.Equals(0x169de) || num2.Equals(0x169df)))) || ((num2.Equals(0x169e0) || num2.Equals(0x169e1)) || (num2.Equals(0x169e2) || num2.Equals(0x169e3))))
                                    {
                                        this.operate_adds_LM(context, ref strResult);
                                    }
                                    else if (((num2.Equals(0x1699c) || num2.Equals(0x169ac)) || (num2.Equals(0x169ad) || num2.Equals(0x169ae))) || (num2.Equals(0x169af) || num2.Equals(0x169b0)))
                                    {
                                        this.operate_adds_BZ(context, ref strResult);
                                    }
                                    else if ((num2.Equals(0x16996) || num2.Equals(0x16997)) || (num2.Equals(0x16998) || num2.Equals(0x169dc)))
                                    {
                                        this.operate_adds_LXL(context, ref strResult);
                                    }
                                    else if ((num2.Equals(0x16999) || num2.Equals(0x1699a)) || (num2.Equals(0x1699b) || num2.Equals(0x169dd)))
                                    {
                                        this.operate_adds_WSL(context, ref strResult);
                                    }
                                    else if (num2.Equals(0x16995))
                                    {
                                        this.operate_adds_LXYZ(context, ref strResult);
                                    }
                                    else
                                    {
                                        this.operate_adds(context, ref strResult);
                                    }
                                }
                            }
                            break;
                        }
                        ReturnResult result = new ReturnResult();
                        result.set_success(400);
                        result.set_tipinfo(PageBase.GetMessageByCache("u100071", "MessageHint"));
                        strResult = JsonHandle.ObjectToJson(result);
                        break;
                    }
                    case "operate_closeopen":
                    {
                        if (this.IsOpenPhase())
                        {
                            string str9 = LSRequest.qq("pk");
                            if (!string.IsNullOrEmpty(str9) && !str9.ToUpper().Equals("A"))
                            {
                                ReturnResult result6 = new ReturnResult();
                                result6.set_success(400);
                                result6.set_tipinfo(PageBase.GetMessageByCache("u100049", "MessageHint"));
                                strResult = JsonHandle.ObjectToJson(result6);
                            }
                            else
                            {
                                this.operate_CloseOpen(context, ref strResult);
                            }
                            break;
                        }
                        ReturnResult result5 = new ReturnResult();
                        result5.set_success(400);
                        result5.set_tipinfo(PageBase.GetMessageByCache("u100071", "MessageHint"));
                        strResult = JsonHandle.ObjectToJson(result5);
                        break;
                    }
                    case "set_allowsale":
                    {
                        string s = LSRequest.qq("oddsid");
                        string str11 = LSRequest.qq("playpage");
                        string str12 = context.Session["user_type"].ToString();
                        string str13 = LSRequest.qq("fast");
                        string str14 = LSRequest.qq("s_user");
                        if (str12.Equals("zj"))
                        {
                            cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str14);
                            if (str13.Equals("2"))
                            {
                                if (!user.get_flag().Equals(1))
                                {
                                    if ((str11.Equals("tmab") || str11.Equals("tmzx1")) || (str11.Equals("tmzx2") || str11.Equals("tmzx3")))
                                    {
                                        this.zj_fast_saleTMAB(context, ref strResult);
                                    }
                                    else
                                    {
                                        this.zj_fast_sale(context, ref strResult);
                                    }
                                }
                                else if ((str11.Equals("tmab") || str11.Equals("tmzx1")) || (str11.Equals("tmzx2") || str11.Equals("tmzx3")))
                                {
                                    this.SaleFast_ex(context, ref strResult);
                                }
                                else
                                {
                                    this.SaleFastAorB_ex(context, ref strResult);
                                }
                            }
                            else if (!user.get_flag().Equals(1))
                            {
                                if ((int.Parse(s) <= 0x16791) && ((str11.Equals("tmab") || str11.Equals("tmzx1")) || str11.Equals("tmzx2")))
                                {
                                    this.zj_fast_saleTMAB(context, ref strResult);
                                }
                                else
                                {
                                    this.zj_allow_sale(context, ref strResult);
                                }
                            }
                            else if ((("92285,92286,92287,92288,92289,92575".IndexOf(s) >= 0) || ("92638,92639,92640,92641,92642,92643".IndexOf(s) >= 0)) || (("92565,92566,92567,92568,92569,92570,92571,92636,92637".IndexOf(s) >= 0) || ("92572,92588,92589,92590,92591,92592".IndexOf(s) >= 0)))
                            {
                                this.SaleALL_LM_ex(context, ref strResult);
                            }
                            else if ((int.Parse(s) <= 0x16791) && ((str11.Equals("tmab") || str11.Equals("tmzx1")) || str11.Equals("tmzx2")))
                            {
                                this.SaleTM_AandB_ex(context, ref strResult);
                            }
                            else if ((str11.Equals("tmab") || str11.Equals("tmzx1")) || str11.Equals("tmzx2"))
                            {
                                this.SaleTM_AOrB_ex(context, ref strResult);
                            }
                            else
                            {
                                this.SaleTM_AOrB_ex(context, ref strResult);
                            }
                            break;
                        }
                        if (!str13.Equals("2"))
                        {
                            if ((int.Parse(s) <= 0x16791) && ((str11.Equals("tmab") || str11.Equals("tmzx1")) || (str11.Equals("tmzx2") || str11.Equals("tmzx3"))))
                            {
                                this.user_allow_saleTMAB(context, ref strResult);
                            }
                            else
                            {
                                this.user_allow_sale(context, ref strResult);
                            }
                            break;
                        }
                        if ((!str11.Equals("tmab") && !str11.Equals("tmzx1")) && (!str11.Equals("tmzx2") && !str11.Equals("tmzx3")))
                        {
                            this.user_fast_sale(context, ref strResult);
                            break;
                        }
                        int index = 0;
                    Label_098B:;
                        if (index < s.Split(new char[] { ',' }).Length)
                        {
                            if (int.Parse(s.Split(new char[] { ',' })[index].ToString()) > 0x16792)
                            {
                                context.Response.End();
                            }
                            index++;
                            goto Label_098B;
                        }
                        this.user_fast_saleTMAB(context, ref strResult);
                        break;
                    }
                    case "get_newbetlist":
                        this.get_newbetlist(context, ref strResult);
                        break;

                    case "get_opennumber":
                        this.get_opennumber(context, ref strResult);
                        break;
                }
                context.Response.ContentType = "text/json";
                context.Response.Write(strResult);
            }
        }

        public void SaleALL_LM_ex(HttpContext context, ref string strResult)
        {
            if (context.Session["user_name"] == null)
            {
                context.Response.End();
            }
            else
            {
                string str = context.Session["user_name"].ToString();
                agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
                ReturnResult result = new ReturnResult();
                result.set_success(400);
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "user_allow_sale");
                if (!model.get_u_type().Trim().Equals("zj"))
                {
                    context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                    context.Response.End();
                }
                if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_3")))
                {
                    context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                    context.Response.End();
                }
                string str3 = LSRequest.qq("phaseid");
                string str4 = LSRequest.qq("playid");
                string oddsid = LSRequest.qq("oddsid");
                string str6 = LSRequest.qq("number");
                LSRequest.qq("playpage");
                string str7 = LSRequest.qq("s_user");
                LSRequest.qq("phase");
                string str8 = LSRequest.qq("jeucode");
                string s = LSRequest.qq("amount");
                string str10 = LSRequest.qq("currentodds");
                if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str8))
                {
                    context.Session["JeuValidate"] = null;
                    result.set_success(400);
                    new Dictionary<string, object>();
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    context.Session["JeuValidate"] = null;
                    if (double.Parse(s) < 10.0)
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100096", "MessageHint"), 10));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str7);
                        if ((user == null) || !user.get_flag().Equals(1))
                        {
                            result.set_tipinfo(PageBase.GetMessageByCache("u100075", "MessageHint"));
                            result.set_success(400);
                            string str11 = base.get_JeuValidate();
                            dictionary.Add("jeucode", str11);
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            string str12 = user.get_salt().ToUpper();
                            string sqlconn = user.get_sqlconn();
                            string str14 = user.get_sqlconn_write();
                            string str15 = user.get_six_kind().ToUpper();
                            string str16 = user.get_u_nicker();
                            string str17 = "";
                            string str18 = "";
                            Dictionary<string, string> dictionary2 = CallBLL.cz_autosale_six_ex_bll.GetHyUpTypeAndZJName(str7, str12, sqlconn);
                            if (dictionary2 == null)
                            {
                                result.set_tipinfo(PageBase.GetMessageByCache("u100075", "MessageHint"));
                                result.set_success(400);
                                string str19 = base.get_JeuValidate();
                                dictionary.Add("jeucode", str19);
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                str17 = dictionary2["su_type"];
                                str18 = dictionary2["zjname"];
                                user_six_rate _rate = CallBLL.cz_autosale_six_ex_bll.GetRateByAccount_ex(str7, str12, sqlconn, str18);
                                double num = 0.0;
                                double num2 = 0.0;
                                if (_rate.get_zcyg().Equals("1"))
                                {
                                    num = (((100.0 - double.Parse(_rate.get_fgszc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc())) - double.Parse(_rate.get_dlzc());
                                    num2 = double.Parse(_rate.get_fgszc());
                                }
                                else
                                {
                                    num2 = (((100.0 - double.Parse(_rate.get_zjzc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc())) - double.Parse(_rate.get_dlzc());
                                    num = double.Parse(_rate.get_zjzc());
                                }
                                bool flag1 = str17.ToLower() != "dl";
                                DataTable table = null;
                                DataSet set = CallBLL.cz_autosale_six_ex_bll.AccountIsDisabled_ex(_rate.get_fgsname(), _rate.get_gdname(), _rate.get_zdname(), _rate.get_dlname(), str7, str12, sqlconn);
                                if (set != null)
                                {
                                    table = set.Tables[0];
                                    if ((table != null) && (table.Rows.Count > 0))
                                    {
                                        if (table.Rows[0]["a_state"].ToString().Trim() == "1")
                                        {
                                            result.set_tipinfo("內網目標系統提示：該內網外補會員或上級已經被凍結,請與上級聯系！");
                                        }
                                        else
                                        {
                                            result.set_tipinfo("內網目標系統提示：該內網外補會員或上級已經被停用,請與上級聯系！");
                                        }
                                        result.set_success(400);
                                        string str21 = base.get_JeuValidate();
                                        dictionary.Add("jeucode", str21);
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                if (!base.IsNumber(s))
                                {
                                    result.set_tipinfo("下注金額有誤！");
                                    result.set_success(500);
                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                else
                                {
                                    string str22 = "";
                                    string str23 = "";
                                    string str24 = "";
                                    string str25 = "";
                                    cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                                    if (currentPhase != null)
                                    {
                                        if (currentPhase.get_is_closed() == 1)
                                        {
                                            result.set_tipinfo(string.Format("奖期[{0}]已封盘,停止下注！", currentPhase.get_phase().ToString()));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        str22 = currentPhase.get_phase().ToString();
                                        str23 = currentPhase.get_p_id().ToString();
                                    }
                                    else
                                    {
                                        result.set_tipinfo(string.Format("该奖期已停止下注！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(oddsid);
                                    DateTime now = DateTime.Now;
                                    DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                                    DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                                    if ((((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91004") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91007") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91038")))
                                    {
                                        if (time3 < now)
                                        {
                                            result.set_tipinfo(string.Format("已經截止下註！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    else if (time2 < now)
                                    {
                                        result.set_tipinfo(string.Format("已經截止下註！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    cz_phase_six _six3 = CallBLL.cz_autosale_six_ex_bll.GetCurrentPhase_ex(str12, sqlconn);
                                    if (_six3 != null)
                                    {
                                        if (_six3.get_is_closed() == 1)
                                        {
                                            result.set_tipinfo(string.Format("內網目標系統提示：奖期[{0}]已封盘,停止下注！", _six3.get_phase().ToString()));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        str24 = _six3.get_phase().ToString();
                                        str25 = _six3.get_p_id().ToString();
                                    }
                                    else
                                    {
                                        result.set_tipinfo(string.Format("內網目標系統提示：奖期已停止下注！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    DataTable table3 = CallBLL.cz_autosale_six_ex_bll.GetPlayIDByOddsIds_ex(oddsid, str12, sqlconn);
                                    DateTime time4 = DateTime.Now;
                                    DateTime time5 = Convert.ToDateTime(_six3.get_stop_date());
                                    DateTime time6 = Convert.ToDateTime(_six3.get_sn_stop_date());
                                    if ((((table3.Rows[0]["play_id"].ToString().Trim() == "91001") || (table3.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((table3.Rows[0]["play_id"].ToString().Trim() == "91004") || (table3.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((table3.Rows[0]["play_id"].ToString().Trim() == "91007") || (table3.Rows[0]["play_id"].ToString().Trim() == "91038")))
                                    {
                                        if (time6 < time4)
                                        {
                                            result.set_tipinfo(string.Format("內網目標系統提示：已經截止下註！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    else if (time5 < time4)
                                    {
                                        result.set_tipinfo(string.Format("內網目標系統提示：已經截止下註！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (!str23.Equals(str3))
                                    {
                                        result.set_tipinfo(string.Format("獎期错误！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                    else if (!str22.Equals(str24))
                                    {
                                        result.set_tipinfo(string.Format("內網目標系統的獎期與當前系統的獎期不一致！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                    else
                                    {
                                        string[] source = this.getlongnum(str6).Split(new char[] { ',' });
                                        if (source.Distinct<string>().ToList<string>().Count != source.Length)
                                        {
                                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100041", "MessageHint"), currentPhase.get_phase().ToString()));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                        }
                                        else
                                        {
                                            string str27 = "";
                                            string str28 = "";
                                            double num6 = 0.0;
                                            DataTable table4 = CallBLL.cz_autosale_six_ex_bll.GetUserRate_ex(str7, 1, str12, sqlconn).Tables[0];
                                            str27 = table4.Rows[0]["six_kind"].ToString().Trim();
                                            str28 = table4.Rows[0]["su_type"].ToString().Trim();
                                            num6 = double.Parse(table4.Rows[0]["six_usable_credit"].ToString().Trim());
                                            string str29 = "0";
                                            string str30 = "0";
                                            string str31 = "0";
                                            string str32 = "0";
                                            string str33 = "0";
                                            string str34 = "0";
                                            double num7 = 0.0;
                                            double num8 = 0.0;
                                            double num9 = 0.0;
                                            double num10 = 0.0;
                                            double num11 = 0.0;
                                            double num12 = 0.0;
                                            string str35 = "";
                                            string str36 = "";
                                            string str37 = "0";
                                            string str38 = "0";
                                            DataTable table5 = CallBLL.cz_autosale_six_ex_bll.GetPlayOddsByID_ex(oddsid, str12, sqlconn).Tables[0];
                                            if (table5.Rows.Count == 0)
                                            {
                                                result.set_success(400);
                                                result.set_tipinfo("內網目標系統提示：賠率ID設置错误!");
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                            }
                                            else
                                            {
                                                int num33 = 100;
                                                DataTable table6 = CallBLL.cz_autosale_six_ex_bll.GetSinglePhaseByBet_ex(str24, str7, num33.ToString(), oddsid, str12, sqlconn).Tables[0];
                                                double num13 = 0.0;
                                                string str39 = "";
                                                List<string> list = new List<string>();
                                                List<string> list2 = new List<string>();
                                                int num14 = 0;
                                                num7 = 0.0;
                                                foreach (DataRow row in table5.Rows)
                                                {
                                                    if (row["odds_id"].ToString().Trim() == oddsid.Trim())
                                                    {
                                                        str39 = row["is_open"].ToString().Trim();
                                                        row["current_odds"].ToString().Trim();
                                                        row[str27 + "_diff"].ToString().Trim();
                                                        str4 = row["play_id"].ToString().Trim();
                                                        str35 = row["play_name"].ToString().Trim();
                                                        str36 = row["put_amount"].ToString().Trim();
                                                        str37 = row["isLM"].ToString().Trim();
                                                        str38 = row["isDoubleOdds"].ToString().Trim();
                                                        num12 = double.Parse(row["allow_min_amount"].ToString().Trim());
                                                        num9 = double.Parse(row["allow_max_amount"].ToString().Trim());
                                                        num11 = double.Parse(row["allow_max_put_amount"].ToString().Trim());
                                                        break;
                                                    }
                                                }
                                                if (table6.Rows.Count > 0)
                                                {
                                                    foreach (DataRow row2 in table6.Rows)
                                                    {
                                                        if (row2["odds_id"].ToString().Trim() == oddsid.Trim())
                                                        {
                                                            num7 = double.Parse(row2["sumbet"].ToString().Trim());
                                                            break;
                                                        }
                                                    }
                                                }
                                                DataTable table7 = CallBLL.cz_autosale_six_ex_bll.GetDrawbackByPlayId_ex(str4, str7, str12, sqlconn).Tables[0];
                                                num8 = double.Parse(table7.Rows[0]["single_max_amount"].ToString().Trim());
                                                double num15 = double.Parse(table7.Rows[0]["single_min_amount"].ToString().Trim());
                                                num10 = double.Parse(table7.Rows[0]["single_phase_amount"].ToString().Trim());
                                                if (num8 > num9)
                                                {
                                                    num8 = num9;
                                                }
                                                if (num10 > num11)
                                                {
                                                    num10 = num11;
                                                }
                                                if (num15 > num12)
                                                {
                                                    num12 = num15;
                                                }
                                                if (str39 != "1")
                                                {
                                                    result.set_tipinfo(string.Format("內網目標系統提示：{0}【{1}】已經停止投注！", str35, str36));
                                                    result.set_success(400);
                                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                                    result.set_data(dictionary);
                                                    strResult = JsonHandle.ObjectToJson(result);
                                                }
                                                else
                                                {
                                                    if (str38.Equals("0"))
                                                    {
                                                        DataTable table8 = this.GetNumberWTTable(oddsid, sqlconn, str12.ToUpper());
                                                        num13 = double.Parse(CallBLL.cz_autosale_six_ex_bll.GetPlay_ex(oddsid, str7, sqlconn, str15, str12.ToUpper(), table8, str6, base.get_YearLianID()));
                                                        if (double.Parse(str10) != double.Parse(num13.ToString()))
                                                        {
                                                            list.Add(num14.ToString());
                                                            list2.Add(num13.ToString());
                                                        }
                                                    }
                                                    if (double.Parse(s) > num8)
                                                    {
                                                        result.set_tipinfo(string.Format("內網目標系統提示：下注金額超出單注最大金額！", new object[0]));
                                                        result.set_success(500);
                                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                                        result.set_data(dictionary);
                                                        strResult = JsonHandle.ObjectToJson(result);
                                                    }
                                                    else if (double.Parse(s) > num6)
                                                    {
                                                        result.set_tipinfo(string.Format("內網目標系統提示：下注金額超出可用金額！", new object[0]));
                                                        result.set_success(500);
                                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                                        result.set_data(dictionary);
                                                        strResult = JsonHandle.ObjectToJson(result);
                                                    }
                                                    else if (double.Parse(s) < num12)
                                                    {
                                                        result.set_tipinfo(string.Format("內網目標系統提示：下注金額低過最低金額！", new object[0]));
                                                        result.set_success(500);
                                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                                        result.set_data(dictionary);
                                                        strResult = JsonHandle.ObjectToJson(result);
                                                    }
                                                    else if (!str37.Equals("1") && ((double.Parse(s) + num7) > num10))
                                                    {
                                                        result.set_tipinfo(string.Format("內網目標系統提示：{0}【{1}】下注單期金額超出單期最大金額！", str35, str36));
                                                        result.set_success(500);
                                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                                        result.set_data(dictionary);
                                                        strResult = JsonHandle.ObjectToJson(result);
                                                    }
                                                    else
                                                    {
                                                        num14++;
                                                        if (list.Count > 0)
                                                        {
                                                            result.set_tipinfo(string.Format("內網目標系統提示：賠率有變動,請確認後再提交!", new object[0]));
                                                            result.set_success(600);
                                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                                            dictionary.Add("index", list);
                                                            dictionary.Add("newpl", list2);
                                                            result.set_data(dictionary);
                                                            strResult = JsonHandle.ObjectToJson(result);
                                                        }
                                                        else if (num6 < double.Parse(s))
                                                        {
                                                            result.set_tipinfo(string.Format("內網目標系統提示：可用餘額不足！", new object[0]));
                                                            result.set_success(500);
                                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                                            result.set_data(dictionary);
                                                            strResult = JsonHandle.ObjectToJson(result);
                                                        }
                                                        else
                                                        {
                                                            DataTable table9 = CallBLL.cz_bet_six_bll.GetSZZTByZJ(str23, table5.Rows[0]["play_id"].ToString(), context.Session["user_name"].ToString(), oddsid, str15);
                                                            if ((table9 == null) || (Convert.ToDouble(table9.Rows[0]["szzt"]) < 1.0))
                                                            {
                                                                result.set_success(400);
                                                                result.set_tipinfo(PageBase.GetMessageByCache("u100047", "MessageHint"));
                                                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                                result.set_data(dictionary);
                                                                strResult = JsonHandle.ObjectToJson(result);
                                                            }
                                                            else if (Convert.ToDouble(s) > Convert.ToDouble(table9.Rows[0]["szzt"]))
                                                            {
                                                                result.set_success(400);
                                                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100076", "MessageHint"), string.Format("{0:F0}", double.Parse(table9.Rows[0]["szzt"].ToString()))));
                                                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                                result.set_data(dictionary);
                                                                strResult = JsonHandle.ObjectToJson(result);
                                                            }
                                                            else
                                                            {
                                                                DataTable table10 = CallBLL.cz_odds_six_bll.GetOddsByID(oddsid).Tables[0];
                                                                if (table10.Rows[0]["is_open"].ToString().Equals("0"))
                                                                {
                                                                    result.set_success(400);
                                                                    result.set_tipinfo(string.Format("{0}【{1}】 已停盤！", table10.Rows[0]["play_name"].ToString(), table10.Rows[0]["put_amount"].ToString()));
                                                                    context.Session["JeuValidate"] = base.get_JeuValidate();
                                                                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                                    result.set_data(dictionary);
                                                                    strResult = JsonHandle.ObjectToJson(result);
                                                                }
                                                                else
                                                                {
                                                                    string str41 = "";
                                                                    num14 = 0;
                                                                    DataTable table11 = CallBLL.cz_autosale_six_ex_bll.GetOddsByID_ex(oddsid, str12, sqlconn).Tables[0];
                                                                    int num16 = int.Parse(table11.Rows[0]["play_id"].ToString());
                                                                    string str42 = table11.Rows[0]["o_play_name"].ToString();
                                                                    string str43 = table11.Rows[0]["put_amount"].ToString();
                                                                    if (table11.Rows[0]["is_open"].ToString().Equals("0"))
                                                                    {
                                                                        result.set_success(400);
                                                                        result.set_tipinfo(string.Format("內網目標系統提示：{0}【{1}】 已停盤！", str42, str43));
                                                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                                        result.set_data(dictionary);
                                                                        strResult = JsonHandle.ObjectToJson(result);
                                                                    }
                                                                    else
                                                                    {
                                                                        double num35;
                                                                        string str44 = string.Format(" '{0}','{1}','{2}','{3}','{4}','{5}' ", new object[] { str18, _rate.get_fgsname(), _rate.get_gdname(), _rate.get_zdname(), _rate.get_dlname(), str7 });
                                                                        foreach (DataRow row3 in CallBLL.cz_autosale_six_ex_bll.GetDrawbackUpNames_ex(str44, str12, sqlconn).Select(string.Format(" play_id={0} ", num16)))
                                                                        {
                                                                            string str60 = row3["u_type"].ToString().Trim();
                                                                            if (str60 != null)
                                                                            {
                                                                                if (!(str60 == "zj"))
                                                                                {
                                                                                    if (str60 == "fgs")
                                                                                    {
                                                                                        goto Label_1921;
                                                                                    }
                                                                                    if (str60 == "gd")
                                                                                    {
                                                                                        goto Label_1945;
                                                                                    }
                                                                                    if (str60 == "zd")
                                                                                    {
                                                                                        goto Label_1969;
                                                                                    }
                                                                                    if (str60 == "dl")
                                                                                    {
                                                                                        goto Label_198D;
                                                                                    }
                                                                                    if (str60 == "hy")
                                                                                    {
                                                                                        goto Label_19B1;
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    str29 = row3[str27 + "_drawback"].ToString().Trim();
                                                                                }
                                                                            }
                                                                            continue;
                                                                        Label_1921:
                                                                            str30 = row3[str27 + "_drawback"].ToString().Trim();
                                                                            continue;
                                                                        Label_1945:
                                                                            str31 = row3[str27 + "_drawback"].ToString().Trim();
                                                                            continue;
                                                                        Label_1969:
                                                                            str32 = row3[str27 + "_drawback"].ToString().Trim();
                                                                            continue;
                                                                        Label_198D:
                                                                            str33 = row3[str27 + "_drawback"].ToString().Trim();
                                                                            continue;
                                                                        Label_19B1:
                                                                            switch (str28)
                                                                            {
                                                                                case "dl":
                                                                                    str34 = row3[str27 + "_drawback"].ToString().Trim();
                                                                                    break;

                                                                                case "zd":
                                                                                    str33 = row3[str27 + "_drawback"].ToString().Trim();
                                                                                    break;

                                                                                case "gd":
                                                                                    str32 = row3[str27 + "_drawback"].ToString().Trim();
                                                                                    break;

                                                                                case "fgs":
                                                                                    str31 = row3[str27 + "_drawback"].ToString().Trim();
                                                                                    break;
                                                                            }
                                                                        }
                                                                        string str45 = str10;
                                                                        if (str38.Equals("1"))
                                                                        {
                                                                            string str46 = table11.Rows[0]["current_odds"].ToString();
                                                                            string str47 = table11.Rows[0][str15 + "_diff"].ToString();
                                                                            string str48 = str46.Split(new char[] { ',' })[0];
                                                                            string str49 = str46.Split(new char[] { ',' })[1];
                                                                            string str50 = str47.Split(new char[] { ',' })[0];
                                                                            string str51 = str50;
                                                                            if (str47.Split(new char[] { ',' }).Length > 1)
                                                                            {
                                                                                str51 = str47.Split(new char[] { ',' })[1];
                                                                            }
                                                                            num35 = double.Parse(str48) + Convert.ToDouble(str50);
                                                                            string str52 = num35.ToString();
                                                                            num35 = double.Parse(str49) + Convert.ToDouble(str51);
                                                                            string str53 = num35.ToString();
                                                                            str41 = str52 + "," + str53;
                                                                        }
                                                                        else
                                                                        {
                                                                            num35 = double.Parse(table11.Rows[0]["current_odds"].ToString()) + Convert.ToDouble(table11.Rows[0][str27 + "_diff"].ToString().Trim());
                                                                            str41 = num35.ToString();
                                                                        }
                                                                        cz_bet_six _six4 = new cz_bet_six();
                                                                        string orderNumber = Utils.GetOrderNumber();
                                                                        _six4.set_order_num(orderNumber);
                                                                        _six4.set_u_name(str7);
                                                                        _six4.set_u_nicker(str16);
                                                                        _six4.set_phase_id(new int?(int.Parse(str25)));
                                                                        _six4.set_phase(str22);
                                                                        _six4.set_bet_time(new DateTime?(DateTime.Now));
                                                                        _six4.set_checkcode(str8);
                                                                        _six4.set_odds_id(new int?(int.Parse(oddsid)));
                                                                        _six4.set_category(table10.Rows[0]["category"].ToString());
                                                                        _six4.set_play_id(new int?(int.Parse(table10.Rows[0]["play_id"].ToString())));
                                                                        _six4.set_play_name(table10.Rows[0]["o_play_name"].ToString());
                                                                        _six4.set_bet_val(str6);
                                                                        _six4.set_odds(str45);
                                                                        _six4.set_amount(new decimal?(decimal.Parse(s)));
                                                                        _six4.set_profit(0);
                                                                        _six4.set_isLM(1);
                                                                        _six4.set_unit_cnt(1);
                                                                        _six4.set_lm_type(0);
                                                                        _six4.set_bet_group(str6);
                                                                        _six4.set_bet_wt("");
                                                                        _six4.set_hy_drawback(new decimal?(decimal.Parse(str34)));
                                                                        _six4.set_dl_drawback(new decimal?(decimal.Parse(str33)));
                                                                        _six4.set_zd_drawback(new decimal?(decimal.Parse(str32)));
                                                                        _six4.set_gd_drawback(new decimal?(decimal.Parse(str31)));
                                                                        _six4.set_fgs_drawback(new decimal?(decimal.Parse(str30)));
                                                                        _six4.set_zj_drawback(new decimal?(decimal.Parse(str29)));
                                                                        _six4.set_dl_rate((float) int.Parse(_rate.get_dlzc()));
                                                                        _six4.set_zd_rate((float) int.Parse(_rate.get_zdzc()));
                                                                        _six4.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                                                                        _six4.set_fgs_rate((float) int.Parse(num2.ToString()));
                                                                        _six4.set_zj_rate((float) int.Parse(num.ToString()));
                                                                        _six4.set_is_payment(0);
                                                                        _six4.set_dl_name(_rate.get_dlname());
                                                                        _six4.set_zd_name(_rate.get_zdname());
                                                                        _six4.set_gd_name(_rate.get_gdname());
                                                                        _six4.set_fgs_name(_rate.get_fgsname());
                                                                        _six4.set_sale_type(1);
                                                                        _six4.set_m_type(-2);
                                                                        _six4.set_kind(str15);
                                                                        _six4.set_ip(LSRequest.GetIP());
                                                                        _six4.set_lottery_type(100);
                                                                        _six4.set_lottery_name(base.GetGameNameByID(_six4.get_lottery_type().ToString()));
                                                                        _six4.set_ordervalidcode(Utils.GetOrderValidCode(_six4.get_u_name(), _six4.get_order_num(), _six4.get_bet_val(), _six4.get_odds(), _six4.get_kind(), Convert.ToInt32(_six4.get_phase_id()), Convert.ToInt32(_six4.get_odds_id()), Convert.ToDouble(_six4.get_amount())));
                                                                        _six4.set_odds_zj(str41);
                                                                        _six4.set_bet_wt_zj("");
                                                                        int num17 = 0;
                                                                        if (!CallBLL.cz_autosale_six_ex_bll.AddBet_ex(_six4, decimal.Parse(s), str7, ref num17, str12, str14) || (num17 <= 0))
                                                                        {
                                                                            result.set_tipinfo(string.Format("內網目標系統提示：系統錯誤！", new object[0]));
                                                                            result.set_success(400);
                                                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                                                            result.set_data(dictionary);
                                                                            strResult = JsonHandle.ObjectToJson(result);
                                                                        }
                                                                        else
                                                                        {
                                                                            double num18 = double.Parse(str45.Split(new char[] { ',' })[0]);
                                                                            double num19 = 0.0;
                                                                            if (str45.Split(new char[] { ',' }).Length > 1)
                                                                            {
                                                                                num19 = double.Parse(str45.Split(new char[] { ',' })[1]);
                                                                            }
                                                                            double num20 = double.Parse(str41.Split(new char[] { ',' })[0]);
                                                                            double num21 = 0.0;
                                                                            if (str41.Split(new char[] { ',' }).Length > 1)
                                                                            {
                                                                                num21 = double.Parse(str41.Split(new char[] { ',' })[1]);
                                                                            }
                                                                            cz_splitgroup_six _six5 = new cz_splitgroup_six();
                                                                            _six5.set_order_num(orderNumber);
                                                                            _six5.set_odds1(new decimal?(decimal.Parse(num18.ToString())));
                                                                            _six5.set_odds2(new decimal?(decimal.Parse(num19.ToString())));
                                                                            _six5.set_odds_id(new int?(int.Parse(oddsid)));
                                                                            _six5.set_item(str6);
                                                                            _six5.set_item_money(new decimal?(decimal.Parse(s)));
                                                                            _six5.set_odds1_zj(new decimal?(decimal.Parse(num20.ToString())));
                                                                            _six5.set_odds2_zj(new decimal?(decimal.Parse(num21.ToString())));
                                                                            CallBLL.cz_autosale_six_ex_bll.SplitgroupAdd_ex(_six5, str12, str14);
                                                                            double num22 = (double.Parse(s) * double.Parse(_rate.get_zjzc())) / 100.0;
                                                                            CallBLL.cz_autosale_six_ex_bll.UpdateGrandTotal_ex(Convert.ToDecimal(num22), int.Parse(oddsid), str12, str14);
                                                                            double num23 = double.Parse(table11.Rows[0]["grand_total"].ToString()) + num22;
                                                                            double num24 = double.Parse(table11.Rows[0]["downbase"].ToString());
                                                                            double num25 = Math.Floor((double) (num23 / num24));
                                                                            if (num25 >= 1.0)
                                                                            {
                                                                                double num26 = double.Parse(table11.Rows[0]["down_odds_rate"].ToString()) * num25;
                                                                                double num27 = num23 - (num24 * num25);
                                                                                if (str38.Equals("1"))
                                                                                {
                                                                                    CallBLL.cz_autosale_six_ex_bll.UpdateGrandTotalCurrentOdds_DoubleOdds_ex(num26.ToString(), num27.ToString(), oddsid, str12, sqlconn, str14);
                                                                                }
                                                                                else
                                                                                {
                                                                                    CallBLL.cz_autosale_six_ex_bll.UpdateGrandTotalCurrentOdds_ex(num26.ToString(), num27.ToString(), oddsid, str12, str14);
                                                                                }
                                                                                cz_system_log _log = new cz_system_log();
                                                                                _log.set_user_name("系統");
                                                                                _log.set_children_name("");
                                                                                _log.set_category(table11.Rows[0]["category"].ToString());
                                                                                _log.set_play_name(str42);
                                                                                _log.set_put_amount(str43);
                                                                                num33 = 100;
                                                                                _log.set_l_name(base.GetGameNameByID(num33.ToString()));
                                                                                _log.set_l_phase(str22);
                                                                                _log.set_action("降賠率");
                                                                                _log.set_odds_id(int.Parse(oddsid));
                                                                                string str55 = table11.Rows[0]["current_odds"].ToString();
                                                                                _log.set_old_val(str55);
                                                                                if (str55.Split(new char[] { ',' }).Length > 1)
                                                                                {
                                                                                    num35 = double.Parse(str55.Split(new char[] { ',' })[0]) - num26;
                                                                                    num35 = double.Parse(str55.Split(new char[] { ',' })[1]) - num26;
                                                                                    _log.set_new_val(num35.ToString() + "," + num35.ToString());
                                                                                }
                                                                                else
                                                                                {
                                                                                    num35 = double.Parse(str55) - num26;
                                                                                    _log.set_new_val(num35.ToString());
                                                                                }
                                                                                _log.set_ip(LSRequest.GetIP());
                                                                                _log.set_add_time(DateTime.Now);
                                                                                _log.set_note("系統自動降賠");
                                                                                _log.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                                                                _log.set_lottery_type(100);
                                                                                CallBLL.cz_autosale_six_ex_bll.SystemLogAdd_ex(_log, str12, str14);
                                                                                cz_jp_odds _odds = new cz_jp_odds();
                                                                                _odds.set_add_time(DateTime.Now);
                                                                                _odds.set_odds_id(int.Parse(oddsid));
                                                                                _odds.set_phase_id(int.Parse(str23));
                                                                                _odds.set_play_name(str42);
                                                                                _odds.set_put_amount(str43);
                                                                                _odds.set_odds(num26.ToString());
                                                                                _odds.set_lottery_type(100);
                                                                                _odds.set_phase(str22);
                                                                                _odds.set_old_odds(str55);
                                                                                if (str55.Split(new char[] { ',' }).Length > 1)
                                                                                {
                                                                                    num35 = double.Parse(str55.Split(new char[] { ',' })[0]) - num26;
                                                                                    num35 = double.Parse(str55.Split(new char[] { ',' })[1]) - num26;
                                                                                    _odds.set_new_odds(num35.ToString() + "," + num35.ToString());
                                                                                }
                                                                                else
                                                                                {
                                                                                    _odds.set_new_odds((double.Parse(str55) - num26).ToString());
                                                                                }
                                                                                CallBLL.cz_autosale_six_ex_bll.JPOddsAdd_ex(_odds, str12, str14);
                                                                            }
                                                                            num14++;
                                                                            cz_bet_six _six6 = new cz_bet_six();
                                                                            _six6.set_order_num(_six4.get_order_num());
                                                                            _six6.set_u_name(_six4.get_u_name());
                                                                            _six6.set_u_nicker(_six4.get_u_nicker());
                                                                            _six6.set_phase_id(new int?(int.Parse(str23)));
                                                                            _six6.set_phase(str22);
                                                                            _six6.set_bet_time(new DateTime?(DateTime.Now));
                                                                            _six6.set_checkcode(str8);
                                                                            _six6.set_odds_id(new int?(int.Parse(oddsid)));
                                                                            _six6.set_category(table10.Rows[0]["category"].ToString());
                                                                            _six6.set_play_id(new int?(int.Parse(table10.Rows[0]["play_id"].ToString())));
                                                                            _six6.set_play_name(table10.Rows[0]["o_play_name"].ToString());
                                                                            _six6.set_bet_val(str6);
                                                                            _six6.set_odds(str45);
                                                                            _six6.set_amount(new decimal?(decimal.Parse(s)));
                                                                            _six6.set_profit(0);
                                                                            _six6.set_isLM(1);
                                                                            _six6.set_unit_cnt(1);
                                                                            _six6.set_lm_type(0);
                                                                            _six6.set_bet_group(str6);
                                                                            _six6.set_bet_wt("");
                                                                            _six6.set_hy_drawback(new decimal?(decimal.Parse(str34)));
                                                                            _six6.set_dl_drawback(new decimal?(decimal.Parse(str33)));
                                                                            _six6.set_zd_drawback(new decimal?(decimal.Parse(str32)));
                                                                            _six6.set_gd_drawback(new decimal?(decimal.Parse(str31)));
                                                                            _six6.set_fgs_drawback(new decimal?(decimal.Parse(str30)));
                                                                            _six6.set_zj_drawback(new decimal?(decimal.Parse(str29)));
                                                                            _six6.set_dl_rate(0f);
                                                                            _six6.set_zd_rate(0f);
                                                                            _six6.set_gd_rate(0f);
                                                                            _six6.set_fgs_rate(0f);
                                                                            _six6.set_zj_rate(0f);
                                                                            _six6.set_is_payment(0);
                                                                            _six6.set_dl_name("");
                                                                            _six6.set_zd_name("");
                                                                            _six6.set_gd_name("");
                                                                            _six6.set_fgs_name(context.Session["user_name"].ToString());
                                                                            _six6.set_sale_type(1);
                                                                            _six6.set_m_type(-2);
                                                                            _six6.set_kind(str15.ToUpper());
                                                                            _six6.set_ip(LSRequest.GetIP());
                                                                            _six6.set_lottery_type(100);
                                                                            _six6.set_lottery_name(base.GetGameNameByID(_six6.get_lottery_type().ToString()));
                                                                            _six6.set_ordervalidcode(Utils.GetOrderValidCode(_six6.get_u_name(), _six6.get_order_num(), _six6.get_bet_val(), _six6.get_odds(), _six6.get_kind(), Convert.ToInt32(_six6.get_phase_id()), Convert.ToInt32(_six6.get_odds_id()), Convert.ToDouble(_six6.get_amount())));
                                                                            _six6.set_bet_wt_zj("");
                                                                            _six6.set_odds_zj(_six4.get_odds());
                                                                            int num28 = 0;
                                                                            CallBLL.cz_bet_six_bll.AddBHBetByZJ(_six6, ref num28);
                                                                            double num29 = double.Parse(str45.Split(new char[] { ',' })[0]);
                                                                            double num30 = 0.0;
                                                                            if (str45.Split(new char[] { ',' }).Length > 1)
                                                                            {
                                                                                num30 = double.Parse(str45.Split(new char[] { ',' })[1]);
                                                                            }
                                                                            cz_splitgroup_six _six7 = new cz_splitgroup_six();
                                                                            _six7.set_order_num(_six6.get_order_num());
                                                                            _six7.set_odds1(new decimal?(decimal.Parse(num29.ToString())));
                                                                            _six7.set_odds2(new decimal?(decimal.Parse(num30.ToString())));
                                                                            _six7.set_odds_id(new int?(int.Parse(oddsid)));
                                                                            _six7.set_item(str6);
                                                                            _six7.set_item_money(new decimal?(decimal.Parse(s)));
                                                                            _six7.set_odds1_zj(new decimal?(decimal.Parse(num29.ToString())));
                                                                            _six7.set_odds2_zj(new decimal?(decimal.Parse(num30.ToString())));
                                                                            CallBLL.cz_splitgroup_six_bll.Add(_six7);
                                                                            string str56 = "";
                                                                            string str57 = "0";
                                                                            string str58 = "0";
                                                                            if (str38.Equals("1"))
                                                                            {
                                                                                str57 = str10.Split(new char[] { ',' })[0];
                                                                                str58 = str10.Split(new char[] { ',' })[1];
                                                                                str56 = ((double.Parse(s) * (double.Parse(str57) - 1.0))).ToString() + "," + (double.Parse(s) * (double.Parse(str58) - 1.0));
                                                                            }
                                                                            else
                                                                            {
                                                                                str57 = str10;
                                                                                str56 = (double.Parse(s) * (double.Parse(str57) - 1.0)).ToString();
                                                                            }
                                                                            string str59 = "";
                                                                            if (str6.Trim() != "")
                                                                            {
                                                                                str59 = str6;
                                                                            }
                                                                            else
                                                                            {
                                                                                str59 = str43;
                                                                            }
                                                                            Dictionary<string, object> dictionary3 = new Dictionary<string, object>();
                                                                            dictionary3.Add("ordernum", orderNumber);
                                                                            dictionary3.Add("playname", str42);
                                                                            dictionary3.Add("ky", str56);
                                                                            dictionary3.Add("putamount", str59);
                                                                            if (str38.Equals("1"))
                                                                            {
                                                                                dictionary3.Add("pl", str57.ToString() + "," + str58.ToString());
                                                                            }
                                                                            else
                                                                            {
                                                                                dictionary3.Add("pl", str57.ToString());
                                                                            }
                                                                            dictionary3.Add("amount", s);
                                                                            if (str37.Equals("1"))
                                                                            {
                                                                                dictionary3.Add("islm", "1");
                                                                            }
                                                                            else
                                                                            {
                                                                                dictionary3.Add("islm", "0");
                                                                            }
                                                                            dictionary.Add("bhdata", dictionary3);
                                                                            new Dictionary<string, object>();
                                                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                                            result.set_data(dictionary);
                                                                            result.set_success(200);
                                                                            strResult = JsonHandle.ObjectToJson(result);
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        public void SaleFast_ex(HttpContext context, ref string strResult)
        {
            ReturnResult result = new ReturnResult();
            result.set_success(400);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "user_allow_sale");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            string str3 = LSRequest.qq("phaseid");
            string str4 = LSRequest.qq("oddsid");
            string str5 = LSRequest.qq("currentodds");
            string s = LSRequest.qq("amount");
            string str7 = LSRequest.qq("s_user");
            LSRequest.qq("pk");
            string str8 = LSRequest.qq("jeucode");
            string[] strArray = str4.Split(new char[] { ',' });
            string[] strArray2 = s.Split(new char[] { ',' });
            string[] strArray3 = str5.Split(new char[] { ',' });
            if (strArray2.Length > 0x31)
            {
                context.Response.End();
            }
            if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str8))
            {
                context.Session["JeuValidate"] = null;
                result.set_success(400);
                new Dictionary<string, object>();
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                context.Session["JeuValidate"] = null;
                if (string.IsNullOrEmpty(str5) || (strArray3.Length <= 0))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100046", "MessageHint"));
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    for (int i = 0; i < strArray2.Length; i++)
                    {
                        if (!base.IsNumber(strArray2[i]))
                        {
                            result.set_tipinfo("下注金額有誤！");
                            result.set_success(500);
                            dictionary.Add("jeucode", base.get_JeuValidate());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str7);
                    if ((user == null) || !user.get_flag().Equals(1))
                    {
                        result.set_tipinfo(PageBase.GetMessageByCache("u100075", "MessageHint"));
                        result.set_success(400);
                        string str9 = base.get_JeuValidate();
                        dictionary.Add("jeucode", str9);
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        string str10 = user.get_salt().ToUpper();
                        string str11 = user.get_sqlconn();
                        string str12 = user.get_sqlconn_write();
                        string str13 = user.get_six_kind().ToUpper();
                        string str14 = user.get_u_nicker();
                        string str15 = "";
                        string str16 = "";
                        Dictionary<string, string> dictionary2 = CallBLL.cz_autosale_six_ex_bll.GetHyUpTypeAndZJName(str7, str10, str11);
                        if (dictionary2 == null)
                        {
                            result.set_tipinfo(PageBase.GetMessageByCache("u100075", "MessageHint"));
                            result.set_success(400);
                            string str17 = base.get_JeuValidate();
                            dictionary.Add("jeucode", str17);
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            str15 = dictionary2["su_type"];
                            str16 = dictionary2["zjname"];
                            user_six_rate _rate = CallBLL.cz_autosale_six_ex_bll.GetRateByAccount_ex(str7, str10, str11, str16);
                            double num2 = 0.0;
                            double num3 = 0.0;
                            if (_rate.get_zcyg().Equals("1"))
                            {
                                num2 = (((100.0 - double.Parse(_rate.get_fgszc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc())) - double.Parse(_rate.get_dlzc());
                                num3 = double.Parse(_rate.get_fgszc());
                            }
                            else
                            {
                                num3 = (((100.0 - double.Parse(_rate.get_zjzc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc())) - double.Parse(_rate.get_dlzc());
                                num2 = double.Parse(_rate.get_zjzc());
                            }
                            int num6 = 1;
                            if (str15.ToLower() != "dl")
                            {
                                num6 = -1;
                            }
                            cz_saleset_six _six2 = CallBLL.cz_saleset_six_bll.GetUser(str7);
                            if (_six2 == null)
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100044", "MessageHint"));
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                string str18 = _six2.get_six_kind().ToUpper();
                                string str19 = "";
                                string str20 = "";
                                string str21 = "";
                                string str22 = "";
                                cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                                if (currentPhase != null)
                                {
                                    if (currentPhase.get_is_closed() == 1)
                                    {
                                        result.set_tipinfo(string.Format("奖期[{0}]已封盘,停止下注！", currentPhase.get_phase().ToString()));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    str19 = currentPhase.get_phase().ToString();
                                    str20 = currentPhase.get_p_id().ToString();
                                }
                                else
                                {
                                    result.set_tipinfo(string.Format("该奖期已停止下注！", new object[0]));
                                    result.set_success(400);
                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                for (int j = 0; j < strArray.Length; j++)
                                {
                                    DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(strArray[j]);
                                    DateTime now = DateTime.Now;
                                    DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                                    DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                                    if ((((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91004") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91007") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91038")))
                                    {
                                        if (time3 < now)
                                        {
                                            result.set_tipinfo(string.Format("已經截止下註！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    else if (time2 < now)
                                    {
                                        result.set_tipinfo(string.Format("已經截止下註！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                foreach (string str23 in strArray)
                                {
                                    DataTable table2 = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(str23);
                                    DateTime time4 = DateTime.Now;
                                    DateTime time5 = Convert.ToDateTime(currentPhase.get_stop_date());
                                    DateTime time6 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                                    if ((table2.Rows[0]["play_id"].ToString().Trim() == "91001") || (table2.Rows[0]["play_id"].ToString().Trim() == "91002"))
                                    {
                                        if (time6 >= time4)
                                        {
                                            continue;
                                        }
                                        result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (time5 < time4)
                                    {
                                        result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                cz_phase_six _six4 = CallBLL.cz_autosale_six_ex_bll.GetCurrentPhase_ex(str10, str11);
                                if (_six4 == null)
                                {
                                    result.set_tipinfo(string.Format("內網目標系統提示：奖期已停止下注！", new object[0]));
                                    result.set_success(400);
                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                else
                                {
                                    List<FastSale> list;
                                    Dictionary<int, string> dictionary3;
                                    string str25;
                                    bool flag;
                                    int? nullable = _six4.get_is_closed();
                                    if (!((nullable.GetValueOrDefault() == 1) && nullable.HasValue))
                                    {
                                        str21 = _six4.get_phase().ToString();
                                        str22 = _six4.get_p_id().ToString();
                                        for (int k = 0; k < strArray.Length; k++)
                                        {
                                            DataTable table3 = CallBLL.cz_autosale_six_ex_bll.GetPlayIDByOddsIds_ex(strArray[k], str10, str11);
                                            DateTime time7 = DateTime.Now;
                                            DateTime time8 = Convert.ToDateTime(_six4.get_stop_date());
                                            DateTime time9 = Convert.ToDateTime(_six4.get_sn_stop_date());
                                            if ((((table3.Rows[0]["play_id"].ToString().Trim() == "91001") || (table3.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((table3.Rows[0]["play_id"].ToString().Trim() == "91004") || (table3.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((table3.Rows[0]["play_id"].ToString().Trim() == "91007") || (table3.Rows[0]["play_id"].ToString().Trim() == "91038")))
                                            {
                                                if (time9 < time7)
                                                {
                                                    result.set_tipinfo(string.Format("內網目標系統提示：已經截止下註！", new object[0]));
                                                    result.set_success(400);
                                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                                    result.set_data(dictionary);
                                                    strResult = JsonHandle.ObjectToJson(result);
                                                    return;
                                                }
                                            }
                                            else if (time8 < time7)
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：已經截止下註！", new object[0]));
                                                result.set_success(400);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                        }
                                        foreach (string str24 in strArray)
                                        {
                                            DataTable table4 = CallBLL.cz_autosale_six_ex_bll.GetPlayIDByOddsIds_ex(str24, str10, str11);
                                            DateTime time10 = DateTime.Now;
                                            DateTime time11 = Convert.ToDateTime(_six4.get_stop_date());
                                            DateTime time12 = Convert.ToDateTime(_six4.get_sn_stop_date());
                                            if ((table4.Rows[0]["play_id"].ToString().Trim() == "91001") || (table4.Rows[0]["play_id"].ToString().Trim() == "91002"))
                                            {
                                                if (time12 >= time10)
                                                {
                                                    continue;
                                                }
                                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                                result.set_success(400);
                                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            if (time11 < time10)
                                            {
                                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                                result.set_success(400);
                                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                        }
                                        if (!str20.Equals(str3))
                                        {
                                            result.set_tipinfo(string.Format("獎期错误！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        if (!str19.Equals(str21))
                                        {
                                            result.set_tipinfo(string.Format("內網目標系統的獎期與當前系統的獎期不一致！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        list = new List<FastSale>();
                                        dictionary3 = new Dictionary<int, string>();
                                        str25 = "";
                                        for (int m = 0; m < strArray.Length; m++)
                                        {
                                            object obj2;
                                            if (m == 0)
                                            {
                                                obj2 = str25;
                                                str25 = string.Concat(new object[] { obj2, strArray[m], ",", Convert.ToInt32(strArray[m]) + 0x31 });
                                            }
                                            else
                                            {
                                                obj2 = str25;
                                                str25 = string.Concat(new object[] { obj2, ",", strArray[m], ",", Convert.ToInt32(strArray[m]) + 0x31 });
                                            }
                                            DataTable table5 = CallBLL.cz_odds_six_bll.GetPlayOddsByID(str25).Tables[0];
                                            DataRow[] rowArray = table5.Select(string.Format(" odds_id={0} ", strArray[m]));
                                            DataRow[] rowArray2 = table5.Select(string.Format(" odds_id={0} ", int.Parse(strArray[m]) + 0x31));
                                            dictionary3.Add(int.Parse(strArray[m]), rowArray[0]["is_open"].ToString());
                                            dictionary3.Add(int.Parse(strArray[m]) + 0x31, rowArray2[0]["is_open"].ToString());
                                        }
                                        flag = false;
                                        foreach (KeyValuePair<int, string> pair in dictionary3)
                                        {
                                            if (pair.Value.Equals("0"))
                                            {
                                                flag = true;
                                                break;
                                            }
                                        }
                                    }
                                    else
                                    {
                                        result.set_tipinfo(string.Format("內網目標系統提示：奖期[{0}]已封盘,停止下注！", _six4.get_phase().ToString()));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (flag)
                                    {
                                        result.set_tipinfo("補貨失敗,特碼A或特碼B存在停盤的玩法，請到具體對應的特碼A或特碼B頁面操作");
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                    else
                                    {
                                        int num43;
                                        DataTable table6 = CallBLL.cz_autosale_six_ex_bll.GetUserRate_ex(_six2.get_u_name(), 1, str10, str11).Tables[0];
                                        string str26 = table6.Rows[0]["su_type"].ToString().Trim();
                                        double num10 = double.Parse(table6.Rows[0]["six_usable_credit"].ToString().Trim());
                                        DataTable oddsTableByOddsIds = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str25);
                                        Dictionary<int, double> dictionary4 = new Dictionary<int, double>();
                                        Dictionary<int, string> dictionary5 = new Dictionary<int, string>();
                                        Dictionary<int, double> dictionary6 = new Dictionary<int, double>();
                                        DataTable table8 = CallBLL.cz_bet_six_bll.GetSZZTByTMABZJ(str20, "91001,91002", model.get_u_name(), str25, str18);
                                        for (int n = 0; n < strArray.Length; n++)
                                        {
                                            int num12 = int.Parse(strArray[n]);
                                            int num13 = int.Parse(strArray[n]) + 0x31;
                                            if (num12 <= 0x16791)
                                            {
                                                DataRow[] rowArray3 = table8.Select(string.Format(" odds_id={0} ", num12));
                                                if (dictionary3[num12].ToString().Equals("1"))
                                                {
                                                    if ((rowArray3 != null) && (rowArray3.Length > 0))
                                                    {
                                                        nullable = null;
                                                        double num14 = Math.Floor(double.Parse(Utils.GetMathRound(double.Parse(rowArray3[0]["szzt"].ToString()), nullable)));
                                                        if (num14 >= 1.0)
                                                        {
                                                            dictionary6.Add(num12, num14);
                                                        }
                                                        else
                                                        {
                                                            dictionary6.Add(num12, 0.0);
                                                        }
                                                    }
                                                    else
                                                    {
                                                        dictionary6.Add(num12, 0.0);
                                                    }
                                                }
                                                else
                                                {
                                                    dictionary6.Add(num12, 0.0);
                                                }
                                                DataRow[] rowArray4 = table8.Select(string.Format(" odds_id={0} ", num13));
                                                if (dictionary3[num13].ToString().Equals("1"))
                                                {
                                                    if ((rowArray4 != null) && (rowArray4.Length > 0))
                                                    {
                                                        nullable = null;
                                                        double num15 = Math.Floor(double.Parse(Utils.GetMathRound(double.Parse(rowArray4[0]["szzt"].ToString()), nullable)));
                                                        if (num15 >= 1.0)
                                                        {
                                                            dictionary6.Add(num13, num15);
                                                        }
                                                        else
                                                        {
                                                            dictionary6.Add(num13, 0.0);
                                                        }
                                                    }
                                                    else
                                                    {
                                                        dictionary6.Add(num13, 0.0);
                                                    }
                                                }
                                                else
                                                {
                                                    dictionary6.Add(num13, 0.0);
                                                }
                                            }
                                        }
                                        if ((dictionary6 != null) && (dictionary6.Count > 0))
                                        {
                                            int num16 = 0;
                                            foreach (KeyValuePair<int, double> pair2 in dictionary6)
                                            {
                                                int key = pair2.Key;
                                                double num18 = 0.0;
                                                if (key <= 0x16791)
                                                {
                                                    double num19 = 0.0;
                                                    double num20 = 0.0;
                                                    for (int num21 = 0; num21 < strArray.Length; num21++)
                                                    {
                                                        if (key.ToString().Equals(strArray[num21]))
                                                        {
                                                            num19 = double.Parse(strArray2[num21]);
                                                            num20 = double.Parse(strArray3[num21]);
                                                        }
                                                    }
                                                    int num22 = pair2.Key + 0x31;
                                                    num18 = pair2.Value + dictionary6[num22];
                                                    double num23 = pair2.Value;
                                                    double num24 = dictionary6[num22];
                                                    num18 = num23 + num24;
                                                    string str27 = dictionary3[key];
                                                    string str28 = dictionary3[num22];
                                                    double num25 = num18;
                                                    if (str27.Equals("0"))
                                                    {
                                                        num25 -= num23;
                                                    }
                                                    if (str28.Equals("0"))
                                                    {
                                                        num25 -= num24;
                                                    }
                                                    if (num19 > num25)
                                                    {
                                                        DataRow[] rowArray5 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", key));
                                                        string str29 = rowArray5[0]["play_name"].ToString();
                                                        string str30 = rowArray5[0]["put_amount"].ToString();
                                                        dictionary5.Add(key, string.Concat(new object[] { str29, ",", str29.Replace('A', 'B'), "|", str30, "|", num20, "|補貨超量！" }));
                                                    }
                                                    else
                                                    {
                                                        double num26 = 0.0;
                                                        double num27 = 0.0;
                                                        if (str27.Equals("1") && (num23 > 0.0))
                                                        {
                                                            if (num19 > num18)
                                                            {
                                                                num26 = num18;
                                                            }
                                                            else if (num19 > num23)
                                                            {
                                                                num26 = num23;
                                                            }
                                                            else
                                                            {
                                                                num26 = num19;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            DataRow[] rowArray6 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", key));
                                                            rowArray6[0]["play_name"].ToString();
                                                            rowArray6[0]["put_amount"].ToString();
                                                            num20.ToString();
                                                        }
                                                        if (str28.Equals("1") && (num24 > 0.0))
                                                        {
                                                            if ((num19 - num26) > num18)
                                                            {
                                                                num27 = num18;
                                                            }
                                                            else if ((num19 - num26) > num24)
                                                            {
                                                                num27 = num24;
                                                            }
                                                            else
                                                            {
                                                                num27 = num19 - num26;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            DataRow[] rowArray7 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", num22));
                                                            rowArray7[0]["play_name"].ToString();
                                                            rowArray7[0]["put_amount"].ToString();
                                                            num20.ToString();
                                                        }
                                                        if (num26 > 0.0)
                                                        {
                                                            dictionary4.Add(key, num26);
                                                        }
                                                        if (num27 > 0.0)
                                                        {
                                                            dictionary4.Add(num22, num27);
                                                        }
                                                        num16++;
                                                    }
                                                }
                                            }
                                        }
                                        else
                                        {
                                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100041", "MessageHint"), currentPhase.get_phase().ToString()));
                                            result.set_success(400);
                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        int index = 0;
                                        List<string> list2 = new List<string>();
                                        List<string> list3 = new List<string>();
                                        foreach (KeyValuePair<int, double> pair3 in dictionary4)
                                        {
                                            DataTable table9 = CallBLL.cz_autosale_six_ex_bll.GetOddsByID_ex(pair3.Key.ToString(), str10, str11).Tables[0];
                                            string str31 = table9.Rows[0]["o_play_name"].ToString();
                                            string str32 = table9.Rows[0]["put_amount"].ToString();
                                            if (table9.Rows[0]["is_open"].ToString().Equals("0"))
                                            {
                                                result.set_success(400);
                                                result.set_tipinfo(string.Format("內網目標系統提示：{0}【{1}】 已停盤！", str31, str32));
                                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            double num29 = 0.0;
                                            DataTable table10 = CallBLL.cz_autosale_six_ex_bll.GetPlayOddsByID_ex(pair3.Key.ToString(), str10, str11).Tables[0];
                                            if (table10.Rows.Count == 0)
                                            {
                                                result.set_success(400);
                                                result.set_tipinfo("內網目標系統提示：賠率ID設置错误!");
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            num43 = 100;
                                            DataTable table11 = CallBLL.cz_autosale_six_ex_bll.GetSinglePhaseByBet_ex(str21, _six2.get_u_name(), num43.ToString(), pair3.Key.ToString(), str10, str11).Tables[0];
                                            string str33 = "";
                                            string str34 = "";
                                            string str35 = "";
                                            string str36 = "";
                                            string str37 = "";
                                            string str38 = "";
                                            double num30 = 0.0;
                                            double num31 = 0.0;
                                            double num32 = 0.0;
                                            foreach (DataRow row in table10.Rows)
                                            {
                                                if (row["odds_id"].ToString().Trim() == pair3.Key.ToString())
                                                {
                                                    str33 = row["is_open"].ToString().Trim();
                                                    str34 = row["play_id"].ToString().Trim();
                                                    str35 = row["play_name"].ToString().Trim();
                                                    str36 = row["put_amount"].ToString().Trim();
                                                    str37 = row["isLM"].ToString().Trim();
                                                    str38 = row["isDoubleOdds"].ToString().Trim();
                                                    num30 = double.Parse(row["allow_min_amount"].ToString().Trim());
                                                    num31 = double.Parse(row["allow_max_amount"].ToString().Trim());
                                                    num32 = double.Parse(row["allow_max_put_amount"].ToString().Trim());
                                                    break;
                                                }
                                            }
                                            if (table11.Rows.Count > 0)
                                            {
                                                foreach (DataRow row2 in table11.Rows)
                                                {
                                                    if (row2["odds_id"].ToString().Trim() == pair3.Key.ToString())
                                                    {
                                                        num29 = double.Parse(row2["sumbet"].ToString().Trim());
                                                        break;
                                                    }
                                                }
                                            }
                                            DataTable table12 = CallBLL.cz_autosale_six_ex_bll.GetDrawbackByPlayId_ex(str34, _six2.get_u_name(), str10, str11).Tables[0];
                                            double num33 = double.Parse(table12.Rows[0]["single_max_amount"].ToString().Trim());
                                            double num34 = double.Parse(table12.Rows[0]["single_min_amount"].ToString().Trim());
                                            double num35 = double.Parse(table12.Rows[0]["single_phase_amount"].ToString().Trim());
                                            if (num33 > num31)
                                            {
                                                num33 = num31;
                                            }
                                            if (num35 > num32)
                                            {
                                                num35 = num32;
                                            }
                                            if (num34 > num30)
                                            {
                                                num30 = num34;
                                            }
                                            if (str33 != "1")
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：{0}<{1}>已經停止投注！", str35, str36));
                                                result.set_success(400);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            double num36 = 0.0;
                                            if (str38.Equals("0"))
                                            {
                                                num36 = double.Parse(CallBLL.cz_autosale_six_ex_bll.GetPlay_ex(pair3.Key.ToString(), _six2.get_u_name(), str11, str13, str10.ToUpper(), null, "", base.get_YearLianID()));
                                                if ((pair3.Key <= 0x16791) && (double.Parse(strArray3[index]) != double.Parse(num36.ToString())))
                                                {
                                                    list2.Add(index.ToString());
                                                    list3.Add(num36.ToString());
                                                }
                                            }
                                            if (double.Parse(s) > num33)
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：下注金額超出單注最大金額！", new object[0]));
                                                result.set_success(500);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            if (double.Parse(s) > num10)
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：下注金額超出可用金額！", new object[0]));
                                                result.set_success(500);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            if (double.Parse(s) < num30)
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：下注金額低過最低金額！", new object[0]));
                                                result.set_success(500);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            if (!str37.Equals("1") && ((double.Parse(s) + num29) > num35))
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：{0}<{1}>下注單期金額超出單期最大金額！", str35, str36));
                                                result.set_success(500);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            index++;
                                        }
                                        if (list3.Count > 0)
                                        {
                                            result.set_tipinfo(string.Format("內網目標系統提示：賠率有變動,請確認後再提交!", new object[0]));
                                            result.set_success(600);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            dictionary.Add("index", list2);
                                            dictionary.Add("newpl", list3);
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                        }
                                        else
                                        {
                                            string str61;
                                            List<cz_bet_six> list4 = new List<cz_bet_six>();
                                            foreach (KeyValuePair<int, double> pair4 in dictionary4)
                                            {
                                                DataTable table13 = CallBLL.cz_autosale_six_ex_bll.GetOddsByID_ex(pair4.Key.ToString(), str10, str11).Tables[0];
                                                int play_id = int.Parse(table13.Rows[0]["play_id"].ToString());
                                                string str40 = table13.Rows[0]["play_name"].ToString();
                                                string str41 = table13.Rows[0]["put_amount"].ToString();
                                                double local1 = pair4.Value;
                                                double num37 = 0.0;
                                                for (int num38 = 0; num38 < strArray.Length; num38++)
                                                {
                                                    if ((pair4.Key > 0x16791) && (pair4.Key <= 0x167c2))
                                                    {
                                                        num43 = pair4.Key - 0x31;
                                                        if (num43.ToString().Equals(strArray[num38]))
                                                        {
                                                            num37 = double.Parse(strArray3[num38]);
                                                        }
                                                    }
                                                    else if (pair4.Key.ToString().Equals(strArray[num38]))
                                                    {
                                                        num37 = double.Parse(strArray3[num38]);
                                                    }
                                                }
                                                string str42 = "";
                                                string str43 = "0";
                                                string str44 = "0";
                                                string str45 = "0";
                                                string str46 = "0";
                                                string str47 = "0";
                                                string str48 = "0";
                                                string orderNumber = Utils.GetOrderNumber();
                                                string str50 = string.Format(" '{0}','{1}','{2}','{3}','{4}','{5}' ", new object[] { str16, _rate.get_fgsname(), _rate.get_gdname(), _rate.get_zdname(), _rate.get_dlname(), _six2.get_u_name() });
                                                foreach (DataRow row3 in CallBLL.cz_autosale_six_ex_bll.GetDrawbackUpNames_ex(str50, str10, str11).AsEnumerable().Where<DataRow>(c => c.Field<int>("play_id") == Convert.ToInt32(play_id)))
                                                {
                                                    str61 = row3["u_type"].ToString().Trim();
                                                    if (str61 != null)
                                                    {
                                                        if (!(str61 == "zj"))
                                                        {
                                                            if (str61 == "fgs")
                                                            {
                                                                goto Label_2272;
                                                            }
                                                            if (str61 == "gd")
                                                            {
                                                                goto Label_2296;
                                                            }
                                                            if (str61 == "zd")
                                                            {
                                                                goto Label_22BA;
                                                            }
                                                            if (str61 == "dl")
                                                            {
                                                                goto Label_22DE;
                                                            }
                                                            if (str61 == "hy")
                                                            {
                                                                goto Label_2302;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            str43 = row3[str18 + "_drawback"].ToString().Trim();
                                                        }
                                                    }
                                                    continue;
                                                Label_2272:
                                                    str44 = row3[str18 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_2296:
                                                    str45 = row3[str18 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_22BA:
                                                    str46 = row3[str18 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_22DE:
                                                    str47 = row3[str18 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_2302:
                                                    switch (str26)
                                                    {
                                                        case "dl":
                                                            str48 = row3[str18 + "_drawback"].ToString().Trim();
                                                            break;

                                                        case "zd":
                                                            str47 = row3[str18 + "_drawback"].ToString().Trim();
                                                            break;

                                                        case "gd":
                                                            str46 = row3[str18 + "_drawback"].ToString().Trim();
                                                            break;

                                                        case "fgs":
                                                            str45 = row3[str18 + "_drawback"].ToString().Trim();
                                                            break;
                                                    }
                                                }
                                                DataTable table15 = CallBLL.cz_autosale_six_ex_bll.GetOddsByID_ex(pair4.Key.ToString(), str10, str11).Tables[0];
                                                string str51 = CallBLL.cz_autosale_six_ex_bll.GetPlay_ex(pair4.Key.ToString(), _six2.get_u_name(), str11, str13, str10.ToUpper(), null, "", base.get_YearLianID());
                                                str42 = (double.Parse(table15.Rows[0]["current_odds"].ToString()) + Convert.ToDouble(table15.Rows[0][str18 + "_diff"].ToString().Trim())).ToString();
                                                cz_bet_six item = new cz_bet_six();
                                                item.set_order_num(Utils.GetOrderNumber());
                                                item.set_checkcode(str8);
                                                item.set_u_name(_six2.get_u_name());
                                                item.set_u_nicker(str14);
                                                item.set_phase_id(new int?(int.Parse(str22)));
                                                item.set_phase(str21);
                                                item.set_bet_time(new DateTime?(DateTime.Now));
                                                item.set_odds_id(new int?(pair4.Key));
                                                item.set_category(table15.Rows[0]["category"].ToString());
                                                item.set_play_id(new int?(int.Parse(table15.Rows[0]["play_id"].ToString())));
                                                item.set_play_name(table15.Rows[0]["o_play_name"].ToString());
                                                item.set_bet_val(table15.Rows[0]["put_amount"].ToString());
                                                item.set_odds(str51);
                                                item.set_bet_wt("");
                                                item.set_amount(new decimal?(decimal.Parse(pair4.Value.ToString())));
                                                item.set_profit(0);
                                                item.set_hy_drawback(new decimal?(decimal.Parse(str48)));
                                                item.set_dl_drawback(new decimal?(decimal.Parse(str47)));
                                                item.set_zd_drawback(new decimal?(decimal.Parse(str46)));
                                                item.set_gd_drawback(new decimal?(decimal.Parse(str45)));
                                                item.set_fgs_drawback(new decimal?(decimal.Parse(str44)));
                                                item.set_zj_drawback(new decimal?(decimal.Parse(str43)));
                                                item.set_dl_rate((float) int.Parse(_rate.get_dlzc()));
                                                item.set_zd_rate((float) int.Parse(_rate.get_zdzc()));
                                                item.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                                                item.set_fgs_rate((float) int.Parse(num3.ToString()));
                                                item.set_zj_rate((float) int.Parse(num2.ToString()));
                                                item.set_is_payment(0);
                                                item.set_dl_name(_rate.get_dlname());
                                                item.set_zd_name(_rate.get_zdname());
                                                item.set_gd_name(_rate.get_gdname());
                                                item.set_fgs_name(_rate.get_fgsname());
                                                item.set_m_type(new int?(num6));
                                                item.set_kind(_six2.get_six_kind().ToUpper());
                                                item.set_ip(LSRequest.GetIP());
                                                item.set_lottery_type(100);
                                                item.set_lottery_name(base.GetGameNameByID(item.get_lottery_type().ToString()));
                                                item.set_isLM(0);
                                                item.set_ordervalidcode(Utils.GetOrderValidCode(item.get_u_name(), item.get_order_num(), item.get_bet_val(), item.get_odds(), item.get_kind(), Convert.ToInt32(item.get_phase_id()), Convert.ToInt32(item.get_odds_id()), Convert.ToDouble(item.get_amount())));
                                                item.set_odds_zj(str42);
                                                item.set_bet_wt_zj("");
                                                int num39 = 0;
                                                if (CallBLL.cz_autosale_six_ex_bll.AddBet_ex(item, decimal.Parse(s), _six2.get_u_name(), ref num39, str10, str12))
                                                {
                                                    list4.Add(item);
                                                    FastSale sale = new FastSale();
                                                    sale.set_success("1");
                                                    sale.set_ordernum(orderNumber);
                                                    sale.set_playname(str40);
                                                    sale.set_putamount(str41);
                                                    string str52 = "";
                                                    str52 = (double.Parse(pair4.Value.ToString()) * (num37 - 1.0)).ToString();
                                                    sale.set_ky(str52);
                                                    sale.set_islm("0");
                                                    sale.set_pl(num37.ToString());
                                                    sale.set_amount(pair4.Value.ToString());
                                                    sale.set_oddsid(pair4.Key.ToString());
                                                    sale.set_message("");
                                                    list.Add(sale);
                                                }
                                            }
                                            if (list4.Count > 0)
                                            {
                                                for (int num41 = 0; num41 < list4.Count; num41++)
                                                {
                                                    cz_bet_six _six6 = list4[num41];
                                                    DataTable table16 = CallBLL.cz_odds_six_bll.GetOddsByID(_six6.get_odds_id().ToString()).Tables[0];
                                                    int play_id = int.Parse(table16.Rows[0]["play_id"].ToString());
                                                    table16.Rows[0]["play_name"].ToString();
                                                    table16.Rows[0]["put_amount"].ToString();
                                                    string str53 = string.Format(" '{0}','{1}','{2}','{3}','{4}','{5}' ", new object[] { str16, _rate.get_fgsname(), _rate.get_gdname(), _rate.get_zdname(), _rate.get_dlname(), _six2.get_u_name() });
                                                    EnumerableRowCollection<DataRow> rows2 = CallBLL.cz_autosale_six_ex_bll.GetDrawbackUpNames_ex(str53, str10, str11).AsEnumerable().Where<DataRow>(c => c.Field<int>("play_id") == Convert.ToInt32(play_id));
                                                    string str54 = "0";
                                                    string str55 = "0";
                                                    string str56 = "0";
                                                    string str57 = "0";
                                                    string str58 = "0";
                                                    string str59 = "0";
                                                    string str60 = "";
                                                    foreach (DataRow row4 in rows2)
                                                    {
                                                        str61 = row4["u_type"].ToString().Trim();
                                                        if (str61 != null)
                                                        {
                                                            if (!(str61 == "zj"))
                                                            {
                                                                if (str61 == "fgs")
                                                                {
                                                                    goto Label_2B2C;
                                                                }
                                                                if (str61 == "gd")
                                                                {
                                                                    goto Label_2B50;
                                                                }
                                                                if (str61 == "zd")
                                                                {
                                                                    goto Label_2B74;
                                                                }
                                                                if (str61 == "dl")
                                                                {
                                                                    goto Label_2B98;
                                                                }
                                                                if (str61 == "hy")
                                                                {
                                                                    goto Label_2BBC;
                                                                }
                                                            }
                                                            else
                                                            {
                                                                str54 = row4[str18 + "_drawback"].ToString().Trim();
                                                            }
                                                        }
                                                        continue;
                                                    Label_2B2C:
                                                        str55 = row4[str18 + "_drawback"].ToString().Trim();
                                                        continue;
                                                    Label_2B50:
                                                        str56 = row4[str18 + "_drawback"].ToString().Trim();
                                                        continue;
                                                    Label_2B74:
                                                        str57 = row4[str18 + "_drawback"].ToString().Trim();
                                                        continue;
                                                    Label_2B98:
                                                        str58 = row4[str18 + "_drawback"].ToString().Trim();
                                                        continue;
                                                    Label_2BBC:
                                                        switch (str26)
                                                        {
                                                            case "dl":
                                                                str59 = row4[str18 + "_drawback"].ToString().Trim();
                                                                break;

                                                            case "zd":
                                                                str58 = row4[str18 + "_drawback"].ToString().Trim();
                                                                break;

                                                            case "gd":
                                                                str57 = row4[str18 + "_drawback"].ToString().Trim();
                                                                break;

                                                            case "fgs":
                                                                str56 = row4[str18 + "_drawback"].ToString().Trim();
                                                                break;
                                                        }
                                                    }
                                                    _six6.get_odds();
                                                    str60 = _six6.get_odds();
                                                    cz_bet_six _six7 = new cz_bet_six();
                                                    _six7.set_order_num(_six6.get_order_num());
                                                    _six7.set_u_name(_six6.get_u_name());
                                                    _six7.set_u_nicker(_six6.get_u_nicker());
                                                    _six7.set_phase_id(new int?(int.Parse(str20)));
                                                    _six7.set_phase(str19);
                                                    _six7.set_bet_time(new DateTime?(DateTime.Now));
                                                    _six7.set_checkcode(_six6.get_checkcode());
                                                    _six7.set_odds_id(_six6.get_odds_id());
                                                    _six7.set_category(_six6.get_category());
                                                    _six7.set_play_id(_six6.get_play_id());
                                                    _six7.set_play_name(_six6.get_play_name());
                                                    _six7.set_bet_val(_six6.get_bet_val());
                                                    _six7.set_odds(_six6.get_odds());
                                                    _six7.set_amount(_six6.get_amount());
                                                    _six7.set_profit(0);
                                                    _six7.set_isLM(0);
                                                    _six7.set_hy_drawback(new decimal?(decimal.Parse(str59)));
                                                    _six7.set_dl_drawback(new decimal?(decimal.Parse(str58)));
                                                    _six7.set_zd_drawback(new decimal?(decimal.Parse(str57)));
                                                    _six7.set_gd_drawback(new decimal?(decimal.Parse(str56)));
                                                    _six7.set_fgs_drawback(new decimal?(decimal.Parse(str55)));
                                                    _six7.set_zj_drawback(new decimal?(decimal.Parse(str54)));
                                                    _six7.set_dl_rate(0f);
                                                    _six7.set_zd_rate(0f);
                                                    _six7.set_gd_rate(0f);
                                                    _six7.set_fgs_rate(0f);
                                                    _six7.set_zj_rate(0f);
                                                    _six7.set_is_payment(0);
                                                    _six7.set_dl_name("");
                                                    _six7.set_zd_name("");
                                                    _six7.set_gd_name("");
                                                    _six7.set_fgs_name(context.Session["user_name"].ToString());
                                                    _six7.set_sale_type(1);
                                                    _six7.set_m_type(-2);
                                                    _six7.set_kind(_six6.get_kind().ToUpper());
                                                    _six7.set_ip(LSRequest.GetIP());
                                                    _six7.set_lottery_type(100);
                                                    _six7.set_lottery_name(base.GetGameNameByID(_six7.get_lottery_type().ToString()));
                                                    _six7.set_ordervalidcode(Utils.GetOrderValidCode(_six7.get_u_name(), _six7.get_order_num(), _six7.get_bet_val(), _six7.get_odds(), _six7.get_kind(), Convert.ToInt32(str20), Convert.ToInt32(_six7.get_odds_id()), Convert.ToDouble(_six7.get_amount())));
                                                    _six7.set_odds_zj(str60);
                                                    int num42 = 0;
                                                    CallBLL.cz_bet_six_bll.AddBHBetByZJ(_six7, ref num42);
                                                }
                                            }
                                            if (dictionary5.Count > 0)
                                            {
                                                foreach (KeyValuePair<int, string> pair5 in dictionary5)
                                                {
                                                    FastSale sale2 = new FastSale();
                                                    sale2.set_success("0");
                                                    sale2.set_ordernum("補貨失敗");
                                                    sale2.set_playname(pair5.Value.ToString().Split(new char[] { '|' })[0]);
                                                    sale2.set_putamount(pair5.Value.ToString().Split(new char[] { '|' })[1]);
                                                    sale2.set_ky("0");
                                                    sale2.set_islm("0");
                                                    sale2.set_pl(pair5.Value.ToString().Split(new char[] { '|' })[2]);
                                                    sale2.set_amount("0");
                                                    sale2.set_oddsid(pair5.Key.ToString());
                                                    sale2.set_message(pair5.Value.ToString().Split(new char[] { '|' })[3]);
                                                    list.Add(sale2);
                                                }
                                            }
                                            dictionary.Add("bhdata", list);
                                            new Dictionary<string, object>();
                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                            result.set_data(dictionary);
                                            result.set_success(200);
                                            strResult = JsonHandle.ObjectToJson(result);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        public void SaleFastAorB_ex(HttpContext context, ref string strResult)
        {
            Func<DataRow, bool> predicate = null;
            ReturnResult result = new ReturnResult();
            result.set_success(400);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "user_allow_sale");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            string str3 = LSRequest.qq("phaseid");
            string str4 = LSRequest.qq("oddsid");
            string str5 = LSRequest.qq("currentodds");
            string str6 = LSRequest.qq("amount");
            string str7 = LSRequest.qq("s_user");
            LSRequest.qq("pk");
            string str8 = LSRequest.qq("jeucode");
            string str9 = LSRequest.qq("playpage");
            string playid = "";
            if (str9.Equals("tma"))
            {
                playid = "91001";
            }
            if (str9.Equals("tmb"))
            {
                playid = "91002";
            }
            string[] strArray = str4.Split(new char[] { ',' });
            string[] strArray2 = str6.Split(new char[] { ',' });
            string[] strArray3 = str5.Split(new char[] { ',' });
            if (strArray2.Length > 0x31)
            {
                context.Response.End();
            }
            if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str8))
            {
                context.Session["JeuValidate"] = null;
                result.set_success(400);
                new Dictionary<string, object>();
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                context.Session["JeuValidate"] = null;
                for (int i = 0; i < strArray2.Length; i++)
                {
                    if (!base.IsNumber(strArray2[i]))
                    {
                        result.set_tipinfo("下注金額有誤！");
                        result.set_success(500);
                        dictionary.Add("jeucode", base.get_JeuValidate());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                }
                if (string.IsNullOrEmpty(str5) || (strArray3.Length <= 0))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100046", "MessageHint"));
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    for (int j = 0; j < strArray2.Length; j++)
                    {
                        if (!base.IsNumber(strArray2[j]))
                        {
                            result.set_tipinfo("下注金額有誤！");
                            result.set_success(500);
                            dictionary.Add("jeucode", base.get_JeuValidate());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str7);
                    if ((user == null) || !user.get_flag().Equals(1))
                    {
                        result.set_tipinfo(PageBase.GetMessageByCache("u100075", "MessageHint"));
                        result.set_success(400);
                        string str10 = base.get_JeuValidate();
                        dictionary.Add("jeucode", str10);
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        string str11 = user.get_salt().ToUpper();
                        string str12 = user.get_sqlconn();
                        string str13 = user.get_sqlconn_write();
                        string str14 = user.get_six_kind().ToUpper();
                        string str15 = user.get_u_nicker();
                        string str16 = "";
                        string str17 = "";
                        Dictionary<string, string> dictionary2 = CallBLL.cz_autosale_six_ex_bll.GetHyUpTypeAndZJName(str7, str11, str12);
                        if (dictionary2 == null)
                        {
                            result.set_tipinfo(PageBase.GetMessageByCache("u100075", "MessageHint"));
                            result.set_success(400);
                            string str18 = base.get_JeuValidate();
                            dictionary.Add("jeucode", str18);
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            str16 = dictionary2["su_type"];
                            str17 = dictionary2["zjname"];
                            user_six_rate _rate = CallBLL.cz_autosale_six_ex_bll.GetRateByAccount_ex(str7, str11, str12, str17);
                            double num3 = 0.0;
                            double num4 = 0.0;
                            if (_rate.get_zcyg().Equals("1"))
                            {
                                num3 = (((100.0 - double.Parse(_rate.get_fgszc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc())) - double.Parse(_rate.get_dlzc());
                                num4 = double.Parse(_rate.get_fgszc());
                            }
                            else
                            {
                                num4 = (((100.0 - double.Parse(_rate.get_zjzc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc())) - double.Parse(_rate.get_dlzc());
                                num3 = double.Parse(_rate.get_zjzc());
                            }
                            int num7 = 1;
                            if (str16.ToLower() != "dl")
                            {
                                num7 = -1;
                            }
                            cz_saleset_six _six2 = CallBLL.cz_saleset_six_bll.GetUser(str7);
                            if (_six2 == null)
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100044", "MessageHint"));
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                string str19 = _six2.get_six_kind().ToUpper();
                                string str20 = "";
                                string s = "";
                                string str22 = "";
                                string str23 = "";
                                cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                                if (currentPhase != null)
                                {
                                    if (currentPhase.get_is_closed() == 1)
                                    {
                                        result.set_tipinfo(string.Format("奖期[{0}]已封盘,停止下注！", currentPhase.get_phase().ToString()));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    str20 = currentPhase.get_phase().ToString();
                                    s = currentPhase.get_p_id().ToString();
                                }
                                else
                                {
                                    result.set_tipinfo(string.Format("该奖期已停止下注！", new object[0]));
                                    result.set_success(400);
                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                for (int k = 0; k < strArray.Length; k++)
                                {
                                    DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(strArray[k]);
                                    DateTime now = DateTime.Now;
                                    DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                                    DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                                    if (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == playid)
                                    {
                                        if (time3 < now)
                                        {
                                            result.set_tipinfo(string.Format("已經截止下註！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    else if (time2 < now)
                                    {
                                        result.set_tipinfo(string.Format("已經截止下註！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                foreach (string str24 in strArray)
                                {
                                    DataTable table2 = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(str24);
                                    DateTime time4 = DateTime.Now;
                                    DateTime time5 = Convert.ToDateTime(currentPhase.get_stop_date());
                                    DateTime time6 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                                    if (table2.Rows[0]["play_id"].ToString().Trim() == playid)
                                    {
                                        if (time6 >= time4)
                                        {
                                            continue;
                                        }
                                        result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (time5 < time4)
                                    {
                                        result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                cz_phase_six _six4 = CallBLL.cz_autosale_six_ex_bll.GetCurrentPhase_ex(str11, str12);
                                if (_six4 == null)
                                {
                                    result.set_tipinfo(string.Format("內網目標系統提示：奖期已停止下注！", new object[0]));
                                    result.set_success(400);
                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                else if (_six4.get_is_closed() != 1)
                                {
                                    str22 = _six4.get_phase().ToString();
                                    str23 = _six4.get_p_id().ToString();
                                    for (int m = 0; m < strArray.Length; m++)
                                    {
                                        DataTable table3 = CallBLL.cz_autosale_six_ex_bll.GetPlayIDByOddsIds_ex(strArray[m], str11, str12);
                                        DateTime time7 = DateTime.Now;
                                        DateTime time8 = Convert.ToDateTime(_six4.get_stop_date());
                                        DateTime time9 = Convert.ToDateTime(_six4.get_sn_stop_date());
                                        if (table3.Rows[0]["play_id"].ToString().Trim() == playid)
                                        {
                                            if (time9 < time7)
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：已經截止下註！", new object[0]));
                                                result.set_success(400);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                        }
                                        else if (time8 < time7)
                                        {
                                            result.set_tipinfo(string.Format("內網目標系統提示：已經截止下註！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    foreach (string str25 in strArray)
                                    {
                                        DataTable table4 = CallBLL.cz_autosale_six_ex_bll.GetPlayIDByOddsIds_ex(str25, str11, str12);
                                        DateTime time10 = DateTime.Now;
                                        DateTime time11 = Convert.ToDateTime(_six4.get_stop_date());
                                        DateTime time12 = Convert.ToDateTime(_six4.get_sn_stop_date());
                                        if (table4.Rows[0]["play_id"].ToString().Trim() == playid)
                                        {
                                            if (time12 >= time10)
                                            {
                                                continue;
                                            }
                                            result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                            result.set_success(400);
                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        if (time11 < time10)
                                        {
                                            result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                            result.set_success(400);
                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    if (!s.Equals(str3))
                                    {
                                        result.set_tipinfo(string.Format("獎期错误！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                    else if (!str20.Equals(str22))
                                    {
                                        result.set_tipinfo(string.Format("內網目標系統的獎期與當前系統的獎期不一致！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                    else
                                    {
                                        string str59;
                                        DataTable table5 = CallBLL.cz_autosale_six_ex_bll.GetUserRate_ex(_six2.get_u_name(), 1, str11, str12).Tables[0];
                                        string str26 = table5.Rows[0]["su_type"].ToString().Trim();
                                        double num10 = double.Parse(table5.Rows[0]["six_usable_credit"].ToString().Trim());
                                        List<FastSale> list = new List<FastSale>();
                                        int index = 0;
                                        foreach (string str27 in strArray)
                                        {
                                            DataTable table6 = CallBLL.cz_odds_six_bll.GetOddsByID(str27).Tables[0];
                                            string str28 = table6.Rows[0]["o_play_name"].ToString();
                                            string str29 = table6.Rows[0]["put_amount"].ToString();
                                            if (table6.Rows[0]["is_open"].ToString().Equals("0"))
                                            {
                                                FastSale item = new FastSale();
                                                item.set_success("0");
                                                item.set_ordernum("補貨失敗");
                                                item.set_playname(str28);
                                                item.set_putamount(str29);
                                                item.set_ky("0");
                                                item.set_islm("0");
                                                item.set_pl(strArray3[index]);
                                                item.set_amount(strArray2[index]);
                                                item.set_oddsid(str27);
                                                item.set_message(string.Format("當前系統提示< {0}【{1}】 已停盤！>", str28, str29));
                                                list.Add(item);
                                            }
                                            double num12 = double.Parse(CallBLL.cz_bet_six_bll.GetSZZTByTMABZJ(s, playid, model.get_u_name(), str27, str19).Rows[0]["szzt"].ToString());
                                            if (double.Parse(strArray2[index]) > num12)
                                            {
                                                FastSale sale2 = new FastSale();
                                                sale2.set_success("0");
                                                sale2.set_ordernum("補貨失敗");
                                                sale2.set_playname(str28);
                                                sale2.set_putamount(str29);
                                                sale2.set_ky("0");
                                                sale2.set_islm("0");
                                                sale2.set_pl(strArray3[index]);
                                                sale2.set_amount(strArray2[index]);
                                                sale2.set_oddsid(str27);
                                                sale2.set_message(string.Format("當前系統提示< {0}【{1}】 補貨超量！>", str28, str29));
                                                list.Add(sale2);
                                            }
                                            index++;
                                        }
                                        int num13 = 0;
                                        new List<string>();
                                        new List<string>();
                                        List<FastSale> list2 = new List<FastSale>();
                                        foreach (string str31 in strArray)
                                        {
                                            DataTable table8 = CallBLL.cz_autosale_six_ex_bll.GetOddsByID_ex(str31, str11, str12).Tables[0];
                                            string str32 = table8.Rows[0]["o_play_name"].ToString();
                                            string str33 = table8.Rows[0]["put_amount"].ToString();
                                            if (table8.Rows[0]["is_open"].ToString().Equals("0"))
                                            {
                                                FastSale sale3 = new FastSale();
                                                sale3.set_success("0");
                                                sale3.set_ordernum("補貨失敗");
                                                sale3.set_playname(str32);
                                                sale3.set_putamount(str33);
                                                sale3.set_ky("0");
                                                sale3.set_islm("0");
                                                sale3.set_pl(strArray3[num13]);
                                                sale3.set_amount(strArray2[num13]);
                                                sale3.set_oddsid(str31);
                                                sale3.set_message(string.Format("內網目標系統提示< {0}【{1}】 已停盤！>", str32, str33));
                                                list2.Add(sale3);
                                            }
                                            double num14 = 0.0;
                                            DataTable table9 = CallBLL.cz_autosale_six_ex_bll.GetPlayOddsByID_ex(str31, str11, str12).Tables[0];
                                            if (table9.Rows.Count == 0)
                                            {
                                                FastSale sale4 = new FastSale();
                                                sale4.set_success("0");
                                                sale4.set_ordernum("補貨失敗");
                                                sale4.set_playname(str32);
                                                sale4.set_putamount(str33);
                                                sale4.set_ky("0");
                                                sale4.set_islm("0");
                                                sale4.set_pl(strArray3[num13]);
                                                sale4.set_amount(strArray2[num13]);
                                                sale4.set_oddsid(str31);
                                                sale4.set_message("內網目標系統提示< 賠率ID設置错误！>");
                                                list2.Add(sale4);
                                            }
                                            int num29 = 100;
                                            DataTable table10 = CallBLL.cz_autosale_six_ex_bll.GetSinglePhaseByBet_ex(str22, _six2.get_u_name(), num29.ToString(), str31, str11, str12).Tables[0];
                                            string str34 = "";
                                            string str35 = "";
                                            string str36 = "";
                                            string str37 = "";
                                            double num15 = 0.0;
                                            double num16 = 0.0;
                                            double num17 = 0.0;
                                            foreach (DataRow row in table9.Rows)
                                            {
                                                if (row["odds_id"].ToString().Trim() == str31)
                                                {
                                                    str34 = row["is_open"].ToString().Trim();
                                                    str35 = row["play_id"].ToString().Trim();
                                                    str36 = row["play_name"].ToString().Trim();
                                                    str37 = row["put_amount"].ToString().Trim();
                                                    row["isLM"].ToString().Trim();
                                                    row["isDoubleOdds"].ToString().Trim();
                                                    num15 = double.Parse(row["allow_min_amount"].ToString().Trim());
                                                    num16 = double.Parse(row["allow_max_amount"].ToString().Trim());
                                                    num17 = double.Parse(row["allow_max_put_amount"].ToString().Trim());
                                                    break;
                                                }
                                            }
                                            if (table10.Rows.Count > 0)
                                            {
                                                foreach (DataRow row2 in table10.Rows)
                                                {
                                                    if (row2["odds_id"].ToString().Trim() == str31)
                                                    {
                                                        num14 = double.Parse(row2["sumbet"].ToString().Trim());
                                                        break;
                                                    }
                                                }
                                            }
                                            DataTable table11 = CallBLL.cz_autosale_six_ex_bll.GetDrawbackByPlayId_ex(str35, _six2.get_u_name(), str11, str12).Tables[0];
                                            double num18 = double.Parse(table11.Rows[0]["single_max_amount"].ToString().Trim());
                                            double num19 = double.Parse(table11.Rows[0]["single_min_amount"].ToString().Trim());
                                            double num20 = double.Parse(table11.Rows[0]["single_phase_amount"].ToString().Trim());
                                            if (num18 > num16)
                                            {
                                                num18 = num16;
                                            }
                                            if (num20 > num17)
                                            {
                                                num20 = num17;
                                            }
                                            if (num19 > num15)
                                            {
                                                num15 = num19;
                                            }
                                            if (str34 != "1")
                                            {
                                                FastSale sale5 = new FastSale();
                                                sale5.set_success("0");
                                                sale5.set_ordernum("補貨失敗");
                                                sale5.set_playname(str32);
                                                sale5.set_putamount(str33);
                                                sale5.set_ky("0");
                                                sale5.set_islm("0");
                                                sale5.set_pl(strArray3[num13]);
                                                sale5.set_amount(strArray2[num13]);
                                                sale5.set_oddsid(str31);
                                                sale5.set_message(string.Format("內網目標系統提示< {0}<{1}>已經停止投注！>", str36, str37));
                                                list2.Add(sale5);
                                            }
                                            double num21 = 0.0;
                                            num21 = double.Parse(CallBLL.cz_autosale_six_ex_bll.GetPlay_ex(str31, _six2.get_u_name(), str12, str14, str11.ToUpper(), null, "", base.get_YearLianID()));
                                            if (double.Parse(strArray3[num13]) != double.Parse(num21.ToString()))
                                            {
                                                FastSale sale6 = new FastSale();
                                                sale6.set_success("0");
                                                sale6.set_ordernum("補貨失敗");
                                                sale6.set_playname(str32);
                                                sale6.set_putamount(str33);
                                                sale6.set_ky("0");
                                                sale6.set_islm("0");
                                                sale6.set_pl(strArray3[num13]);
                                                sale6.set_amount(strArray2[num13]);
                                                sale6.set_oddsid(str31);
                                                sale6.set_message(string.Format("內網目標系統提示< {0}<{1}>賠率變動！>", str36, str37));
                                                list2.Add(sale6);
                                            }
                                            if (double.Parse(strArray2[num13]) > num18)
                                            {
                                                FastSale sale7 = new FastSale();
                                                sale7.set_success("0");
                                                sale7.set_ordernum("補貨失敗");
                                                sale7.set_playname(str32);
                                                sale7.set_putamount(str33);
                                                sale7.set_ky("0");
                                                sale7.set_islm("0");
                                                sale7.set_pl(strArray3[num13]);
                                                sale7.set_amount(strArray2[num13]);
                                                sale7.set_oddsid(str31);
                                                sale7.set_message("內網目標系統提示< 補貨超量！>");
                                                list2.Add(sale7);
                                            }
                                            if (double.Parse(strArray2[num13]) > num10)
                                            {
                                                FastSale sale8 = new FastSale();
                                                sale8.set_success("0");
                                                sale8.set_ordernum("補貨失敗");
                                                sale8.set_playname(str32);
                                                sale8.set_putamount(str33);
                                                sale8.set_ky("0");
                                                sale8.set_islm("0");
                                                sale8.set_pl(strArray3[num13]);
                                                sale8.set_amount(strArray2[num13]);
                                                sale8.set_oddsid(str31);
                                                sale8.set_message("內網目標系統提示 <補貨金額超量超出可用金額！>");
                                                list2.Add(sale8);
                                            }
                                            if (double.Parse(strArray2[num13]) < num15)
                                            {
                                                FastSale sale9 = new FastSale();
                                                sale9.set_success("0");
                                                sale9.set_ordernum("補貨失敗");
                                                sale9.set_playname(str32);
                                                sale9.set_putamount(str33);
                                                sale9.set_ky("0");
                                                sale9.set_islm("0");
                                                sale9.set_pl(strArray3[num13]);
                                                sale9.set_amount(strArray2[num13]);
                                                sale9.set_oddsid(str31);
                                                sale9.set_message("內網目標系統提示< 補貨金額低過最低金額！>");
                                                list2.Add(sale9);
                                            }
                                            if ((double.Parse(strArray2[num13]) + num14) > num20)
                                            {
                                                FastSale sale10 = new FastSale();
                                                sale10.set_success("0");
                                                sale10.set_ordernum("補貨失敗");
                                                sale10.set_playname(str32);
                                                sale10.set_putamount(str33);
                                                sale10.set_ky("0");
                                                sale10.set_islm("0");
                                                sale10.set_pl(strArray3[num13]);
                                                sale10.set_amount(strArray2[num13]);
                                                sale10.set_oddsid(str31);
                                                sale10.set_message(string.Format("內網目標系統提示：{0}【{1}】下注單期金額超出單期最大金額！", str36, str37));
                                                list2.Add(sale10);
                                            }
                                            num13++;
                                        }
                                        int num22 = 0;
                                        List<cz_bet_six> list3 = new List<cz_bet_six>();
                                        foreach (string str39 in strArray)
                                        {
                                            bool flag = false;
                                            bool flag2 = false;
                                            for (int n = 0; n < list.Count; n++)
                                            {
                                                FastSale sale11 = list[n];
                                                if (str39.Equals(sale11.get_oddsid()))
                                                {
                                                    flag = true;
                                                    break;
                                                }
                                            }
                                            for (int num24 = 0; num24 < list2.Count; num24++)
                                            {
                                                FastSale sale12 = list2[num24];
                                                if (str39.Equals(sale12.get_oddsid()))
                                                {
                                                    flag2 = true;
                                                    break;
                                                }
                                            }
                                            if (!flag && !flag2)
                                            {
                                                string str40 = "";
                                                string str41 = "0";
                                                string str42 = "0";
                                                string str43 = "0";
                                                string str44 = "0";
                                                string str45 = "0";
                                                string str46 = "0";
                                                string orderNumber = Utils.GetOrderNumber();
                                                string str48 = string.Format(" '{0}','{1}','{2}','{3}','{4}','{5}' ", new object[] { str17, _rate.get_fgsname(), _rate.get_gdname(), _rate.get_zdname(), _rate.get_dlname(), _six2.get_u_name() });
                                                if (predicate == null)
                                                {
                                                    predicate = c => c.Field<int>("play_id") == Convert.ToInt32(playid);
                                                }
                                                foreach (DataRow row3 in CallBLL.cz_autosale_six_ex_bll.GetDrawbackUpNames_ex(str48, str11, str12).AsEnumerable().Where<DataRow>(predicate))
                                                {
                                                    str59 = row3["u_type"].ToString().Trim();
                                                    if (str59 != null)
                                                    {
                                                        if (!(str59 == "zj"))
                                                        {
                                                            if (str59 == "fgs")
                                                            {
                                                                goto Label_1BA1;
                                                            }
                                                            if (str59 == "gd")
                                                            {
                                                                goto Label_1BC5;
                                                            }
                                                            if (str59 == "zd")
                                                            {
                                                                goto Label_1BE9;
                                                            }
                                                            if (str59 == "dl")
                                                            {
                                                                goto Label_1C0D;
                                                            }
                                                            if (str59 == "hy")
                                                            {
                                                                goto Label_1C31;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            str41 = row3[str19 + "_drawback"].ToString().Trim();
                                                        }
                                                    }
                                                    continue;
                                                Label_1BA1:
                                                    str42 = row3[str19 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_1BC5:
                                                    str43 = row3[str19 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_1BE9:
                                                    str44 = row3[str19 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_1C0D:
                                                    str45 = row3[str19 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_1C31:
                                                    if (str26 == "dl")
                                                    {
                                                        str46 = row3[str19 + "_drawback"].ToString().Trim();
                                                    }
                                                    else if (str26 == "zd")
                                                    {
                                                        str45 = row3[str19 + "_drawback"].ToString().Trim();
                                                    }
                                                    else if (str26 == "gd")
                                                    {
                                                        str44 = row3[str19 + "_drawback"].ToString().Trim();
                                                    }
                                                    else if (str26 == "fgs")
                                                    {
                                                        str43 = row3[str19 + "_drawback"].ToString().Trim();
                                                    }
                                                }
                                                DataTable table13 = CallBLL.cz_autosale_six_ex_bll.GetOddsByID_ex(str39, str11, str12).Tables[0];
                                                string str49 = CallBLL.cz_autosale_six_ex_bll.GetPlay_ex(str39, _six2.get_u_name(), str12, str14, str11.ToUpper(), null, "", base.get_YearLianID());
                                                str40 = (double.Parse(table13.Rows[0]["current_odds"].ToString()) + Convert.ToDouble(table13.Rows[0][str19 + "_diff"].ToString().Trim())).ToString();
                                                cz_bet_six _six5 = new cz_bet_six();
                                                _six5.set_order_num(Utils.GetOrderNumber());
                                                _six5.set_checkcode(str8);
                                                _six5.set_u_name(_six2.get_u_name());
                                                _six5.set_u_nicker(str15);
                                                _six5.set_phase_id(new int?(int.Parse(str23)));
                                                _six5.set_phase(str22);
                                                _six5.set_bet_time(new DateTime?(DateTime.Now));
                                                _six5.set_odds_id(new int?(int.Parse(str39)));
                                                _six5.set_category(table13.Rows[0]["category"].ToString());
                                                _six5.set_play_id(new int?(int.Parse(table13.Rows[0]["play_id"].ToString())));
                                                _six5.set_play_name(table13.Rows[0]["o_play_name"].ToString());
                                                _six5.set_bet_val(table13.Rows[0]["put_amount"].ToString());
                                                _six5.set_odds(str49);
                                                _six5.set_bet_wt("");
                                                _six5.set_amount(new decimal?(decimal.Parse(strArray2[num22])));
                                                _six5.set_profit(0);
                                                _six5.set_hy_drawback(new decimal?(decimal.Parse(str46)));
                                                _six5.set_dl_drawback(new decimal?(decimal.Parse(str45)));
                                                _six5.set_zd_drawback(new decimal?(decimal.Parse(str44)));
                                                _six5.set_gd_drawback(new decimal?(decimal.Parse(str43)));
                                                _six5.set_fgs_drawback(new decimal?(decimal.Parse(str42)));
                                                _six5.set_zj_drawback(new decimal?(decimal.Parse(str41)));
                                                _six5.set_dl_rate((float) int.Parse(_rate.get_dlzc()));
                                                _six5.set_zd_rate((float) int.Parse(_rate.get_zdzc()));
                                                _six5.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                                                _six5.set_fgs_rate((float) int.Parse(num4.ToString()));
                                                _six5.set_zj_rate((float) int.Parse(num3.ToString()));
                                                _six5.set_is_payment(0);
                                                _six5.set_dl_name(_rate.get_dlname());
                                                _six5.set_zd_name(_rate.get_zdname());
                                                _six5.set_gd_name(_rate.get_gdname());
                                                _six5.set_fgs_name(_rate.get_fgsname());
                                                _six5.set_m_type(new int?(num7));
                                                _six5.set_kind(_six2.get_six_kind().ToUpper());
                                                _six5.set_ip(LSRequest.GetIP());
                                                _six5.set_lottery_type(100);
                                                _six5.set_lottery_name(base.GetGameNameByID(_six5.get_lottery_type().ToString()));
                                                _six5.set_isLM(0);
                                                _six5.set_ordervalidcode(Utils.GetOrderValidCode(_six5.get_u_name(), _six5.get_order_num(), _six5.get_bet_val(), _six5.get_odds(), _six5.get_kind(), Convert.ToInt32(_six5.get_phase_id()), Convert.ToInt32(_six5.get_odds_id()), Convert.ToDouble(_six5.get_amount())));
                                                _six5.set_odds_zj(str40);
                                                _six5.set_bet_wt_zj("");
                                                int num25 = 0;
                                                if (CallBLL.cz_autosale_six_ex_bll.AddBet_ex(_six5, decimal.Parse(strArray2[num22]), _six2.get_u_name(), ref num25, str11, str13))
                                                {
                                                    list3.Add(_six5);
                                                    FastSale sale13 = new FastSale();
                                                    sale13.set_success("1");
                                                    sale13.set_ordernum(orderNumber);
                                                    sale13.set_playname(_six5.get_play_name());
                                                    sale13.set_putamount(_six5.get_bet_val());
                                                    string str50 = "";
                                                    str50 = (double.Parse(strArray2[num22]) * (double.Parse(str49) - 1.0)).ToString();
                                                    sale13.set_ky(str50);
                                                    sale13.set_islm("0");
                                                    sale13.set_pl(str49);
                                                    sale13.set_amount(strArray2[num22]);
                                                    sale13.set_oddsid(_six5.get_odds_id().ToString());
                                                    sale13.set_message("");
                                                    list.Add(sale13);
                                                }
                                            }
                                            num22++;
                                        }
                                        if (list3.Count > 0)
                                        {
                                            for (int num27 = 0; num27 < list3.Count; num27++)
                                            {
                                                cz_bet_six _six6 = list3[num27];
                                                DataTable table14 = CallBLL.cz_odds_six_bll.GetOddsByID(_six6.get_odds_id().ToString()).Tables[0];
                                                int play_id = int.Parse(table14.Rows[0]["play_id"].ToString());
                                                table14.Rows[0]["play_name"].ToString();
                                                table14.Rows[0]["put_amount"].ToString();
                                                string str51 = string.Format(" '{0}','{1}','{2}','{3}','{4}','{5}' ", new object[] { str17, _rate.get_fgsname(), _rate.get_gdname(), _rate.get_zdname(), _rate.get_dlname(), _six2.get_u_name() });
                                                EnumerableRowCollection<DataRow> rows2 = CallBLL.cz_autosale_six_ex_bll.GetDrawbackUpNames_ex(str51, str11, str12).AsEnumerable().Where<DataRow>(c => c.Field<int>("play_id") == Convert.ToInt32(play_id));
                                                string str52 = "0";
                                                string str53 = "0";
                                                string str54 = "0";
                                                string str55 = "0";
                                                string str56 = "0";
                                                string str57 = "0";
                                                string str58 = "";
                                                foreach (DataRow row4 in rows2)
                                                {
                                                    str59 = row4["u_type"].ToString().Trim();
                                                    if (str59 != null)
                                                    {
                                                        if (!(str59 == "zj"))
                                                        {
                                                            if (str59 == "fgs")
                                                            {
                                                                goto Label_2435;
                                                            }
                                                            if (str59 == "gd")
                                                            {
                                                                goto Label_2459;
                                                            }
                                                            if (str59 == "zd")
                                                            {
                                                                goto Label_247D;
                                                            }
                                                            if (str59 == "dl")
                                                            {
                                                                goto Label_24A1;
                                                            }
                                                            if (str59 == "hy")
                                                            {
                                                                goto Label_24C5;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            str52 = row4[str19 + "_drawback"].ToString().Trim();
                                                        }
                                                    }
                                                    continue;
                                                Label_2435:
                                                    str53 = row4[str19 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_2459:
                                                    str54 = row4[str19 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_247D:
                                                    str55 = row4[str19 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_24A1:
                                                    str56 = row4[str19 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_24C5:
                                                    switch (str26)
                                                    {
                                                        case "dl":
                                                            str57 = row4[str19 + "_drawback"].ToString().Trim();
                                                            break;

                                                        case "zd":
                                                            str56 = row4[str19 + "_drawback"].ToString().Trim();
                                                            break;

                                                        case "gd":
                                                            str55 = row4[str19 + "_drawback"].ToString().Trim();
                                                            break;

                                                        case "fgs":
                                                            str54 = row4[str19 + "_drawback"].ToString().Trim();
                                                            break;
                                                    }
                                                }
                                                _six6.get_odds();
                                                str58 = _six6.get_odds();
                                                cz_bet_six _six7 = new cz_bet_six();
                                                _six7.set_order_num(_six6.get_order_num());
                                                _six7.set_u_name(_six6.get_u_name());
                                                _six7.set_u_nicker(_six6.get_u_nicker());
                                                _six7.set_phase_id(new int?(int.Parse(s)));
                                                _six7.set_phase(str20);
                                                _six7.set_bet_time(new DateTime?(DateTime.Now));
                                                _six7.set_checkcode(_six6.get_checkcode());
                                                _six7.set_odds_id(_six6.get_odds_id());
                                                _six7.set_category(_six6.get_category());
                                                _six7.set_play_id(_six6.get_play_id());
                                                _six7.set_play_name(_six6.get_play_name());
                                                _six7.set_bet_val(_six6.get_bet_val());
                                                _six7.set_odds(_six6.get_odds());
                                                _six7.set_amount(_six6.get_amount());
                                                _six7.set_profit(0);
                                                _six7.set_isLM(0);
                                                _six7.set_hy_drawback(new decimal?(decimal.Parse(str57)));
                                                _six7.set_dl_drawback(new decimal?(decimal.Parse(str56)));
                                                _six7.set_zd_drawback(new decimal?(decimal.Parse(str55)));
                                                _six7.set_gd_drawback(new decimal?(decimal.Parse(str54)));
                                                _six7.set_fgs_drawback(new decimal?(decimal.Parse(str53)));
                                                _six7.set_zj_drawback(new decimal?(decimal.Parse(str52)));
                                                _six7.set_dl_rate(0f);
                                                _six7.set_zd_rate(0f);
                                                _six7.set_gd_rate(0f);
                                                _six7.set_fgs_rate(0f);
                                                _six7.set_zj_rate(0f);
                                                _six7.set_is_payment(0);
                                                _six7.set_dl_name("");
                                                _six7.set_zd_name("");
                                                _six7.set_gd_name("");
                                                _six7.set_fgs_name(context.Session["user_name"].ToString());
                                                _six7.set_sale_type(1);
                                                _six7.set_m_type(-2);
                                                _six7.set_kind(_six6.get_kind().ToUpper());
                                                _six7.set_ip(LSRequest.GetIP());
                                                _six7.set_lottery_type(100);
                                                _six7.set_lottery_name(base.GetGameNameByID(_six7.get_lottery_type().ToString()));
                                                _six7.set_ordervalidcode(Utils.GetOrderValidCode(_six7.get_u_name(), _six7.get_order_num(), _six7.get_bet_val(), _six7.get_odds(), _six7.get_kind(), Convert.ToInt32(_six7.get_phase_id()), Convert.ToInt32(_six7.get_odds_id()), Convert.ToDouble(_six7.get_amount())));
                                                _six7.set_odds_zj(str58);
                                                int num28 = 0;
                                                CallBLL.cz_bet_six_bll.AddBHBetByZJ(_six7, ref num28);
                                            }
                                        }
                                        dictionary.Add("bhdata", list);
                                        new Dictionary<string, object>();
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        result.set_success(200);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                }
                                else
                                {
                                    result.set_tipinfo(string.Format("內網目標系統提示：奖期[{0}]已封盘,停止下注！", _six4.get_phase().ToString()));
                                    result.set_success(400);
                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                            }
                        }
                    }
                }
            }
        }

        public void SaleTM_AandB_ex(HttpContext context, ref string strResult)
        {
            ReturnResult result = new ReturnResult();
            result.set_success(400);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "user_allow_sale");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            string str3 = LSRequest.qq("phaseid");
            string str4 = LSRequest.qq("oddsid");
            string str5 = LSRequest.qq("currentodds");
            string s = LSRequest.qq("amount");
            LSRequest.qq("number");
            string str7 = LSRequest.qq("s_user");
            LSRequest.qq("pk");
            string str8 = LSRequest.qq("jeucode");
            string[] strArray = str4.Split(new char[] { ',' });
            string[] strArray2 = s.Split(new char[] { ',' });
            string[] strArray3 = str5.Split(new char[] { ',' });
            if (strArray2.Length > 0x31)
            {
                context.Response.End();
            }
            if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str8))
            {
                context.Session["JeuValidate"] = null;
                result.set_success(400);
                new Dictionary<string, object>();
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                context.Session["JeuValidate"] = null;
                if (double.Parse(s) < 10.0)
                {
                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100096", "MessageHint"), 10));
                    result.set_success(400);
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else if (string.IsNullOrEmpty(str5) || (strArray3.Length <= 0))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100046", "MessageHint"));
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    for (int i = 0; i < strArray2.Length; i++)
                    {
                        if (!base.IsNumber(strArray2[i]))
                        {
                            result.set_tipinfo("下注金額有誤！");
                            result.set_success(500);
                            dictionary.Add("jeucode", base.get_JeuValidate());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                    }
                    cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str7);
                    if ((user == null) || !user.get_flag().Equals(1))
                    {
                        result.set_tipinfo(PageBase.GetMessageByCache("u100075", "MessageHint"));
                        result.set_success(400);
                        string str9 = base.get_JeuValidate();
                        dictionary.Add("jeucode", str9);
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        string str10 = user.get_salt().ToUpper();
                        string str11 = user.get_sqlconn();
                        string str12 = user.get_sqlconn_write();
                        string str13 = user.get_six_kind().ToUpper();
                        string str14 = user.get_u_nicker();
                        string str15 = "";
                        string str16 = "";
                        Dictionary<string, string> dictionary2 = CallBLL.cz_autosale_six_ex_bll.GetHyUpTypeAndZJName(str7, str10, str11);
                        if (dictionary2 == null)
                        {
                            result.set_tipinfo(PageBase.GetMessageByCache("u100075", "MessageHint"));
                            result.set_success(400);
                            string str17 = base.get_JeuValidate();
                            dictionary.Add("jeucode", str17);
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            str15 = dictionary2["su_type"];
                            str16 = dictionary2["zjname"];
                            user_six_rate _rate = CallBLL.cz_autosale_six_ex_bll.GetRateByAccount_ex(str7, str10, str11, str16);
                            double num2 = 0.0;
                            double num3 = 0.0;
                            if (_rate.get_zcyg().Equals("1"))
                            {
                                num2 = (((100.0 - double.Parse(_rate.get_fgszc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc())) - double.Parse(_rate.get_dlzc());
                                num3 = double.Parse(_rate.get_fgszc());
                            }
                            else
                            {
                                num3 = (((100.0 - double.Parse(_rate.get_zjzc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc())) - double.Parse(_rate.get_dlzc());
                                num2 = double.Parse(_rate.get_zjzc());
                            }
                            int num6 = 1;
                            if (str15.ToLower() != "dl")
                            {
                                num6 = -1;
                            }
                            cz_saleset_six _six2 = CallBLL.cz_saleset_six_bll.GetUser(str7);
                            if (_six2 == null)
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100044", "MessageHint"));
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                string str18 = _six2.get_six_kind().ToUpper();
                                string str19 = "";
                                string str20 = "";
                                string str21 = "";
                                string str22 = "";
                                cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                                if (currentPhase != null)
                                {
                                    if (currentPhase.get_is_closed() == 1)
                                    {
                                        result.set_tipinfo(string.Format("奖期[{0}]已封盘,停止下注！", currentPhase.get_phase().ToString()));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    str19 = currentPhase.get_phase().ToString();
                                    str20 = currentPhase.get_p_id().ToString();
                                }
                                else
                                {
                                    result.set_tipinfo(string.Format("该奖期已停止下注！", new object[0]));
                                    result.set_success(400);
                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                for (int j = 0; j < strArray.Length; j++)
                                {
                                    DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(strArray[j]);
                                    DateTime now = DateTime.Now;
                                    DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                                    DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                                    if ((((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91004") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91007") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91038")))
                                    {
                                        if (time3 < now)
                                        {
                                            result.set_tipinfo(string.Format("已經截止下註！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    else if (time2 < now)
                                    {
                                        result.set_tipinfo(string.Format("已經截止下註！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                foreach (string str23 in strArray)
                                {
                                    DataTable table2 = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(str23);
                                    DateTime time4 = DateTime.Now;
                                    DateTime time5 = Convert.ToDateTime(currentPhase.get_stop_date());
                                    DateTime time6 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                                    if ((table2.Rows[0]["play_id"].ToString().Trim() == "91001") || (table2.Rows[0]["play_id"].ToString().Trim() == "91002"))
                                    {
                                        if (time6 >= time4)
                                        {
                                            continue;
                                        }
                                        result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (time5 < time4)
                                    {
                                        result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                cz_phase_six _six4 = CallBLL.cz_autosale_six_ex_bll.GetCurrentPhase_ex(str10, str11);
                                if (_six4 == null)
                                {
                                    result.set_tipinfo(string.Format("內網目標系統提示：奖期已停止下注！", new object[0]));
                                    result.set_success(400);
                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                else
                                {
                                    List<FastSale> list;
                                    Dictionary<int, string> dictionary3;
                                    string str25;
                                    bool flag;
                                    int? nullable = _six4.get_is_closed();
                                    if (!((nullable.GetValueOrDefault() == 1) && nullable.HasValue))
                                    {
                                        str21 = _six4.get_phase().ToString();
                                        str22 = _six4.get_p_id().ToString();
                                        for (int k = 0; k < strArray.Length; k++)
                                        {
                                            DataTable table3 = CallBLL.cz_autosale_six_ex_bll.GetPlayIDByOddsIds_ex(strArray[k], str10, str11);
                                            DateTime time7 = DateTime.Now;
                                            DateTime time8 = Convert.ToDateTime(_six4.get_stop_date());
                                            DateTime time9 = Convert.ToDateTime(_six4.get_sn_stop_date());
                                            if ((((table3.Rows[0]["play_id"].ToString().Trim() == "91001") || (table3.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((table3.Rows[0]["play_id"].ToString().Trim() == "91004") || (table3.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((table3.Rows[0]["play_id"].ToString().Trim() == "91007") || (table3.Rows[0]["play_id"].ToString().Trim() == "91038")))
                                            {
                                                if (time9 < time7)
                                                {
                                                    result.set_tipinfo(string.Format("內網目標系統提示：已經截止下註！", new object[0]));
                                                    result.set_success(400);
                                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                                    result.set_data(dictionary);
                                                    strResult = JsonHandle.ObjectToJson(result);
                                                    return;
                                                }
                                            }
                                            else if (time8 < time7)
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：已經截止下註！", new object[0]));
                                                result.set_success(400);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                        }
                                        foreach (string str24 in strArray)
                                        {
                                            DataTable table4 = CallBLL.cz_autosale_six_ex_bll.GetPlayIDByOddsIds_ex(str24, str10, str11);
                                            DateTime time10 = DateTime.Now;
                                            DateTime time11 = Convert.ToDateTime(_six4.get_stop_date());
                                            DateTime time12 = Convert.ToDateTime(_six4.get_sn_stop_date());
                                            if ((table4.Rows[0]["play_id"].ToString().Trim() == "91001") || (table4.Rows[0]["play_id"].ToString().Trim() == "91002"))
                                            {
                                                if (time12 >= time10)
                                                {
                                                    continue;
                                                }
                                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                                result.set_success(400);
                                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            if (time11 < time10)
                                            {
                                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                                result.set_success(400);
                                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                        }
                                        if (!str20.Equals(str3))
                                        {
                                            result.set_tipinfo(string.Format("獎期错误！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        if (!str19.Equals(str21))
                                        {
                                            result.set_tipinfo(string.Format("內網目標系統的獎期與當前系統的獎期不一致！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        list = new List<FastSale>();
                                        dictionary3 = new Dictionary<int, string>();
                                        str25 = "";
                                        for (int m = 0; m < strArray.Length; m++)
                                        {
                                            object obj2;
                                            if (m == 0)
                                            {
                                                obj2 = str25;
                                                str25 = string.Concat(new object[] { obj2, strArray[m], ",", Convert.ToInt32(strArray[m]) + 0x31 });
                                            }
                                            else
                                            {
                                                obj2 = str25;
                                                str25 = string.Concat(new object[] { obj2, ",", strArray[m], ",", Convert.ToInt32(strArray[m]) + 0x31 });
                                            }
                                            DataTable table5 = CallBLL.cz_odds_six_bll.GetPlayOddsByID(str25).Tables[0];
                                            DataRow[] rowArray = table5.Select(string.Format(" odds_id={0} ", strArray[m]));
                                            DataRow[] rowArray2 = table5.Select(string.Format(" odds_id={0} ", int.Parse(strArray[m]) + 0x31));
                                            dictionary3.Add(int.Parse(strArray[m]), rowArray[0]["is_open"].ToString());
                                            dictionary3.Add(int.Parse(strArray[m]) + 0x31, rowArray2[0]["is_open"].ToString());
                                        }
                                        flag = false;
                                        foreach (KeyValuePair<int, string> pair in dictionary3)
                                        {
                                            if (pair.Value.Equals("0"))
                                            {
                                                flag = true;
                                                break;
                                            }
                                        }
                                    }
                                    else
                                    {
                                        result.set_tipinfo(string.Format("內網目標系統提示：奖期[{0}]已封盘,停止下注！", _six4.get_phase().ToString()));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (flag)
                                    {
                                        result.set_tipinfo("補貨失敗,特碼A或特碼B存在停盤的玩法，請到具體對應的特碼A或特碼B頁面操作");
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                    else
                                    {
                                        int num43;
                                        DataTable table6 = CallBLL.cz_autosale_six_ex_bll.GetUserRate_ex(_six2.get_u_name(), 1, str10, str11).Tables[0];
                                        string str26 = table6.Rows[0]["su_type"].ToString().Trim();
                                        double num10 = double.Parse(table6.Rows[0]["six_usable_credit"].ToString().Trim());
                                        DataTable oddsTableByOddsIds = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str25);
                                        Dictionary<int, double> dictionary4 = new Dictionary<int, double>();
                                        Dictionary<int, string> dictionary5 = new Dictionary<int, string>();
                                        Dictionary<int, double> dictionary6 = new Dictionary<int, double>();
                                        DataTable table8 = CallBLL.cz_bet_six_bll.GetSZZTByTMABZJ(str20, "91001,91002", model.get_u_name(), str25, str18);
                                        for (int n = 0; n < strArray.Length; n++)
                                        {
                                            int num12 = int.Parse(strArray[n]);
                                            int num13 = int.Parse(strArray[n]) + 0x31;
                                            if (num12 <= 0x16791)
                                            {
                                                DataRow[] rowArray3 = table8.Select(string.Format(" odds_id={0} ", num12));
                                                if (dictionary3[num12].ToString().Equals("1"))
                                                {
                                                    if ((rowArray3 != null) && (rowArray3.Length > 0))
                                                    {
                                                        nullable = null;
                                                        double num14 = Math.Floor(double.Parse(Utils.GetMathRound(double.Parse(rowArray3[0]["szzt"].ToString()), nullable)));
                                                        if (num14 >= 1.0)
                                                        {
                                                            dictionary6.Add(num12, num14);
                                                        }
                                                        else
                                                        {
                                                            dictionary6.Add(num12, 0.0);
                                                        }
                                                    }
                                                    else
                                                    {
                                                        dictionary6.Add(num12, 0.0);
                                                    }
                                                }
                                                else
                                                {
                                                    dictionary6.Add(num12, 0.0);
                                                }
                                                DataRow[] rowArray4 = table8.Select(string.Format(" odds_id={0} ", num13));
                                                if (dictionary3[num13].ToString().Equals("1"))
                                                {
                                                    if ((rowArray4 != null) && (rowArray4.Length > 0))
                                                    {
                                                        nullable = null;
                                                        double num15 = Math.Floor(double.Parse(Utils.GetMathRound(double.Parse(rowArray4[0]["szzt"].ToString()), nullable)));
                                                        if (num15 >= 1.0)
                                                        {
                                                            dictionary6.Add(num13, num15);
                                                        }
                                                        else
                                                        {
                                                            dictionary6.Add(num13, 0.0);
                                                        }
                                                    }
                                                    else
                                                    {
                                                        dictionary6.Add(num13, 0.0);
                                                    }
                                                }
                                                else
                                                {
                                                    dictionary6.Add(num13, 0.0);
                                                }
                                            }
                                        }
                                        if ((dictionary6 != null) && (dictionary6.Count > 0))
                                        {
                                            int num16 = 0;
                                            foreach (KeyValuePair<int, double> pair2 in dictionary6)
                                            {
                                                int key = pair2.Key;
                                                double num18 = 0.0;
                                                if (key <= 0x16791)
                                                {
                                                    double num19 = 0.0;
                                                    double num20 = 0.0;
                                                    for (int num21 = 0; num21 < strArray.Length; num21++)
                                                    {
                                                        if (key.ToString().Equals(strArray[num21]))
                                                        {
                                                            num19 = double.Parse(strArray2[num21]);
                                                            num20 = double.Parse(strArray3[num21]);
                                                        }
                                                    }
                                                    int num22 = pair2.Key + 0x31;
                                                    num18 = pair2.Value + dictionary6[num22];
                                                    double num23 = pair2.Value;
                                                    double num24 = dictionary6[num22];
                                                    num18 = num23 + num24;
                                                    string str27 = dictionary3[key];
                                                    string str28 = dictionary3[num22];
                                                    double num25 = num18;
                                                    if (str27.Equals("0"))
                                                    {
                                                        num25 -= num23;
                                                    }
                                                    if (str28.Equals("0"))
                                                    {
                                                        num25 -= num24;
                                                    }
                                                    if (num19 > num25)
                                                    {
                                                        DataRow[] rowArray5 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", key));
                                                        string str29 = rowArray5[0]["play_name"].ToString();
                                                        string str30 = rowArray5[0]["put_amount"].ToString();
                                                        dictionary5.Add(key, string.Concat(new object[] { str29, ",", str29.Replace('A', 'B'), "|", str30, "|", num20, "|補貨超量！" }));
                                                    }
                                                    else
                                                    {
                                                        double num26 = 0.0;
                                                        double num27 = 0.0;
                                                        if (str27.Equals("1") && (num23 > 0.0))
                                                        {
                                                            if (num19 > num18)
                                                            {
                                                                num26 = num18;
                                                            }
                                                            else if (num19 > num23)
                                                            {
                                                                num26 = num23;
                                                            }
                                                            else
                                                            {
                                                                num26 = num19;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            DataRow[] rowArray6 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", key));
                                                            rowArray6[0]["play_name"].ToString();
                                                            rowArray6[0]["put_amount"].ToString();
                                                            num20.ToString();
                                                        }
                                                        if (str28.Equals("1") && (num24 > 0.0))
                                                        {
                                                            if ((num19 - num26) > num18)
                                                            {
                                                                num27 = num18;
                                                            }
                                                            else if ((num19 - num26) > num24)
                                                            {
                                                                num27 = num24;
                                                            }
                                                            else
                                                            {
                                                                num27 = num19 - num26;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            DataRow[] rowArray7 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", num22));
                                                            rowArray7[0]["play_name"].ToString();
                                                            rowArray7[0]["put_amount"].ToString();
                                                            num20.ToString();
                                                        }
                                                        if (num26 > 0.0)
                                                        {
                                                            dictionary4.Add(key, num26);
                                                        }
                                                        if (num27 > 0.0)
                                                        {
                                                            dictionary4.Add(num22, num27);
                                                        }
                                                        num16++;
                                                    }
                                                }
                                            }
                                        }
                                        else
                                        {
                                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100041", "MessageHint"), currentPhase.get_phase().ToString()));
                                            result.set_success(400);
                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        int index = 0;
                                        List<string> list2 = new List<string>();
                                        List<string> list3 = new List<string>();
                                        foreach (KeyValuePair<int, double> pair3 in dictionary4)
                                        {
                                            DataTable table9 = CallBLL.cz_autosale_six_ex_bll.GetOddsByID_ex(pair3.Key.ToString(), str10, str11).Tables[0];
                                            string str31 = table9.Rows[0]["o_play_name"].ToString();
                                            string str32 = table9.Rows[0]["put_amount"].ToString();
                                            if (table9.Rows[0]["is_open"].ToString().Equals("0"))
                                            {
                                                result.set_success(400);
                                                result.set_tipinfo(string.Format("內網目標系統提示：{0}【{1}】 已停盤！", str31, str32));
                                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            double num29 = 0.0;
                                            DataTable table10 = CallBLL.cz_autosale_six_ex_bll.GetPlayOddsByID_ex(pair3.Key.ToString(), str10, str11).Tables[0];
                                            if (table10.Rows.Count == 0)
                                            {
                                                result.set_success(400);
                                                result.set_tipinfo("內網目標系統提示：賠率ID設置错误!");
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            num43 = 100;
                                            DataTable table11 = CallBLL.cz_autosale_six_ex_bll.GetSinglePhaseByBet_ex(str21, _six2.get_u_name(), num43.ToString(), pair3.Key.ToString(), str10, str11).Tables[0];
                                            string str33 = "";
                                            string str34 = "";
                                            string str35 = "";
                                            string str36 = "";
                                            string str37 = "";
                                            string str38 = "";
                                            double num30 = 0.0;
                                            double num31 = 0.0;
                                            double num32 = 0.0;
                                            foreach (DataRow row in table10.Rows)
                                            {
                                                if (row["odds_id"].ToString().Trim() == pair3.Key.ToString())
                                                {
                                                    str33 = row["is_open"].ToString().Trim();
                                                    str34 = row["play_id"].ToString().Trim();
                                                    str35 = row["play_name"].ToString().Trim();
                                                    str36 = row["put_amount"].ToString().Trim();
                                                    str37 = row["isLM"].ToString().Trim();
                                                    str38 = row["isDoubleOdds"].ToString().Trim();
                                                    num30 = double.Parse(row["allow_min_amount"].ToString().Trim());
                                                    num31 = double.Parse(row["allow_max_amount"].ToString().Trim());
                                                    num32 = double.Parse(row["allow_max_put_amount"].ToString().Trim());
                                                    break;
                                                }
                                            }
                                            if (table11.Rows.Count > 0)
                                            {
                                                foreach (DataRow row2 in table11.Rows)
                                                {
                                                    if (row2["odds_id"].ToString().Trim() == pair3.Key.ToString())
                                                    {
                                                        num29 = double.Parse(row2["sumbet"].ToString().Trim());
                                                        break;
                                                    }
                                                }
                                            }
                                            DataTable table12 = CallBLL.cz_autosale_six_ex_bll.GetDrawbackByPlayId_ex(str34, _six2.get_u_name(), str10, str11).Tables[0];
                                            double num33 = double.Parse(table12.Rows[0]["single_max_amount"].ToString().Trim());
                                            double num34 = double.Parse(table12.Rows[0]["single_min_amount"].ToString().Trim());
                                            double num35 = double.Parse(table12.Rows[0]["single_phase_amount"].ToString().Trim());
                                            if (num33 > num31)
                                            {
                                                num33 = num31;
                                            }
                                            if (num35 > num32)
                                            {
                                                num35 = num32;
                                            }
                                            if (num34 > num30)
                                            {
                                                num30 = num34;
                                            }
                                            if (str33 != "1")
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：{0}【{1}】已經停止投注！", str35, str36));
                                                result.set_success(400);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            double num36 = 0.0;
                                            if (str38.Equals("0"))
                                            {
                                                num36 = double.Parse(CallBLL.cz_autosale_six_ex_bll.GetPlay_ex(pair3.Key.ToString(), _six2.get_u_name(), str11, str13, str10.ToUpper(), null, "", base.get_YearLianID()));
                                                if ((pair3.Key <= 0x16791) && (double.Parse(strArray3[index]) != double.Parse(num36.ToString())))
                                                {
                                                    list2.Add(index.ToString());
                                                    list3.Add(num36.ToString());
                                                }
                                            }
                                            if (double.Parse(s) > num33)
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：下注金額超出單注最大金額！", new object[0]));
                                                result.set_success(500);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            if (double.Parse(s) > num10)
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：下注金額超出可用金額！", new object[0]));
                                                result.set_success(500);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            if (double.Parse(s) < num30)
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：下注金額低過最低金額！", new object[0]));
                                                result.set_success(500);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            if (!str37.Equals("1") && ((double.Parse(s) + num29) > num35))
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：{0}【{1}】下注單期金額超出單期最大金額！", str35, str36));
                                                result.set_success(500);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                                return;
                                            }
                                            index++;
                                        }
                                        if (list3.Count > 0)
                                        {
                                            result.set_tipinfo(string.Format("內網目標系統提示：賠率有變動,請確認後再提交!", new object[0]));
                                            result.set_success(600);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            dictionary.Add("index", list2);
                                            dictionary.Add("newpl", list3);
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                        }
                                        else
                                        {
                                            string str61;
                                            List<cz_bet_six> list4 = new List<cz_bet_six>();
                                            foreach (KeyValuePair<int, double> pair4 in dictionary4)
                                            {
                                                DataTable table13 = CallBLL.cz_autosale_six_ex_bll.GetOddsByID_ex(pair4.Key.ToString(), str10, str11).Tables[0];
                                                int play_id = int.Parse(table13.Rows[0]["play_id"].ToString());
                                                string str40 = table13.Rows[0]["play_name"].ToString();
                                                string str41 = table13.Rows[0]["put_amount"].ToString();
                                                double local1 = pair4.Value;
                                                double num37 = 0.0;
                                                for (int num38 = 0; num38 < strArray.Length; num38++)
                                                {
                                                    if ((pair4.Key > 0x16791) && (pair4.Key <= 0x167c2))
                                                    {
                                                        num43 = pair4.Key - 0x31;
                                                        if (num43.ToString().Equals(strArray[num38]))
                                                        {
                                                            num37 = double.Parse(strArray3[num38]);
                                                        }
                                                    }
                                                    else if (pair4.Key.ToString().Equals(strArray[num38]))
                                                    {
                                                        num37 = double.Parse(strArray3[num38]);
                                                    }
                                                }
                                                string str42 = "";
                                                string str43 = "0";
                                                string str44 = "0";
                                                string str45 = "0";
                                                string str46 = "0";
                                                string str47 = "0";
                                                string str48 = "0";
                                                string orderNumber = Utils.GetOrderNumber();
                                                string str50 = string.Format(" '{0}','{1}','{2}','{3}','{4}','{5}' ", new object[] { str16, _rate.get_fgsname(), _rate.get_gdname(), _rate.get_zdname(), _rate.get_dlname(), _six2.get_u_name() });
                                                foreach (DataRow row3 in CallBLL.cz_autosale_six_ex_bll.GetDrawbackUpNames_ex(str50, str10, str11).AsEnumerable().Where<DataRow>(c => c.Field<int>("play_id") == Convert.ToInt32(play_id)))
                                                {
                                                    str61 = row3["u_type"].ToString().Trim();
                                                    if (str61 != null)
                                                    {
                                                        if (!(str61 == "zj"))
                                                        {
                                                            if (str61 == "fgs")
                                                            {
                                                                goto Label_2301;
                                                            }
                                                            if (str61 == "gd")
                                                            {
                                                                goto Label_2325;
                                                            }
                                                            if (str61 == "zd")
                                                            {
                                                                goto Label_2349;
                                                            }
                                                            if (str61 == "dl")
                                                            {
                                                                goto Label_236D;
                                                            }
                                                            if (str61 == "hy")
                                                            {
                                                                goto Label_2391;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            str43 = row3[str18 + "_drawback"].ToString().Trim();
                                                        }
                                                    }
                                                    continue;
                                                Label_2301:
                                                    str44 = row3[str18 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_2325:
                                                    str45 = row3[str18 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_2349:
                                                    str46 = row3[str18 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_236D:
                                                    str47 = row3[str18 + "_drawback"].ToString().Trim();
                                                    continue;
                                                Label_2391:
                                                    switch (str26)
                                                    {
                                                        case "dl":
                                                            str48 = row3[str18 + "_drawback"].ToString().Trim();
                                                            break;

                                                        case "zd":
                                                            str47 = row3[str18 + "_drawback"].ToString().Trim();
                                                            break;

                                                        case "gd":
                                                            str46 = row3[str18 + "_drawback"].ToString().Trim();
                                                            break;

                                                        case "fgs":
                                                            str45 = row3[str18 + "_drawback"].ToString().Trim();
                                                            break;
                                                    }
                                                }
                                                DataTable table15 = CallBLL.cz_autosale_six_ex_bll.GetOddsByID_ex(pair4.Key.ToString(), str10, str11).Tables[0];
                                                string str51 = CallBLL.cz_autosale_six_ex_bll.GetPlay_ex(pair4.Key.ToString(), _six2.get_u_name(), str11, str13, str10.ToUpper(), null, "", base.get_YearLianID());
                                                str42 = (double.Parse(table15.Rows[0]["current_odds"].ToString()) + Convert.ToDouble(table15.Rows[0][str18 + "_diff"].ToString().Trim())).ToString();
                                                cz_bet_six item = new cz_bet_six();
                                                item.set_order_num(orderNumber);
                                                item.set_checkcode(str8);
                                                item.set_u_name(_six2.get_u_name());
                                                item.set_u_nicker(str14);
                                                item.set_phase_id(new int?(int.Parse(str22)));
                                                item.set_phase(str21);
                                                item.set_bet_time(new DateTime?(DateTime.Now));
                                                item.set_odds_id(new int?(pair4.Key));
                                                item.set_category(table15.Rows[0]["category"].ToString());
                                                item.set_play_id(new int?(int.Parse(table15.Rows[0]["play_id"].ToString())));
                                                item.set_play_name(table15.Rows[0]["o_play_name"].ToString());
                                                item.set_bet_val(table15.Rows[0]["put_amount"].ToString());
                                                item.set_odds(str51);
                                                item.set_bet_wt("");
                                                item.set_amount(new decimal?(decimal.Parse(pair4.Value.ToString())));
                                                item.set_profit(0);
                                                item.set_hy_drawback(new decimal?(decimal.Parse(str48)));
                                                item.set_dl_drawback(new decimal?(decimal.Parse(str47)));
                                                item.set_zd_drawback(new decimal?(decimal.Parse(str46)));
                                                item.set_gd_drawback(new decimal?(decimal.Parse(str45)));
                                                item.set_fgs_drawback(new decimal?(decimal.Parse(str44)));
                                                item.set_zj_drawback(new decimal?(decimal.Parse(str43)));
                                                item.set_dl_rate((float) int.Parse(_rate.get_dlzc()));
                                                item.set_zd_rate((float) int.Parse(_rate.get_zdzc()));
                                                item.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                                                item.set_fgs_rate((float) int.Parse(num3.ToString()));
                                                item.set_zj_rate((float) int.Parse(num2.ToString()));
                                                item.set_is_payment(0);
                                                item.set_dl_name(_rate.get_dlname());
                                                item.set_zd_name(_rate.get_zdname());
                                                item.set_gd_name(_rate.get_gdname());
                                                item.set_fgs_name(_rate.get_fgsname());
                                                item.set_m_type(new int?(num6));
                                                item.set_kind(_six2.get_six_kind().ToUpper());
                                                item.set_ip(LSRequest.GetIP());
                                                item.set_lottery_type(100);
                                                item.set_lottery_name(base.GetGameNameByID(item.get_lottery_type().ToString()));
                                                item.set_isLM(0);
                                                item.set_ordervalidcode(Utils.GetOrderValidCode(item.get_u_name(), item.get_order_num(), item.get_bet_val(), item.get_odds(), item.get_kind(), Convert.ToInt32(item.get_phase_id()), Convert.ToInt32(item.get_odds_id()), Convert.ToDouble(item.get_amount())));
                                                item.set_odds_zj(str42);
                                                item.set_bet_wt_zj("");
                                                int num39 = 0;
                                                if (CallBLL.cz_autosale_six_ex_bll.AddBet_ex(item, decimal.Parse(s), _six2.get_u_name(), ref num39, str10, str12))
                                                {
                                                    list4.Add(item);
                                                    FastSale sale = new FastSale();
                                                    sale.set_success("1");
                                                    sale.set_ordernum(orderNumber);
                                                    sale.set_playname(str40);
                                                    sale.set_putamount(str41);
                                                    string str52 = "";
                                                    str52 = (double.Parse(pair4.Value.ToString()) * (num37 - 1.0)).ToString();
                                                    sale.set_ky(str52);
                                                    sale.set_islm("0");
                                                    sale.set_pl(num37.ToString());
                                                    sale.set_amount(pair4.Value.ToString());
                                                    sale.set_oddsid(pair4.Key.ToString());
                                                    sale.set_message("");
                                                    list.Add(sale);
                                                }
                                            }
                                            if (list4.Count > 0)
                                            {
                                                for (int num41 = 0; num41 < list4.Count; num41++)
                                                {
                                                    cz_bet_six _six6 = list4[num41];
                                                    DataTable table16 = CallBLL.cz_odds_six_bll.GetOddsByID(_six6.get_odds_id().ToString()).Tables[0];
                                                    int play_id = int.Parse(table16.Rows[0]["play_id"].ToString());
                                                    table16.Rows[0]["play_name"].ToString();
                                                    table16.Rows[0]["put_amount"].ToString();
                                                    string str53 = string.Format(" '{0}','{1}','{2}','{3}','{4}','{5}' ", new object[] { str16, _rate.get_fgsname(), _rate.get_gdname(), _rate.get_zdname(), _rate.get_dlname(), _six2.get_u_name() });
                                                    EnumerableRowCollection<DataRow> rows2 = CallBLL.cz_autosale_six_ex_bll.GetDrawbackUpNames_ex(str53, str10, str11).AsEnumerable().Where<DataRow>(c => c.Field<int>("play_id") == Convert.ToInt32(play_id));
                                                    string str54 = "0";
                                                    string str55 = "0";
                                                    string str56 = "0";
                                                    string str57 = "0";
                                                    string str58 = "0";
                                                    string str59 = "0";
                                                    string str60 = "";
                                                    foreach (DataRow row4 in rows2)
                                                    {
                                                        str61 = row4["u_type"].ToString().Trim();
                                                        if (str61 != null)
                                                        {
                                                            if (!(str61 == "zj"))
                                                            {
                                                                if (str61 == "fgs")
                                                                {
                                                                    goto Label_2BB8;
                                                                }
                                                                if (str61 == "gd")
                                                                {
                                                                    goto Label_2BDC;
                                                                }
                                                                if (str61 == "zd")
                                                                {
                                                                    goto Label_2C00;
                                                                }
                                                                if (str61 == "dl")
                                                                {
                                                                    goto Label_2C24;
                                                                }
                                                                if (str61 == "hy")
                                                                {
                                                                    goto Label_2C48;
                                                                }
                                                            }
                                                            else
                                                            {
                                                                str54 = row4[str18 + "_drawback"].ToString().Trim();
                                                            }
                                                        }
                                                        continue;
                                                    Label_2BB8:
                                                        str55 = row4[str18 + "_drawback"].ToString().Trim();
                                                        continue;
                                                    Label_2BDC:
                                                        str56 = row4[str18 + "_drawback"].ToString().Trim();
                                                        continue;
                                                    Label_2C00:
                                                        str57 = row4[str18 + "_drawback"].ToString().Trim();
                                                        continue;
                                                    Label_2C24:
                                                        str58 = row4[str18 + "_drawback"].ToString().Trim();
                                                        continue;
                                                    Label_2C48:
                                                        switch (str26)
                                                        {
                                                            case "dl":
                                                                str59 = row4[str18 + "_drawback"].ToString().Trim();
                                                                break;

                                                            case "zd":
                                                                str58 = row4[str18 + "_drawback"].ToString().Trim();
                                                                break;

                                                            case "gd":
                                                                str57 = row4[str18 + "_drawback"].ToString().Trim();
                                                                break;

                                                            case "fgs":
                                                                str56 = row4[str18 + "_drawback"].ToString().Trim();
                                                                break;
                                                        }
                                                    }
                                                    _six6.get_odds();
                                                    str60 = _six6.get_odds();
                                                    cz_bet_six _six7 = new cz_bet_six();
                                                    _six7.set_order_num(_six6.get_order_num());
                                                    _six7.set_u_name(_six6.get_u_name());
                                                    _six7.set_u_nicker(_six6.get_u_nicker());
                                                    _six7.set_phase_id(new int?(int.Parse(str20)));
                                                    _six7.set_phase(str19);
                                                    _six7.set_bet_time(new DateTime?(DateTime.Now));
                                                    _six7.set_checkcode(_six6.get_checkcode());
                                                    _six7.set_odds_id(_six6.get_odds_id());
                                                    _six7.set_category(_six6.get_category());
                                                    _six7.set_play_id(_six6.get_play_id());
                                                    _six7.set_play_name(_six6.get_play_name());
                                                    _six7.set_bet_val(_six6.get_bet_val());
                                                    _six7.set_odds(_six6.get_odds());
                                                    _six7.set_amount(_six6.get_amount());
                                                    _six7.set_profit(0);
                                                    _six7.set_isLM(0);
                                                    _six7.set_hy_drawback(new decimal?(decimal.Parse(str59)));
                                                    _six7.set_dl_drawback(new decimal?(decimal.Parse(str58)));
                                                    _six7.set_zd_drawback(new decimal?(decimal.Parse(str57)));
                                                    _six7.set_gd_drawback(new decimal?(decimal.Parse(str56)));
                                                    _six7.set_fgs_drawback(new decimal?(decimal.Parse(str55)));
                                                    _six7.set_zj_drawback(new decimal?(decimal.Parse(str54)));
                                                    _six7.set_dl_rate(0f);
                                                    _six7.set_zd_rate(0f);
                                                    _six7.set_gd_rate(0f);
                                                    _six7.set_fgs_rate(0f);
                                                    _six7.set_zj_rate(0f);
                                                    _six7.set_is_payment(0);
                                                    _six7.set_dl_name("");
                                                    _six7.set_zd_name("");
                                                    _six7.set_gd_name("");
                                                    _six7.set_fgs_name(context.Session["user_name"].ToString());
                                                    _six7.set_sale_type(1);
                                                    _six7.set_m_type(-2);
                                                    _six7.set_kind(_six6.get_kind().ToUpper());
                                                    _six7.set_ip(LSRequest.GetIP());
                                                    _six7.set_lottery_type(100);
                                                    _six7.set_lottery_name(base.GetGameNameByID(_six7.get_lottery_type().ToString()));
                                                    _six7.set_ordervalidcode(Utils.GetOrderValidCode(_six7.get_u_name(), _six7.get_order_num(), _six7.get_bet_val(), _six7.get_odds(), _six7.get_kind(), Convert.ToInt32(str20), Convert.ToInt32(_six7.get_odds_id()), Convert.ToDouble(_six7.get_amount())));
                                                    _six7.set_odds_zj(str60);
                                                    int num42 = 0;
                                                    CallBLL.cz_bet_six_bll.AddBHBetByZJ(_six7, ref num42);
                                                }
                                            }
                                            if (dictionary5.Count > 0)
                                            {
                                                foreach (KeyValuePair<int, string> pair5 in dictionary5)
                                                {
                                                    FastSale sale2 = new FastSale();
                                                    sale2.set_success("0");
                                                    sale2.set_ordernum("補貨失敗");
                                                    sale2.set_playname(pair5.Value.ToString().Split(new char[] { '|' })[0]);
                                                    sale2.set_putamount(pair5.Value.ToString().Split(new char[] { '|' })[1]);
                                                    sale2.set_ky("0");
                                                    sale2.set_islm("0");
                                                    sale2.set_pl(pair5.Value.ToString().Split(new char[] { '|' })[2]);
                                                    sale2.set_amount("0");
                                                    sale2.set_oddsid(pair5.Key.ToString());
                                                    sale2.set_message(pair5.Value.ToString().Split(new char[] { '|' })[3]);
                                                    list.Add(sale2);
                                                }
                                            }
                                            dictionary.Add("bhdata", list);
                                            new Dictionary<string, object>();
                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                            result.set_data(dictionary);
                                            result.set_success(200);
                                            strResult = JsonHandle.ObjectToJson(result);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        public void SaleTM_AOrB_ex(HttpContext context, ref string strResult)
        {
            if (context.Session["user_name"] == null)
            {
                context.Response.End();
            }
            else
            {
                string str = context.Session["user_name"].ToString();
                agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
                ReturnResult result = new ReturnResult();
                result.set_success(400);
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "user_allow_sale");
                if (!model.get_u_type().Trim().Equals("zj"))
                {
                    context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                    context.Response.End();
                }
                if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_3")))
                {
                    context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                    context.Response.End();
                }
                string str3 = LSRequest.qq("phaseid");
                string str4 = LSRequest.qq("playid");
                string oddsid = LSRequest.qq("oddsid");
                string str6 = LSRequest.qq("number");
                LSRequest.qq("playpage");
                string str7 = LSRequest.qq("s_user");
                LSRequest.qq("phase");
                string str8 = LSRequest.qq("jeucode");
                string s = LSRequest.qq("amount");
                string str10 = LSRequest.qq("currentodds");
                if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str8))
                {
                    context.Session["JeuValidate"] = null;
                    result.set_success(400);
                    new Dictionary<string, object>();
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    context.Session["JeuValidate"] = null;
                    if (double.Parse(s) < 10.0)
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100096", "MessageHint"), 10));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str7);
                        if ((user == null) || !user.get_flag().Equals(1))
                        {
                            result.set_tipinfo(PageBase.GetMessageByCache("u100075", "MessageHint"));
                            result.set_success(400);
                            string str11 = base.get_JeuValidate();
                            dictionary.Add("jeucode", str11);
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            string str12 = user.get_salt().ToUpper();
                            string sqlconn = user.get_sqlconn();
                            string str14 = user.get_sqlconn_write();
                            string str15 = user.get_six_kind();
                            string str16 = user.get_u_nicker();
                            string str17 = "";
                            string str18 = "";
                            Dictionary<string, string> dictionary2 = CallBLL.cz_autosale_six_ex_bll.GetHyUpTypeAndZJName(str7, str12, sqlconn);
                            if (dictionary2 == null)
                            {
                                result.set_tipinfo(PageBase.GetMessageByCache("u100075", "MessageHint"));
                                result.set_success(400);
                                string str19 = base.get_JeuValidate();
                                dictionary.Add("jeucode", str19);
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                str17 = dictionary2["su_type"];
                                str18 = dictionary2["zjname"];
                                user_six_rate _rate = CallBLL.cz_autosale_six_ex_bll.GetRateByAccount_ex(str7, str12, sqlconn, str18);
                                double num = 0.0;
                                double num2 = 0.0;
                                if (_rate.get_zcyg().Equals("1"))
                                {
                                    num = (((100.0 - double.Parse(_rate.get_fgszc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc())) - double.Parse(_rate.get_dlzc());
                                    num2 = double.Parse(_rate.get_fgszc());
                                }
                                else
                                {
                                    num2 = (((100.0 - double.Parse(_rate.get_zjzc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc())) - double.Parse(_rate.get_dlzc());
                                    num = double.Parse(_rate.get_zjzc());
                                }
                                int num5 = 1;
                                if (str17.ToLower() != "dl")
                                {
                                    num5 = -1;
                                }
                                DataTable table = null;
                                DataSet set = CallBLL.cz_autosale_six_ex_bll.AccountIsDisabled_ex(_rate.get_fgsname(), _rate.get_gdname(), _rate.get_zdname(), _rate.get_dlname(), str7, str12, sqlconn);
                                if (set != null)
                                {
                                    table = set.Tables[0];
                                    if ((table != null) && (table.Rows.Count > 0))
                                    {
                                        if (table.Rows[0]["a_state"].ToString().Trim() == "1")
                                        {
                                            result.set_tipinfo("內網目標系統提示：該內網外補會員或上級已經被凍結,請與上級聯系！");
                                        }
                                        else
                                        {
                                            result.set_tipinfo("內網目標系統提示：該內網外補會員或上級已經被停用,請與上級聯系！");
                                        }
                                        result.set_success(400);
                                        string str21 = base.get_JeuValidate();
                                        dictionary.Add("jeucode", str21);
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                if (!base.IsNumber(s))
                                {
                                    result.set_tipinfo("下注金額有誤！");
                                    result.set_success(500);
                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                else
                                {
                                    string str22 = "";
                                    string str23 = "";
                                    string str24 = "";
                                    string str25 = "";
                                    cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                                    if (currentPhase != null)
                                    {
                                        if (currentPhase.get_is_closed() == 1)
                                        {
                                            result.set_tipinfo(string.Format("奖期[{0}]已封盘,停止下注！", currentPhase.get_phase().ToString()));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        str22 = currentPhase.get_phase().ToString();
                                        str23 = currentPhase.get_p_id().ToString();
                                    }
                                    else
                                    {
                                        result.set_tipinfo(string.Format("该奖期已停止下注！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(oddsid);
                                    DateTime now = DateTime.Now;
                                    DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                                    DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                                    if ((((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91004") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91007") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91038")))
                                    {
                                        if (time3 < now)
                                        {
                                            result.set_tipinfo(string.Format("已經截止下註！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    else if (time2 < now)
                                    {
                                        result.set_tipinfo(string.Format("已經截止下註！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    cz_phase_six _six3 = CallBLL.cz_autosale_six_ex_bll.GetCurrentPhase_ex(str12, sqlconn);
                                    if (_six3 != null)
                                    {
                                        if (_six3.get_is_closed() == 1)
                                        {
                                            result.set_tipinfo(string.Format("內網目標系統提示：奖期[{0}]已封盘,停止下注！", _six3.get_phase().ToString()));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                        str24 = _six3.get_phase().ToString();
                                        str25 = _six3.get_p_id().ToString();
                                    }
                                    else
                                    {
                                        result.set_tipinfo(string.Format("內網目標系統提示：奖期已停止下注！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    DataTable table3 = CallBLL.cz_autosale_six_ex_bll.GetPlayIDByOddsIds_ex(oddsid, str12, sqlconn);
                                    DateTime time4 = DateTime.Now;
                                    DateTime time5 = Convert.ToDateTime(_six3.get_stop_date());
                                    DateTime time6 = Convert.ToDateTime(_six3.get_sn_stop_date());
                                    if ((((table3.Rows[0]["play_id"].ToString().Trim() == "91001") || (table3.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((table3.Rows[0]["play_id"].ToString().Trim() == "91004") || (table3.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((table3.Rows[0]["play_id"].ToString().Trim() == "91007") || (table3.Rows[0]["play_id"].ToString().Trim() == "91038")))
                                    {
                                        if (time6 < time4)
                                        {
                                            result.set_tipinfo(string.Format("內網目標系統提示：已經截止下註！", new object[0]));
                                            result.set_success(400);
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    else if (time5 < time4)
                                    {
                                        result.set_tipinfo(string.Format("內網目標系統提示：已經截止下註！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (!str23.Equals(str3))
                                    {
                                        result.set_tipinfo(string.Format("獎期错误！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                    else if (!str22.Equals(str24))
                                    {
                                        result.set_tipinfo(string.Format("內網目標系統的獎期與當前系統的獎期不一致！", new object[0]));
                                        result.set_success(400);
                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                    }
                                    else
                                    {
                                        string str26 = "";
                                        string str27 = "";
                                        double num6 = 0.0;
                                        DataTable table4 = CallBLL.cz_autosale_six_ex_bll.GetUserRate_ex(str7, 1, str12, sqlconn).Tables[0];
                                        str26 = table4.Rows[0]["six_kind"].ToString().Trim();
                                        str27 = table4.Rows[0]["su_type"].ToString().Trim();
                                        num6 = double.Parse(table4.Rows[0]["six_usable_credit"].ToString().Trim());
                                        string str28 = "0";
                                        string str29 = "0";
                                        string str30 = "0";
                                        string str31 = "0";
                                        string str32 = "0";
                                        string str33 = "0";
                                        double num7 = 0.0;
                                        double num8 = 0.0;
                                        double num9 = 0.0;
                                        double num10 = 0.0;
                                        double num11 = 0.0;
                                        double num12 = 0.0;
                                        string str34 = "";
                                        string str35 = "";
                                        string str36 = "0";
                                        DataTable table5 = CallBLL.cz_autosale_six_ex_bll.GetPlayOddsByID_ex(oddsid, str12, sqlconn).Tables[0];
                                        if (table5.Rows.Count == 0)
                                        {
                                            result.set_success(400);
                                            result.set_tipinfo("內網目標系統提示：賠率ID設置错误!");
                                            dictionary.Add("jeucode", base.get_JeuValidate());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                        }
                                        else
                                        {
                                            int num26 = 100;
                                            DataTable table6 = CallBLL.cz_autosale_six_ex_bll.GetSinglePhaseByBet_ex(str24, str7, num26.ToString(), oddsid, str12, sqlconn).Tables[0];
                                            double num13 = 0.0;
                                            string str37 = "";
                                            List<string> list = new List<string>();
                                            List<string> list2 = new List<string>();
                                            int num14 = 0;
                                            num7 = 0.0;
                                            foreach (DataRow row in table5.Rows)
                                            {
                                                if (row["odds_id"].ToString().Trim() == oddsid.Trim())
                                                {
                                                    str37 = row["is_open"].ToString().Trim();
                                                    str4 = row["play_id"].ToString().Trim();
                                                    str34 = row["play_name"].ToString().Trim();
                                                    str35 = row["put_amount"].ToString().Trim();
                                                    str36 = row["isLM"].ToString().Trim();
                                                    row["isDoubleOdds"].ToString().Trim();
                                                    num12 = double.Parse(row["allow_min_amount"].ToString().Trim());
                                                    num9 = double.Parse(row["allow_max_amount"].ToString().Trim());
                                                    num11 = double.Parse(row["allow_max_put_amount"].ToString().Trim());
                                                    break;
                                                }
                                            }
                                            if (table6.Rows.Count > 0)
                                            {
                                                foreach (DataRow row2 in table6.Rows)
                                                {
                                                    if (row2["odds_id"].ToString().Trim() == oddsid.Trim())
                                                    {
                                                        num7 = double.Parse(row2["sumbet"].ToString().Trim());
                                                        break;
                                                    }
                                                }
                                            }
                                            DataTable table7 = CallBLL.cz_autosale_six_ex_bll.GetDrawbackByPlayId_ex(str4, str7, str12, sqlconn).Tables[0];
                                            num8 = double.Parse(table7.Rows[0]["single_max_amount"].ToString().Trim());
                                            double num15 = double.Parse(table7.Rows[0]["single_min_amount"].ToString().Trim());
                                            num10 = double.Parse(table7.Rows[0]["single_phase_amount"].ToString().Trim());
                                            if (num8 > num9)
                                            {
                                                num8 = num9;
                                            }
                                            if (num10 > num11)
                                            {
                                                num10 = num11;
                                            }
                                            if (num15 > num12)
                                            {
                                                num12 = num15;
                                            }
                                            if (str37 != "1")
                                            {
                                                result.set_tipinfo(string.Format("內網目標系統提示：{0}【{1}】已經停止投注！", str34, str35));
                                                result.set_success(400);
                                                dictionary.Add("jeucode", base.get_JeuValidate());
                                                result.set_data(dictionary);
                                                strResult = JsonHandle.ObjectToJson(result);
                                            }
                                            else
                                            {
                                                DataTable table8 = this.GetNumberWTTable(oddsid, sqlconn, str12.ToUpper());
                                                num13 = double.Parse(CallBLL.cz_autosale_six_ex_bll.GetPlay_ex(oddsid, str7, sqlconn, str15, str12.ToUpper(), table8, str6, base.get_YearLianID()));
                                                if (double.Parse(str10) != double.Parse(num13.ToString()))
                                                {
                                                    list.Add(num14.ToString());
                                                    list2.Add(num13.ToString());
                                                }
                                                if (double.Parse(s) > num8)
                                                {
                                                    result.set_tipinfo(string.Format("內網目標系統提示：下注金額超出單注最大金額！", new object[0]));
                                                    result.set_success(500);
                                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                                    result.set_data(dictionary);
                                                    strResult = JsonHandle.ObjectToJson(result);
                                                }
                                                else if (double.Parse(s) > num6)
                                                {
                                                    result.set_tipinfo(string.Format("內網目標系統提示：下注金額超出可用金額！", new object[0]));
                                                    result.set_success(500);
                                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                                    result.set_data(dictionary);
                                                    strResult = JsonHandle.ObjectToJson(result);
                                                }
                                                else if (double.Parse(s) < num12)
                                                {
                                                    result.set_tipinfo(string.Format("內網目標系統提示：下注金額低過最低金額！", new object[0]));
                                                    result.set_success(500);
                                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                                    result.set_data(dictionary);
                                                    strResult = JsonHandle.ObjectToJson(result);
                                                }
                                                else if (!str36.Equals("1") && ((double.Parse(s) + num7) > num10))
                                                {
                                                    result.set_tipinfo(string.Format("內網目標系統提示：{0}【{1}】下注單期金額超出單期最大金額！", str34, str35));
                                                    result.set_success(500);
                                                    dictionary.Add("jeucode", base.get_JeuValidate());
                                                    result.set_data(dictionary);
                                                    strResult = JsonHandle.ObjectToJson(result);
                                                }
                                                else
                                                {
                                                    num14++;
                                                    if (list.Count > 0)
                                                    {
                                                        result.set_tipinfo(string.Format("內網目標系統提示：賠率有變動,請確認後再提交!", new object[0]));
                                                        result.set_success(600);
                                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                                        dictionary.Add("index", list);
                                                        dictionary.Add("newpl", list2);
                                                        result.set_data(dictionary);
                                                        strResult = JsonHandle.ObjectToJson(result);
                                                    }
                                                    else if (num6 < double.Parse(s))
                                                    {
                                                        result.set_tipinfo(string.Format("內網目標系統提示：可用餘額不足！", new object[0]));
                                                        result.set_success(500);
                                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                                        result.set_data(dictionary);
                                                        strResult = JsonHandle.ObjectToJson(result);
                                                    }
                                                    else
                                                    {
                                                        DataTable table9 = CallBLL.cz_bet_six_bll.GetSZZTByZJ(str23, table5.Rows[0]["play_id"].ToString(), context.Session["user_name"].ToString(), oddsid, str15);
                                                        if ((table9 == null) || (Convert.ToDouble(table9.Rows[0]["szzt"]) < 1.0))
                                                        {
                                                            result.set_success(400);
                                                            result.set_tipinfo(PageBase.GetMessageByCache("u100047", "MessageHint"));
                                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                            result.set_data(dictionary);
                                                            strResult = JsonHandle.ObjectToJson(result);
                                                        }
                                                        else if (Convert.ToDouble(s) > Convert.ToDouble(table9.Rows[0]["szzt"]))
                                                        {
                                                            result.set_success(400);
                                                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100076", "MessageHint"), string.Format("{0:F0}", double.Parse(table9.Rows[0]["szzt"].ToString()))));
                                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                            result.set_data(dictionary);
                                                            strResult = JsonHandle.ObjectToJson(result);
                                                        }
                                                        else
                                                        {
                                                            DataTable table10 = CallBLL.cz_odds_six_bll.GetOddsByID(oddsid).Tables[0];
                                                            if (table10.Rows[0]["is_open"].ToString().Equals("0"))
                                                            {
                                                                result.set_success(400);
                                                                result.set_tipinfo(string.Format("{0}【{1}】 已停盤！", table10.Rows[0]["play_name"].ToString(), table10.Rows[0]["put_amount"].ToString()));
                                                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                                result.set_data(dictionary);
                                                                strResult = JsonHandle.ObjectToJson(result);
                                                            }
                                                            else
                                                            {
                                                                string str39 = "";
                                                                num14 = 0;
                                                                DataTable table11 = CallBLL.cz_autosale_six_ex_bll.GetOddsByID_ex(oddsid, str12, sqlconn).Tables[0];
                                                                int num16 = int.Parse(table11.Rows[0]["play_id"].ToString());
                                                                string str40 = table11.Rows[0]["o_play_name"].ToString();
                                                                string str41 = table11.Rows[0]["put_amount"].ToString();
                                                                if (table11.Rows[0]["is_open"].ToString().Equals("0"))
                                                                {
                                                                    result.set_success(400);
                                                                    result.set_tipinfo(string.Format("內網目標系統提示：{0}【{1}】 已停盤！", str40, str41));
                                                                    context.Session["JeuValidate"] = base.get_JeuValidate();
                                                                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                                    result.set_data(dictionary);
                                                                    strResult = JsonHandle.ObjectToJson(result);
                                                                }
                                                                else
                                                                {
                                                                    string str42 = string.Format(" '{0}','{1}','{2}','{3}','{4}','{5}' ", new object[] { str18, _rate.get_fgsname(), _rate.get_gdname(), _rate.get_zdname(), _rate.get_dlname(), str7 });
                                                                    foreach (DataRow row3 in CallBLL.cz_autosale_six_ex_bll.GetDrawbackUpNames_ex(str42, str12, sqlconn).Select(string.Format(" play_id={0} ", num16)))
                                                                    {
                                                                        string str49 = row3["u_type"].ToString().Trim();
                                                                        if (str49 != null)
                                                                        {
                                                                            if (!(str49 == "zj"))
                                                                            {
                                                                                if (str49 == "fgs")
                                                                                {
                                                                                    goto Label_1848;
                                                                                }
                                                                                if (str49 == "gd")
                                                                                {
                                                                                    goto Label_186C;
                                                                                }
                                                                                if (str49 == "zd")
                                                                                {
                                                                                    goto Label_1890;
                                                                                }
                                                                                if (str49 == "dl")
                                                                                {
                                                                                    goto Label_18B4;
                                                                                }
                                                                                if (str49 == "hy")
                                                                                {
                                                                                    goto Label_18D8;
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                str28 = row3[str26 + "_drawback"].ToString().Trim();
                                                                            }
                                                                        }
                                                                        continue;
                                                                    Label_1848:
                                                                        str29 = row3[str26 + "_drawback"].ToString().Trim();
                                                                        continue;
                                                                    Label_186C:
                                                                        str30 = row3[str26 + "_drawback"].ToString().Trim();
                                                                        continue;
                                                                    Label_1890:
                                                                        str31 = row3[str26 + "_drawback"].ToString().Trim();
                                                                        continue;
                                                                    Label_18B4:
                                                                        str32 = row3[str26 + "_drawback"].ToString().Trim();
                                                                        continue;
                                                                    Label_18D8:
                                                                        switch (str27)
                                                                        {
                                                                            case "dl":
                                                                                str33 = row3[str26 + "_drawback"].ToString().Trim();
                                                                                break;

                                                                            case "zd":
                                                                                str32 = row3[str26 + "_drawback"].ToString().Trim();
                                                                                break;

                                                                            case "gd":
                                                                                str31 = row3[str26 + "_drawback"].ToString().Trim();
                                                                                break;

                                                                            case "fgs":
                                                                                str30 = row3[str26 + "_drawback"].ToString().Trim();
                                                                                break;
                                                                        }
                                                                    }
                                                                    string str43 = str10;
                                                                    double num28 = double.Parse(table11.Rows[0]["current_odds"].ToString()) + Convert.ToDouble(table11.Rows[0][str26 + "_diff"].ToString().Trim());
                                                                    str39 = num28.ToString();
                                                                    cz_bet_six _six4 = new cz_bet_six();
                                                                    _six4.set_order_num(Utils.GetOrderNumber());
                                                                    _six4.set_checkcode(str8);
                                                                    _six4.set_u_name(str7);
                                                                    _six4.set_u_nicker(str16);
                                                                    _six4.set_phase_id(new int?(int.Parse(str25)));
                                                                    _six4.set_phase(str24);
                                                                    _six4.set_bet_time(new DateTime?(DateTime.Now));
                                                                    _six4.set_odds_id(new int?(int.Parse(oddsid)));
                                                                    _six4.set_category(table11.Rows[0]["category"].ToString());
                                                                    _six4.set_play_id(new int?(int.Parse(table11.Rows[0]["play_id"].ToString())));
                                                                    _six4.set_play_name(table11.Rows[0]["o_play_name"].ToString());
                                                                    _six4.set_bet_val(table11.Rows[0]["put_amount"].ToString());
                                                                    _six4.set_odds(str43);
                                                                    _six4.set_amount(new decimal?(decimal.Parse(s)));
                                                                    _six4.set_profit(0);
                                                                    _six4.set_hy_drawback(new decimal?(decimal.Parse(str33)));
                                                                    _six4.set_dl_drawback(new decimal?(decimal.Parse(str32)));
                                                                    _six4.set_zd_drawback(new decimal?(decimal.Parse(str31)));
                                                                    _six4.set_gd_drawback(new decimal?(decimal.Parse(str30)));
                                                                    _six4.set_fgs_drawback(new decimal?(decimal.Parse(str29)));
                                                                    _six4.set_zj_drawback(new decimal?(decimal.Parse(str28)));
                                                                    _six4.set_dl_rate((float) int.Parse(_rate.get_dlzc()));
                                                                    _six4.set_zd_rate((float) int.Parse(_rate.get_zdzc()));
                                                                    _six4.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                                                                    _six4.set_fgs_rate((float) int.Parse(num2.ToString()));
                                                                    _six4.set_zj_rate((float) int.Parse(num.ToString()));
                                                                    _six4.set_is_payment(0);
                                                                    _six4.set_dl_name(_rate.get_dlname());
                                                                    _six4.set_zd_name(_rate.get_zdname());
                                                                    _six4.set_gd_name(_rate.get_gdname());
                                                                    _six4.set_fgs_name(_rate.get_fgsname());
                                                                    _six4.set_m_type(new int?(num5));
                                                                    _six4.set_kind(str26.ToUpper());
                                                                    _six4.set_ip(LSRequest.GetIP());
                                                                    _six4.set_lottery_type(100);
                                                                    _six4.set_lottery_name(base.GetGameNameByID(_six4.get_lottery_type().ToString()));
                                                                    _six4.set_isLM(0);
                                                                    _six4.set_ordervalidcode(Utils.GetOrderValidCode(_six4.get_u_name(), _six4.get_order_num(), _six4.get_bet_val(), _six4.get_odds(), _six4.get_kind(), Convert.ToInt32(_six4.get_phase_id()), Convert.ToInt32(_six4.get_odds_id()), Convert.ToDouble(_six4.get_amount())));
                                                                    _six4.set_odds_zj(str39);
                                                                    int num17 = 0;
                                                                    if (!CallBLL.cz_autosale_six_ex_bll.AddBet_ex(_six4, decimal.Parse(s), str7, ref num17, str12, str14) || (num17 <= 0))
                                                                    {
                                                                        result.set_tipinfo(string.Format("內網目標系統提示：系統錯誤！", new object[0]));
                                                                        result.set_success(400);
                                                                        dictionary.Add("jeucode", base.get_JeuValidate());
                                                                        result.set_data(dictionary);
                                                                        strResult = JsonHandle.ObjectToJson(result);
                                                                    }
                                                                    else
                                                                    {
                                                                        double num18 = (double.Parse(s) * double.Parse(_rate.get_zjzc())) / 100.0;
                                                                        CallBLL.cz_autosale_six_ex_bll.UpdateGrandTotal_ex(Convert.ToDecimal(num18), int.Parse(oddsid), str12, sqlconn);
                                                                        double num19 = double.Parse(table11.Rows[0]["grand_total"].ToString()) + num18;
                                                                        double num20 = double.Parse(table11.Rows[0]["downbase"].ToString());
                                                                        double num21 = Math.Floor((double) (num19 / num20));
                                                                        if (num21 >= 1.0)
                                                                        {
                                                                            double num22 = double.Parse(table11.Rows[0]["down_odds_rate"].ToString()) * num21;
                                                                            CallBLL.cz_autosale_six_ex_bll.UpdateGrandTotalCurrentOdds_ex(num22.ToString(), (num19 - (num20 * num21)).ToString(), oddsid, str12, str14);
                                                                            cz_system_log _log = new cz_system_log();
                                                                            _log.set_user_name("系統");
                                                                            _log.set_children_name("");
                                                                            _log.set_category(table11.Rows[0]["category"].ToString());
                                                                            _log.set_play_name(str40);
                                                                            _log.set_put_amount(str41);
                                                                            num26 = 100;
                                                                            _log.set_l_name(base.GetGameNameByID(num26.ToString()));
                                                                            _log.set_l_phase(str22);
                                                                            _log.set_action("降賠率");
                                                                            _log.set_odds_id(int.Parse(oddsid));
                                                                            string str44 = table11.Rows[0]["current_odds"].ToString();
                                                                            _log.set_old_val(str44);
                                                                            num28 = double.Parse(str44) - num22;
                                                                            _log.set_new_val(num28.ToString());
                                                                            _log.set_ip(LSRequest.GetIP());
                                                                            _log.set_add_time(DateTime.Now);
                                                                            _log.set_note("系統自動降賠");
                                                                            _log.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                                                            _log.set_lottery_type(100);
                                                                            CallBLL.cz_autosale_six_ex_bll.SystemLogAdd_ex(_log, str12, str14);
                                                                            cz_jp_odds _odds = new cz_jp_odds();
                                                                            _odds.set_add_time(DateTime.Now);
                                                                            _odds.set_odds_id(int.Parse(oddsid));
                                                                            _odds.set_phase_id(int.Parse(str23));
                                                                            _odds.set_play_name(str40);
                                                                            _odds.set_put_amount(str41);
                                                                            _odds.set_odds(num22.ToString());
                                                                            _odds.set_lottery_type(100);
                                                                            _odds.set_phase(str22);
                                                                            _odds.set_old_odds(str44);
                                                                            num28 = double.Parse(str44) - num22;
                                                                            _odds.set_new_odds(num28.ToString());
                                                                            CallBLL.cz_autosale_six_ex_bll.JPOddsAdd_ex(_odds, str12, str14);
                                                                            if (int.Parse(oddsid) <= 0x16791)
                                                                            {
                                                                                num26 = Convert.ToInt32(oddsid) + 0x31;
                                                                                CallBLL.cz_autosale_six_ex_bll.UpdateCurrentOdds_ex(num22.ToString(), num26.ToString(), str12, str14);
                                                                                cz_system_log _log2 = new cz_system_log();
                                                                                _log2.set_user_name("系統");
                                                                                _log2.set_children_name("");
                                                                                _log2.set_category(table11.Rows[0]["category"].ToString());
                                                                                _log2.set_play_name(str40);
                                                                                _log2.set_put_amount(str41);
                                                                                num26 = 100;
                                                                                _log2.set_l_name(base.GetGameNameByID(num26.ToString()));
                                                                                _log2.set_l_phase(str22);
                                                                                _log2.set_action("降賠率");
                                                                                _log2.set_odds_id(int.Parse(oddsid) + 0x31);
                                                                                string str45 = table11.Rows[0]["current_odds"].ToString();
                                                                                _log2.set_old_val(str45);
                                                                                num28 = double.Parse(str45) - num22;
                                                                                _log2.set_new_val(num28.ToString());
                                                                                _log2.set_ip(LSRequest.GetIP());
                                                                                _log2.set_add_time(DateTime.Now);
                                                                                _log2.set_note("系統自動降賠");
                                                                                _log2.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                                                                _log2.set_lottery_type(100);
                                                                                CallBLL.cz_autosale_six_ex_bll.SystemLogAdd_ex(_log2, str12, str14);
                                                                                cz_jp_odds _odds2 = new cz_jp_odds();
                                                                                _odds2.set_add_time(DateTime.Now);
                                                                                _odds2.set_odds_id(int.Parse(oddsid) + 0x31);
                                                                                _odds2.set_phase_id(int.Parse(str23));
                                                                                _odds2.set_play_name(str40);
                                                                                _odds2.set_put_amount(str41);
                                                                                _odds2.set_odds(num22.ToString());
                                                                                _odds2.set_lottery_type(100);
                                                                                _odds2.set_phase(str22);
                                                                                _odds2.set_old_odds(str45);
                                                                                num28 = double.Parse(str45) - num22;
                                                                                _odds2.set_new_odds(num28.ToString());
                                                                                CallBLL.cz_autosale_six_ex_bll.JPOddsAdd_ex(_odds2, str12, str14);
                                                                            }
                                                                            if ((int.Parse(oddsid) > 0x16791) && (int.Parse(oddsid) <= 0x167c2))
                                                                            {
                                                                                num26 = Convert.ToInt32(oddsid) - 0x31;
                                                                                CallBLL.cz_autosale_six_ex_bll.UpdateCurrentOdds_ex(num22.ToString(), num26.ToString(), str12, str14);
                                                                                cz_system_log _log3 = new cz_system_log();
                                                                                _log3.set_user_name("系統");
                                                                                _log3.set_children_name("");
                                                                                _log3.set_category(table11.Rows[0]["category"].ToString());
                                                                                _log3.set_play_name(str40);
                                                                                _log3.set_put_amount(str41);
                                                                                num26 = 100;
                                                                                _log3.set_l_name(base.GetGameNameByID(num26.ToString()));
                                                                                _log3.set_l_phase(str22);
                                                                                _log3.set_action("降賠率");
                                                                                _log3.set_odds_id(int.Parse(oddsid) - 0x31);
                                                                                string str46 = table11.Rows[0]["current_odds"].ToString();
                                                                                _log3.set_old_val(str46);
                                                                                num28 = double.Parse(str46) - num22;
                                                                                _log3.set_new_val(num28.ToString());
                                                                                _log3.set_ip(LSRequest.GetIP());
                                                                                _log3.set_add_time(DateTime.Now);
                                                                                _log3.set_note("系統自動降賠");
                                                                                _log3.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                                                                _log3.set_lottery_type(100);
                                                                                CallBLL.cz_autosale_six_ex_bll.SystemLogAdd_ex(_log3, str12, str14);
                                                                                cz_jp_odds _odds3 = new cz_jp_odds();
                                                                                _odds3.set_add_time(DateTime.Now);
                                                                                _odds3.set_odds_id(int.Parse(oddsid) - 0x31);
                                                                                _odds3.set_phase_id(int.Parse(str23));
                                                                                _odds3.set_play_name(str40);
                                                                                _odds3.set_put_amount(str41);
                                                                                _odds3.set_odds(num22.ToString());
                                                                                _odds3.set_lottery_type(100);
                                                                                _odds3.set_phase(str22);
                                                                                _odds3.set_old_odds(str46);
                                                                                _odds3.set_new_odds((double.Parse(str46) - num22).ToString());
                                                                                CallBLL.cz_autosale_six_ex_bll.JPOddsAdd_ex(_odds3, str12, str14);
                                                                            }
                                                                        }
                                                                        num14++;
                                                                        cz_bet_six _six5 = new cz_bet_six();
                                                                        _six5.set_order_num(_six4.get_order_num());
                                                                        _six5.set_u_name(_six4.get_u_name());
                                                                        _six5.set_u_nicker(_six4.get_u_nicker());
                                                                        _six5.set_phase_id(new int?(int.Parse(str23)));
                                                                        _six5.set_phase(str22);
                                                                        _six5.set_bet_time(new DateTime?(DateTime.Now));
                                                                        _six5.set_checkcode(str8);
                                                                        _six5.set_odds_id(new int?(int.Parse(oddsid)));
                                                                        _six5.set_category(table11.Rows[0]["category"].ToString());
                                                                        _six5.set_play_id(new int?(int.Parse(table11.Rows[0]["play_id"].ToString())));
                                                                        _six5.set_play_name(table11.Rows[0]["o_play_name"].ToString());
                                                                        _six5.set_bet_val(table11.Rows[0]["put_amount"].ToString());
                                                                        _six5.set_odds(str10);
                                                                        _six5.set_amount(new decimal?(decimal.Parse(s)));
                                                                        _six5.set_profit(0);
                                                                        _six5.set_isLM(0);
                                                                        _six5.set_hy_drawback(new decimal?(decimal.Parse(str33)));
                                                                        _six5.set_dl_drawback(new decimal?(decimal.Parse(str32)));
                                                                        _six5.set_zd_drawback(new decimal?(decimal.Parse(str31)));
                                                                        _six5.set_gd_drawback(new decimal?(decimal.Parse(str30)));
                                                                        _six5.set_fgs_drawback(new decimal?(decimal.Parse(str29)));
                                                                        _six5.set_zj_drawback(new decimal?(decimal.Parse(str28)));
                                                                        _six5.set_dl_rate(0f);
                                                                        _six5.set_zd_rate(0f);
                                                                        _six5.set_gd_rate(0f);
                                                                        _six5.set_fgs_rate(0f);
                                                                        _six5.set_zj_rate(0f);
                                                                        _six5.set_is_payment(0);
                                                                        _six5.set_dl_name("");
                                                                        _six5.set_zd_name("");
                                                                        _six5.set_gd_name("");
                                                                        _six5.set_fgs_name(context.Session["user_name"].ToString());
                                                                        _six5.set_sale_type(1);
                                                                        _six5.set_m_type(-2);
                                                                        _six5.set_kind(_six4.get_kind().ToUpper());
                                                                        _six5.set_ip(LSRequest.GetIP());
                                                                        _six5.set_lottery_type(100);
                                                                        _six5.set_lottery_name(base.GetGameNameByID(_six5.get_lottery_type().ToString()));
                                                                        _six5.set_ordervalidcode(Utils.GetOrderValidCode(_six5.get_u_name(), _six5.get_order_num(), _six5.get_bet_val(), _six5.get_odds(), _six5.get_kind(), Convert.ToInt32(_six5.get_phase_id()), Convert.ToInt32(_six5.get_odds_id()), Convert.ToDouble(_six5.get_amount())));
                                                                        _six5.set_odds_zj(_six4.get_odds());
                                                                        int num24 = 0;
                                                                        CallBLL.cz_bet_six_bll.AddBHBetByZJ(_six5, ref num24);
                                                                        string str47 = "";
                                                                        double num25 = double.Parse(s) * (num13 - 1.0);
                                                                        str47 = num25.ToString();
                                                                        string str48 = str41;
                                                                        List<FastSale> list3 = new List<FastSale>();
                                                                        FastSale item = new FastSale();
                                                                        item.set_success("1");
                                                                        item.set_ordernum(_six4.get_order_num());
                                                                        item.set_playname(_six4.get_play_name());
                                                                        item.set_putamount(str48);
                                                                        str47 = num25.ToString();
                                                                        item.set_ky(str47);
                                                                        item.set_islm("0");
                                                                        item.set_pl(num13.ToString());
                                                                        item.set_amount(s);
                                                                        item.set_message("");
                                                                        list3.Add(item);
                                                                        dictionary.Add("bhdata", list3);
                                                                        new Dictionary<string, object>();
                                                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                                                        result.set_data(dictionary);
                                                                        result.set_success(200);
                                                                        strResult = JsonHandle.ObjectToJson(result);
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        private void SetWtValue(DataTable numberAmountTableDT, DataTable wtTableDT, string odds_id, double min_odds, double current_odds, double p_jphl, double p_pljd, string category, string play_name, string put_amount, string phase, string phase_id)
        {
            foreach (DataRow row in numberAmountTableDT.Rows)
            {
                int num = int.Parse(row["number"].ToString());
                double num2 = double.Parse(row["amount"].ToString());
                double num3 = double.Parse(wtTableDT.Select(string.Format(" number={0} ", num))[0]["wt_value"].ToString());
                double num4 = p_jphl;
                double num5 = p_pljd;
                double num6 = Math.Floor((double) (num2 / num4));
                if (num6 >= 1.0)
                {
                    num5 *= num6;
                    double num7 = num4 * num6;
                    double num8 = num3 - num5;
                    if ((num8 + current_odds) > min_odds)
                    {
                        CallBLL.cz_lm_number_amount_six_bll.SetNumberWTValue(int.Parse(odds_id), num, num8, num7);
                    }
                    else if (current_odds > min_odds)
                    {
                        num8 = -(current_odds - min_odds);
                        CallBLL.cz_lm_number_amount_six_bll.SetNumberWTValue(int.Parse(odds_id), num, num8, num7);
                    }
                    this.SetWtValueLog(odds_id, num3, num8, category, play_name, put_amount, phase, phase_id, num.ToString());
                }
            }
        }

        private void SetWtValueDuble(DataTable numberAmountTableDT, DataTable wtTableDT, string odds_id, string min_odds, string current_odds, double p_jphl, double p_pljd, string category, string play_name, string put_amount, string phase, string phase_id)
        {
            foreach (DataRow row in numberAmountTableDT.Rows)
            {
                int num = int.Parse(row["number"].ToString());
                double num2 = double.Parse(row["amount"].ToString());
                double num3 = double.Parse(wtTableDT.Select(string.Format(" number={0} ", num))[0]["wt_value"].ToString());
                double num4 = p_jphl;
                double num5 = p_pljd;
                double num6 = Math.Floor((double) (num2 / num4));
                if (num6 >= 1.0)
                {
                    num5 *= num6;
                    double num7 = num4 * num6;
                    double num8 = num3 - num5;
                    double num9 = double.Parse(min_odds.Split(new char[] { ',' })[0]);
                    double num10 = double.Parse(min_odds.Split(new char[] { ',' })[1]);
                    double num11 = double.Parse(current_odds.Split(new char[] { ',' })[0]);
                    double num12 = double.Parse(current_odds.Split(new char[] { ',' })[1]);
                    if (((num8 + num11) > num9) && ((num8 + num12) > num10))
                    {
                        CallBLL.cz_lm_number_amount_six_bll.SetNumberWTValue(int.Parse(odds_id), num, num8, num7);
                    }
                    else if ((num11 > num9) && (num12 > num10))
                    {
                        if ((num11 - num9) > (num12 - num10))
                        {
                            num8 = -(num12 - num10);
                        }
                        else
                        {
                            num8 = -(num11 - num9);
                        }
                        CallBLL.cz_lm_number_amount_six_bll.SetNumberWTValue(int.Parse(odds_id), num, num8, num7);
                    }
                    this.SetWtValueLog(odds_id, num3, num8, category, play_name, put_amount, phase, phase_id, num.ToString());
                }
            }
        }

        private void SetWtValueLog(string odds_id, double old_val, double new_val, string category, string play_name, string put_amount, string phase, string phase_id, string number)
        {
            cz_system_log _log = new cz_system_log();
            _log.set_user_name("系統");
            _log.set_children_name("");
            _log.set_category(category);
            _log.set_play_name(play_name);
            _log.set_put_amount(put_amount);
            int num = 100;
            _log.set_l_name(base.GetGameNameByID(num.ToString()));
            _log.set_l_phase(phase);
            _log.set_action("降賠率");
            _log.set_odds_id(int.Parse(odds_id));
            _log.set_old_val(string.Format("號碼【{0}】：{1}", number, old_val));
            _log.set_new_val(string.Format("號碼【{0}】：{1}", number, new_val));
            _log.set_ip(LSRequest.GetIP());
            _log.set_add_time(DateTime.Now);
            _log.set_note("系統自動降賠");
            _log.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
            _log.set_lottery_type(100);
            CallBLL.cz_system_log_bll.Add(_log);
            cz_jp_odds _odds = new cz_jp_odds();
            _odds.set_add_time(DateTime.Now);
            _odds.set_odds_id(int.Parse(odds_id));
            _odds.set_phase_id(int.Parse(phase_id));
            _odds.set_play_name(play_name);
            _odds.set_put_amount(put_amount);
            _odds.set_odds((old_val - new_val).ToString());
            _odds.set_lottery_type(100);
            _odds.set_phase(phase);
            _odds.set_old_odds(old_val.ToString());
            _odds.set_new_odds(new_val.ToString());
            _odds.set_number(number);
            CallBLL.cz_jp_odds_bll.Add(_odds);
        }

        public void ShortcutBarOperate_adds(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                LSRequest.qq("number");
                LSRequest.qq("phaseid");
                string str5 = LSRequest.qq("pk");
                if (string.IsNullOrEmpty(str5))
                {
                    str5 = "A";
                }
                else
                {
                    str5 = str5.ToUpper();
                }
                string str6 = LSRequest.qq("wtvalue");
                string str7 = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else if (CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str4) == null)
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    string str12;
                    double num34;
                    int num35;
                    string[] strArray = str4.Split(new char[] { ',' });
                    if (str3.Equals("5") || str3.Equals("6"))
                    {
                        if (string.IsNullOrEmpty(str6))
                        {
                            str6 = "0.01";
                        }
                        double num = str3.Equals("5") ? Convert.ToDouble(str6) : -Convert.ToDouble(str6);
                        Dictionary<string, double> dictionary2 = new Dictionary<string, double>();
                        for (int i = 0; i < strArray.Length; i++)
                        {
                            double num11;
                            double num15;
                            string str8 = strArray[i];
                            cz_odds_six _six = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str8));
                            double num3 = Convert.ToDouble(_six.get_current_odds());
                            double num4 = Convert.ToDouble(_six.get_max_odds());
                            double num5 = Convert.ToDouble(_six.get_min_odds());
                            double num6 = 0.0;
                            str12 = str5.ToUpper();
                            if (str12 != null)
                            {
                                if (!(str12 == "A"))
                                {
                                    if (str12 == "B")
                                    {
                                        goto Label_0318;
                                    }
                                    if (str12 == "C")
                                    {
                                        goto Label_0328;
                                    }
                                }
                                else
                                {
                                    num6 = Convert.ToDouble(_six.get_a_diff());
                                }
                            }
                            goto Label_0336;
                        Label_0318:
                            num6 = Convert.ToDouble(_six.get_b_diff());
                            goto Label_0336;
                        Label_0328:
                            num6 = Convert.ToDouble(_six.get_c_diff());
                        Label_0336:
                            num34 = (num3 + num6) + num;
                            double num7 = double.Parse(num34.ToString());
                            if (str3.Equals("5"))
                            {
                                if (num7 > num4)
                                {
                                    dictionary2.Add(str8, num4);
                                }
                                else
                                {
                                    dictionary2.Add(str8, num7);
                                }
                            }
                            if (str3.Equals("6"))
                            {
                                if (num7 < num5)
                                {
                                    dictionary2.Add(str8, num5);
                                }
                                else
                                {
                                    dictionary2.Add(str8, num7);
                                }
                            }
                            if ((int.Parse(str8) < 0x16761) || (int.Parse(str8) > 0x16791))
                            {
                                goto Label_04EE;
                            }
                            double num8 = Convert.ToDouble(CallBLL.cz_system_set_six_bll.GetModel(1).get_ev_0());
                            cz_odds_six _six3 = CallBLL.cz_odds_six_bll.GetModel(int.Parse(str8) + 0x31);
                            Convert.ToDouble(_six3.get_current_odds());
                            double num9 = Convert.ToDouble(_six3.get_max_odds());
                            double num10 = Convert.ToDouble(_six3.get_min_odds());
                            str12 = str5.ToUpper();
                            if (str12 != null)
                            {
                                if (!(str12 == "A"))
                                {
                                    if (str12 == "B")
                                    {
                                        goto Label_0469;
                                    }
                                    if (str12 == "C")
                                    {
                                        goto Label_0478;
                                    }
                                }
                                else
                                {
                                    Convert.ToDouble(_six3.get_a_diff());
                                }
                            }
                            goto Label_0485;
                        Label_0469:
                            Convert.ToDouble(_six3.get_b_diff());
                            goto Label_0485;
                        Label_0478:
                            Convert.ToDouble(_six3.get_c_diff());
                        Label_0485:
                            num11 = num7 + num8;
                            if (num11 > num9)
                            {
                                num35 = int.Parse(str8) + 0x31;
                                dictionary2.Add(num35.ToString(), num9);
                            }
                            else
                            {
                                num35 = int.Parse(str8) + 0x31;
                                dictionary2.Add(num35.ToString(), num11);
                            }
                            if (num11 < num10)
                            {
                                num35 = int.Parse(str8) + 0x31;
                                dictionary2.Add(num35.ToString(), num10);
                            }
                        Label_04EE:
                            if ((int.Parse(str8) < 0x16792) || (int.Parse(str8) > 0x167c2))
                            {
                                continue;
                            }
                            double num12 = Convert.ToDouble(CallBLL.cz_system_set_six_bll.GetModel(1).get_ev_0());
                            cz_odds_six _six5 = CallBLL.cz_odds_six_bll.GetModel(int.Parse(str8) - 0x31);
                            Convert.ToDouble(_six5.get_current_odds());
                            double num13 = Convert.ToDouble(_six5.get_max_odds());
                            double num14 = Convert.ToDouble(_six5.get_min_odds());
                            str12 = str5.ToUpper();
                            if (str12 != null)
                            {
                                if (!(str12 == "A"))
                                {
                                    if (str12 == "B")
                                    {
                                        goto Label_05B1;
                                    }
                                    if (str12 == "C")
                                    {
                                        goto Label_05C0;
                                    }
                                }
                                else
                                {
                                    Convert.ToDouble(_six5.get_a_diff());
                                }
                            }
                            goto Label_05CD;
                        Label_05B1:
                            Convert.ToDouble(_six5.get_b_diff());
                            goto Label_05CD;
                        Label_05C0:
                            Convert.ToDouble(_six5.get_c_diff());
                        Label_05CD:
                            num15 = num7 - num12;
                            if (num15 > num13)
                            {
                                num35 = int.Parse(str8) - 0x31;
                                dictionary2.Add(num35.ToString(), num13);
                            }
                            else
                            {
                                num35 = int.Parse(str8) - 0x31;
                                dictionary2.Add(num35.ToString(), num15);
                            }
                            if (num15 < num14)
                            {
                                num35 = int.Parse(str8) - 0x31;
                                dictionary2.Add(num35.ToString(), num14);
                            }
                        }
                        string str9 = string.Join(",", dictionary2.Keys.ToArray<string>());
                        DataTable table2 = null;
                        Dictionary<string, double> dictionary3 = new Dictionary<string, double>();
                        if (base.IsChildSync())
                        {
                            table2 = CallBLL.cz_odds_six_bll.ZK_GetOddsTableByOddsIds(str9, base.IsChildSystem().get_conn());
                            foreach (KeyValuePair<string, double> pair in dictionary2)
                            {
                                double num16 = double.Parse(table2.Select(string.Format(" odds_id={0} ", pair.Key))[0]["current_odds"].ToString());
                                if (pair.Value > num16)
                                {
                                    dictionary3.Add(pair.Key, num16);
                                }
                                else
                                {
                                    dictionary3.Add(pair.Key, pair.Value);
                                }
                            }
                        }
                        else
                        {
                            dictionary3 = dictionary2;
                        }
                        DataTable oddsTableByOddsIds = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str9);
                        if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsShortcutBar(dictionary3) > 0)
                        {
                            if (oddsTableByOddsIds != null)
                            {
                                base.kjj_log(oddsTableByOddsIds, CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str9), str3);
                            }
                            result.set_success(200);
                            dictionary.Add("play_odds", this.GetOddsByOddsIds(str4, str5)["play_odds"]);
                        }
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else if (str3.Equals("7"))
                    {
                        if (string.IsNullOrEmpty(str7))
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            double num18 = Convert.ToDouble(str7);
                            Dictionary<string, double> dictionary4 = new Dictionary<string, double>();
                            for (int j = 0; j < strArray.Length; j++)
                            {
                                double num31;
                                string str10 = strArray[j];
                                cz_odds_six _six6 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str10));
                                double.Parse(_six6.get_current_odds());
                                double num20 = double.Parse(_six6.get_max_odds());
                                double num21 = double.Parse(_six6.get_min_odds());
                                double num22 = 0.0;
                                str12 = str5;
                                if (str12 != null)
                                {
                                    if (!(str12 == "A"))
                                    {
                                        if (str12 == "B")
                                        {
                                            goto Label_088B;
                                        }
                                        if (str12 == "C")
                                        {
                                            goto Label_089B;
                                        }
                                    }
                                    else
                                    {
                                        num22 = Convert.ToDouble(_six6.get_a_diff());
                                    }
                                }
                                goto Label_08A9;
                            Label_088B:
                                num22 = Convert.ToDouble(_six6.get_b_diff());
                                goto Label_08A9;
                            Label_089B:
                                num22 = Convert.ToDouble(_six6.get_c_diff());
                            Label_08A9:
                                num34 = num18 - num22;
                                double num23 = double.Parse(double.Parse(num34.ToString()).ToString("N6"));
                                if (num23 > num20)
                                {
                                    dictionary4.Add(str10, num20);
                                }
                                else if (num23 < num21)
                                {
                                    dictionary4.Add(str10, num21);
                                }
                                else
                                {
                                    dictionary4.Add(str10, num23);
                                }
                                if ((int.Parse(str10) < 0x16761) || (int.Parse(str10) > 0x16791))
                                {
                                    goto Label_0A5D;
                                }
                                double num24 = Convert.ToDouble(CallBLL.cz_system_set_six_bll.GetModel(1).get_ev_0());
                                cz_odds_six _six8 = CallBLL.cz_odds_six_bll.GetModel(int.Parse(str10) + 0x31);
                                Convert.ToDouble(_six8.get_current_odds());
                                double num25 = Convert.ToDouble(_six8.get_max_odds());
                                double num26 = Convert.ToDouble(_six8.get_min_odds());
                                str12 = str5.ToUpper();
                                if (str12 != null)
                                {
                                    if (!(str12 == "A"))
                                    {
                                        if (str12 == "B")
                                        {
                                            goto Label_09C5;
                                        }
                                        if (str12 == "C")
                                        {
                                            goto Label_09D4;
                                        }
                                    }
                                    else
                                    {
                                        Convert.ToDouble(_six8.get_a_diff());
                                    }
                                }
                                goto Label_09E1;
                            Label_09C5:
                                Convert.ToDouble(_six8.get_b_diff());
                                goto Label_09E1;
                            Label_09D4:
                                Convert.ToDouble(_six8.get_c_diff());
                            Label_09E1:
                                num34 = num23 + num24;
                                double num27 = double.Parse(num34.ToString("N6"));
                                if (num27 > num25)
                                {
                                    num35 = int.Parse(str10) + 0x31;
                                    dictionary4.Add(num35.ToString(), num25);
                                }
                                else
                                {
                                    num35 = int.Parse(str10) + 0x31;
                                    dictionary4.Add(num35.ToString(), num27);
                                }
                                if (num27 < num26)
                                {
                                    num35 = int.Parse(str10) + 0x31;
                                    dictionary4.Add(num35.ToString(), num26);
                                }
                            Label_0A5D:
                                if ((int.Parse(str10) < 0x16792) || (int.Parse(str10) > 0x167c2))
                                {
                                    continue;
                                }
                                double num28 = Convert.ToDouble(CallBLL.cz_system_set_six_bll.GetModel(1).get_ev_0());
                                cz_odds_six _six10 = CallBLL.cz_odds_six_bll.GetModel(int.Parse(str10) - 0x31);
                                Convert.ToDouble(_six10.get_current_odds());
                                double num29 = Convert.ToDouble(_six10.get_max_odds());
                                double num30 = Convert.ToDouble(_six10.get_min_odds());
                                str12 = str5.ToUpper();
                                if (str12 != null)
                                {
                                    if (!(str12 == "A"))
                                    {
                                        if (str12 == "B")
                                        {
                                            goto Label_0B20;
                                        }
                                        if (str12 == "C")
                                        {
                                            goto Label_0B2F;
                                        }
                                    }
                                    else
                                    {
                                        Convert.ToDouble(_six10.get_a_diff());
                                    }
                                }
                                goto Label_0B3C;
                            Label_0B20:
                                Convert.ToDouble(_six10.get_b_diff());
                                goto Label_0B3C;
                            Label_0B2F:
                                Convert.ToDouble(_six10.get_c_diff());
                            Label_0B3C:
                                num31 = num23 - num28;
                                if (num31 > num29)
                                {
                                    num35 = int.Parse(str10) - 0x31;
                                    dictionary4.Add(num35.ToString(), num29);
                                }
                                else
                                {
                                    num35 = int.Parse(str10) - 0x31;
                                    dictionary4.Add(num35.ToString(), num31);
                                }
                                if (num31 < num30)
                                {
                                    dictionary4.Add((int.Parse(str10) - 0x31).ToString(), num30);
                                }
                            }
                            string str11 = string.Join(",", dictionary4.Keys.ToArray<string>());
                            DataTable oldTable = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str11);
                            DataTable table5 = null;
                            Dictionary<string, double> dictionary5 = new Dictionary<string, double>();
                            if (base.IsChildSync())
                            {
                                table5 = CallBLL.cz_odds_six_bll.ZK_GetOddsTableByOddsIds(str11, base.IsChildSystem().get_conn());
                                foreach (KeyValuePair<string, double> pair2 in dictionary4)
                                {
                                    double num32 = double.Parse(table5.Select(string.Format(" odds_id={0} ", pair2.Key))[0]["current_odds"].ToString());
                                    if (pair2.Value > num32)
                                    {
                                        dictionary5.Add(pair2.Key, num32);
                                    }
                                    else
                                    {
                                        dictionary5.Add(pair2.Key, pair2.Value);
                                    }
                                }
                            }
                            else
                            {
                                dictionary5 = dictionary4;
                            }
                            if (CallBLL.cz_odds_six_bll.UpdateCurrentOddsShortcutBar(dictionary5) > 0)
                            {
                                if (oldTable != null)
                                {
                                    base.kjj_log(oldTable, CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str11), str3);
                                }
                                result.set_success(200);
                                dictionary.Add("play_odds", this.GetOddsByOddsIds(str4, str5)["play_odds"]);
                            }
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                    }
                }
            }
        }

        public void ShortcutBarOperate_adds_wt(HttpContext context, ref string strResult)
        {
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_six_op_odds().Equals(1))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            ReturnResult result = new ReturnResult();
            if (!model.get_u_type().Trim().Equals("fgs"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100027", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str3 = LSRequest.qq("optype");
                LSRequest.qq("playid");
                string str4 = LSRequest.qq("oddsid");
                LSRequest.qq("number");
                LSRequest.qq("phaseid");
                string str5 = LSRequest.qq("pk");
                if (string.IsNullOrEmpty(str5))
                {
                    str5 = "A";
                }
                else
                {
                    str5 = str5.ToUpper();
                }
                if ((!str5.Equals("A") && !str5.Equals("B")) && !str5.Equals("C"))
                {
                    context.Response.End();
                }
                string str6 = LSRequest.qq("wtvalue");
                string str7 = LSRequest.qq("inputvalue");
                LSRequest.qq("isopen");
                LSRequest.qq("playpage");
                Dictionary<string, object> dictionary = new Dictionary<string, object>();
                dictionary.Add("type", "operate_adds");
                result.set_data(dictionary);
                if (string.IsNullOrEmpty(str4))
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else if (CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str4) == null)
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    double num28;
                    int num33;
                    string[] strArray = str4.Split(new char[] { ',' });
                    if (str3.Equals("5") || str3.Equals("6"))
                    {
                        if (string.IsNullOrEmpty(str6))
                        {
                            str6 = "0.01";
                        }
                        double num = str3.Equals("5") ? Convert.ToDouble(str6) : -Convert.ToDouble(str6);
                        Dictionary<string, double> dictionary2 = new Dictionary<string, double>();
                        for (int i = 0; i < strArray.Length; i++)
                        {
                            double num32;
                            string str8 = strArray[i];
                            cz_odds_six _six = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str8));
                            double num3 = double.Parse(_six.get_current_odds());
                            double num4 = Convert.ToDouble(_six.get_max_odds());
                            double num5 = Convert.ToDouble(_six.get_min_odds());
                            double num6 = 0.0;
                            if (str5.Equals("A"))
                            {
                                num6 = Convert.ToDouble(_six.get_a_diff());
                            }
                            else if (str5.Equals("B"))
                            {
                                num6 = Convert.ToDouble(_six.get_b_diff());
                            }
                            else if (str5.Equals("C"))
                            {
                                num6 = Convert.ToDouble(_six.get_c_diff());
                            }
                            base.GetFgsWTTable(100);
                            double wtvalue = 0.0;
                            base.GetOperate_SIX(str8, ref wtvalue);
                            double num8 = num3;
                            double num9 = num5;
                            num28 = num3 + wtvalue;
                            double num10 = double.Parse(num28.ToString());
                            double num11 = double.Parse((num3 + num6).ToString());
                            double num12 = double.Parse(((num8 - num9) + 1.0).ToString());
                            double num13 = 0.0;
                            string str10 = str3;
                            if (str10 != null)
                            {
                                if (!(str10 == "5"))
                                {
                                    if (str10 == "6")
                                    {
                                        goto Label_041E;
                                    }
                                }
                                else
                                {
                                    num13 = double.Parse((num10 + Convert.ToDouble(str6)).ToString());
                                }
                            }
                            goto Label_0439;
                        Label_041E:
                            num32 = num10 + -Convert.ToDouble(str6);
                            num13 = double.Parse(num32.ToString());
                        Label_0439:
                            if (str3.Equals("5"))
                            {
                                if (num13 > num11)
                                {
                                    dictionary2.Add(str8, 0.0);
                                }
                                else
                                {
                                    dictionary2.Add(str8, num);
                                }
                            }
                            if (str3.Equals("6"))
                            {
                                if (num13 < num12)
                                {
                                    dictionary2.Add(str8, 0.0);
                                }
                                else
                                {
                                    dictionary2.Add(str8, num);
                                }
                            }
                        }
                        DataTable oddsWTbyFGS = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                        num33 = 100;
                        base.Add_FgsOddsWT_Lock(num33.ToString(), str, str4);
                        int num14 = CallBLL.cz_odds_wt_six_bll.UpdateFgsOddsShortcutBar(dictionary2, model.get_fgs_name(), str3);
                        base.Del_FgsOddsWT_Lock(100.ToString(), str, str4);
                        if (num14 > 0)
                        {
                            CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                            FileCacheHelper.UpdateFGSWTFile(100);
                            base.fgs_opt_six_log(oddsWTbyFGS, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                            result.set_success(200);
                            dictionary.Add("play_odds", this.GetOddsByOddsIds_wt(model, context, str4, str5)["play_odds"]);
                        }
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else if (str3.Equals("7"))
                    {
                        if (string.IsNullOrEmpty(str7))
                        {
                            result.set_success(400);
                            result.set_tipinfo(PageBase.GetMessageByCache("u100008", "MessageHint"));
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            Dictionary<string, double> dictionary3 = new Dictionary<string, double>();
                            for (int j = 0; j < strArray.Length; j++)
                            {
                                string str9 = strArray[j];
                                cz_odds_six _six2 = CallBLL.cz_odds_six_bll.GetModel(Convert.ToInt32(str9));
                                double num16 = double.Parse(_six2.get_current_odds());
                                double num17 = Convert.ToDouble(_six2.get_max_odds());
                                double num18 = Convert.ToDouble(_six2.get_min_odds());
                                double num19 = 0.0;
                                if (str5.Equals("A"))
                                {
                                    num19 = Convert.ToDouble(_six2.get_a_diff());
                                }
                                else if (str5.Equals("B"))
                                {
                                    num19 = Convert.ToDouble(_six2.get_b_diff());
                                }
                                else if (str5.Equals("C"))
                                {
                                    num19 = Convert.ToDouble(_six2.get_c_diff());
                                }
                                double num20 = 0.0;
                                base.GetOperate_SIX(str9, ref num20);
                                double num21 = num16;
                                double num22 = num18;
                                double num23 = double.Parse((num16 + num20).ToString());
                                double num24 = double.Parse((num16 + num19).ToString());
                                double num25 = double.Parse(((num21 - num22) + 1.0).ToString());
                                str7 = (double.Parse(str7) - num19).ToString();
                                if (double.Parse(str7) < num25)
                                {
                                    num28 = num25 - num16;
                                    dictionary3.Add(str9, double.Parse(num28.ToString()));
                                }
                                else if (double.Parse(str7) > num24)
                                {
                                    dictionary3.Add(str9, 0.0);
                                }
                                else if (double.Parse(str7) >= num21)
                                {
                                    dictionary3.Add(str9, 0.0);
                                }
                                else
                                {
                                    double num26 = double.Parse((double.Parse(str7) - double.Parse(num23.ToString())).ToString());
                                    dictionary3.Add(str9, num26);
                                }
                            }
                            DataTable table3 = CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str);
                            num33 = 100;
                            base.Add_FgsOddsWT_Lock(num33.ToString(), str, str4);
                            int num27 = CallBLL.cz_odds_wt_six_bll.UpdateFgsOddsShortcutBar(dictionary3, model.get_fgs_name(), str3);
                            base.Del_FgsOddsWT_Lock(100.ToString(), str, str4);
                            if (num27 > 0)
                            {
                                CacheHelper.RemoveAllCache("fgs_wt_FileCacheKey" + context.Session["user_name"].ToString() + 100);
                                FileCacheHelper.UpdateFGSWTFile(100);
                                base.fgs_opt_six_log(table3, CallBLL.cz_odds_wt_six_bll.GetOddsWTbyFGS(str4, str), str3, str, str4);
                                result.set_success(200);
                                dictionary.Add("play_odds", this.GetOddsByOddsIds_wt(model, context, str4, str5)["play_odds"]);
                            }
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                    }
                }
            }
        }

        public void user_allow_sale(HttpContext context, ref string strResult)
        {
            cz_bet_six _six5;
            double num31;
            cz_system_log _log3;
            DataTable table11;
            int? nullable;
            int num38;
            string str71;
            double num40;
            ReturnResult result = new ReturnResult();
            result.set_success(400);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "user_allow_sale");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            agent_six_rate _rate = base.GetUserRate_six(model.get_zjname());
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_allow_sale().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100022", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            else if ((model.get_users_child_session() != null) && (model.get_users_child_session().get_permissions_name().IndexOf("po_5_2") < 0))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100022", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            if (model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100026", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            int num = 100;
            string s = LSRequest.qq("phaseid");
            string str4 = LSRequest.qq("oddsid");
            string str5 = LSRequest.qq("currentodds");
            string str6 = LSRequest.qq("amount");
            string str7 = LSRequest.qq("number");
            string str8 = LSRequest.qq("pk");
            string str9 = LSRequest.qq("jeucode");
            if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str9))
            {
                context.Session["JeuValidate"] = null;
                result.set_success(400);
                new Dictionary<string, object>();
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            context.Session["JeuValidate"] = null;
            string str10 = "A";
            if (!Utils.Agent_AllowSaleKind(str8, model.get_six_kind(), ref str10))
            {
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100056", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            str4.Split(new char[] { ',' });
            if (str6.Split(new char[] { ',' }).Length > 100)
            {
                context.Response.End();
            }
            string str11 = "";
            string str12 = "";
            cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
            if (currentPhase != null)
            {
                if (currentPhase.get_is_closed() == 1)
                {
                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                    result.set_success(400);
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                    return;
                }
                str11 = currentPhase.get_phase().ToString();
                num38 = currentPhase.get_p_id();
                str12 = num38.ToString();
            }
            else
            {
                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            if (!s.Equals(str12))
            {
                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100042", "MessageHint"), currentPhase.get_phase().ToString()));
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(str4);
            DateTime now = DateTime.Now;
            DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
            DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
            if ((((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91004") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91007") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91038")))
            {
                if (time3 < now)
                {
                    result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                    result.set_success(400);
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                    return;
                }
            }
            else if (time2 < now)
            {
                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            DataTable oddsTableByOddsIds = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str4);
            if (oddsTableByOddsIds == null)
            {
                result.set_tipinfo(PageBase.GetMessageByCache("u100041", "MessageHint"));
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            if (!oddsTableByOddsIds.Rows[0]["is_open"].ToString().Equals("1"))
            {
                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            DataSet set = CallBLL.cz_bet_six_bll.GetBHSZZTByUName(model.get_u_name(), model.get_u_type(), str12, str4, str7, str10);
            if (((set != null) && (set.Tables.Count > 0)) && (set.Tables[0].Rows.Count > 0))
            {
                if (Convert.ToDouble(set.Tables[0].Rows[0]["szzt"].ToString()) < Convert.ToDouble(str6))
                {
                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100043", "MessageHint"), currentPhase.get_phase().ToString()));
                    result.set_success(400);
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                    return;
                }
                if (Convert.ToDouble(str6) < 10.0)
                {
                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100096", "MessageHint"), 10));
                    result.set_success(400);
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                    return;
                }
            }
            else
            {
                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100041", "MessageHint"), currentPhase.get_phase().ToString()));
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            string str14 = "";
            string str15 = "";
            string str16 = "";
            DataTable table3 = CallBLL.cz_odds_six_bll.GetOddsByID(str4).Tables[0];
            int num3 = int.Parse(table3.Rows[0]["play_id"].ToString());
            string str17 = table3.Rows[0]["current_odds"].ToString().Trim();
            string diff = table3.Rows[0][str10 + "_diff"].ToString().Trim();
            string isDoubleOdds = table3.Rows[0]["isDoubleOdds"] + "".Trim();
            string str20 = table3.Rows[0]["put_amount"].ToString();
            bool flag2 = (table3.Rows[0]["isLM"]).Equals("1");
            string str21 = table3.Rows[0]["o_play_name"].ToString().Trim();
            string str22 = "";
            base.GetOdds_SIX_Sale(str4, str17, diff, isDoubleOdds, ref str14, ref str15, ref str16, ref str22);
            if (model.get_u_type().Equals("fgs") && model.get_six_op_odds().Equals(1))
            {
                if (isDoubleOdds.Equals("1"))
                {
                    str16 = str22;
                    str14 = str22.Split(new char[] { ',' })[0];
                    str15 = str22.Split(new char[] { ',' })[1];
                }
                else
                {
                    str14 = str22;
                }
            }
            DataRow[] rowArray = base.GetUserDrawback_six().Tables[0].Select(string.Format(" play_id={0} ", num3));
            string str23 = "0";
            string str24 = "0";
            string str25 = "0";
            string str26 = "0";
            string str27 = "0";
            string str28 = "0";
            double num4 = 0.0;
            double num5 = 0.0;
            if (_rate.get_zcyg().Equals("1"))
            {
                num4 = ((100.0 - double.Parse(_rate.get_fgszc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc());
                num5 = double.Parse(_rate.get_fgszc());
            }
            else if (model.get_u_type() == "fgs")
            {
                num4 = 100.0;
            }
            else
            {
                num5 = ((100.0 - double.Parse(_rate.get_zjzc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc());
                num4 = double.Parse(_rate.get_zjzc());
            }
            foreach (DataRow row in rowArray)
            {
                str71 = row["u_type"].ToString().Trim();
                if (str71 != null)
                {
                    if (!(str71 == "zj"))
                    {
                        if (str71 == "fgs")
                        {
                            goto Label_0EFC;
                        }
                        if (str71 == "gd")
                        {
                            goto Label_0F20;
                        }
                        if (str71 == "zd")
                        {
                            goto Label_0F41;
                        }
                        if (str71 == "dl")
                        {
                            goto Label_0F62;
                        }
                        if (str71 == "hy")
                        {
                            goto Label_0F83;
                        }
                    }
                    else
                    {
                        str23 = row[str10 + "_drawback"].ToString().Trim();
                    }
                }
                continue;
            Label_0EFC:
                str24 = row[str10 + "_drawback"].ToString().Trim();
                continue;
            Label_0F20:
                str25 = row[str10 + "_drawback"].ToString().Trim();
                continue;
            Label_0F41:
                str26 = row[str10 + "_drawback"].ToString().Trim();
                continue;
            Label_0F62:
                str27 = row[str10 + "_drawback"].ToString().Trim();
                continue;
            Label_0F83:
                str28 = row[str10 + "_drawback"].ToString().Trim();
            }
            str71 = model.get_u_type();
            if (str71 != null)
            {
                if (!(str71 == "fgs"))
                {
                    if (str71 == "gd")
                    {
                        str26 = str25;
                    }
                    else if (str71 == "zd")
                    {
                        str27 = str26;
                    }
                    else if (str71 == "dl")
                    {
                        str28 = str27;
                    }
                }
                else
                {
                    str25 = str24;
                }
            }
            string orderNumber = Utils.GetOrderNumber();
            if ((("92285,92286,92287,92288,92289,92575".IndexOf(str4) <= -1) && ("92638,92639,92640,92641,92642,92643".IndexOf(str4) <= -1)) && (("92565,92566,92567,92568,92569,92570,92571,92636,92637".IndexOf(str4) <= -1) && ("92572,92588,92589,92590,92591,92592".IndexOf(str4) <= -1)))
            {
                _six5 = new cz_bet_six();
                _six5.set_order_num(orderNumber);
                _six5.set_u_name(model.get_u_name());
                _six5.set_u_nicker(model.get_u_nicker());
                _six5.set_phase_id(new int?(int.Parse(str12)));
                _six5.set_phase(str11);
                _six5.set_bet_time(new DateTime?(DateTime.Now));
                _six5.set_checkcode(str9);
                _six5.set_odds_id(new int?(int.Parse(str4)));
                _six5.set_category(table3.Rows[0]["category"].ToString());
                _six5.set_play_id(new int?(int.Parse(table3.Rows[0]["play_id"].ToString())));
                _six5.set_play_name(table3.Rows[0]["o_play_name"].ToString());
                _six5.set_bet_val(table3.Rows[0]["put_amount"].ToString());
                _six5.set_odds(str14);
                _six5.set_amount(new decimal?(decimal.Parse(str6)));
                _six5.set_profit(0);
                _six5.set_isLM(0);
                str71 = model.get_u_type().Trim();
                if (str71 != null)
                {
                    if (!(str71 == "dl"))
                    {
                        if (str71 == "zd")
                        {
                            _six5.set_hy_drawback(0);
                            _six5.set_dl_drawback(new decimal?(decimal.Parse(str27)));
                            _six5.set_zd_drawback(new decimal?(decimal.Parse(str26)));
                            _six5.set_gd_drawback(new decimal?(decimal.Parse(str25)));
                            _six5.set_fgs_drawback(new decimal?(decimal.Parse(str24)));
                            _six5.set_zj_drawback(new decimal?(decimal.Parse(str23)));
                            _six5.set_dl_rate(0f);
                            _six5.set_zd_rate(0f);
                            _six5.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                            _six5.set_fgs_rate(float.Parse(num5.ToString()));
                            _six5.set_zj_rate(float.Parse(num4.ToString()));
                            _six5.set_dl_name("");
                            _six5.set_zd_name(_rate.get_zdname());
                            _six5.set_gd_name(_rate.get_gdname());
                            _six5.set_fgs_name(_rate.get_fgsname());
                        }
                        else if (str71 == "gd")
                        {
                            _six5.set_hy_drawback(0);
                            _six5.set_dl_drawback(0);
                            _six5.set_zd_drawback(new decimal?(decimal.Parse(str26)));
                            _six5.set_gd_drawback(new decimal?(decimal.Parse(str25)));
                            _six5.set_fgs_drawback(new decimal?(decimal.Parse(str24)));
                            _six5.set_zj_drawback(new decimal?(decimal.Parse(str23)));
                            _six5.set_dl_rate(0f);
                            _six5.set_zd_rate(0f);
                            _six5.set_gd_rate(0f);
                            _six5.set_fgs_rate(float.Parse(num5.ToString()));
                            _six5.set_zj_rate(float.Parse(num4.ToString()));
                            _six5.set_dl_name("");
                            _six5.set_zd_name("");
                            _six5.set_gd_name(_rate.get_gdname());
                            _six5.set_fgs_name(_rate.get_fgsname());
                        }
                        else if (str71 == "fgs")
                        {
                            _six5.set_hy_drawback(0);
                            _six5.set_dl_drawback(0);
                            _six5.set_zd_drawback(0);
                            _six5.set_gd_drawback(new decimal?(decimal.Parse(str25)));
                            _six5.set_fgs_drawback(new decimal?(decimal.Parse(str24)));
                            _six5.set_zj_drawback(new decimal?(decimal.Parse(str23)));
                            _six5.set_dl_rate(0f);
                            _six5.set_zd_rate(0f);
                            _six5.set_gd_rate(0f);
                            _six5.set_fgs_rate(0f);
                            _six5.set_zj_rate(float.Parse(num4.ToString()));
                            _six5.set_dl_name("");
                            _six5.set_zd_name("");
                            _six5.set_gd_name("");
                            _six5.set_fgs_name(_rate.get_fgsname());
                        }
                    }
                    else
                    {
                        _six5.set_hy_drawback(new decimal?(decimal.Parse(str28)));
                        _six5.set_dl_drawback(new decimal?(decimal.Parse(str27)));
                        _six5.set_zd_drawback(new decimal?(decimal.Parse(str26)));
                        _six5.set_gd_drawback(new decimal?(decimal.Parse(str25)));
                        _six5.set_fgs_drawback(new decimal?(decimal.Parse(str24)));
                        _six5.set_zj_drawback(new decimal?(decimal.Parse(str23)));
                        _six5.set_dl_rate(0f);
                        _six5.set_zd_rate((float) int.Parse(_rate.get_zdzc()));
                        _six5.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                        _six5.set_fgs_rate(float.Parse(num5.ToString()));
                        _six5.set_zj_rate(float.Parse(num4.ToString()));
                        _six5.set_dl_name(_rate.get_dlname());
                        _six5.set_zd_name(_rate.get_zdname());
                        _six5.set_gd_name(_rate.get_gdname());
                        _six5.set_fgs_name(_rate.get_fgsname());
                    }
                }
            }
            else
            {
                string str30 = this.getlongnum(str7.Replace("-", ""));
                string[] source = str30.Split(new char[] { ',' });
                if (source.Distinct<string>().ToList<string>().Count != source.Length)
                {
                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100041", "MessageHint"), currentPhase.get_phase().ToString()));
                    result.set_success(400);
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                    return;
                }
                DataTable wT = null;
                switch (str4)
                {
                    case "92286":
                        wT = CallBLL.cz_wt_3z2_six_bll.GetWT();
                        break;

                    case "92285":
                        wT = CallBLL.cz_wt_3qz_six_bll.GetWT();
                        break;

                    case "92287":
                        wT = CallBLL.cz_wt_2qz_six_bll.GetWT();
                        break;

                    case "92288":
                        wT = CallBLL.cz_wt_2zt_six_bll.GetWT();
                        break;

                    case "92289":
                        wT = CallBLL.cz_wt_tc_six_bll.GetWT();
                        break;

                    case "92575":
                        wT = CallBLL.cz_wt_4z1_six_bll.GetWT();
                        break;

                    case "92638":
                        wT = CallBLL.cz_wt_3qz_b_six_bll.GetWT();
                        break;

                    case "92639":
                        wT = CallBLL.cz_wt_3z2_b_six_bll.GetWT();
                        break;

                    case "92640":
                        wT = CallBLL.cz_wt_2qz_b_six_bll.GetWT();
                        break;

                    case "92641":
                        wT = CallBLL.cz_wt_2zt_b_six_bll.GetWT();
                        break;

                    case "92642":
                        wT = CallBLL.cz_wt_tc_b_six_bll.GetWT();
                        break;

                    case "92643":
                        wT = CallBLL.cz_wt_4z1_b_six_bll.GetWT();
                        break;

                    case "92566":
                        wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT();
                        break;

                    case "92567":
                        wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT();
                        break;

                    case "92568":
                        wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT();
                        break;

                    case "92636":
                        wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT();
                        break;

                    case "92569":
                        wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT();
                        break;

                    case "92570":
                        wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT();
                        break;

                    case "92571":
                        wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT();
                        break;

                    case "92637":
                        wT = CallBLL.cz_wt_sxlwsl_six_bll.GetWT();
                        break;

                    case "92572":
                        wT = CallBLL.cz_wt_5bz_six_bll.GetWT();
                        break;

                    case "92588":
                        wT = CallBLL.cz_wt_6bz_six_bll.GetWT();
                        break;

                    case "92589":
                        wT = CallBLL.cz_wt_7bz_six_bll.GetWT();
                        break;

                    case "92590":
                        wT = CallBLL.cz_wt_8bz_six_bll.GetWT();
                        break;

                    case "92591":
                        wT = CallBLL.cz_wt_9bz_six_bll.GetWT();
                        break;

                    case "92592":
                        wT = CallBLL.cz_wt_10bz_six_bll.GetWT();
                        break;

                    case "92565":
                        wT = CallBLL.cz_wt_6xyz_six_bll.GetWT();
                        break;
                }
                string str31 = "";
                string str32 = "";
                string str33 = "";
                string str34 = "";
                if (isDoubleOdds.Equals("1"))
                {
                    if ((str4.Equals("92566") || str4.Equals("92567")) || (str4.Equals("92568") || str4.Equals("92636")))
                    {
                        if (str30.ToString().Trim().IndexOf(base.get_YearLianID()) >= 0)
                        {
                            string[] strArray3 = str16.Split(new char[] { ',' });
                            str31 = strArray3[1];
                            str32 = base.get_YearLianID() + "|" + strArray3[1];
                            string[] strArray4 = str22.Split(new char[] { ',' });
                            str33 = strArray4[1];
                            str34 = base.get_YearLianID() + "|" + strArray4[1];
                        }
                        else
                        {
                            str31 = FunctionSix.get_sxws_min_pl(wT, str30, str16, str4);
                            str33 = FunctionSix.get_sxws_min_pl(wT, str30, str22, str4);
                            if (!string.IsNullOrEmpty(str31))
                            {
                                str32 = str31;
                            }
                            if (!string.IsNullOrEmpty(str33))
                            {
                                str34 = str33;
                            }
                        }
                    }
                    else if ((str4.Equals("92569") || str4.Equals("92570")) || (str4.Equals("92571") || str4.Equals("92637")))
                    {
                        if (str30.ToString().Trim().IndexOf("10") >= 0)
                        {
                            string[] strArray5 = str16.Split(new char[] { ',' });
                            str31 = strArray5[1];
                            str32 = 10 + "|" + strArray5[1];
                            string[] strArray6 = str22.Split(new char[] { ',' });
                            str33 = strArray6[1];
                            str34 = 10 + "|" + strArray6[1];
                        }
                        else
                        {
                            str31 = FunctionSix.get_sxws_min_pl(wT, str30, str16, str4);
                            str33 = FunctionSix.get_sxws_min_pl(wT, str30, str22, str4);
                            if (!string.IsNullOrEmpty(str31))
                            {
                                str32 = str31;
                            }
                            if (!string.IsNullOrEmpty(str33))
                            {
                                str34 = str33;
                            }
                        }
                    }
                    else
                    {
                        str31 = FunctionSix.get_ball_min_pl(wT, str30, str16);
                        str33 = FunctionSix.get_ball_min_pl(wT, str30, str22);
                        if (!string.IsNullOrEmpty(str31))
                        {
                            str32 = str31;
                        }
                        if (!string.IsNullOrEmpty(str33))
                        {
                            str34 = str33;
                        }
                    }
                }
                else
                {
                    str31 = FunctionSix.get_ball_min_pl(wT, str30, str14);
                    str33 = FunctionSix.get_ball_min_pl(wT, str30, str22);
                    if (!string.IsNullOrEmpty(str31))
                    {
                        str32 = str31;
                    }
                    if (!string.IsNullOrEmpty(str33))
                    {
                        str34 = str33;
                    }
                }
                cz_bet_six _six2 = new cz_bet_six();
                _six2.set_order_num(orderNumber);
                _six2.set_u_name(model.get_u_name());
                _six2.set_u_nicker(model.get_u_nicker());
                _six2.set_phase_id(new int?(int.Parse(str12)));
                _six2.set_phase(str11);
                _six2.set_bet_time(new DateTime?(DateTime.Now));
                _six2.set_checkcode(str9);
                _six2.set_odds_id(new int?(int.Parse(str4)));
                _six2.set_category(table3.Rows[0]["category"].ToString());
                _six2.set_play_id(new int?(int.Parse(table3.Rows[0]["play_id"].ToString())));
                _six2.set_play_name(str21);
                _six2.set_bet_val(str30);
                _six2.set_odds(isDoubleOdds.Equals("1") ? str16 : str14);
                _six2.set_amount(new decimal?(decimal.Parse(str6)));
                _six2.set_profit(0);
                _six2.set_isLM(1);
                _six2.set_unit_cnt(1);
                _six2.set_lm_type(0);
                _six2.set_bet_group(str30);
                _six2.set_bet_wt(str32);
                str71 = model.get_u_type().Trim();
                if (str71 != null)
                {
                    if (!(str71 == "dl"))
                    {
                        if (str71 == "zd")
                        {
                            _six2.set_hy_drawback(0);
                            _six2.set_dl_drawback(new decimal?(decimal.Parse(str27)));
                            _six2.set_zd_drawback(new decimal?(decimal.Parse(str26)));
                            _six2.set_gd_drawback(new decimal?(decimal.Parse(str25)));
                            _six2.set_fgs_drawback(new decimal?(decimal.Parse(str24)));
                            _six2.set_zj_drawback(new decimal?(decimal.Parse(str23)));
                            _six2.set_dl_rate(0f);
                            _six2.set_zd_rate(0f);
                            _six2.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                            _six2.set_fgs_rate(float.Parse(num5.ToString()));
                            _six2.set_zj_rate(float.Parse(num4.ToString()));
                            _six2.set_dl_name("");
                            _six2.set_zd_name(_rate.get_zdname());
                            _six2.set_gd_name(_rate.get_gdname());
                            _six2.set_fgs_name(_rate.get_fgsname());
                        }
                        else if (str71 == "gd")
                        {
                            _six2.set_hy_drawback(0);
                            _six2.set_dl_drawback(0);
                            _six2.set_zd_drawback(new decimal?(decimal.Parse(str26)));
                            _six2.set_gd_drawback(new decimal?(decimal.Parse(str25)));
                            _six2.set_fgs_drawback(new decimal?(decimal.Parse(str24)));
                            _six2.set_zj_drawback(new decimal?(decimal.Parse(str23)));
                            _six2.set_dl_rate(0f);
                            _six2.set_zd_rate(0f);
                            _six2.set_gd_rate(0f);
                            _six2.set_fgs_rate(float.Parse(num5.ToString()));
                            _six2.set_zj_rate(float.Parse(num4.ToString()));
                            _six2.set_dl_name("");
                            _six2.set_zd_name("");
                            _six2.set_gd_name(_rate.get_gdname());
                            _six2.set_fgs_name(_rate.get_fgsname());
                        }
                        else if (str71 == "fgs")
                        {
                            _six2.set_hy_drawback(0);
                            _six2.set_dl_drawback(0);
                            _six2.set_zd_drawback(0);
                            _six2.set_gd_drawback(new decimal?(decimal.Parse(str25)));
                            _six2.set_fgs_drawback(new decimal?(decimal.Parse(str24)));
                            _six2.set_zj_drawback(new decimal?(decimal.Parse(str23)));
                            _six2.set_dl_rate(0f);
                            _six2.set_zd_rate(0f);
                            _six2.set_gd_rate(0f);
                            _six2.set_fgs_rate(0f);
                            _six2.set_zj_rate(float.Parse(num4.ToString()));
                            _six2.set_dl_name("");
                            _six2.set_zd_name("");
                            _six2.set_gd_name("");
                            _six2.set_fgs_name(_rate.get_fgsname());
                        }
                    }
                    else
                    {
                        _six2.set_hy_drawback(new decimal?(decimal.Parse(str28)));
                        _six2.set_dl_drawback(new decimal?(decimal.Parse(str27)));
                        _six2.set_zd_drawback(new decimal?(decimal.Parse(str26)));
                        _six2.set_gd_drawback(new decimal?(decimal.Parse(str25)));
                        _six2.set_fgs_drawback(new decimal?(decimal.Parse(str24)));
                        _six2.set_zj_drawback(new decimal?(decimal.Parse(str23)));
                        _six2.set_dl_rate(0f);
                        _six2.set_zd_rate((float) int.Parse(_rate.get_zdzc()));
                        _six2.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                        _six2.set_fgs_rate(float.Parse(num5.ToString()));
                        _six2.set_zj_rate(float.Parse(num4.ToString()));
                        _six2.set_dl_name(_rate.get_dlname());
                        _six2.set_zd_name(_rate.get_zdname());
                        _six2.set_gd_name(_rate.get_gdname());
                        _six2.set_fgs_name(_rate.get_fgsname());
                    }
                }
                _six2.set_is_payment(0);
                _six2.set_sale_type(1);
                _six2.set_m_type(-2);
                _six2.set_kind(str10);
                _six2.set_ip(LSRequest.GetIP());
                _six2.set_lottery_type(100);
                _six2.set_lottery_name(base.GetGameNameByID(_six2.get_lottery_type().ToString()));
                _six2.set_odds_zj(str22);
                _six2.set_bet_wt_zj(str34);
                _six2.set_ordervalidcode(Utils.GetOrderValidCode(_six2.get_u_name(), _six2.get_order_num(), _six2.get_bet_val(), _six2.get_odds(), _six2.get_kind(), int.Parse(_six2.get_phase_id().ToString()), int.Parse(_six2.get_odds_id().ToString()), Convert.ToDouble(_six2.get_amount())));
                int num9 = 0;
                CallBLL.cz_bet_six_bll.AddBHBet(_six2, decimal.Parse(str6), str, ref num9, _rate);
                cz_system_set_six _six3 = CallBLL.cz_system_set_six_bll.GetSystemSet(100);
                string str35 = "92285,92286,92287,92288,92289,92575,92638,92639,92640,92641,92642,92643";
                if ((str35.IndexOf(str4) < 0) || _six3.get_single_number_isdown().Equals(0))
                {
                    double num10 = (Convert.ToDouble(str6) * num4) / 100.0;
                    double num11 = double.Parse(table3.Rows[0]["grand_total"].ToString()) + num10;
                    double num12 = double.Parse(table3.Rows[0]["downbase"].ToString());
                    double num13 = Math.Floor((double) (num11 / num12));
                    if (num13 >= 1.0)
                    {
                        double num14 = double.Parse(table3.Rows[0]["down_odds_rate"].ToString()) * num13;
                        double num15 = num11 - (num12 * num13);
                        string str36 = "";
                        string str37 = "";
                        DataSet oddsByID = null;
                        if ((base.IsShowLM_B() == 1) && (("92285,92286,92287,92288,92289,92575".IndexOf(str4) > -1) || ("92638,92639,92640,92641,92642,92643".IndexOf(str4) > -1)))
                        {
                            Utils.Six_LM_AB(str4, ref str36, ref str37);
                            oddsByID = CallBLL.cz_odds_six_bll.GetOddsByID(str36);
                        }
                        if (isDoubleOdds.Equals("1"))
                        {
                            if ((CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds_DoubleOdds(num14.ToString(), num11.ToString(), str4.ToString()) > 0) && !string.IsNullOrEmpty(str36))
                            {
                                CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds_DoubleOddsLM_AB(num14.ToString(), str36);
                            }
                        }
                        else if ((CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds(num14.ToString(), num15.ToString(), str4) > 0) && !string.IsNullOrEmpty(str36))
                        {
                            CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOddsLM_AB(num14.ToString(), str36);
                        }
                        cz_system_log _log = new cz_system_log();
                        _log.set_user_name("系統");
                        _log.set_children_name("");
                        _log.set_category(table3.Rows[0]["category"].ToString());
                        _log.set_play_name(table3.Rows[0]["play_name"].ToString());
                        _log.set_put_amount(str20);
                        _log.set_l_name(LSKeys.get_SIX_Name());
                        _log.set_l_phase(str11);
                        _log.set_action("降賠率");
                        _log.set_odds_id(int.Parse(str4));
                        string str38 = table3.Rows[0]["current_odds"].ToString();
                        _log.set_old_val(str38);
                        if (str38.Split(new char[] { ',' }).Length > 1)
                        {
                            num40 = double.Parse(str38.Split(new char[] { ',' })[0]) - num14;
                            num40 = double.Parse(str38.Split(new char[] { ',' })[1]) - num14;
                            _log.set_new_val(num40.ToString() + "," + num40.ToString());
                        }
                        else
                        {
                            num40 = double.Parse(str38) - num14;
                            _log.set_new_val(num40.ToString());
                        }
                        _log.set_ip(LSRequest.GetIP());
                        _log.set_add_time(DateTime.Now);
                        _log.set_note("系統自動降賠");
                        _log.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                        _log.set_lottery_type(100);
                        CallBLL.cz_system_log_bll.Add(_log);
                        cz_jp_odds _odds = new cz_jp_odds();
                        _odds.set_add_time(DateTime.Now);
                        _odds.set_odds_id(int.Parse(str4));
                        _odds.set_phase_id(int.Parse(s));
                        _odds.set_play_name(str21);
                        _odds.set_put_amount(str20);
                        _odds.set_odds(num14.ToString());
                        _odds.set_lottery_type(100);
                        _odds.set_phase(str11);
                        _odds.set_old_odds(str38);
                        if (str38.Split(new char[] { ',' }).Length > 1)
                        {
                            num40 = double.Parse(str38.Split(new char[] { ',' })[0]) - num14;
                            num40 = double.Parse(str38.Split(new char[] { ',' })[1]) - num14;
                            _odds.set_new_odds(num40.ToString() + "," + num40.ToString());
                        }
                        else
                        {
                            num40 = double.Parse(str38) - num14;
                            _odds.set_new_odds(num40.ToString());
                        }
                        CallBLL.cz_jp_odds_bll.Add(_odds);
                        if (!string.IsNullOrEmpty(str36))
                        {
                            DataTable table6 = oddsByID.Tables[0];
                            string str39 = table6.Rows[0]["o_play_name"].ToString();
                            string str40 = table6.Rows[0]["put_amount"].ToString();
                            cz_system_log _log2 = new cz_system_log();
                            _log2.set_user_name("系統");
                            _log2.set_children_name("");
                            _log2.set_category(table6.Rows[0]["category"].ToString());
                            _log2.set_play_name(str39);
                            _log2.set_put_amount(str40);
                            _log2.set_l_name(LSKeys.get_SIX_Name());
                            _log2.set_l_phase(str11);
                            _log2.set_action("降賠率");
                            _log2.set_odds_id(int.Parse(str36));
                            string str41 = table6.Rows[0]["current_odds"].ToString();
                            _log2.set_old_val(str41);
                            if (str41.Split(new char[] { ',' }).Length > 1)
                            {
                                num40 = double.Parse(str41.Split(new char[] { ',' })[0]) - num14;
                                num40 = double.Parse(str41.Split(new char[] { ',' })[1]) - num14;
                                _log2.set_new_val(num40.ToString() + "," + num40.ToString());
                            }
                            else
                            {
                                num40 = double.Parse(str41) - num14;
                                _log2.set_new_val(num40.ToString());
                            }
                            _log2.set_ip(LSRequest.GetIP());
                            _log2.set_add_time(DateTime.Now);
                            _log2.set_note("系統自動降賠(聯動)");
                            _log2.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                            _log2.set_lottery_type(100);
                            CallBLL.cz_system_log_bll.Add(_log2);
                            cz_jp_odds _odds2 = new cz_jp_odds();
                            _odds2.set_add_time(DateTime.Now);
                            _odds2.set_odds_id(int.Parse(str36));
                            _odds2.set_phase_id(int.Parse(s));
                            _odds2.set_play_name(str39);
                            _odds2.set_put_amount(str40);
                            _odds2.set_odds(num14.ToString());
                            _odds2.set_lottery_type(100);
                            _odds2.set_phase(str11);
                            _odds2.set_old_odds(str41);
                            if (str41.Split(new char[] { ',' }).Length > 1)
                            {
                                num40 = double.Parse(str41.Split(new char[] { ',' })[0]) - num14;
                                num40 = double.Parse(str41.Split(new char[] { ',' })[1]) - num14;
                                _odds2.set_new_odds(num40.ToString() + "," + num40.ToString());
                            }
                            else
                            {
                                num40 = double.Parse(str41) - num14;
                                _odds2.set_new_odds(num40.ToString());
                            }
                            CallBLL.cz_jp_odds_bll.Add(_odds2);
                        }
                    }
                }
                double num18 = 0.0;
                double num19 = 0.0;
                FunctionSix.GetWTByG_FZ(str4, str30, isDoubleOdds.Equals("1") ? str16 : str14, str32, ref num18, ref num19, base.get_YearLianID());
                double num20 = 0.0;
                double num21 = 0.0;
                FunctionSix.GetWTByG_FZ(str4, str30, isDoubleOdds.Equals("1") ? str22 : str22.Split(new char[] { ',' })[0], str34, ref num20, ref num21, base.get_YearLianID());
                cz_splitgroup_six _six4 = new cz_splitgroup_six();
                _six4.set_order_num(orderNumber);
                _six4.set_odds1(new decimal?(decimal.Parse(num18.ToString())));
                _six4.set_odds2(new decimal?(decimal.Parse(num19.ToString())));
                _six4.set_odds_id(new int?(int.Parse(str4)));
                _six4.set_item(str30);
                _six4.set_item_money(new decimal?(decimal.Parse(str6)));
                _six4.set_odds1_zj(new decimal?(decimal.Parse(num20.ToString())));
                _six4.set_odds2_zj(new decimal?(decimal.Parse(num21.ToString())));
                CallBLL.cz_splitgroup_six_bll.Add(_six4);
                DataTable fgsWTTable = null;
                double num22 = 0.0;
                str71 = model.get_u_type().ToLower();
                if (str71 != null)
                {
                    if (!(str71 == "dl"))
                    {
                        if (str71 == "zd")
                        {
                            if (model.get_six_op_odds().Equals(1))
                            {
                                fgsWTTable = base.GetFgsWTTable(100);
                            }
                            num22 = 0.0;
                            CallBLL.cz_autosale_six_bll.Agent_GDAutoSaleLM(_six2.get_order_num(), str9, "", str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, LSRequest.GetIP(), Convert.ToInt16(num), base.GetGameNameByID(Convert.ToInt16(num).ToString()), model, _rate, wT, base.get_YearLianID(), 0, fgsWTTable, ref num22);
                            if (model.get_six_op_odds().Equals(1))
                            {
                                fgsWTTable = base.GetFgsWTTable(100);
                            }
                            num22 = 0.0;
                            CallBLL.cz_autosale_six_bll.Agent_FGSAutoSaleLM(_six2.get_order_num(), str9, "", str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, LSRequest.GetIP(), Convert.ToInt16(num), base.GetGameNameByID(Convert.ToInt16(num).ToString()), model, _rate, wT, base.get_YearLianID(), 0, fgsWTTable, ref num22);
                            if (num22 > 0.0)
                            {
                            }
                        }
                        else if (str71 == "gd")
                        {
                            if (model.get_six_op_odds().Equals(1))
                            {
                                fgsWTTable = base.GetFgsWTTable(100);
                            }
                            num22 = 0.0;
                            CallBLL.cz_autosale_six_bll.Agent_FGSAutoSaleLM(_six2.get_order_num(), str9, "", str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, LSRequest.GetIP(), Convert.ToInt16(num), base.GetGameNameByID(Convert.ToInt16(num).ToString()), model, _rate, wT, base.get_YearLianID(), 0, fgsWTTable, ref num22);
                        }
                    }
                    else
                    {
                        if (model.get_six_op_odds().Equals(1))
                        {
                            fgsWTTable = base.GetFgsWTTable(100);
                        }
                        num22 = 0.0;
                        CallBLL.cz_autosale_six_bll.Agent_ZDAutoSaleLM(_six2.get_order_num(), str9, "", str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, LSRequest.GetIP(), Convert.ToInt16(num), base.GetGameNameByID(Convert.ToInt16(num).ToString()), model, _rate, wT, base.get_YearLianID(), 0, fgsWTTable, ref num22);
                        if (model.get_six_op_odds().Equals(1))
                        {
                            fgsWTTable = base.GetFgsWTTable(100);
                        }
                        num22 = 0.0;
                        CallBLL.cz_autosale_six_bll.Agent_GDAutoSaleLM(_six2.get_order_num(), str9, "", str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, LSRequest.GetIP(), Convert.ToInt16(num), base.GetGameNameByID(Convert.ToInt16(num).ToString()), model, _rate, wT, base.get_YearLianID(), 0, fgsWTTable, ref num22);
                        if (model.get_six_op_odds().Equals(1))
                        {
                            fgsWTTable = base.GetFgsWTTable(100);
                        }
                        num22 = 0.0;
                        CallBLL.cz_autosale_six_bll.Agent_FGSAutoSaleLM(_six2.get_order_num(), str9, "", str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, LSRequest.GetIP(), Convert.ToInt16(num), base.GetGameNameByID(Convert.ToInt16(num).ToString()), model, _rate, wT, base.get_YearLianID(), 0, fgsWTTable, ref num22);
                        if (num22 > 0.0)
                        {
                        }
                    }
                }
                nullable = _six3.get_single_number_isdown();
                if (nullable.Equals(1) && (str35.IndexOf(str4) > -1))
                {
                    string str42 = table3.Rows[0][str10 + "_diff"].ToString();
                    double.Parse(table3.Rows[0]["grand_total"].ToString());
                    double num23 = double.Parse(table3.Rows[0]["downbase"].ToString());
                    double num24 = double.Parse(table3.Rows[0]["down_odds_rate"].ToString());
                    List<string> values = new List<string>();
                    double num25 = ((((double) _six2.get_amount().Value) / ((double) _six2.get_unit_cnt().Value)) * num4) / 100.0;
                    nullable = _six2.get_odds_id();
                    CallBLL.cz_lm_number_amount_six_bll.SetLMSingleNumber(int.Parse(nullable.ToString()), _six2.get_bet_group(), num25, ref values);
                    string str43 = string.Join(",", values);
                    DataSet set5 = CallBLL.cz_lm_number_amount_six_bll.GetListByNumber(str4, str43, num23);
                    if (set5 != null)
                    {
                        string category = _six2.get_category();
                        string str45 = _six2.get_play_name();
                        string str46 = str20;
                        string phase = _six2.get_phase();
                        string str48 = _six2.get_phase_id().ToString();
                        DataTable numberAmountTableDT = set5.Tables["numberAmountTable"];
                        DataTable wtTableDT = set5.Tables["wtTable"];
                        DataTable table10 = set5.Tables["oddsTable"];
                        string str49 = table10.Rows[0]["isDoubleOdds"].ToString();
                        string str50 = table10.Rows[0][str10 + "_diff"].ToString();
                        if (str49.Equals("1"))
                        {
                            string str51 = str5.Split(new char[] { ',' })[0];
                            string str52 = str5.Split(new char[] { ',' })[1];
                            string str53 = "";
                            string str54 = "";
                            str53 = str42.Split(new char[] { ',' })[0];
                            str54 = str53;
                            if (str42.Split(new char[] { ',' }).Length > 1)
                            {
                                str54 = str42.Split(new char[] { ',' })[1];
                            }
                            string pl = (Convert.ToDouble(str51) + Convert.ToDouble(str53)) + "," + (Convert.ToDouble(str52) + Convert.ToDouble(str54));
                            string str56 = table10.Rows[0]["min_odds"].ToString();
                            string maxpl = "0,0";
                            string minpl = "0,0";
                            base.GetOdds_SIX(str4, ref pl, ref maxpl, ref minpl);
                            this.SetWtValueDuble(numberAmountTableDT, wtTableDT, str4, str56, pl, num23, num24, category, str45, str46, phase, str48);
                        }
                        else
                        {
                            string str59 = table10.Rows[0]["current_odds"].ToString();
                            string str60 = table10.Rows[0]["min_odds"].ToString();
                            string str61 = (Convert.ToDouble(str59) + Convert.ToDouble(str50)).ToString();
                            string str62 = "0";
                            string str63 = "0";
                            base.GetOdds_SIX(str4, ref str61, ref str62, ref str63);
                            if (double.Parse(str60) < double.Parse(str61))
                            {
                                this.SetWtValue(numberAmountTableDT, wtTableDT, str4, double.Parse(str60), double.Parse(str61), num23, num24, category, str45, str46, phase, str48);
                            }
                        }
                    }
                }
                goto Label_427C;
            }
            _six5.set_is_payment(0);
            _six5.set_sale_type(1);
            _six5.set_m_type(-2);
            _six5.set_kind(str10);
            _six5.set_ip(LSRequest.GetIP());
            _six5.set_lottery_type(new int?(Convert.ToInt16(num)));
            nullable = _six5.get_lottery_type();
            _six5.set_lottery_name(base.GetGameNameByID(nullable.ToString()));
            _six5.set_odds_zj(str22);
            _six5.set_ordervalidcode(Utils.GetOrderValidCode(_six5.get_u_name(), _six5.get_order_num(), _six5.get_bet_val(), _six5.get_odds(), _six5.get_kind(), Convert.ToInt32(_six5.get_phase_id()), Convert.ToInt32(_six5.get_odds_id()), Convert.ToDouble(_six5.get_amount())));
            int num26 = 0;
            CallBLL.cz_bet_six_bll.AddBHBet(_six5, decimal.Parse(str6), str, ref num26, _rate);
            double num27 = (Convert.ToDouble(str6) * num4) / 100.0;
            cz_system_set_six systemSet = CallBLL.cz_system_set_six_bll.GetSystemSet(100);
            double num28 = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            if ((int.Parse(str4) > 0x16791) && (int.Parse(str4) <= 0x167c2))
            {
                nullable = systemSet.get_is_tmab();
                if (nullable.Equals(1))
                {
                    num38 = int.Parse(str4) - 0x31;
                    DataSet set6 = CallBLL.cz_odds_six_bll.GetOddsByID(num38.ToString());
                    num28 = double.Parse(set6.Tables[0].Rows[0]["grand_total"].ToString());
                    num29 = double.Parse(set6.Tables[0].Rows[0]["downbase"].ToString());
                    num30 = double.Parse(set6.Tables[0].Rows[0]["down_odds_rate"].ToString());
                    goto Label_37A5;
                }
            }
            num28 = double.Parse(table3.Rows[0]["grand_total"].ToString()) + num27;
            num29 = double.Parse(table3.Rows[0]["downbase"].ToString());
            num30 = double.Parse(table3.Rows[0]["down_odds_rate"].ToString());
        Label_37A5:
            num31 = Math.Floor((double) (num28 / num29));
            if (num31 < 1.0)
            {
                goto Label_3E20;
            }
            double num32 = num30 * num31;
            double num33 = num28 - (num29 * num31);
            if ((int.Parse(str4) > 0x16791) && (int.Parse(str4) <= 0x167c2))
            {
                nullable = systemSet.get_is_tmab();
                if (nullable.Equals(1))
                {
                    CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds(num32.ToString(), num33.ToString(), str4, true);
                    goto Label_3845;
                }
            }
            CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds(num32.ToString(), num33.ToString(), str4);
        Label_3845:
            _log3 = new cz_system_log();
            _log3.set_user_name("系統");
            _log3.set_children_name("");
            _log3.set_category(table3.Rows[0]["category"].ToString());
            _log3.set_play_name(table3.Rows[0]["play_name"].ToString());
            _log3.set_put_amount(str20);
            _log3.set_l_name(LSKeys.get_SIX_Name());
            _log3.set_l_phase(str11);
            _log3.set_action("降賠率");
            _log3.set_odds_id(int.Parse(str4));
            string str64 = table3.Rows[0]["current_odds"].ToString();
            _log3.set_old_val(str64);
            _log3.set_new_val((double.Parse(str64) - num32).ToString());
            _log3.set_ip(LSRequest.GetIP());
            _log3.set_add_time(DateTime.Now);
            _log3.set_note("系統自動降賠");
            _log3.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
            _log3.set_lottery_type(100);
            CallBLL.cz_system_log_bll.Add(_log3);
            cz_jp_odds _odds3 = new cz_jp_odds();
            _odds3.set_add_time(DateTime.Now);
            _odds3.set_odds_id(int.Parse(str4));
            _odds3.set_phase_id(int.Parse(s));
            _odds3.set_play_name(str21);
            _odds3.set_put_amount(str20);
            _odds3.set_odds(num32.ToString());
            _odds3.set_lottery_type(100);
            _odds3.set_phase(str11);
            _odds3.set_old_odds(str64);
            num40 = double.Parse(str64) - num32;
            _odds3.set_new_odds(num40.ToString());
            CallBLL.cz_jp_odds_bll.Add(_odds3);
            if (int.Parse(str4.Trim()) < 0x16792)
            {
                num38 = int.Parse(str4.Trim()) + 0x31;
                CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOddsTMAB(num32.ToString(), num33.ToString(), num38.ToString());
                cz_system_log _log4 = new cz_system_log();
                _log4.set_user_name("系統");
                _log4.set_children_name("");
                _log4.set_category(table3.Rows[0]["category"].ToString());
                _log3.set_play_name(table3.Rows[0]["play_name"].ToString());
                _log3.set_put_amount(str20);
                _log4.set_l_name(LSKeys.get_SIX_Name());
                _log4.set_l_phase(str11);
                _log4.set_action("降賠率");
                _log4.set_odds_id(int.Parse(str4) + 0x31);
                string str65 = table3.Rows[0]["current_odds"].ToString();
                _log4.set_old_val(str65);
                num40 = double.Parse(str65) - num32;
                _log4.set_new_val(num40.ToString());
                _log4.set_ip(LSRequest.GetIP());
                _log4.set_add_time(DateTime.Now);
                _log4.set_note("系統自動降賠");
                _log4.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                _log4.set_lottery_type(100);
                CallBLL.cz_system_log_bll.Add(_log3);
                cz_jp_odds _odds4 = new cz_jp_odds();
                _odds4.set_add_time(DateTime.Now);
                _odds4.set_odds_id(int.Parse(str4));
                _odds4.set_phase_id(int.Parse(s));
                _odds4.set_play_name(str21);
                _odds4.set_put_amount(str20);
                _odds4.set_odds(num32.ToString());
                _odds4.set_lottery_type(100);
                _odds4.set_phase(str11);
                _odds4.set_old_odds(str65);
                num40 = double.Parse(str65) - num32;
                _odds4.set_new_odds(num40.ToString());
                CallBLL.cz_jp_odds_bll.Add(_odds4);
            }
            if ((int.Parse(str4.Trim()) > 0x16791) && (int.Parse(str4.Trim()) < 0x167c3))
            {
                CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOddsTMAB(num32.ToString(), num33.ToString(), (int.Parse(str4.Trim()) - 0x31).ToString());
                cz_system_log _log5 = new cz_system_log();
                _log5.set_user_name("系統");
                _log5.set_children_name("");
                _log5.set_category(table3.Rows[0]["category"].ToString());
                _log3.set_play_name(table3.Rows[0]["play_name"].ToString());
                _log3.set_put_amount(str20);
                _log5.set_l_name(LSKeys.get_SIX_Name());
                _log5.set_l_phase(str11);
                _log5.set_action("降賠率");
                _log5.set_odds_id(int.Parse(str4) - 0x31);
                string str66 = table3.Rows[0]["current_odds"].ToString();
                _log5.set_old_val(str66);
                num40 = double.Parse(str66) - num32;
                _log5.set_new_val(num40.ToString());
                _log5.set_ip(LSRequest.GetIP());
                _log5.set_add_time(DateTime.Now);
                _log5.set_note("系統自動降賠");
                _log5.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                _log5.set_lottery_type(100);
                CallBLL.cz_system_log_bll.Add(_log3);
                cz_jp_odds _odds5 = new cz_jp_odds();
                _odds5.set_add_time(DateTime.Now);
                _odds5.set_odds_id(int.Parse(str4));
                _odds5.set_phase_id(int.Parse(s));
                _odds5.set_play_name(str21);
                _odds5.set_put_amount(str20);
                _odds5.set_odds(num32.ToString());
                _odds5.set_lottery_type(100);
                _odds5.set_phase(str11);
                _odds5.set_old_odds(str66);
                _odds5.set_new_odds((double.Parse(str66) - num32).ToString());
                CallBLL.cz_jp_odds_bll.Add(_odds5);
            }
        Label_3E20:
            table11 = null;
            double num34 = 0.0;
            str71 = model.get_u_type().ToLower();
            if (str71 != null)
            {
                if (!(str71 == "dl"))
                {
                    if (str71 == "zd")
                    {
                        if (model.get_six_op_odds().Equals(1))
                        {
                            table11 = base.GetFgsWTTable(100);
                        }
                        num34 = 0.0;
                        CallBLL.cz_autosale_six_bll.Agent_GDAutoSale(_six5.get_order_num(), str9, model.get_u_nicker(), str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, _six5.get_ip(), Convert.ToInt16(num), _six5.get_lottery_name(), model, _rate, table11, ref num34);
                        nullable = model.get_six_op_odds();
                        if (nullable.Equals(1))
                        {
                            table11 = base.GetFgsWTTable(100);
                        }
                        num34 = 0.0;
                        CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six5.get_order_num(), str9, model.get_u_nicker(), str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, _six5.get_ip(), Convert.ToInt16(num), _six5.get_lottery_name(), model, _rate, table11, ref num34);
                        if (num34 > 0.0)
                        {
                        }
                    }
                    else if (str71 == "gd")
                    {
                        nullable = model.get_six_op_odds();
                        if (nullable.Equals(1))
                        {
                            table11 = base.GetFgsWTTable(100);
                        }
                        num34 = 0.0;
                        CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six5.get_order_num(), str9, model.get_u_nicker(), str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, _six5.get_ip(), Convert.ToInt16(num), _six5.get_lottery_name(), model, _rate, table11, ref num34);
                    }
                }
                else
                {
                    if (model.get_six_op_odds().Equals(1))
                    {
                        table11 = base.GetFgsWTTable(100);
                    }
                    num34 = 0.0;
                    CallBLL.cz_autosale_six_bll.Agent_ZDAutoSale(_six5.get_order_num(), str9, model.get_u_nicker(), str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, _six5.get_ip(), Convert.ToInt16(num), _six5.get_lottery_name(), model, _rate, table11, ref num34);
                    if (model.get_six_op_odds().Equals(1))
                    {
                        table11 = base.GetFgsWTTable(100);
                    }
                    num34 = 0.0;
                    CallBLL.cz_autosale_six_bll.Agent_GDAutoSale(_six5.get_order_num(), str9, model.get_u_nicker(), str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, _six5.get_ip(), Convert.ToInt16(num), _six5.get_lottery_name(), model, _rate, table11, ref num34);
                    nullable = model.get_six_op_odds();
                    if (nullable.Equals(1))
                    {
                        table11 = base.GetFgsWTTable(100);
                    }
                    num34 = 0.0;
                    CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six5.get_order_num(), str9, model.get_u_nicker(), str10, table3.Rows[0]["play_id"].ToString(), str4.Trim(), str23, str24, str25, str26, str27, str28, str12, str11, _six5.get_ip(), Convert.ToInt16(num), _six5.get_lottery_name(), model, _rate, table11, ref num34);
                    if (num34 > 0.0)
                    {
                    }
                }
            }
        Label_427C:
            if (flag2)
            {
                string str67 = "";
                if (isDoubleOdds.Equals("1"))
                {
                    double num35 = double.Parse(str6) * (double.Parse(str14) - 1.0);
                    nullable = null;
                    str67 = Utils.GetMathRound(num35, nullable).ToString() + "," + Utils.GetMathRound(double.Parse(str6) * (double.Parse(str15) - 1.0), null);
                }
                else
                {
                    double num36 = double.Parse(str6) * (double.Parse(str14) - 1.0);
                    str67 = Utils.GetMathRound(num36, null).ToString();
                }
                string str68 = "";
                if (str7.Trim() != "")
                {
                    str68 = str7;
                }
                else
                {
                    str68 = str20;
                }
                Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                dictionary2.Add("ordernum", orderNumber);
                dictionary2.Add("playname", str21);
                dictionary2.Add("ky", str67);
                if ((str4.Equals("92565") || str4.Equals("92566")) || ((str4.Equals("92567") || str4.Equals("92568")) || str4.Equals("92636")))
                {
                    dictionary2.Add("putamount", FunctionSix.GetSXLNameBySXid(str68));
                }
                else if ((str4.Equals("92569") || str4.Equals("92570")) || (str4.Equals("92571") || str4.Equals("92637")))
                {
                    dictionary2.Add("putamount", FunctionSix.GetWSLNameBySXid(str68));
                }
                else
                {
                    dictionary2.Add("putamount", str68);
                }
                if (isDoubleOdds.Equals("1"))
                {
                    dictionary2.Add("pl", str14.ToString() + "," + str15.ToString());
                }
                else
                {
                    dictionary2.Add("pl", str14.ToString());
                }
                dictionary2.Add("amount", str6);
                if (flag2)
                {
                    dictionary2.Add("islm", "1");
                }
                else
                {
                    dictionary2.Add("islm", "0");
                }
                dictionary.Add("bhdata", dictionary2);
            }
            else
            {
                string mathRound = "";
                double num37 = double.Parse(str6) * (double.Parse(str14) - 1.0);
                mathRound = Utils.GetMathRound(num37, null);
                string str70 = str20;
                List<FastSale> list2 = new List<FastSale>();
                FastSale item = new FastSale();
                item.set_success("1");
                item.set_ordernum(orderNumber);
                item.set_playname(str21);
                item.set_putamount(str70);
                mathRound = num37.ToString();
                item.set_ky(mathRound);
                item.set_islm("0");
                item.set_pl(str14);
                item.set_amount(str6);
                item.set_message("");
                list2.Add(item);
                dictionary.Add("bhdata", list2);
            }
            new Dictionary<string, object>();
            dictionary.Add("jeucode", base.get_JeuValidate());
            result.set_data(dictionary);
            result.set_success(200);
            strResult = JsonHandle.ObjectToJson(result);
        }

        public void user_allow_saleTMAB(HttpContext context, ref string strResult)
        {
            ReturnResult result = new ReturnResult();
            result.set_success(400);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "user_allow_sale");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            agent_six_rate _rate = base.GetUserRate_six(model.get_zjname());
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_allow_sale().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100022", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            else if ((model.get_users_child_session() != null) && (model.get_users_child_session().get_permissions_name().IndexOf("po_5_2") < 0))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100022", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            if (model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100026", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            int num = 100;
            string s = LSRequest.qq("phaseid");
            string str4 = LSRequest.qq("oddsid");
            LSRequest.qq("currentodds");
            string str5 = LSRequest.qq("amount");
            string str6 = LSRequest.qq("number");
            string str7 = LSRequest.qq("pk");
            string str8 = LSRequest.qq("jeucode");
            if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str8))
            {
                context.Session["JeuValidate"] = null;
                result.set_success(400);
                new Dictionary<string, object>();
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                context.Session["JeuValidate"] = null;
                string str9 = "A";
                if (!Utils.Agent_AllowSaleKind(str7, model.get_six_kind(), ref str9))
                {
                    result.set_success(400);
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100056", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else if (!Utils.IsIntMoney(str5))
                {
                    result.set_success(400);
                    new Dictionary<string, object>();
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100041", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    int? nullable;
                    if (str5.Split(new char[] { ',' }).Length > 2)
                    {
                        context.Response.End();
                    }
                    string str10 = "";
                    string str11 = "";
                    cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                    if (currentPhase != null)
                    {
                        nullable = currentPhase.get_is_closed();
                        if ((nullable.GetValueOrDefault() == 1) && nullable.HasValue)
                        {
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                            result.set_success(400);
                            context.Session["JeuValidate"] = base.get_JeuValidate();
                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        str10 = currentPhase.get_phase().ToString();
                        str11 = currentPhase.get_p_id().ToString();
                    }
                    else
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (!s.Equals(str11))
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100042", "MessageHint"), currentPhase.get_phase().ToString()));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(str4);
                        DateTime now = DateTime.Now;
                        DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                        DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                        if ((((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91004") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91007") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91038")))
                        {
                            if (time3 < now)
                            {
                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        else if (time2 < now)
                        {
                            result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                            result.set_success(400);
                            context.Session["JeuValidate"] = base.get_JeuValidate();
                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        string str12 = "";
                        if (int.Parse(str4) < 0x16792)
                        {
                            str12 = str4 + "," + (Convert.ToInt32(str4) + 0x31);
                        }
                        DataTable oddsTableByOddsIds = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str12);
                        if (oddsTableByOddsIds == null)
                        {
                            result.set_tipinfo(PageBase.GetMessageByCache("u100041", "MessageHint"));
                            result.set_success(400);
                            context.Session["JeuValidate"] = base.get_JeuValidate();
                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            string str13 = oddsTableByOddsIds.Rows[0]["is_open"];
                            string str14 = oddsTableByOddsIds.Rows[0]["put_amount"];
                            string str15 = oddsTableByOddsIds.Rows[1]["is_open"];
                            string str16 = oddsTableByOddsIds.Rows[1]["put_amount"];
                            Dictionary<int, string> dictionary2 = new Dictionary<int, string>();
                            dictionary2.Add(int.Parse(oddsTableByOddsIds.Rows[0]["odds_id"].ToString()), str13);
                            dictionary2.Add(int.Parse(oddsTableByOddsIds.Rows[1]["odds_id"].ToString()), str15);
                            if (str13.Equals("0") && str15.Equals("0"))
                            {
                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                Dictionary<int, double> dictionary3 = new Dictionary<int, double>();
                                DataSet set = CallBLL.cz_bet_six_bll.GetBHSZZTByUName_TMAB(model.get_u_name(), model.get_u_type(), str11, str12, str6, str9);
                                if (((set != null) && (set.Tables.Count > 0)) && (set.Tables[0].Rows.Count > 0))
                                {
                                    double num2 = 0.0;
                                    int num3 = int.Parse(str4);
                                    int num4 = Convert.ToInt32(str4) + 0x31;
                                    double num5 = 0.0;
                                    double num6 = 0.0;
                                    for (int i = 0; i < set.Tables[0].Rows.Count; i++)
                                    {
                                        nullable = null;
                                        double num8 = Math.Floor(double.Parse(Utils.GetMathRound(Convert.ToDouble(set.Tables[0].Rows[i]["szzt"].ToString()), nullable)));
                                        if (num8 < 1.0)
                                        {
                                            num8 = 0.0;
                                        }
                                        int num9 = int.Parse(set.Tables[0].Rows[i]["odds_id"].ToString());
                                        if (num9.Equals(num3) && str13.Equals("1"))
                                        {
                                            num2 += num8;
                                            if (double.Parse(str5) > num8)
                                            {
                                                num5 = num8;
                                            }
                                            else
                                            {
                                                num5 = double.Parse(str5);
                                            }
                                        }
                                        if (num9.Equals(num4) && str15.Equals("1"))
                                        {
                                            num2 += num8;
                                            if ((double.Parse(str5) - num5) > num8)
                                            {
                                                num6 = num8;
                                            }
                                            else
                                            {
                                                num6 = double.Parse(str5) - num5;
                                            }
                                        }
                                    }
                                    if (num5 >= 1.0)
                                    {
                                        dictionary3.Add(num3, num5);
                                    }
                                    if (num6 >= 1.0)
                                    {
                                        dictionary3.Add(num4, num6);
                                    }
                                    if ((num5 <= 0.0) && (num6 <= 0.0))
                                    {
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100041", "MessageHint"), currentPhase.get_phase().ToString()));
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (str13.Equals("1") && str15.Equals("0"))
                                    {
                                        if (num5 < Convert.ToDouble(str5))
                                        {
                                            result.set_tipinfo(string.Format("補貨失敗:特码B【{0}】已封盘,特码A【{1}】補貨超量！", str14, str16));
                                            result.set_success(400);
                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    else if (str13.Equals("0") && str15.Equals("1"))
                                    {
                                        if (num6 < Convert.ToDouble(str5))
                                        {
                                            result.set_tipinfo(string.Format("補貨失敗:特码A【{0}】已封盘,特码B【{1}】補貨超量！", str14, str16));
                                            result.set_success(400);
                                            context.Session["JeuValidate"] = base.get_JeuValidate();
                                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                            result.set_data(dictionary);
                                            strResult = JsonHandle.ObjectToJson(result);
                                            return;
                                        }
                                    }
                                    else if (num2 < Convert.ToDouble(str5))
                                    {
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100043", "MessageHint"), currentPhase.get_phase().ToString()));
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (Convert.ToDouble(str5) < 10.0)
                                    {
                                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100096", "MessageHint"), 10));
                                        result.set_success(400);
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                else
                                {
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100041", "MessageHint"), currentPhase.get_phase().ToString()));
                                    result.set_success(400);
                                    context.Session["JeuValidate"] = base.get_JeuValidate();
                                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                List<FastSale> list = new List<FastSale>();
                                foreach (KeyValuePair<int, double> pair in dictionary3)
                                {
                                    decimal num15;
                                    double num21;
                                    cz_system_log _log;
                                    string str36;
                                    int num26;
                                    string str38;
                                    string str17 = "";
                                    string str18 = "";
                                    string str19 = "";
                                    DataTable table3 = CallBLL.cz_odds_six_bll.GetOddsByID(pair.Key.ToString()).Tables[0];
                                    int num10 = int.Parse(table3.Rows[0]["play_id"].ToString());
                                    string str20 = table3.Rows[0]["current_odds"].ToString().Trim();
                                    string diff = table3.Rows[0][str9 + "_diff"].ToString().Trim();
                                    string isDoubleOdds = table3.Rows[0]["isDoubleOdds"] + "".Trim();
                                    string str23 = table3.Rows[0]["put_amount"].ToString();
                                    string str24 = table3.Rows[0]["o_play_name"].ToString().Trim();
                                    string str25 = "";
                                    base.GetOdds_SIX_Sale(pair.Key.ToString(), str20, diff, isDoubleOdds, ref str17, ref str18, ref str19, ref str25);
                                    if (model.get_u_type().Equals("fgs"))
                                    {
                                        nullable = model.get_six_op_odds();
                                        if (nullable.Equals(1))
                                        {
                                            str17 = str25;
                                        }
                                    }
                                    DataRow[] rowArray = base.GetUserDrawback_six().Tables[0].Select(string.Format(" play_id={0} ", num10));
                                    string str26 = "0";
                                    string str27 = "0";
                                    string str28 = "0";
                                    string str29 = "0";
                                    string str30 = "0";
                                    string str31 = "0";
                                    double num11 = 0.0;
                                    double num12 = 0.0;
                                    if (_rate.get_zcyg().Equals("1"))
                                    {
                                        num11 = ((100.0 - double.Parse(_rate.get_fgszc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc());
                                        num12 = double.Parse(_rate.get_fgszc());
                                    }
                                    else if (model.get_u_type() == "fgs")
                                    {
                                        num11 = 100.0;
                                    }
                                    else
                                    {
                                        num12 = ((100.0 - double.Parse(_rate.get_zjzc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc());
                                        num11 = double.Parse(_rate.get_zjzc());
                                    }
                                    foreach (DataRow row in rowArray)
                                    {
                                        str38 = row["u_type"].ToString().Trim();
                                        if (str38 != null)
                                        {
                                            if (!(str38 == "zj"))
                                            {
                                                if (str38 == "fgs")
                                                {
                                                    goto Label_1342;
                                                }
                                                if (str38 == "gd")
                                                {
                                                    goto Label_1366;
                                                }
                                                if (str38 == "zd")
                                                {
                                                    goto Label_1387;
                                                }
                                                if (str38 == "dl")
                                                {
                                                    goto Label_13A8;
                                                }
                                                if (str38 == "hy")
                                                {
                                                    goto Label_13C9;
                                                }
                                            }
                                            else
                                            {
                                                str26 = row[str9 + "_drawback"].ToString().Trim();
                                            }
                                        }
                                        continue;
                                    Label_1342:
                                        str27 = row[str9 + "_drawback"].ToString().Trim();
                                        continue;
                                    Label_1366:
                                        str28 = row[str9 + "_drawback"].ToString().Trim();
                                        continue;
                                    Label_1387:
                                        str29 = row[str9 + "_drawback"].ToString().Trim();
                                        continue;
                                    Label_13A8:
                                        str30 = row[str9 + "_drawback"].ToString().Trim();
                                        continue;
                                    Label_13C9:
                                        str31 = row[str9 + "_drawback"].ToString().Trim();
                                    }
                                    str38 = model.get_u_type();
                                    if (str38 != null)
                                    {
                                        if (!(str38 == "fgs"))
                                        {
                                            if (str38 == "gd")
                                            {
                                                goto Label_1444;
                                            }
                                            if (str38 == "zd")
                                            {
                                                goto Label_144A;
                                            }
                                            if (str38 == "dl")
                                            {
                                                goto Label_1450;
                                            }
                                        }
                                        else
                                        {
                                            str28 = str27;
                                        }
                                    }
                                    goto Label_1454;
                                Label_1444:
                                    str29 = str28;
                                    goto Label_1454;
                                Label_144A:
                                    str30 = str29;
                                    goto Label_1454;
                                Label_1450:
                                    str31 = str30;
                                Label_1454:
                                    num15 = decimal.Parse(Utils.GetMathRound(pair.Value, null));
                                    string orderNumber = Utils.GetOrderNumber();
                                    cz_bet_six _six2 = new cz_bet_six();
                                    _six2.set_order_num(orderNumber);
                                    _six2.set_u_name(model.get_u_name());
                                    _six2.set_u_nicker(model.get_u_nicker());
                                    _six2.set_phase_id(new int?(int.Parse(str11)));
                                    _six2.set_phase(str10);
                                    _six2.set_bet_time(new DateTime?(DateTime.Now));
                                    _six2.set_checkcode(str8);
                                    _six2.set_odds_id(new int?(pair.Key));
                                    _six2.set_category(table3.Rows[0]["category"].ToString());
                                    _six2.set_play_id(new int?(int.Parse(table3.Rows[0]["play_id"].ToString())));
                                    _six2.set_play_name(table3.Rows[0]["o_play_name"].ToString());
                                    _six2.set_bet_val(table3.Rows[0]["put_amount"].ToString());
                                    _six2.set_odds(str17);
                                    _six2.set_amount(new decimal?(num15));
                                    _six2.set_profit(0);
                                    _six2.set_isLM(0);
                                    str38 = model.get_u_type().Trim();
                                    if (str38 != null)
                                    {
                                        if (!(str38 == "dl"))
                                        {
                                            if (str38 == "zd")
                                            {
                                                goto Label_1719;
                                            }
                                            if (str38 == "gd")
                                            {
                                                goto Label_1817;
                                            }
                                            if (str38 == "fgs")
                                            {
                                                goto Label_190A;
                                            }
                                        }
                                        else
                                        {
                                            _six2.set_hy_drawback(new decimal?(decimal.Parse(str31)));
                                            _six2.set_dl_drawback(new decimal?(decimal.Parse(str30)));
                                            _six2.set_zd_drawback(new decimal?(decimal.Parse(str29)));
                                            _six2.set_gd_drawback(new decimal?(decimal.Parse(str28)));
                                            _six2.set_fgs_drawback(new decimal?(decimal.Parse(str27)));
                                            _six2.set_zj_drawback(new decimal?(decimal.Parse(str26)));
                                            _six2.set_dl_rate(0f);
                                            _six2.set_zd_rate((float) int.Parse(_rate.get_zdzc()));
                                            _six2.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                                            _six2.set_fgs_rate(float.Parse(num12.ToString()));
                                            _six2.set_zj_rate(float.Parse(num11.ToString()));
                                            _six2.set_dl_name(_rate.get_dlname());
                                            _six2.set_zd_name(_rate.get_zdname());
                                            _six2.set_gd_name(_rate.get_gdname());
                                            _six2.set_fgs_name(_rate.get_fgsname());
                                        }
                                    }
                                    goto Label_19EE;
                                Label_1719:
                                    _six2.set_hy_drawback(0);
                                    _six2.set_dl_drawback(new decimal?(decimal.Parse(str30)));
                                    _six2.set_zd_drawback(new decimal?(decimal.Parse(str29)));
                                    _six2.set_gd_drawback(new decimal?(decimal.Parse(str28)));
                                    _six2.set_fgs_drawback(new decimal?(decimal.Parse(str27)));
                                    _six2.set_zj_drawback(new decimal?(decimal.Parse(str26)));
                                    _six2.set_dl_rate(0f);
                                    _six2.set_zd_rate(0f);
                                    _six2.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                                    _six2.set_fgs_rate(float.Parse(num12.ToString()));
                                    _six2.set_zj_rate(float.Parse(num11.ToString()));
                                    _six2.set_dl_name("");
                                    _six2.set_zd_name(_rate.get_zdname());
                                    _six2.set_gd_name(_rate.get_gdname());
                                    _six2.set_fgs_name(_rate.get_fgsname());
                                    goto Label_19EE;
                                Label_1817:
                                    _six2.set_hy_drawback(0);
                                    _six2.set_dl_drawback(0);
                                    _six2.set_zd_drawback(new decimal?(decimal.Parse(str29)));
                                    _six2.set_gd_drawback(new decimal?(decimal.Parse(str28)));
                                    _six2.set_fgs_drawback(new decimal?(decimal.Parse(str27)));
                                    _six2.set_zj_drawback(new decimal?(decimal.Parse(str26)));
                                    _six2.set_dl_rate(0f);
                                    _six2.set_zd_rate(0f);
                                    _six2.set_gd_rate(0f);
                                    _six2.set_fgs_rate(float.Parse(num12.ToString()));
                                    _six2.set_zj_rate(float.Parse(num11.ToString()));
                                    _six2.set_dl_name("");
                                    _six2.set_zd_name("");
                                    _six2.set_gd_name(_rate.get_gdname());
                                    _six2.set_fgs_name(_rate.get_fgsname());
                                    goto Label_19EE;
                                Label_190A:
                                    _six2.set_hy_drawback(0);
                                    _six2.set_dl_drawback(0);
                                    _six2.set_zd_drawback(0);
                                    _six2.set_gd_drawback(new decimal?(decimal.Parse(str28)));
                                    _six2.set_fgs_drawback(new decimal?(decimal.Parse(str27)));
                                    _six2.set_zj_drawback(new decimal?(decimal.Parse(str26)));
                                    _six2.set_dl_rate(0f);
                                    _six2.set_zd_rate(0f);
                                    _six2.set_gd_rate(0f);
                                    _six2.set_fgs_rate(0f);
                                    _six2.set_zj_rate(float.Parse(num11.ToString()));
                                    _six2.set_dl_name("");
                                    _six2.set_zd_name("");
                                    _six2.set_gd_name("");
                                    _six2.set_fgs_name(_rate.get_fgsname());
                                Label_19EE:
                                    _six2.set_is_payment(0);
                                    _six2.set_sale_type(1);
                                    _six2.set_m_type(-2);
                                    _six2.set_kind(str9);
                                    _six2.set_ip(LSRequest.GetIP());
                                    _six2.set_lottery_type(new int?(Convert.ToInt16(num)));
                                    nullable = _six2.get_lottery_type();
                                    _six2.set_lottery_name(base.GetGameNameByID(nullable.ToString()));
                                    _six2.set_odds_zj(str25);
                                    _six2.set_ordervalidcode(Utils.GetOrderValidCode(_six2.get_u_name(), _six2.get_order_num(), _six2.get_bet_val(), _six2.get_odds(), _six2.get_kind(), Convert.ToInt32(_six2.get_phase_id()), Convert.ToInt32(_six2.get_odds_id()), Convert.ToDouble(_six2.get_amount())));
                                    int num16 = 0;
                                    CallBLL.cz_bet_six_bll.AddBHBet(_six2, num15, str, ref num16, _rate);
                                    double num17 = (Convert.ToDouble(num15) * num11) / 100.0;
                                    cz_system_set_six systemSet = CallBLL.cz_system_set_six_bll.GetSystemSet(100);
                                    double num18 = 0.0;
                                    double num19 = 0.0;
                                    double num20 = 0.0;
                                    if ((pair.Key > 0x16791) && (pair.Key <= 0x167c2))
                                    {
                                        nullable = systemSet.get_is_tmab();
                                        if (nullable.Equals(1))
                                        {
                                            num26 = pair.Key - 0x31;
                                            DataSet oddsByID = CallBLL.cz_odds_six_bll.GetOddsByID(num26.ToString());
                                            num18 = double.Parse(oddsByID.Tables[0].Rows[0]["grand_total"].ToString());
                                            num19 = double.Parse(oddsByID.Tables[0].Rows[0]["downbase"].ToString());
                                            num20 = double.Parse(oddsByID.Tables[0].Rows[0]["down_odds_rate"].ToString());
                                            goto Label_1C7D;
                                        }
                                    }
                                    num18 = double.Parse(table3.Rows[0]["grand_total"].ToString()) + num17;
                                    num19 = double.Parse(table3.Rows[0]["downbase"].ToString());
                                    num20 = double.Parse(table3.Rows[0]["down_odds_rate"].ToString());
                                Label_1C7D:
                                    num21 = Math.Floor((double) (num18 / num19));
                                    if (num21 < 1.0)
                                    {
                                        goto Label_22FB;
                                    }
                                    double num22 = num20 * num21;
                                    double num23 = num18 - (num19 * num21);
                                    if ((pair.Key > 0x16791) && (pair.Key <= 0x167c2))
                                    {
                                        nullable = systemSet.get_is_tmab();
                                        if (nullable.Equals(1))
                                        {
                                            CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds(num22.ToString(), num23.ToString(), pair.Key.ToString(), true);
                                            goto Label_1D39;
                                        }
                                    }
                                    CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds(num22.ToString(), num23.ToString(), pair.Key.ToString());
                                Label_1D39:
                                    _log = new cz_system_log();
                                    _log.set_user_name("系統");
                                    _log.set_children_name("");
                                    _log.set_category(table3.Rows[0]["category"].ToString());
                                    _log.set_play_name(table3.Rows[0]["play_name"].ToString());
                                    _log.set_put_amount(str23);
                                    _log.set_l_name(LSKeys.get_SIX_Name());
                                    _log.set_l_phase(str10);
                                    _log.set_action("降賠率");
                                    _log.set_odds_id(pair.Key);
                                    string str33 = table3.Rows[0]["current_odds"].ToString();
                                    _log.set_old_val(str33);
                                    double num28 = double.Parse(str33) - num22;
                                    _log.set_new_val(num28.ToString());
                                    _log.set_ip(LSRequest.GetIP());
                                    _log.set_add_time(DateTime.Now);
                                    _log.set_note("系統自動降賠");
                                    _log.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                    _log.set_lottery_type(100);
                                    CallBLL.cz_system_log_bll.Add(_log);
                                    cz_jp_odds _odds = new cz_jp_odds();
                                    _odds.set_add_time(DateTime.Now);
                                    _odds.set_odds_id(pair.Key);
                                    _odds.set_phase_id(int.Parse(s));
                                    _odds.set_play_name(str24);
                                    _odds.set_put_amount(str23);
                                    _odds.set_odds(num22.ToString());
                                    _odds.set_lottery_type(100);
                                    _odds.set_phase(str10);
                                    _odds.set_old_odds(str33);
                                    num28 = double.Parse(str33) - num22;
                                    _odds.set_new_odds(num28.ToString());
                                    CallBLL.cz_jp_odds_bll.Add(_odds);
                                    if (pair.Key < 0x16792)
                                    {
                                        num26 = pair.Key + 0x31;
                                        CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOddsTMAB(num22.ToString(), num23.ToString(), num26.ToString());
                                        cz_system_log _log2 = new cz_system_log();
                                        _log2.set_user_name("系統");
                                        _log2.set_children_name("");
                                        _log2.set_category(table3.Rows[0]["category"].ToString());
                                        _log.set_play_name(table3.Rows[0]["play_name"].ToString());
                                        _log.set_put_amount(str23);
                                        _log2.set_l_name(LSKeys.get_SIX_Name());
                                        _log2.set_l_phase(str10);
                                        _log2.set_action("降賠率");
                                        _log2.set_odds_id(pair.Key + 0x31);
                                        string str34 = table3.Rows[0]["current_odds"].ToString();
                                        _log2.set_old_val(str34);
                                        num28 = double.Parse(str34) - num22;
                                        _log2.set_new_val(num28.ToString());
                                        _log2.set_ip(LSRequest.GetIP());
                                        _log2.set_add_time(DateTime.Now);
                                        _log2.set_note("系統自動降賠");
                                        _log2.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                        _log2.set_lottery_type(100);
                                        CallBLL.cz_system_log_bll.Add(_log);
                                        cz_jp_odds _odds2 = new cz_jp_odds();
                                        _odds2.set_add_time(DateTime.Now);
                                        _odds2.set_odds_id(pair.Key);
                                        _odds2.set_phase_id(int.Parse(s));
                                        _odds2.set_play_name(str24);
                                        _odds2.set_put_amount(str23);
                                        _odds2.set_odds(num22.ToString());
                                        _odds2.set_lottery_type(100);
                                        _odds2.set_phase(str10);
                                        _odds2.set_old_odds(str34);
                                        num28 = double.Parse(str34) - num22;
                                        _odds2.set_new_odds(num28.ToString());
                                        CallBLL.cz_jp_odds_bll.Add(_odds2);
                                    }
                                    if ((pair.Key > 0x16791) && (pair.Key < 0x167c3))
                                    {
                                        CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOddsTMAB(num22.ToString(), num23.ToString(), (pair.Key - 0x31).ToString());
                                        cz_system_log _log3 = new cz_system_log();
                                        _log3.set_user_name("系統");
                                        _log3.set_children_name("");
                                        _log3.set_category(table3.Rows[0]["category"].ToString());
                                        _log.set_play_name(table3.Rows[0]["play_name"].ToString());
                                        _log.set_put_amount(str23);
                                        _log3.set_l_name(LSKeys.get_SIX_Name());
                                        _log3.set_l_phase(str10);
                                        _log3.set_action("降賠率");
                                        _log3.set_odds_id(pair.Key - 0x31);
                                        string str35 = table3.Rows[0]["current_odds"].ToString();
                                        _log3.set_old_val(str35);
                                        num28 = double.Parse(str35) - num22;
                                        _log3.set_new_val(num28.ToString());
                                        _log3.set_ip(LSRequest.GetIP());
                                        _log3.set_add_time(DateTime.Now);
                                        _log3.set_note("系統自動降賠");
                                        _log3.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                        _log3.set_lottery_type(100);
                                        CallBLL.cz_system_log_bll.Add(_log);
                                        cz_jp_odds _odds3 = new cz_jp_odds();
                                        _odds3.set_add_time(DateTime.Now);
                                        _odds3.set_odds_id(pair.Key);
                                        _odds3.set_phase_id(int.Parse(s));
                                        _odds3.set_play_name(str24);
                                        _odds3.set_put_amount(str23);
                                        _odds3.set_odds(num22.ToString());
                                        _odds3.set_lottery_type(100);
                                        _odds3.set_phase(str10);
                                        _odds3.set_old_odds(str35);
                                        _odds3.set_new_odds((double.Parse(str35) - num22).ToString());
                                        CallBLL.cz_jp_odds_bll.Add(_odds3);
                                    }
                                Label_22FB:
                                    str36 = "";
                                    double num24 = pair.Value * (double.Parse(str17) - 1.0);
                                    nullable = null;
                                    str36 = Utils.GetMathRound(num24, nullable).ToString();
                                    string str37 = str23;
                                    FastSale item = new FastSale();
                                    item.set_success("1");
                                    item.set_ordernum(orderNumber);
                                    item.set_playname(str24);
                                    item.set_putamount(str37);
                                    item.set_ky(str36);
                                    item.set_islm("0");
                                    item.set_pl(str17);
                                    nullable = null;
                                    item.set_amount(Utils.GetMathRound(pair.Value, nullable).ToString());
                                    item.set_message("");
                                    list.Add(item);
                                    DataTable fgsWTTable = null;
                                    double num25 = 0.0;
                                    str38 = model.get_u_type().ToLower();
                                    if (str38 != null)
                                    {
                                        if (!(str38 == "dl"))
                                        {
                                            if (str38 == "zd")
                                            {
                                                goto Label_2630;
                                            }
                                            if (str38 == "gd")
                                            {
                                                goto Label_279C;
                                            }
                                        }
                                        else
                                        {
                                            if (model.get_six_op_odds().Equals(1))
                                            {
                                                fgsWTTable = base.GetFgsWTTable(100);
                                            }
                                            num25 = 0.0;
                                            CallBLL.cz_autosale_six_bll.Agent_ZDAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair.Key.ToString(), str26, str27, str28, str29, str30, str31, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num25);
                                            if (model.get_six_op_odds().Equals(1))
                                            {
                                                fgsWTTable = base.GetFgsWTTable(100);
                                            }
                                            num25 = 0.0;
                                            CallBLL.cz_autosale_six_bll.Agent_GDAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair.Key.ToString(), str26, str27, str28, str29, str30, str31, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num25);
                                            nullable = model.get_six_op_odds();
                                            if (nullable.Equals(1))
                                            {
                                                fgsWTTable = base.GetFgsWTTable(100);
                                            }
                                            num25 = 0.0;
                                            CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair.Key.ToString(), str26, str27, str28, str29, str30, str31, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num25);
                                            if (num25 > 0.0)
                                            {
                                            }
                                        }
                                    }
                                    continue;
                                Label_2630:
                                    if (model.get_six_op_odds().Equals(1))
                                    {
                                        fgsWTTable = base.GetFgsWTTable(100);
                                    }
                                    num25 = 0.0;
                                    CallBLL.cz_autosale_six_bll.Agent_GDAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair.Key.ToString(), str26, str27, str28, str29, str30, str31, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num25);
                                    nullable = model.get_six_op_odds();
                                    if (nullable.Equals(1))
                                    {
                                        fgsWTTable = base.GetFgsWTTable(100);
                                    }
                                    num25 = 0.0;
                                    CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair.Key.ToString(), str26, str27, str28, str29, str30, str31, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num25);
                                    if (num25 > 0.0)
                                    {
                                    }
                                    continue;
                                Label_279C:
                                    nullable = model.get_six_op_odds();
                                    if (nullable.Equals(1))
                                    {
                                        fgsWTTable = base.GetFgsWTTable(100);
                                    }
                                    num25 = 0.0;
                                    CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair.Key.ToString(), str26, str27, str28, str29, str30, str31, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num25);
                                }
                                dictionary.Add("bhdata", list);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                        }
                    }
                }
            }
        }

        public void user_fast_sale(HttpContext context, ref string strResult)
        {
            ReturnResult result = new ReturnResult();
            result.set_success(400);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "user_allow_sale");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            agent_six_rate _rate = base.GetUserRate_six(model.get_zjname());
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_allow_sale().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100022", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            else if ((model.get_users_child_session() != null) && (model.get_users_child_session().get_permissions_name().IndexOf("po_5_2") < 0))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100022", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            if (model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100026", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            int num = 100;
            string s = LSRequest.qq("phaseid");
            string str4 = LSRequest.qq("oddsid");
            LSRequest.qq("currentodds");
            string str5 = LSRequest.qq("amount");
            string str6 = LSRequest.qq("number");
            string str7 = LSRequest.qq("pk");
            string str8 = LSRequest.qq("jeucode");
            if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str8))
            {
                context.Session["JeuValidate"] = null;
                result.set_success(400);
                new Dictionary<string, object>();
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                context.Session["JeuValidate"] = null;
                string str9 = "A";
                if (!Utils.Agent_AllowSaleKind(str7, model.get_six_kind(), ref str9))
                {
                    result.set_success(400);
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100056", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    int? nullable;
                    string[] strArray = str4.Split(new char[] { ',' });
                    string[] strArray2 = str5.Split(new char[] { ',' });
                    if (strArray2.Length > 0x31)
                    {
                        context.Response.End();
                    }
                    string str10 = "";
                    string str11 = "";
                    cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                    if (currentPhase != null)
                    {
                        nullable = currentPhase.get_is_closed();
                        if ((nullable.GetValueOrDefault() == 1) && nullable.HasValue)
                        {
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                            result.set_success(400);
                            context.Session["JeuValidate"] = base.get_JeuValidate();
                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        str10 = currentPhase.get_phase().ToString();
                        str11 = currentPhase.get_p_id().ToString();
                    }
                    else
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (!s.Equals(str11))
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100042", "MessageHint"), currentPhase.get_phase().ToString()));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        int index = 0;
                        foreach (string str12 in strArray)
                        {
                            DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(str12);
                            DateTime now = DateTime.Now;
                            DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                            DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                            if ((((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91004") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91007") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91038")))
                            {
                                if (time3 < now)
                                {
                                    result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                    result.set_success(400);
                                    context.Session["JeuValidate"] = base.get_JeuValidate();
                                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                            }
                            else if (time2 < now)
                            {
                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            DataTable oddsTableByOddsIds = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str12);
                            if (oddsTableByOddsIds == null)
                            {
                                result.set_tipinfo(PageBase.GetMessageByCache("u100041", "MessageHint"));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else if (!oddsTableByOddsIds.Rows[0]["is_open"].ToString().Equals("1"))
                            {
                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                DataSet set = CallBLL.cz_bet_six_bll.GetBHSZZTByUName(model.get_u_name(), model.get_u_type(), str11, str12, str6, str9);
                                if (((set != null) && (set.Tables.Count > 0)) && (set.Tables[0].Rows.Count > 0))
                                {
                                    if (Convert.ToDouble(set.Tables[0].Rows[0]["szzt"].ToString()) >= Convert.ToDouble(strArray2[index]))
                                    {
                                        goto Label_0AEF;
                                    }
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100043", "MessageHint"), currentPhase.get_phase().ToString()));
                                    result.set_success(400);
                                    context.Session["JeuValidate"] = base.get_JeuValidate();
                                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                                else
                                {
                                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100041", "MessageHint"), currentPhase.get_phase().ToString()));
                                    result.set_success(400);
                                    context.Session["JeuValidate"] = base.get_JeuValidate();
                                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                }
                            }
                            return;
                        Label_0AEF:
                            index++;
                        }
                        List<FastSale> list = new List<FastSale>();
                        index = 0;
                        foreach (string str14 in strArray)
                        {
                            string str30;
                            double num14;
                            cz_system_log _log;
                            FastSale sale;
                            int num19;
                            string str35;
                            string str15 = "";
                            string str16 = "";
                            string str17 = "";
                            DataTable table3 = CallBLL.cz_odds_six_bll.GetOddsByID(str14).Tables[0];
                            int num4 = int.Parse(table3.Rows[0]["play_id"].ToString());
                            string str18 = table3.Rows[0]["current_odds"].ToString().Trim();
                            string diff = table3.Rows[0][str9 + "_diff"].ToString().Trim();
                            string isDoubleOdds = table3.Rows[0]["isDoubleOdds"] + "".Trim();
                            string str21 = table3.Rows[0]["put_amount"].ToString();
                            (table3.Rows[0]["isLM"]).Equals("1");
                            string str22 = table3.Rows[0]["o_play_name"].ToString().Trim();
                            string str23 = "";
                            base.GetOdds_SIX_Sale(str14, str18, diff, isDoubleOdds, ref str15, ref str16, ref str17, ref str23);
                            if (model.get_u_type().Equals("fgs") && model.get_six_op_odds().Equals(1))
                            {
                                str15 = str23;
                            }
                            DataRow[] rowArray = base.GetUserDrawback_six().Tables[0].Select(string.Format(" play_id={0} ", num4));
                            string str24 = "0";
                            string str25 = "0";
                            string str26 = "0";
                            string str27 = "0";
                            string str28 = "0";
                            string str29 = "0";
                            double num5 = 0.0;
                            double num6 = 0.0;
                            if (_rate.get_zcyg().Equals("1"))
                            {
                                num5 = ((100.0 - double.Parse(_rate.get_fgszc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc());
                                num6 = double.Parse(_rate.get_fgszc());
                            }
                            else if (model.get_u_type() == "fgs")
                            {
                                num5 = 100.0;
                            }
                            else
                            {
                                num6 = ((100.0 - double.Parse(_rate.get_zjzc())) - double.Parse(_rate.get_gdzc())) - double.Parse(_rate.get_zdzc());
                                num5 = double.Parse(_rate.get_zjzc());
                            }
                            foreach (DataRow row in rowArray)
                            {
                                str35 = row["u_type"].ToString().Trim();
                                if (str35 != null)
                                {
                                    if (!(str35 == "zj"))
                                    {
                                        if (str35 == "fgs")
                                        {
                                            goto Label_0E8C;
                                        }
                                        if (str35 == "gd")
                                        {
                                            goto Label_0EB0;
                                        }
                                        if (str35 == "zd")
                                        {
                                            goto Label_0ED1;
                                        }
                                        if (str35 == "dl")
                                        {
                                            goto Label_0EF2;
                                        }
                                        if (str35 == "hy")
                                        {
                                            goto Label_0F13;
                                        }
                                    }
                                    else
                                    {
                                        str24 = row[str9 + "_drawback"].ToString().Trim();
                                    }
                                }
                                continue;
                            Label_0E8C:
                                str25 = row[str9 + "_drawback"].ToString().Trim();
                                continue;
                            Label_0EB0:
                                str26 = row[str9 + "_drawback"].ToString().Trim();
                                continue;
                            Label_0ED1:
                                str27 = row[str9 + "_drawback"].ToString().Trim();
                                continue;
                            Label_0EF2:
                                str28 = row[str9 + "_drawback"].ToString().Trim();
                                continue;
                            Label_0F13:
                                str29 = row[str9 + "_drawback"].ToString().Trim();
                            }
                            str35 = model.get_u_type();
                            if (str35 != null)
                            {
                                if (!(str35 == "fgs"))
                                {
                                    if (str35 == "gd")
                                    {
                                        goto Label_0F8E;
                                    }
                                    if (str35 == "zd")
                                    {
                                        goto Label_0F94;
                                    }
                                    if (str35 == "dl")
                                    {
                                        goto Label_0F9A;
                                    }
                                }
                                else
                                {
                                    str26 = str25;
                                }
                            }
                            goto Label_0F9E;
                        Label_0F8E:
                            str27 = str26;
                            goto Label_0F9E;
                        Label_0F94:
                            str28 = str27;
                            goto Label_0F9E;
                        Label_0F9A:
                            str29 = str28;
                        Label_0F9E:
                            str30 = Utils.GetOrderNumber();
                            cz_bet_six _six2 = new cz_bet_six();
                            _six2.set_order_num(str30);
                            _six2.set_u_name(model.get_u_name());
                            _six2.set_u_nicker(model.get_u_nicker());
                            _six2.set_phase_id(new int?(int.Parse(str11)));
                            _six2.set_phase(str10);
                            _six2.set_bet_time(new DateTime?(DateTime.Now));
                            _six2.set_checkcode(str8);
                            _six2.set_odds_id(new int?(int.Parse(str14)));
                            _six2.set_category(table3.Rows[0]["category"].ToString());
                            _six2.set_play_id(new int?(int.Parse(table3.Rows[0]["play_id"].ToString())));
                            _six2.set_play_name(table3.Rows[0]["o_play_name"].ToString());
                            _six2.set_bet_val(table3.Rows[0]["put_amount"].ToString());
                            _six2.set_odds(str15);
                            _six2.set_amount(new decimal?(decimal.Parse(strArray2[index])));
                            _six2.set_profit(0);
                            _six2.set_isLM(0);
                            str35 = model.get_u_type().Trim();
                            if (str35 != null)
                            {
                                if (!(str35 == "dl"))
                                {
                                    if (str35 == "zd")
                                    {
                                        goto Label_124E;
                                    }
                                    if (str35 == "gd")
                                    {
                                        goto Label_134C;
                                    }
                                    if (str35 == "fgs")
                                    {
                                        goto Label_143F;
                                    }
                                }
                                else
                                {
                                    _six2.set_hy_drawback(new decimal?(decimal.Parse(str29)));
                                    _six2.set_dl_drawback(new decimal?(decimal.Parse(str28)));
                                    _six2.set_zd_drawback(new decimal?(decimal.Parse(str27)));
                                    _six2.set_gd_drawback(new decimal?(decimal.Parse(str26)));
                                    _six2.set_fgs_drawback(new decimal?(decimal.Parse(str25)));
                                    _six2.set_zj_drawback(new decimal?(decimal.Parse(str24)));
                                    _six2.set_dl_rate(0f);
                                    _six2.set_zd_rate((float) int.Parse(_rate.get_zdzc()));
                                    _six2.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                                    _six2.set_fgs_rate(float.Parse(num6.ToString()));
                                    _six2.set_zj_rate(float.Parse(num5.ToString()));
                                    _six2.set_dl_name(_rate.get_dlname());
                                    _six2.set_zd_name(_rate.get_zdname());
                                    _six2.set_gd_name(_rate.get_gdname());
                                    _six2.set_fgs_name(_rate.get_fgsname());
                                }
                            }
                            goto Label_1523;
                        Label_124E:
                            _six2.set_hy_drawback(0);
                            _six2.set_dl_drawback(new decimal?(decimal.Parse(str28)));
                            _six2.set_zd_drawback(new decimal?(decimal.Parse(str27)));
                            _six2.set_gd_drawback(new decimal?(decimal.Parse(str26)));
                            _six2.set_fgs_drawback(new decimal?(decimal.Parse(str25)));
                            _six2.set_zj_drawback(new decimal?(decimal.Parse(str24)));
                            _six2.set_dl_rate(0f);
                            _six2.set_zd_rate(0f);
                            _six2.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                            _six2.set_fgs_rate(float.Parse(num6.ToString()));
                            _six2.set_zj_rate(float.Parse(num5.ToString()));
                            _six2.set_dl_name("");
                            _six2.set_zd_name(_rate.get_zdname());
                            _six2.set_gd_name(_rate.get_gdname());
                            _six2.set_fgs_name(_rate.get_fgsname());
                            goto Label_1523;
                        Label_134C:
                            _six2.set_hy_drawback(0);
                            _six2.set_dl_drawback(0);
                            _six2.set_zd_drawback(new decimal?(decimal.Parse(str27)));
                            _six2.set_gd_drawback(new decimal?(decimal.Parse(str26)));
                            _six2.set_fgs_drawback(new decimal?(decimal.Parse(str25)));
                            _six2.set_zj_drawback(new decimal?(decimal.Parse(str24)));
                            _six2.set_dl_rate(0f);
                            _six2.set_zd_rate(0f);
                            _six2.set_gd_rate(0f);
                            _six2.set_fgs_rate(float.Parse(num6.ToString()));
                            _six2.set_zj_rate(float.Parse(num5.ToString()));
                            _six2.set_dl_name("");
                            _six2.set_zd_name("");
                            _six2.set_gd_name(_rate.get_gdname());
                            _six2.set_fgs_name(_rate.get_fgsname());
                            goto Label_1523;
                        Label_143F:
                            _six2.set_hy_drawback(0);
                            _six2.set_dl_drawback(0);
                            _six2.set_zd_drawback(0);
                            _six2.set_gd_drawback(new decimal?(decimal.Parse(str26)));
                            _six2.set_fgs_drawback(new decimal?(decimal.Parse(str25)));
                            _six2.set_zj_drawback(new decimal?(decimal.Parse(str24)));
                            _six2.set_dl_rate(0f);
                            _six2.set_zd_rate(0f);
                            _six2.set_gd_rate(0f);
                            _six2.set_fgs_rate(0f);
                            _six2.set_zj_rate(float.Parse(num5.ToString()));
                            _six2.set_dl_name("");
                            _six2.set_zd_name("");
                            _six2.set_gd_name("");
                            _six2.set_fgs_name(_rate.get_fgsname());
                        Label_1523:
                            _six2.set_is_payment(0);
                            _six2.set_sale_type(1);
                            _six2.set_m_type(-2);
                            _six2.set_kind(str9);
                            _six2.set_ip(LSRequest.GetIP());
                            _six2.set_lottery_type(new int?(Convert.ToInt16(num)));
                            nullable = _six2.get_lottery_type();
                            _six2.set_lottery_name(base.GetGameNameByID(nullable.ToString()));
                            _six2.set_odds_zj(str23);
                            _six2.set_ordervalidcode(Utils.GetOrderValidCode(_six2.get_u_name(), _six2.get_order_num(), _six2.get_bet_val(), _six2.get_odds(), _six2.get_kind(), Convert.ToInt32(_six2.get_phase_id()), Convert.ToInt32(_six2.get_odds_id()), Convert.ToDouble(_six2.get_amount())));
                            int num9 = 0;
                            CallBLL.cz_bet_six_bll.AddBHBet(_six2, decimal.Parse(strArray2[index]), str, ref num9, _rate);
                            double num10 = (Convert.ToDouble(strArray2[index]) * num5) / 100.0;
                            cz_system_set_six systemSet = CallBLL.cz_system_set_six_bll.GetSystemSet(100);
                            double num11 = 0.0;
                            double num12 = 0.0;
                            double num13 = 0.0;
                            if ((int.Parse(str14) > 0x16791) && (int.Parse(str14) <= 0x167c2))
                            {
                                nullable = systemSet.get_is_tmab();
                                if (nullable.Equals(1))
                                {
                                    num19 = int.Parse(str14) - 0x31;
                                    DataSet oddsByID = CallBLL.cz_odds_six_bll.GetOddsByID(num19.ToString());
                                    num11 = double.Parse(oddsByID.Tables[0].Rows[0]["grand_total"].ToString());
                                    num12 = double.Parse(oddsByID.Tables[0].Rows[0]["downbase"].ToString());
                                    num13 = double.Parse(oddsByID.Tables[0].Rows[0]["down_odds_rate"].ToString());
                                    goto Label_17BD;
                                }
                            }
                            num11 = double.Parse(table3.Rows[0]["grand_total"].ToString()) + num10;
                            num12 = double.Parse(table3.Rows[0]["downbase"].ToString());
                            num13 = double.Parse(table3.Rows[0]["down_odds_rate"].ToString());
                        Label_17BD:
                            num14 = Math.Floor((double) (num11 / num12));
                            if (num14 < 1.0)
                            {
                                goto Label_1DCF;
                            }
                            double num15 = num13 * num14;
                            double num16 = num11 - (num12 * num14);
                            if ((int.Parse(str14) > 0x16791) && (int.Parse(str14) <= 0x167c2))
                            {
                                nullable = systemSet.get_is_tmab();
                                if (nullable.Equals(1))
                                {
                                    CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds(num15.ToString(), num16.ToString(), str14, true);
                                    goto Label_185D;
                                }
                            }
                            CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds(num15.ToString(), num16.ToString(), str14);
                        Label_185D:
                            _log = new cz_system_log();
                            _log.set_user_name("系統");
                            _log.set_children_name("");
                            _log.set_category(table3.Rows[0]["category"].ToString());
                            _log.set_play_name(table3.Rows[0]["play_name"].ToString());
                            _log.set_put_amount(str21);
                            _log.set_l_name(LSKeys.get_SIX_Name());
                            _log.set_l_phase(str10);
                            _log.set_action("降賠率");
                            _log.set_odds_id(int.Parse(str14));
                            string str31 = table3.Rows[0]["current_odds"].ToString();
                            _log.set_old_val(str31);
                            double num22 = double.Parse(str31) - num15;
                            _log.set_new_val(num22.ToString());
                            _log.set_ip(LSRequest.GetIP());
                            _log.set_add_time(DateTime.Now);
                            _log.set_note("系統自動降賠");
                            _log.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                            _log.set_lottery_type(100);
                            CallBLL.cz_system_log_bll.Add(_log);
                            cz_jp_odds _odds = new cz_jp_odds();
                            _odds.set_add_time(DateTime.Now);
                            _odds.set_odds_id(int.Parse(str14));
                            _odds.set_phase_id(int.Parse(s));
                            _odds.set_play_name(str22);
                            _odds.set_put_amount(str21);
                            _odds.set_odds(num15.ToString());
                            _odds.set_lottery_type(100);
                            _odds.set_phase(str10);
                            CallBLL.cz_jp_odds_bll.Add(_odds);
                            if (int.Parse(str14.Trim()) < 0x16792)
                            {
                                num19 = int.Parse(str14.Trim()) + 0x31;
                                CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOddsTMAB(num15.ToString(), num16.ToString(), num19.ToString());
                                cz_system_log _log2 = new cz_system_log();
                                _log2.set_user_name("系統");
                                _log2.set_children_name("");
                                _log2.set_category(table3.Rows[0]["category"].ToString());
                                _log.set_play_name(table3.Rows[0]["play_name"].ToString());
                                _log.set_put_amount(str21);
                                _log2.set_l_name(LSKeys.get_SIX_Name());
                                _log2.set_l_phase(str10);
                                _log2.set_action("降賠率");
                                _log2.set_odds_id(int.Parse(str14) + 0x31);
                                string str32 = table3.Rows[0]["current_odds"].ToString();
                                _log2.set_old_val(str32);
                                num22 = double.Parse(str32) - num15;
                                _log2.set_new_val(num22.ToString());
                                _log2.set_ip(LSRequest.GetIP());
                                _log2.set_add_time(DateTime.Now);
                                _log2.set_note("系統自動降賠");
                                _log2.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                _log2.set_lottery_type(100);
                                CallBLL.cz_system_log_bll.Add(_log);
                                cz_jp_odds _odds2 = new cz_jp_odds();
                                _odds2.set_add_time(DateTime.Now);
                                _odds2.set_odds_id(int.Parse(str14));
                                _odds2.set_phase_id(int.Parse(s));
                                _odds2.set_play_name(str22);
                                _odds2.set_put_amount(str21);
                                _odds2.set_odds(num15.ToString());
                                _odds2.set_lottery_type(100);
                                _odds2.set_phase(str10);
                                CallBLL.cz_jp_odds_bll.Add(_odds2);
                            }
                            if ((int.Parse(str14.Trim()) > 0x16791) && (int.Parse(str14.Trim()) < 0x167c3))
                            {
                                CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOddsTMAB(num15.ToString(), num16.ToString(), (int.Parse(str14.Trim()) - 0x31).ToString());
                                cz_system_log _log3 = new cz_system_log();
                                _log3.set_user_name("系統");
                                _log3.set_children_name("");
                                _log3.set_category(table3.Rows[0]["category"].ToString());
                                _log.set_play_name(table3.Rows[0]["play_name"].ToString());
                                _log.set_put_amount(str21);
                                _log3.set_l_name(LSKeys.get_SIX_Name());
                                _log3.set_l_phase(str10);
                                _log3.set_action("降賠率");
                                _log3.set_odds_id(int.Parse(str14) - 0x31);
                                string str33 = table3.Rows[0]["current_odds"].ToString();
                                _log3.set_old_val(str33);
                                _log3.set_new_val((double.Parse(str33) - num15).ToString());
                                _log3.set_ip(LSRequest.GetIP());
                                _log3.set_add_time(DateTime.Now);
                                _log3.set_note("系統自動降賠");
                                _log3.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                _log3.set_lottery_type(100);
                                CallBLL.cz_system_log_bll.Add(_log);
                                cz_jp_odds _odds3 = new cz_jp_odds();
                                _odds3.set_add_time(DateTime.Now);
                                _odds3.set_odds_id(int.Parse(str14));
                                _odds3.set_phase_id(int.Parse(s));
                                _odds3.set_play_name(str22);
                                _odds3.set_put_amount(str21);
                                _odds3.set_odds(num15.ToString());
                                _odds3.set_lottery_type(100);
                                _odds3.set_phase(str10);
                                CallBLL.cz_jp_odds_bll.Add(_odds3);
                            }
                        Label_1DCF:
                            sale = new FastSale();
                            sale.set_success("1");
                            sale.set_ordernum(str30);
                            sale.set_playname(str22);
                            sale.set_putamount(str21);
                            string mathRound = "";
                            double num17 = double.Parse(strArray2[index]) * (double.Parse(str15) - 1.0);
                            nullable = null;
                            mathRound = Utils.GetMathRound(num17, nullable);
                            sale.set_ky(mathRound);
                            sale.set_islm("0");
                            sale.set_pl(str15);
                            sale.set_amount(Utils.GetMathRound(double.Parse(strArray2[index]), null));
                            sale.set_oddsid(str14);
                            sale.set_message("");
                            list.Add(sale);
                            DataTable fgsWTTable = null;
                            double num18 = 0.0;
                            str35 = model.get_u_type().ToLower();
                            if (str35 != null)
                            {
                                if (!(str35 == "dl"))
                                {
                                    if (str35 == "zd")
                                    {
                                        goto Label_20EA;
                                    }
                                    if (str35 == "gd")
                                    {
                                        goto Label_2244;
                                    }
                                }
                                else
                                {
                                    if (model.get_six_op_odds().Equals(1))
                                    {
                                        fgsWTTable = base.GetFgsWTTable(100);
                                    }
                                    num18 = 0.0;
                                    CallBLL.cz_autosale_six_bll.Agent_ZDAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), str14.Trim(), str24, str25, str26, str27, str28, str29, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num18);
                                    if (model.get_six_op_odds().Equals(1))
                                    {
                                        fgsWTTable = base.GetFgsWTTable(100);
                                    }
                                    num18 = 0.0;
                                    CallBLL.cz_autosale_six_bll.Agent_GDAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), str14.Trim(), str24, str25, str26, str27, str28, str29, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num18);
                                    if (model.get_six_op_odds().Equals(1))
                                    {
                                        fgsWTTable = base.GetFgsWTTable(100);
                                    }
                                    num18 = 0.0;
                                    CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), str14.Trim(), str24, str25, str26, str27, str28, str29, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num18);
                                    if (num18 > 0.0)
                                    {
                                    }
                                }
                            }
                            goto Label_22ED;
                        Label_20EA:
                            if (model.get_six_op_odds().Equals(1))
                            {
                                fgsWTTable = base.GetFgsWTTable(100);
                            }
                            num18 = 0.0;
                            CallBLL.cz_autosale_six_bll.Agent_GDAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), str14.Trim(), str24, str25, str26, str27, str28, str29, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num18);
                            if (model.get_six_op_odds().Equals(1))
                            {
                                fgsWTTable = base.GetFgsWTTable(100);
                            }
                            num18 = 0.0;
                            CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), str14.Trim(), str24, str25, str26, str27, str28, str29, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num18);
                            if (num18 > 0.0)
                            {
                            }
                            goto Label_22ED;
                        Label_2244:
                            if (model.get_six_op_odds().Equals(1))
                            {
                                fgsWTTable = base.GetFgsWTTable(100);
                            }
                            num18 = 0.0;
                            CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), str14.Trim(), str24, str25, str26, str27, str28, str29, str11, str10, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num18);
                        Label_22ED:
                            index++;
                        }
                        dictionary.Add("bhdata", list);
                        new Dictionary<string, object>();
                        dictionary.Add("jeucode", base.get_JeuValidate());
                        result.set_data(dictionary);
                        result.set_success(200);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                }
            }
        }

        public void user_fast_saleTMAB(HttpContext context, ref string strResult)
        {
            int? nullable;
            ReturnResult result = new ReturnResult();
            result.set_success(400);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "user_allow_sale");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            agent_six_rate _rate = base.GetUserRate_six(model.get_zjname());
            if (!string.IsNullOrEmpty(base.Permission_Ashx_DL(model, "po_5_2")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!model.get_allow_sale().Equals(1))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100022", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            else if ((model.get_users_child_session() != null) && (model.get_users_child_session().get_permissions_name().IndexOf("po_5_2") < 0))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100022", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            if (model.get_u_type().Trim().Equals("zj"))
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100026", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                context.Response.End();
            }
            int num = 100;
            string s = LSRequest.qq("phaseid");
            string str4 = LSRequest.qq("oddsid");
            LSRequest.qq("currentodds");
            string str5 = LSRequest.qq("amount");
            string str6 = LSRequest.qq("number");
            string str7 = LSRequest.qq("pk");
            string str8 = LSRequest.qq("jeucode");
            if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str8))
            {
                context.Session["JeuValidate"] = null;
                result.set_success(400);
                new Dictionary<string, object>();
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            context.Session["JeuValidate"] = null;
            string str9 = "A";
            if (!Utils.Agent_AllowSaleKind(str7, model.get_six_kind(), ref str9))
            {
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100056", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            string[] strArray = str5.Split(new char[] { ',' });
            if (str4.Split(new char[] { ',' }).Length > 0x31)
            {
                context.Response.End();
            }
            string str10 = "";
            int index = 0;
        Label_0525:;
            if (index < str4.Split(new char[] { ',' }).Length)
            {
                object obj2;
                if (index == 0)
                {
                    obj2 = str10;
                    str10 = string.Concat(new object[] { obj2, str4.Split(new char[] { ',' })[index], ",", Convert.ToInt32(str4.Split(new char[] { ',' })[index]) + 0x31 });
                }
                else
                {
                    obj2 = str10;
                    str10 = string.Concat(new object[] { obj2, ",", str4.Split(new char[] { ',' })[index], ",", Convert.ToInt32(str4.Split(new char[] { ',' })[index]) + 0x31 });
                }
                index++;
                goto Label_0525;
            }
            string str11 = "";
            string str12 = "";
            cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
            if (currentPhase != null)
            {
                nullable = currentPhase.get_is_closed();
                if ((nullable.GetValueOrDefault() == 1) && nullable.HasValue)
                {
                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                    result.set_success(400);
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                    return;
                }
                str11 = currentPhase.get_phase().ToString();
                str12 = currentPhase.get_p_id().ToString();
            }
            else
            {
                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
                return;
            }
            if (!s.Equals(str12))
            {
                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100042", "MessageHint"), currentPhase.get_phase().ToString()));
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                foreach (string str13 in str4.Split(new char[] { ',' }))
                {
                    DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(str13);
                    DateTime now = DateTime.Now;
                    DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                    DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                    if ((((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91004") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91007") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91038")))
                    {
                        if (time3 >= now)
                        {
                            continue;
                        }
                        result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (time2 < now)
                    {
                        result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                }
                Dictionary<int, string> dictionary2 = new Dictionary<int, string>();
                int length = str4.Split(new char[] { ',' }).Length;
                DataTable oddsTableByOddsIds = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str10);
                for (int i = 0; i < oddsTableByOddsIds.Rows.Count; i++)
                {
                    int key = int.Parse(oddsTableByOddsIds.Rows[i]["odds_id"].ToString());
                    string str14 = oddsTableByOddsIds.Rows[i]["is_open"].ToString();
                    if (key <= 0x16791)
                    {
                        int num6 = int.Parse(oddsTableByOddsIds.Rows[i + length]["odds_id"].ToString());
                        string str15 = oddsTableByOddsIds.Rows[i + length]["is_open"].ToString();
                        dictionary2.Add(key, str14);
                        dictionary2.Add(num6, str15);
                    }
                }
                int num7 = 0;
                foreach (KeyValuePair<int, string> pair in dictionary2)
                {
                    if (pair.Value.Equals("1"))
                    {
                        num7 = 1;
                        break;
                    }
                }
                if (!num7.Equals(0))
                {
                    Dictionary<int, double> dictionary3 = new Dictionary<int, double>();
                    Dictionary<int, string> dictionary4 = new Dictionary<int, string>();
                    Dictionary<int, double> dictionary5 = new Dictionary<int, double>();
                    DataSet set = CallBLL.cz_bet_six_bll.GetBHSZZTByUName_TMAB(model.get_u_name(), model.get_u_type(), str12, str10, str6, str9);
                    int num8 = 0;
                    while (true)
                    {
                        if (num8 >= str10.Split(new char[] { ',' }).Length)
                        {
                            double num33;
                            if ((dictionary5 != null) && (dictionary5.Count > 0))
                            {
                                int num11 = 0;
                                foreach (KeyValuePair<int, double> pair2 in dictionary5)
                                {
                                    int num12 = pair2.Key;
                                    double num13 = 0.0;
                                    if (num12 <= 0x16791)
                                    {
                                        int num14 = pair2.Key + 0x31;
                                        num13 = pair2.Value + dictionary5[num14];
                                        double num15 = pair2.Value;
                                        double num16 = dictionary5[num14];
                                        num13 = num15 + num16;
                                        string str16 = dictionary2[num12];
                                        string str17 = dictionary2[num14];
                                        double num17 = num13;
                                        if (str16.Equals("0"))
                                        {
                                            num17 -= num15;
                                        }
                                        if (str17.Equals("0"))
                                        {
                                            num17 -= num16;
                                        }
                                        if (double.Parse(strArray[num11].ToString()) > num17)
                                        {
                                            DataRow[] rowArray3 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", num12));
                                            string str18 = rowArray3[0]["play_name"].ToString();
                                            string str19 = rowArray3[0]["put_amount"].ToString();
                                            string str20 = rowArray3[0]["current_odds"].ToString();
                                            string str21 = rowArray3[0][str9 + "_diff"].ToString();
                                            num33 = double.Parse(str20) + double.Parse(str21);
                                            string str22 = num33.ToString();
                                            if (model.get_six_op_odds().Equals("1"))
                                            {
                                                string str23 = "";
                                                string str24 = "";
                                                string str25 = "";
                                                base.GetOdds_SIX_Sale(num12.ToString(), str20, str21, "0", ref str22, ref str23, ref str24, ref str25);
                                                if (model.get_u_type().Equals("fgs") && model.get_six_op_odds().Equals(1))
                                                {
                                                    str22 = str25;
                                                }
                                            }
                                            dictionary4.Add(num12, str18 + "," + str18.Replace('A', 'B') + "|" + str19 + "|" + str22 + "|補貨超量！");
                                        }
                                        else
                                        {
                                            double num18 = 0.0;
                                            double num19 = 0.0;
                                            if (str16.Equals("1") && (num15 > 0.0))
                                            {
                                                if (double.Parse(strArray[num11].ToString()) > num13)
                                                {
                                                    num18 = num13;
                                                }
                                                else if (double.Parse(strArray[num11].ToString()) > num15)
                                                {
                                                    num18 = num15;
                                                }
                                                else
                                                {
                                                    num18 = double.Parse(strArray[num11].ToString());
                                                }
                                            }
                                            else
                                            {
                                                DataRow[] rowArray4 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", num12));
                                                string str26 = rowArray4[0]["play_name"].ToString();
                                                string str27 = rowArray4[0]["put_amount"].ToString();
                                                string str28 = rowArray4[0]["current_odds"].ToString();
                                                string str29 = rowArray4[0][str9 + "_diff"].ToString();
                                                num33 = double.Parse(str28) + double.Parse(str29);
                                                string str30 = num33.ToString();
                                                if (model.get_six_op_odds().Equals("1"))
                                                {
                                                    string str31 = "";
                                                    string str32 = "";
                                                    string str33 = "";
                                                    base.GetOdds_SIX_Sale(num12.ToString(), str28, str29, "0", ref str30, ref str31, ref str32, ref str33);
                                                    if (model.get_u_type().Equals("fgs") && model.get_six_op_odds().Equals(1))
                                                    {
                                                        str30 = str33;
                                                    }
                                                }
                                                if (str16.Equals("0") && (num18 > 0.0))
                                                {
                                                    dictionary4.Add(num12, str26 + "|" + str27 + "|" + str30 + "|已封盘！");
                                                }
                                                if ((str16.Equals("1") && (num18 <= 0.0)) && (num16 < double.Parse(strArray[num11])))
                                                {
                                                    dictionary4.Add(num12, str26 + "|" + str27 + "|" + str30 + "|無補貨注額！");
                                                }
                                            }
                                            if (str17.Equals("1") && (num16 > 0.0))
                                            {
                                                if ((double.Parse(strArray[num11].ToString()) - num18) > num13)
                                                {
                                                    num19 = num13;
                                                }
                                                else if ((double.Parse(strArray[num11].ToString()) - num18) > num16)
                                                {
                                                    num19 = num16;
                                                }
                                                else
                                                {
                                                    num19 = double.Parse(strArray[num11].ToString()) - num18;
                                                }
                                            }
                                            else
                                            {
                                                DataRow[] rowArray5 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", num14));
                                                string str34 = rowArray5[0]["play_name"].ToString();
                                                string str35 = rowArray5[0]["put_amount"].ToString();
                                                string str36 = rowArray5[0]["current_odds"].ToString();
                                                string str37 = rowArray5[0][str9 + "_diff"].ToString();
                                                num33 = double.Parse(str36) + double.Parse(str37);
                                                string str38 = num33.ToString();
                                                if (model.get_six_op_odds().Equals("1"))
                                                {
                                                    string str39 = "";
                                                    string str40 = "";
                                                    string str41 = "";
                                                    base.GetOdds_SIX_Sale(num12.ToString(), str36, str37, "0", ref str38, ref str39, ref str40, ref str41);
                                                    if (model.get_u_type().Equals("fgs") && model.get_six_op_odds().Equals(1))
                                                    {
                                                        str38 = str41;
                                                    }
                                                }
                                                if (str17.Equals("0") && (num19 > 0.0))
                                                {
                                                    dictionary4.Add(num14, str34 + "|" + str35 + "|" + str38 + "|已封盘！");
                                                }
                                                else if (str17.Equals("1") && (num19 <= 0.0))
                                                {
                                                    dictionary4.Add(num14, str34 + "|" + str35 + "|" + str38 + "|無補貨注額！");
                                                }
                                            }
                                            if (num18 > 0.0)
                                            {
                                                dictionary3.Add(num12, num18);
                                            }
                                            if (num19 > 0.0)
                                            {
                                                dictionary3.Add(num14, num19);
                                            }
                                            num11++;
                                        }
                                    }
                                }
                            }
                            else
                            {
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100041", "MessageHint"), currentPhase.get_phase().ToString()));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            List<FastSale> list = new List<FastSale>();
                            foreach (KeyValuePair<int, double> pair3 in dictionary3)
                            {
                                string str57;
                                double num26;
                                cz_system_log _log;
                                FastSale sale;
                                int num31;
                                string str62;
                                string str42 = "";
                                string str43 = "";
                                string str44 = "";
                                DataTable table3 = CallBLL.cz_odds_six_bll.GetOddsByID(pair3.Key.ToString()).Tables[0];
                                int num20 = int.Parse(table3.Rows[0]["play_id"].ToString());
                                string str45 = table3.Rows[0]["current_odds"].ToString().Trim();
                                string diff = table3.Rows[0][str9 + "_diff"].ToString().Trim();
                                string isDoubleOdds = table3.Rows[0]["isDoubleOdds"] + "".Trim();
                                string str48 = table3.Rows[0]["put_amount"].ToString();
                                (table3.Rows[0]["isLM"]).Equals("1");
                                string str49 = table3.Rows[0]["o_play_name"].ToString().Trim();
                                string str50 = "";
                                base.GetOdds_SIX_Sale(pair3.Key.ToString(), str45, diff, isDoubleOdds, ref str42, ref str43, ref str44, ref str50);
                                if (model.get_u_type().Equals("fgs") && model.get_six_op_odds().Equals(1))
                                {
                                    str42 = str50;
                                }
                                DataRow[] rowArray6 = base.GetUserDrawback_six().Tables[0].Select(string.Format(" play_id={0} ", num20));
                                string str51 = "0";
                                string str52 = "0";
                                string str53 = "0";
                                string str54 = "0";
                                string str55 = "0";
                                string str56 = "0";
                                foreach (DataRow row in rowArray6)
                                {
                                    str62 = row["u_type"].ToString().Trim();
                                    if (str62 != null)
                                    {
                                        if (!(str62 == "zj"))
                                        {
                                            if (str62 == "fgs")
                                            {
                                                goto Label_17D2;
                                            }
                                            if (str62 == "gd")
                                            {
                                                goto Label_17F6;
                                            }
                                            if (str62 == "zd")
                                            {
                                                goto Label_1817;
                                            }
                                            if (str62 == "dl")
                                            {
                                                goto Label_1838;
                                            }
                                            if (str62 == "hy")
                                            {
                                                goto Label_1859;
                                            }
                                        }
                                        else
                                        {
                                            str51 = row[str9 + "_drawback"].ToString().Trim();
                                        }
                                    }
                                    continue;
                                Label_17D2:
                                    str52 = row[str9 + "_drawback"].ToString().Trim();
                                    continue;
                                Label_17F6:
                                    str53 = row[str9 + "_drawback"].ToString().Trim();
                                    continue;
                                Label_1817:
                                    str54 = row[str9 + "_drawback"].ToString().Trim();
                                    continue;
                                Label_1838:
                                    str55 = row[str9 + "_drawback"].ToString().Trim();
                                    continue;
                                Label_1859:
                                    str56 = row[str9 + "_drawback"].ToString().Trim();
                                }
                                str62 = model.get_u_type();
                                if (str62 != null)
                                {
                                    if (!(str62 == "fgs"))
                                    {
                                        if (str62 == "gd")
                                        {
                                            goto Label_18D4;
                                        }
                                        if (str62 == "zd")
                                        {
                                            goto Label_18DA;
                                        }
                                        if (str62 == "dl")
                                        {
                                            goto Label_18E0;
                                        }
                                    }
                                    else
                                    {
                                        str53 = str52;
                                    }
                                }
                                goto Label_18E4;
                            Label_18D4:
                                str54 = str53;
                                goto Label_18E4;
                            Label_18DA:
                                str55 = str54;
                                goto Label_18E4;
                            Label_18E0:
                                str56 = str55;
                            Label_18E4:
                                str57 = Utils.GetOrderNumber();
                                cz_bet_six _six2 = new cz_bet_six();
                                _six2.set_order_num(str57);
                                _six2.set_u_name(model.get_u_name());
                                _six2.set_u_nicker(model.get_u_nicker());
                                _six2.set_phase_id(new int?(int.Parse(str12)));
                                _six2.set_phase(str11);
                                _six2.set_bet_time(new DateTime?(DateTime.Now));
                                _six2.set_checkcode(str8);
                                _six2.set_odds_id(new int?(int.Parse(pair3.Key.ToString())));
                                _six2.set_category(table3.Rows[0]["category"].ToString());
                                _six2.set_play_id(new int?(int.Parse(table3.Rows[0]["play_id"].ToString())));
                                _six2.set_play_name(table3.Rows[0]["o_play_name"].ToString());
                                _six2.set_bet_val(table3.Rows[0]["put_amount"].ToString());
                                _six2.set_odds(str42);
                                _six2.set_amount(new decimal?(decimal.Parse(pair3.Value.ToString())));
                                _six2.set_profit(0);
                                _six2.set_isLM(0);
                                _six2.set_hy_drawback(new decimal?(decimal.Parse(str56)));
                                _six2.set_dl_drawback(new decimal?(decimal.Parse(str55)));
                                _six2.set_zd_drawback(new decimal?(decimal.Parse(str54)));
                                _six2.set_gd_drawback(new decimal?(decimal.Parse(str53)));
                                _six2.set_fgs_drawback(new decimal?(decimal.Parse(str52)));
                                _six2.set_zj_drawback(new decimal?(decimal.Parse(str51)));
                                _six2.set_dl_rate((float) int.Parse(_rate.get_dlzc()));
                                _six2.set_zd_rate((float) int.Parse(_rate.get_zdzc()));
                                _six2.set_gd_rate((float) int.Parse(_rate.get_gdzc()));
                                _six2.set_fgs_rate((float) int.Parse(_rate.get_fgszc()));
                                _six2.set_zj_rate((float) int.Parse(_rate.get_zjzc()));
                                _six2.set_is_payment(0);
                                _six2.set_dl_name(_rate.get_dlname());
                                _six2.set_zd_name(_rate.get_zdname());
                                _six2.set_gd_name(_rate.get_gdname());
                                _six2.set_fgs_name(_rate.get_fgsname());
                                _six2.set_sale_type(1);
                                _six2.set_m_type(-2);
                                _six2.set_kind(str9);
                                _six2.set_ip(LSRequest.GetIP());
                                _six2.set_lottery_type(new int?(Convert.ToInt16(num)));
                                nullable = _six2.get_lottery_type();
                                _six2.set_lottery_name(base.GetGameNameByID(nullable.ToString()));
                                _six2.set_odds_zj(str50);
                                _six2.set_ordervalidcode(Utils.GetOrderValidCode(_six2.get_u_name(), _six2.get_order_num(), _six2.get_bet_val(), _six2.get_odds(), _six2.get_kind(), Convert.ToInt32(_six2.get_phase_id()), Convert.ToInt32(_six2.get_odds_id()), Convert.ToDouble(_six2.get_amount())));
                                int num21 = 0;
                                CallBLL.cz_bet_six_bll.AddBHBet(_six2, decimal.Parse(pair3.Value.ToString()), str, ref num21, _rate);
                                double num22 = (Convert.ToDouble(pair3.Value.ToString()) * Convert.ToDouble(_rate.get_zjzc())) / 100.0;
                                cz_system_set_six systemSet = CallBLL.cz_system_set_six_bll.GetSystemSet(100);
                                double num23 = 0.0;
                                double num24 = 0.0;
                                double num25 = 0.0;
                                if ((pair3.Key > 0x16791) && (pair3.Key <= 0x167c2))
                                {
                                    nullable = systemSet.get_is_tmab();
                                    if (nullable.Equals(1))
                                    {
                                        num31 = pair3.Key - 0x31;
                                        DataSet oddsByID = CallBLL.cz_odds_six_bll.GetOddsByID(num31.ToString());
                                        num23 = double.Parse(oddsByID.Tables[0].Rows[0]["grand_total"].ToString());
                                        num24 = double.Parse(oddsByID.Tables[0].Rows[0]["downbase"].ToString());
                                        num25 = double.Parse(oddsByID.Tables[0].Rows[0]["down_odds_rate"].ToString());
                                        goto Label_1E13;
                                    }
                                }
                                num23 = double.Parse(table3.Rows[0]["grand_total"].ToString()) + num22;
                                num24 = double.Parse(table3.Rows[0]["downbase"].ToString());
                                num25 = double.Parse(table3.Rows[0]["down_odds_rate"].ToString());
                            Label_1E13:
                                num26 = Math.Floor((double) (num23 / num24));
                                if (num26 < 1.0)
                                {
                                    goto Label_24DB;
                                }
                                double num27 = num25 * num26;
                                double num28 = num23 - (num24 * num26);
                                if ((pair3.Key > 0x16791) && (pair3.Key <= 0x167c2))
                                {
                                    nullable = systemSet.get_is_tmab();
                                    if (nullable.Equals(1))
                                    {
                                        CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds(num27.ToString(), num28.ToString(), pair3.Key.ToString(), true);
                                        goto Label_1ECF;
                                    }
                                }
                                CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOdds(num27.ToString(), num28.ToString(), pair3.Key.ToString());
                            Label_1ECF:
                                _log = new cz_system_log();
                                _log.set_user_name("系統");
                                _log.set_children_name("");
                                _log.set_category(table3.Rows[0]["category"].ToString());
                                _log.set_play_name(table3.Rows[0]["play_name"].ToString());
                                _log.set_put_amount(str48);
                                _log.set_l_name(LSKeys.get_SIX_Name());
                                _log.set_l_phase(str11);
                                _log.set_action("降賠率");
                                _log.set_odds_id(int.Parse(pair3.Key.ToString()));
                                string str58 = table3.Rows[0]["current_odds"].ToString();
                                _log.set_old_val(str58);
                                num33 = double.Parse(str58) - num27;
                                _log.set_new_val(num33.ToString());
                                _log.set_ip(LSRequest.GetIP());
                                _log.set_add_time(DateTime.Now);
                                _log.set_note("系統自動降賠");
                                _log.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                _log.set_lottery_type(100);
                                CallBLL.cz_system_log_bll.Add(_log);
                                cz_jp_odds _odds = new cz_jp_odds();
                                _odds.set_add_time(DateTime.Now);
                                _odds.set_odds_id(int.Parse(pair3.Key.ToString()));
                                _odds.set_phase_id(int.Parse(s));
                                _odds.set_play_name(str49);
                                _odds.set_put_amount(str48);
                                _odds.set_odds(num27.ToString());
                                _odds.set_lottery_type(100);
                                _odds.set_phase(str11);
                                CallBLL.cz_jp_odds_bll.Add(_odds);
                                if (int.Parse(pair3.Key.ToString().Trim()) < 0x16792)
                                {
                                    num31 = int.Parse(pair3.Key.ToString().Trim()) + 0x31;
                                    CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOddsTMAB(num27.ToString(), num28.ToString(), num31.ToString());
                                    cz_system_log _log2 = new cz_system_log();
                                    _log2.set_user_name("系統");
                                    _log2.set_children_name("");
                                    _log2.set_category(table3.Rows[0]["category"].ToString());
                                    _log.set_play_name(table3.Rows[0]["play_name"].ToString());
                                    _log.set_put_amount(str48);
                                    _log2.set_l_name(LSKeys.get_SIX_Name());
                                    _log2.set_l_phase(str11);
                                    _log2.set_action("降賠率");
                                    _log2.set_odds_id(int.Parse(pair3.Key.ToString()) + 0x31);
                                    string str59 = table3.Rows[0]["current_odds"].ToString();
                                    _log2.set_old_val(str59);
                                    num33 = double.Parse(str59) - num27;
                                    _log2.set_new_val(num33.ToString());
                                    _log2.set_ip(LSRequest.GetIP());
                                    _log2.set_add_time(DateTime.Now);
                                    _log2.set_note("系統自動降賠");
                                    _log2.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                    _log2.set_lottery_type(100);
                                    CallBLL.cz_system_log_bll.Add(_log);
                                    cz_jp_odds _odds2 = new cz_jp_odds();
                                    _odds2.set_add_time(DateTime.Now);
                                    _odds2.set_odds_id(int.Parse(pair3.Key.ToString()));
                                    _odds2.set_phase_id(int.Parse(s));
                                    _odds2.set_play_name(str49);
                                    _odds2.set_put_amount(str48);
                                    _odds2.set_odds(num27.ToString());
                                    _odds2.set_lottery_type(100);
                                    _odds2.set_phase(str11);
                                    CallBLL.cz_jp_odds_bll.Add(_odds2);
                                }
                                if ((int.Parse(pair3.Key.ToString().Trim()) > 0x16791) && (int.Parse(pair3.Key.ToString().Trim()) < 0x167c3))
                                {
                                    CallBLL.cz_odds_six_bll.UpdateGrandTotalCurrentOddsTMAB(num27.ToString(), num28.ToString(), (int.Parse(pair3.Key.ToString().Trim()) - 0x31).ToString());
                                    cz_system_log _log3 = new cz_system_log();
                                    _log3.set_user_name("系統");
                                    _log3.set_children_name("");
                                    _log3.set_category(table3.Rows[0]["category"].ToString());
                                    _log.set_play_name(table3.Rows[0]["play_name"].ToString());
                                    _log.set_put_amount(str48);
                                    _log3.set_l_name(LSKeys.get_SIX_Name());
                                    _log3.set_l_phase(str11);
                                    _log3.set_action("降賠率");
                                    _log3.set_odds_id(int.Parse(pair3.Key.ToString()) - 0x31);
                                    string str60 = table3.Rows[0]["current_odds"].ToString();
                                    _log3.set_old_val(str60);
                                    _log3.set_new_val((double.Parse(str60) - num27).ToString());
                                    _log3.set_ip(LSRequest.GetIP());
                                    _log3.set_add_time(DateTime.Now);
                                    _log3.set_note("系統自動降賠");
                                    _log3.set_type_id(Convert.ToInt32((LSEnums.LogTypeID) 0));
                                    _log3.set_lottery_type(100);
                                    CallBLL.cz_system_log_bll.Add(_log);
                                    cz_jp_odds _odds3 = new cz_jp_odds();
                                    _odds3.set_add_time(DateTime.Now);
                                    _odds3.set_odds_id(int.Parse(pair3.Key.ToString()));
                                    _odds3.set_phase_id(int.Parse(s));
                                    _odds3.set_play_name(str49);
                                    _odds3.set_put_amount(str48);
                                    _odds3.set_odds(num27.ToString());
                                    _odds3.set_lottery_type(100);
                                    _odds3.set_phase(str11);
                                    CallBLL.cz_jp_odds_bll.Add(_odds3);
                                }
                            Label_24DB:
                                sale = new FastSale();
                                sale.set_success("1");
                                sale.set_ordernum(str57);
                                sale.set_playname(str49);
                                sale.set_putamount(str48);
                                string mathRound = "";
                                double num29 = double.Parse(pair3.Value.ToString()) * (double.Parse(str42) - 1.0);
                                nullable = null;
                                mathRound = Utils.GetMathRound(num29, nullable);
                                sale.set_ky(mathRound);
                                sale.set_islm("0");
                                sale.set_pl(str42);
                                sale.set_amount(Utils.GetMathRound(pair3.Value, null));
                                sale.set_oddsid(pair3.Key.ToString());
                                sale.set_message("");
                                list.Add(sale);
                                DataTable fgsWTTable = null;
                                double num30 = 0.0;
                                str62 = model.get_u_type().ToLower();
                                if (str62 != null)
                                {
                                    if (!(str62 == "dl"))
                                    {
                                        if (str62 == "zd")
                                        {
                                            goto Label_2836;
                                        }
                                        if (str62 == "gd")
                                        {
                                            goto Label_29AC;
                                        }
                                    }
                                    else
                                    {
                                        if (model.get_six_op_odds().Equals(1))
                                        {
                                            fgsWTTable = base.GetFgsWTTable(100);
                                        }
                                        num30 = 0.0;
                                        CallBLL.cz_autosale_six_bll.Agent_ZDAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair3.Key.ToString().Trim(), str51, str52, str53, str54, str55, str56, str12, str11, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num30);
                                        if (model.get_six_op_odds().Equals(1))
                                        {
                                            fgsWTTable = base.GetFgsWTTable(100);
                                        }
                                        num30 = 0.0;
                                        CallBLL.cz_autosale_six_bll.Agent_GDAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair3.Key.ToString().Trim(), str51, str52, str53, str54, str55, str56, str12, str11, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num30);
                                        if (model.get_six_op_odds().Equals(1))
                                        {
                                            fgsWTTable = base.GetFgsWTTable(100);
                                        }
                                        num30 = 0.0;
                                        CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair3.Key.ToString().Trim(), str51, str52, str53, str54, str55, str56, str12, str11, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num30);
                                        if (num30 > 0.0)
                                        {
                                        }
                                    }
                                }
                                continue;
                            Label_2836:
                                if (model.get_six_op_odds().Equals(1))
                                {
                                    fgsWTTable = base.GetFgsWTTable(100);
                                }
                                num30 = 0.0;
                                CallBLL.cz_autosale_six_bll.Agent_GDAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair3.Key.ToString().Trim(), str51, str52, str53, str54, str55, str56, str12, str11, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num30);
                                if (model.get_six_op_odds().Equals(1))
                                {
                                    fgsWTTable = base.GetFgsWTTable(100);
                                }
                                num30 = 0.0;
                                CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair3.Key.ToString().Trim(), str51, str52, str53, str54, str55, str56, str12, str11, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num30);
                                if (num30 > 0.0)
                                {
                                }
                                continue;
                            Label_29AC:
                                if (model.get_six_op_odds().Equals(1))
                                {
                                    fgsWTTable = base.GetFgsWTTable(100);
                                }
                                num30 = 0.0;
                                CallBLL.cz_autosale_six_bll.Agent_FGSAutoSale(_six2.get_order_num(), str8, model.get_u_nicker(), str9, table3.Rows[0]["play_id"].ToString(), pair3.Key.ToString().Trim(), str51, str52, str53, str54, str55, str56, str12, str11, _six2.get_ip(), Convert.ToInt16(num), _six2.get_lottery_name(), model, _rate, fgsWTTable, ref num30);
                            }
                            if (dictionary4.Count > 0)
                            {
                                foreach (KeyValuePair<int, string> pair4 in dictionary4)
                                {
                                    FastSale item = new FastSale();
                                    item.set_success("0");
                                    item.set_ordernum("補貨失敗");
                                    item.set_playname(pair4.Value.ToString().Split(new char[] { '|' })[0]);
                                    item.set_putamount(pair4.Value.ToString().Split(new char[] { '|' })[1]);
                                    item.set_ky("0");
                                    item.set_islm("0");
                                    item.set_pl(pair4.Value.ToString().Split(new char[] { '|' })[2]);
                                    item.set_amount("0");
                                    item.set_oddsid(pair4.Key.ToString());
                                    item.set_message(pair4.Value.ToString().Split(new char[] { '|' })[3]);
                                    list.Add(item);
                                }
                            }
                            dictionary.Add("bhdata", list);
                            new Dictionary<string, object>();
                            dictionary.Add("jeucode", base.get_JeuValidate());
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        int num9 = int.Parse(str10.Split(new char[] { ',' })[num8]);
                        int num10 = int.Parse(str10.Split(new char[] { ',' })[num8]) + 0x31;
                        if (num9 <= 0x16791)
                        {
                            DataRow[] rowArray = set.Tables[0].Select(string.Format(" odds_id={0} ", num9));
                            if (dictionary2[num9].ToString().Equals("1"))
                            {
                                if ((rowArray != null) && (rowArray.Length > 0))
                                {
                                    dictionary5.Add(num9, double.Parse(Utils.GetMathRound(double.Parse(rowArray[0]["szzt"].ToString()), 5)));
                                }
                                else
                                {
                                    dictionary5.Add(num9, 0.0);
                                }
                            }
                            else
                            {
                                dictionary5.Add(num9, 0.0);
                            }
                            DataRow[] rowArray2 = set.Tables[0].Select(string.Format(" odds_id={0} ", num10));
                            if (dictionary2[num10].ToString().Equals("1"))
                            {
                                if ((rowArray2 != null) && (rowArray2.Length > 0))
                                {
                                    dictionary5.Add(num10, double.Parse(Utils.GetMathRound(double.Parse(rowArray2[0]["szzt"].ToString()), 5)));
                                }
                                else
                                {
                                    dictionary5.Add(num10, 0.0);
                                }
                            }
                            else
                            {
                                dictionary5.Add(num10, 0.0);
                            }
                        }
                        num8++;
                    }
                }
                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                result.set_success(400);
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
            }
        }

        public void zj_allow_sale(HttpContext context, ref string strResult)
        {
            ReturnResult result = new ReturnResult();
            result.set_success(400);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "user_allow_sale");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            base.UserRate_six(model.get_zjname());
            object obj1 = context.Session["six_rate_FileCacheKey" + context.Session["user_name"].ToString()];
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            int num = 100;
            string str3 = LSRequest.qq("phaseid");
            string s = LSRequest.qq("oddsid");
            string str5 = LSRequest.qq("currentodds");
            string str6 = LSRequest.qq("amount");
            string str7 = LSRequest.qq("number");
            string str8 = LSRequest.qq("s_user");
            string str9 = LSRequest.qq("pk");
            string str10 = LSRequest.qq("jeucode");
            cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str8);
            if (user == null)
            {
                result.set_success(400);
                result.set_tipinfo(PageBase.GetMessageByCache("u100044", "MessageHint"));
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                string str11 = user.get_six_kind().ToUpper();
                if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str10))
                {
                    context.Session["JeuValidate"] = null;
                    result.set_success(400);
                    new Dictionary<string, object>();
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    context.Session["JeuValidate"] = null;
                    if (double.Parse(str6) < 10.0)
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100096", "MessageHint"), 10));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        string str12 = "";
                        string str13 = "";
                        cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                        if (currentPhase != null)
                        {
                            if (currentPhase.get_is_closed() == 1)
                            {
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            str12 = currentPhase.get_phase().ToString();
                            str13 = currentPhase.get_p_id().ToString();
                        }
                        else
                        {
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                            result.set_success(400);
                            context.Session["JeuValidate"] = base.get_JeuValidate();
                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        if (!str3.Equals(str13))
                        {
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100042", "MessageHint"), currentPhase.get_phase().ToString()));
                            result.set_success(400);
                            context.Session["JeuValidate"] = base.get_JeuValidate();
                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(s);
                            DateTime now = DateTime.Now;
                            DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                            DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                            if ((((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91004") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91007") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91038")))
                            {
                                if (time3 < now)
                                {
                                    result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                    result.set_success(400);
                                    context.Session["JeuValidate"] = base.get_JeuValidate();
                                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                            }
                            else if (time2 < now)
                            {
                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            DataTable table2 = CallBLL.cz_odds_six_bll.GetOddsByID(s).Tables[0];
                            int num2 = int.Parse(table2.Rows[0]["play_id"].ToString());
                            string str14 = table2.Rows[0]["isDoubleOdds"] + "".Trim();
                            string str15 = table2.Rows[0]["put_amount"].ToString();
                            bool flag = (table2.Rows[0]["isLM"]).Equals("1");
                            string str16 = table2.Rows[0]["o_play_name"].ToString().Trim();
                            if (table2.Rows[0]["is_open"].ToString().Trim().Equals("0"))
                            {
                                result.set_success(400);
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100074", "MessageHint"), str16, str15));
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                            else
                            {
                                if (!model.get_negative_sale().Equals(1))
                                {
                                    string str18 = s;
                                    string str19 = num2.ToString();
                                    if (int.Parse(s) <= 0x167c2)
                                    {
                                        if (int.Parse(s) <= 0x16791)
                                        {
                                            str18 = s + "," + (int.Parse(s) + 0x31);
                                        }
                                        if ((int.Parse(s) > 0x16791) && (int.Parse(s) <= 0x167c2))
                                        {
                                            str18 = (int.Parse(s) - 0x31) + "," + s;
                                        }
                                        str19 = "91001,91002";
                                    }
                                    DataTable table3 = CallBLL.cz_bet_six_bll.GetSZZTByZJ(str3, str19, model.get_u_name(), str18, str9);
                                    double num3 = 0.0;
                                    if (int.Parse(s) <= 0x167c2)
                                    {
                                        if (!string.IsNullOrEmpty(table3.Rows[0]["szzt"].ToString()))
                                        {
                                            num3 += Convert.ToDouble(table3.Rows[0]["szzt"]);
                                        }
                                        if ((table3.Rows.Count > 1) && !string.IsNullOrEmpty(table3.Rows[1]["szzt"].ToString()))
                                        {
                                            num3 += Convert.ToDouble(table3.Rows[1]["szzt"]);
                                        }
                                    }
                                    else
                                    {
                                        num3 = Convert.ToDouble(table3.Rows[0]["szzt"]);
                                    }
                                    if ((table3 == null) || (num3 < 1.0))
                                    {
                                        result.set_success(400);
                                        if (int.Parse(s) <= 0x167c2)
                                        {
                                            result.set_tipinfo(string.Format("補貨注額不能大於特碼【{0}】A+B總貨量: {1} ！", str15, (int) num3));
                                        }
                                        else
                                        {
                                            result.set_tipinfo(PageBase.GetMessageByCache("u100047", "MessageHint"));
                                        }
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (Convert.ToDouble(str6) > num3)
                                    {
                                        result.set_success(400);
                                        if (int.Parse(s) <= 0x167c2)
                                        {
                                            result.set_tipinfo(string.Format("補貨注額不能大於特碼【{0}】A+B總貨量: {1} ！", str15, (int) num3));
                                        }
                                        else
                                        {
                                            result.set_tipinfo(PageBase.GetMessageByCache("u100048", "MessageHint"));
                                        }
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                if (str14.Equals("1"))
                                {
                                    if (str5.Split(new char[] { ',' }).Length < 2)
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(PageBase.GetMessageByCache("u100046", "MessageHint"));
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                    if (string.IsNullOrEmpty(str5.Split(new char[] { ',' })[0]) || string.IsNullOrEmpty(str5.Split(new char[] { ',' })[1]))
                                    {
                                        result.set_success(400);
                                        result.set_tipinfo(PageBase.GetMessageByCache("u100046", "MessageHint"));
                                        context.Session["JeuValidate"] = base.get_JeuValidate();
                                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                        result.set_data(dictionary);
                                        strResult = JsonHandle.ObjectToJson(result);
                                        return;
                                    }
                                }
                                else if (string.IsNullOrEmpty(str5))
                                {
                                    result.set_success(400);
                                    result.set_tipinfo(PageBase.GetMessageByCache("u100046", "MessageHint"));
                                    context.Session["JeuValidate"] = base.get_JeuValidate();
                                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                                cz_drawback_six drawback = CallBLL.cz_drawback_six_bll.GetDrawback(Convert.ToInt32(num2), user.get_u_name());
                                string str20 = "";
                                string str21 = "";
                                string str22 = "";
                                string str23 = "";
                                string str24 = "0";
                                string str25 = "0";
                                string str26 = "0";
                                string str27 = "0";
                                string str28 = "0";
                                string str29 = "0";
                                string str37 = str11.ToUpper();
                                if (str37 != null)
                                {
                                    if (!(str37 == "A"))
                                    {
                                        if (str37 == "B")
                                        {
                                            str24 = drawback.get_b_drawback().ToString();
                                            str25 = drawback.get_b_drawback().ToString();
                                        }
                                        else if (str37 == "C")
                                        {
                                            str24 = drawback.get_c_drawback().ToString();
                                            str25 = drawback.get_c_drawback().ToString();
                                        }
                                    }
                                    else
                                    {
                                        str24 = drawback.get_a_drawback().ToString();
                                        str25 = drawback.get_a_drawback().ToString();
                                    }
                                }
                                str20 = str;
                                string orderNumber = Utils.GetOrderNumber();
                                if (flag)
                                {
                                    cz_bet_six _six4 = new cz_bet_six();
                                    _six4.set_order_num(orderNumber);
                                    _six4.set_u_name(user.get_u_name());
                                    _six4.set_u_nicker(user.get_u_nicker());
                                    _six4.set_phase_id(new int?(int.Parse(str13)));
                                    _six4.set_phase(str12);
                                    _six4.set_bet_time(new DateTime?(DateTime.Now));
                                    _six4.set_checkcode(str10);
                                    _six4.set_odds_id(new int?(int.Parse(s)));
                                    _six4.set_category(table2.Rows[0]["category"].ToString());
                                    _six4.set_play_id(new int?(int.Parse(table2.Rows[0]["play_id"].ToString())));
                                    _six4.set_play_name(table2.Rows[0]["o_play_name"].ToString());
                                    _six4.set_bet_val(str7);
                                    _six4.set_odds(str14.Equals("1") ? (str5.Split(new char[] { ',' })[0] + "," + str5.Split(new char[] { ',' })[1]) : str5);
                                    _six4.set_amount(new decimal?(decimal.Parse(str6)));
                                    _six4.set_profit(0);
                                    _six4.set_isLM(1);
                                    _six4.set_unit_cnt(1);
                                    _six4.set_lm_type(0);
                                    _six4.set_bet_group(str7);
                                    _six4.set_hy_drawback(new decimal?(decimal.Parse(str29)));
                                    _six4.set_dl_drawback(new decimal?(decimal.Parse(str28)));
                                    _six4.set_zd_drawback(new decimal?(decimal.Parse(str27)));
                                    _six4.set_gd_drawback(new decimal?(decimal.Parse(str26)));
                                    _six4.set_fgs_drawback(new decimal?(decimal.Parse(str25)));
                                    _six4.set_zj_drawback(new decimal?(decimal.Parse(str24)));
                                    _six4.set_dl_rate(0f);
                                    _six4.set_zd_rate(0f);
                                    _six4.set_gd_rate(0f);
                                    _six4.set_fgs_rate(0f);
                                    _six4.set_zj_rate(0f);
                                    _six4.set_is_payment(0);
                                    _six4.set_dl_name(str23);
                                    _six4.set_zd_name(str22);
                                    _six4.set_gd_name(str21);
                                    _six4.set_fgs_name(str20);
                                    _six4.set_sale_type(1);
                                    _six4.set_m_type(-2);
                                    _six4.set_kind(str11);
                                    _six4.set_ip(LSRequest.GetIP());
                                    _six4.set_lottery_type(new int?(Convert.ToInt16(num)));
                                    _six4.set_lottery_name(base.GetGameNameByID(_six4.get_lottery_type().ToString()));
                                    _six4.set_ordervalidcode(Utils.GetOrderValidCode(_six4.get_u_name(), _six4.get_order_num(), _six4.get_bet_val(), _six4.get_odds(), _six4.get_kind(), Convert.ToInt32(_six4.get_phase_id()), Convert.ToInt32(_six4.get_odds_id()), Convert.ToDouble(_six4.get_amount())));
                                    _six4.set_odds_zj(str5);
                                    int num4 = 0;
                                    CallBLL.cz_bet_six_bll.AddBHBetByZJ(_six4, ref num4);
                                    double num5 = 0.0;
                                    double num6 = 0.0;
                                    FunctionSix.GetWTByG_FZ(s, str7, str5, null, ref num5, ref num6, base.get_YearLianID());
                                    cz_splitgroup_six _six5 = new cz_splitgroup_six();
                                    _six5.set_order_num(_six4.get_order_num());
                                    _six5.set_odds1(new decimal?(decimal.Parse(num5.ToString())));
                                    _six5.set_odds2(new decimal?(decimal.Parse(num6.ToString())));
                                    _six5.set_odds_id(new int?(int.Parse(s)));
                                    _six5.set_item(str7);
                                    _six5.set_item_money(new decimal?(decimal.Parse(str6)));
                                    _six5.set_odds1_zj(new decimal?(decimal.Parse(num5.ToString())));
                                    _six5.set_odds2_zj(new decimal?(decimal.Parse(num6.ToString())));
                                    CallBLL.cz_splitgroup_six_bll.Add(_six5);
                                }
                                else
                                {
                                    cz_bet_six _six6 = new cz_bet_six();
                                    _six6.set_order_num(orderNumber);
                                    _six6.set_u_name(user.get_u_name());
                                    _six6.set_u_nicker(user.get_u_nicker());
                                    _six6.set_phase_id(new int?(int.Parse(str13)));
                                    _six6.set_phase(str12);
                                    _six6.set_bet_time(new DateTime?(DateTime.Now));
                                    _six6.set_checkcode(str10);
                                    _six6.set_odds_id(new int?(int.Parse(s)));
                                    _six6.set_category(table2.Rows[0]["category"].ToString());
                                    _six6.set_play_id(new int?(int.Parse(table2.Rows[0]["play_id"].ToString())));
                                    _six6.set_play_name(table2.Rows[0]["o_play_name"].ToString());
                                    _six6.set_bet_val(table2.Rows[0]["put_amount"].ToString());
                                    _six6.set_odds(str5);
                                    _six6.set_amount(new decimal?(decimal.Parse(str6)));
                                    _six6.set_profit(0);
                                    _six6.set_isLM(0);
                                    _six6.set_hy_drawback(new decimal?(decimal.Parse(str29)));
                                    _six6.set_dl_drawback(new decimal?(decimal.Parse(str28)));
                                    _six6.set_zd_drawback(new decimal?(decimal.Parse(str27)));
                                    _six6.set_gd_drawback(new decimal?(decimal.Parse(str26)));
                                    _six6.set_fgs_drawback(new decimal?(decimal.Parse(str25)));
                                    _six6.set_zj_drawback(new decimal?(decimal.Parse(str24)));
                                    _six6.set_dl_rate(0f);
                                    _six6.set_zd_rate(0f);
                                    _six6.set_gd_rate(0f);
                                    _six6.set_fgs_rate(0f);
                                    _six6.set_zj_rate(0f);
                                    _six6.set_is_payment(0);
                                    _six6.set_dl_name(str23);
                                    _six6.set_zd_name(str22);
                                    _six6.set_gd_name(str21);
                                    _six6.set_fgs_name(str20);
                                    _six6.set_sale_type(1);
                                    _six6.set_m_type(-2);
                                    _six6.set_kind(str11.ToUpper());
                                    _six6.set_ip(LSRequest.GetIP());
                                    _six6.set_lottery_type(new int?(Convert.ToInt16(num)));
                                    _six6.set_lottery_name(base.GetGameNameByID(_six6.get_lottery_type().ToString()));
                                    _six6.set_ordervalidcode(Utils.GetOrderValidCode(_six6.get_u_name(), _six6.get_order_num(), _six6.get_bet_val(), _six6.get_odds(), _six6.get_kind(), Convert.ToInt32(_six6.get_phase_id()), Convert.ToInt32(_six6.get_odds_id()), Convert.ToDouble(_six6.get_amount())));
                                    _six6.set_odds_zj(str5);
                                    int num7 = 0;
                                    CallBLL.cz_bet_six_bll.AddBHBetByZJ(_six6, ref num7);
                                }
                                if (flag)
                                {
                                    string str31 = "";
                                    string str32 = "0";
                                    string str33 = "0";
                                    if (str14.Equals("1"))
                                    {
                                        str32 = str5.Split(new char[] { ',' })[0];
                                        str33 = str5.Split(new char[] { ',' })[1];
                                        str31 = ((double.Parse(str6) * (double.Parse(str32) - 1.0))).ToString() + "," + (double.Parse(str6) * (double.Parse(str33) - 1.0));
                                    }
                                    else
                                    {
                                        str32 = str5;
                                        str31 = (double.Parse(str6) * (double.Parse(str32) - 1.0)).ToString();
                                    }
                                    string str34 = "";
                                    if (str7.Trim() != "")
                                    {
                                        str34 = str7;
                                    }
                                    else
                                    {
                                        str34 = str15;
                                    }
                                    Dictionary<string, object> dictionary2 = new Dictionary<string, object>();
                                    dictionary2.Add("ordernum", orderNumber);
                                    dictionary2.Add("playname", str16);
                                    dictionary2.Add("ky", str31);
                                    if ((s.Equals("92565") || s.Equals("92566")) || ((s.Equals("92567") || s.Equals("92568")) || s.Equals("92636")))
                                    {
                                        dictionary2.Add("putamount", FunctionSix.GetSXLNameBySXid(str34));
                                    }
                                    else if ((s.Equals("92569") || s.Equals("92570")) || (s.Equals("92571") || s.Equals("92637")))
                                    {
                                        dictionary2.Add("putamount", FunctionSix.GetWSLNameBySXid(str34));
                                    }
                                    else
                                    {
                                        dictionary2.Add("putamount", str34);
                                    }
                                    if (str14.Equals("1"))
                                    {
                                        dictionary2.Add("pl", str32.ToString() + "," + str33.ToString());
                                    }
                                    else
                                    {
                                        dictionary2.Add("pl", str32.ToString());
                                    }
                                    dictionary2.Add("amount", str6);
                                    if (flag)
                                    {
                                        dictionary2.Add("islm", "1");
                                    }
                                    else
                                    {
                                        dictionary2.Add("islm", "0");
                                    }
                                    dictionary.Add("bhdata", dictionary2);
                                }
                                else
                                {
                                    string str35 = "";
                                    string str36 = str5;
                                    double num10 = double.Parse(str6) * (double.Parse(str36) - 1.0);
                                    str35 = num10.ToString();
                                    bool flag1 = str7.Trim() != "";
                                    List<FastSale> list = new List<FastSale>();
                                    FastSale item = new FastSale();
                                    item.set_success("1");
                                    item.set_ordernum(orderNumber);
                                    item.set_playname(str16);
                                    item.set_putamount(str15);
                                    str35 = num10.ToString();
                                    item.set_ky(str35);
                                    item.set_islm("0");
                                    item.set_pl(str36);
                                    item.set_message("");
                                    item.set_amount(str6);
                                    list.Add(item);
                                    dictionary.Add("bhdata", list);
                                }
                                new Dictionary<string, object>();
                                dictionary.Add("jeucode", base.get_JeuValidate());
                                result.set_data(dictionary);
                                result.set_success(200);
                                strResult = JsonHandle.ObjectToJson(result);
                            }
                        }
                    }
                }
            }
        }

        public void zj_fast_sale(HttpContext context, ref string strResult)
        {
            ReturnResult result = new ReturnResult();
            result.set_success(400);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "user_allow_sale");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            int num = 100;
            string str3 = LSRequest.qq("phaseid");
            string str4 = LSRequest.qq("oddsid");
            string str5 = LSRequest.qq("currentodds");
            string str6 = LSRequest.qq("amount");
            string str7 = LSRequest.qq("s_user");
            string str8 = LSRequest.qq("pk");
            string str9 = LSRequest.qq("jeucode");
            string[] strArray = str4.Split(new char[] { ',' });
            string[] strArray2 = str6.Split(new char[] { ',' });
            string[] strArray3 = str5.Split(new char[] { ',' });
            if (strArray2.Length > 0x31)
            {
                context.Response.End();
            }
            if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str9))
            {
                context.Session["JeuValidate"] = null;
                result.set_success(400);
                new Dictionary<string, object>();
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                context.Session["JeuValidate"] = null;
                cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str7);
                if (user == null)
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100044", "MessageHint"));
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    string str10 = user.get_six_kind().ToUpper();
                    string str11 = "";
                    string str12 = "";
                    cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                    if (currentPhase != null)
                    {
                        if (currentPhase.get_is_closed() == 1)
                        {
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                            result.set_success(400);
                            context.Session["JeuValidate"] = base.get_JeuValidate();
                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        str11 = currentPhase.get_phase().ToString();
                        str12 = currentPhase.get_p_id().ToString();
                    }
                    else
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (!str3.Equals(str12))
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100042", "MessageHint"), currentPhase.get_phase().ToString()));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        int index = 0;
                        foreach (string str13 in strArray)
                        {
                            DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(str13);
                            DateTime now = DateTime.Now;
                            DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                            DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                            if ((((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002")) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91004") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91005"))) || ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91007") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91038")))
                            {
                                if (time3 < now)
                                {
                                    result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                    result.set_success(400);
                                    context.Session["JeuValidate"] = base.get_JeuValidate();
                                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                    result.set_data(dictionary);
                                    strResult = JsonHandle.ObjectToJson(result);
                                    return;
                                }
                            }
                            else if (time2 < now)
                            {
                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (string.IsNullOrEmpty(str5) || (strArray3.Length <= 0))
                            {
                                result.set_success(400);
                                result.set_tipinfo(PageBase.GetMessageByCache("u100046", "MessageHint"));
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        List<FastSale> list = new List<FastSale>();
                        index = 0;
                        foreach (string str14 in strArray)
                        {
                            DataTable table2 = CallBLL.cz_odds_six_bll.GetOddsByID(str14).Tables[0];
                            int num3 = int.Parse(table2.Rows[0]["play_id"].ToString());
                            string text1 = table2.Rows[0]["isDoubleOdds"] + "".Trim();
                            string str15 = table2.Rows[0]["put_amount"].ToString();
                            bool flag = (table2.Rows[0]["isLM"]).Equals("1");
                            string str16 = table2.Rows[0]["o_play_name"].ToString().Trim();
                            table2.Rows[0]["current_odds"].ToString().Trim();
                            table2.Rows[0][str10.ToUpper() + "_diff"].ToString().Trim();
                            if (table2.Rows[0]["is_open"].ToString().Trim().Equals("0"))
                            {
                                FastSale item = new FastSale();
                                item.set_success("0");
                                item.set_ordernum("補貨失敗");
                                item.set_playname(str16);
                                item.set_putamount(str15);
                                item.set_ky("0");
                                item.set_islm("0");
                                item.set_pl(strArray3[index]);
                                item.set_amount(strArray2[index]);
                                item.set_oddsid(str14);
                                item.set_message("已封盤");
                                list.Add(item);
                                goto Label_116C;
                            }
                            double num4 = 0.0;
                            if (!model.get_negative_sale().Equals(1))
                            {
                                string str18 = str14;
                                string str19 = num3.ToString();
                                if (int.Parse(str14) <= 0x167c2)
                                {
                                    if (int.Parse(str14) <= 0x16791)
                                    {
                                        str18 = str14 + "," + (int.Parse(str14) + 0x31);
                                    }
                                    if ((int.Parse(str14) > 0x16791) && (int.Parse(str14) <= 0x167c2))
                                    {
                                        str18 = (int.Parse(str14) - 0x31) + "," + str14;
                                    }
                                    str19 = "91001,91002";
                                }
                                DataTable table3 = CallBLL.cz_bet_six_bll.GetSZZTByZJ(str3, str19, model.get_u_name(), str18, str8);
                                if (int.Parse(str14) <= 0x167c2)
                                {
                                    if (!string.IsNullOrEmpty(table3.Rows[0]["szzt"].ToString()))
                                    {
                                        num4 += Convert.ToDouble(table3.Rows[0]["szzt"]);
                                    }
                                    if (!string.IsNullOrEmpty(table3.Rows[1]["szzt"].ToString()))
                                    {
                                        num4 += Convert.ToDouble(table3.Rows[1]["szzt"]);
                                    }
                                }
                                else
                                {
                                    num4 = Convert.ToDouble(table3.Rows[0]["szzt"]);
                                }
                                if ((table3 == null) || (num4 < 1.0))
                                {
                                    FastSale sale2 = new FastSale();
                                    sale2.set_success("0");
                                    sale2.set_playname(str16);
                                    sale2.set_putamount(str15);
                                    sale2.set_islm("0");
                                    sale2.set_pl(strArray3[index]);
                                    sale2.set_amount(strArray2[index]);
                                    sale2.set_oddsid(str14);
                                    if (int.Parse(str14) <= 0x167c2)
                                    {
                                        sale2.set_message(string.Format("補貨注額不能大於特碼【{0}】A+B總貨量: {1} ！", str15, (int) num4));
                                    }
                                    else
                                    {
                                        sale2.set_message(PageBase.GetMessageByCache("u100047", "MessageHint"));
                                    }
                                    list.Add(sale2);
                                }
                                else if (Convert.ToDouble(strArray2[index]) > num4)
                                {
                                    FastSale sale3 = new FastSale();
                                    sale3.set_success("0");
                                    sale3.set_playname(str16);
                                    sale3.set_putamount(str15);
                                    sale3.set_islm("0");
                                    sale3.set_pl(strArray3[index]);
                                    sale3.set_amount(strArray2[index]);
                                    sale3.set_oddsid(str14);
                                    if (int.Parse(str14) <= 0x167c2)
                                    {
                                        sale3.set_message(string.Format("補貨注額不能大於特碼【{0}】A+B總貨量: {1} ！", str15, (int) num4));
                                    }
                                    else
                                    {
                                        sale3.set_message(PageBase.GetMessageByCache("u100048", "MessageHint"));
                                    }
                                    list.Add(sale3);
                                }
                            }
                            cz_drawback_six drawback = CallBLL.cz_drawback_six_bll.GetDrawback(Convert.ToInt32(num3), user.get_u_name());
                            string str20 = "";
                            string str21 = "";
                            string str22 = "";
                            string str23 = "";
                            string s = "0";
                            string str25 = "0";
                            string str26 = "0";
                            string str27 = "0";
                            string str28 = "0";
                            string str29 = "0";
                            string str32 = str10.ToUpper();
                            if (str32 != null)
                            {
                                if (!(str32 == "A"))
                                {
                                    if (str32 == "B")
                                    {
                                        goto Label_0D2E;
                                    }
                                    if (str32 == "C")
                                    {
                                        goto Label_0D60;
                                    }
                                }
                                else
                                {
                                    s = drawback.get_a_drawback().ToString();
                                    str25 = drawback.get_a_drawback().ToString();
                                }
                            }
                            goto Label_0D90;
                        Label_0D2E:
                            s = drawback.get_b_drawback().ToString();
                            str25 = drawback.get_b_drawback().ToString();
                            goto Label_0D90;
                        Label_0D60:
                            s = drawback.get_c_drawback().ToString();
                            str25 = drawback.get_c_drawback().ToString();
                        Label_0D90:
                            str20 = str;
                            string orderNumber = Utils.GetOrderNumber();
                            if (!flag)
                            {
                                cz_bet_six _six4 = new cz_bet_six();
                                _six4.set_order_num(orderNumber);
                                _six4.set_u_name(user.get_u_name());
                                _six4.set_u_nicker(user.get_u_nicker());
                                _six4.set_phase_id(new int?(int.Parse(str12)));
                                _six4.set_phase(str11);
                                _six4.set_bet_time(new DateTime?(DateTime.Now));
                                _six4.set_checkcode(str9);
                                _six4.set_odds_id(new int?(int.Parse(str14)));
                                _six4.set_category(table2.Rows[0]["category"].ToString());
                                _six4.set_play_id(new int?(int.Parse(table2.Rows[0]["play_id"].ToString())));
                                _six4.set_play_name(table2.Rows[0]["o_play_name"].ToString());
                                _six4.set_bet_val(table2.Rows[0]["put_amount"].ToString());
                                _six4.set_odds(strArray3[index]);
                                _six4.set_amount(new decimal?(decimal.Parse(strArray2[index])));
                                _six4.set_profit(0);
                                _six4.set_isLM(0);
                                _six4.set_hy_drawback(new decimal?(decimal.Parse(str29)));
                                _six4.set_dl_drawback(new decimal?(decimal.Parse(str28)));
                                _six4.set_zd_drawback(new decimal?(decimal.Parse(str27)));
                                _six4.set_gd_drawback(new decimal?(decimal.Parse(str26)));
                                _six4.set_fgs_drawback(new decimal?(decimal.Parse(str25)));
                                _six4.set_zj_drawback(new decimal?(decimal.Parse(s)));
                                _six4.set_dl_rate(0f);
                                _six4.set_zd_rate(0f);
                                _six4.set_gd_rate(0f);
                                _six4.set_fgs_rate(0f);
                                _six4.set_zj_rate(0f);
                                _six4.set_is_payment(0);
                                _six4.set_dl_name(str23);
                                _six4.set_zd_name(str22);
                                _six4.set_gd_name(str21);
                                _six4.set_fgs_name(str20);
                                _six4.set_sale_type(1);
                                _six4.set_m_type(-2);
                                _six4.set_kind(str10.ToUpper());
                                _six4.set_ip(LSRequest.GetIP());
                                _six4.set_lottery_type(new int?(Convert.ToInt16(num)));
                                _six4.set_lottery_name(base.GetGameNameByID(_six4.get_lottery_type().ToString()));
                                _six4.set_ordervalidcode(Utils.GetOrderValidCode(_six4.get_u_name(), _six4.get_order_num(), _six4.get_bet_val(), _six4.get_odds(), _six4.get_kind(), Convert.ToInt32(_six4.get_phase_id()), Convert.ToInt32(_six4.get_odds_id()), Convert.ToDouble(_six4.get_amount())));
                                _six4.set_odds_zj(strArray3[index]);
                                int num5 = 0;
                                if (num4 > 1.0)
                                {
                                    CallBLL.cz_bet_six_bll.AddBHBetByZJ(_six4, ref num5);
                                    FastSale sale4 = new FastSale();
                                    sale4.set_success("1");
                                    sale4.set_ordernum(orderNumber);
                                    sale4.set_playname(str16);
                                    sale4.set_putamount(str15);
                                    string str31 = "";
                                    str31 = (double.Parse(strArray2[index]) * (double.Parse(strArray3[index]) - 1.0)).ToString();
                                    sale4.set_ky(str31);
                                    sale4.set_islm("0");
                                    sale4.set_pl(strArray3[index]);
                                    sale4.set_amount(strArray2[index]);
                                    sale4.set_oddsid(str14);
                                    sale4.set_message("");
                                    list.Add(sale4);
                                }
                            }
                        Label_116C:
                            index++;
                        }
                        dictionary.Add("bhdata", list);
                        new Dictionary<string, object>();
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        result.set_success(200);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                }
            }
        }

        public void zj_fast_saleTMAB(HttpContext context, ref string strResult)
        {
            ReturnResult result = new ReturnResult();
            result.set_success(400);
            Dictionary<string, object> dictionary = new Dictionary<string, object>();
            dictionary.Add("type", "user_allow_sale");
            string str = context.Session["user_name"].ToString();
            agent_userinfo_session model = context.Session[str + "lottery_session_user_info"] as agent_userinfo_session;
            if (!model.get_u_type().Trim().Equals("zj"))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            if (!string.IsNullOrEmpty(base.Permission_Ashx_ZJ(model, "po_1_3")))
            {
                context.Response.Write(PageBase.GetMessageByCache("u100027", "MessageHint"));
                context.Response.End();
            }
            string str3 = LSRequest.qq("phaseid");
            string str4 = LSRequest.qq("oddsid");
            string str5 = LSRequest.qq("currentodds");
            string str6 = LSRequest.qq("amount");
            LSRequest.qq("number");
            string str7 = LSRequest.qq("s_user");
            LSRequest.qq("pk");
            string str8 = LSRequest.qq("jeucode");
            string[] strArray = str4.Split(new char[] { ',' });
            string[] strArray2 = str6.Split(new char[] { ',' });
            string[] strArray3 = str5.Split(new char[] { ',' });
            if (strArray2.Length > 0x31)
            {
                context.Response.End();
            }
            if ((context.Session["JeuValidate"] == null) || !context.Session["JeuValidate"].ToString().Equals(str8))
            {
                context.Session["JeuValidate"] = null;
                result.set_success(400);
                new Dictionary<string, object>();
                context.Session["JeuValidate"] = base.get_JeuValidate();
                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                result.set_data(dictionary);
                result.set_tipinfo(PageBase.GetMessageByCache("u100030", "MessageHint"));
                strResult = JsonHandle.ObjectToJson(result);
            }
            else
            {
                context.Session["JeuValidate"] = null;
                for (int i = 0; i < strArray2.Length; i++)
                {
                    if (!base.IsNumber(strArray2[i]))
                    {
                        result.set_tipinfo("下注金額有誤！");
                        result.set_success(500);
                        dictionary.Add("jeucode", base.get_JeuValidate());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                }
                cz_saleset_six user = CallBLL.cz_saleset_six_bll.GetUser(str7);
                if (user == null)
                {
                    result.set_success(400);
                    result.set_tipinfo(PageBase.GetMessageByCache("u100044", "MessageHint"));
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else if ((strArray2.Length == 1) && (double.Parse(strArray2[0]) < 10.0))
                {
                    result.set_success(400);
                    result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100096", "MessageHint"), 10));
                    context.Session["JeuValidate"] = base.get_JeuValidate();
                    dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                    result.set_data(dictionary);
                    strResult = JsonHandle.ObjectToJson(result);
                }
                else
                {
                    int? nullable;
                    string str9 = user.get_six_kind().ToUpper();
                    string str10 = "";
                    string str11 = "";
                    cz_phase_six currentPhase = CallBLL.cz_phase_six_bll.GetCurrentPhase();
                    if (currentPhase != null)
                    {
                        nullable = currentPhase.get_is_closed();
                        if ((nullable.GetValueOrDefault() == 1) && nullable.HasValue)
                        {
                            result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                            result.set_success(400);
                            context.Session["JeuValidate"] = base.get_JeuValidate();
                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                            return;
                        }
                        str10 = currentPhase.get_phase().ToString();
                        str11 = currentPhase.get_p_id().ToString();
                    }
                    else
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100039", "MessageHint"), currentPhase.get_phase().ToString()));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                        return;
                    }
                    if (!str3.Equals(str11))
                    {
                        result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100042", "MessageHint"), currentPhase.get_phase().ToString()));
                        result.set_success(400);
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else if (string.IsNullOrEmpty(str5) || (strArray3.Length <= 0))
                    {
                        result.set_success(400);
                        result.set_tipinfo(PageBase.GetMessageByCache("u100046", "MessageHint"));
                        context.Session["JeuValidate"] = base.get_JeuValidate();
                        dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                        result.set_data(dictionary);
                        strResult = JsonHandle.ObjectToJson(result);
                    }
                    else
                    {
                        foreach (string str12 in strArray)
                        {
                            DataTable playIDByOddsIds = CallBLL.cz_odds_six_bll.GetPlayIDByOddsIds(str12);
                            DateTime now = DateTime.Now;
                            DateTime time2 = Convert.ToDateTime(currentPhase.get_stop_date());
                            DateTime time3 = Convert.ToDateTime(currentPhase.get_sn_stop_date());
                            if ((playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91001") || (playIDByOddsIds.Rows[0]["play_id"].ToString().Trim() == "91002"))
                            {
                                if (time3 >= now)
                                {
                                    continue;
                                }
                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            if (time2 < now)
                            {
                                result.set_tipinfo(PageBase.GetMessageByCache("u100040", "MessageHint"));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                        }
                        List<FastSale> list = new List<FastSale>();
                        Dictionary<int, string> dictionary2 = new Dictionary<int, string>();
                        string str13 = "";
                        for (int j = 0; j < strArray.Length; j++)
                        {
                            object obj2;
                            if (j == 0)
                            {
                                obj2 = str13;
                                str13 = string.Concat(new object[] { obj2, strArray[j], ",", Convert.ToInt32(strArray[j]) + 0x31 });
                            }
                            else
                            {
                                obj2 = str13;
                                str13 = string.Concat(new object[] { obj2, ",", strArray[j], ",", Convert.ToInt32(strArray[j]) + 0x31 });
                            }
                            DataTable table2 = CallBLL.cz_odds_six_bll.GetPlayOddsByID(str13).Tables[0];
                            DataRow[] rowArray = table2.Select(string.Format(" odds_id={0} ", strArray[j]));
                            DataRow[] rowArray2 = table2.Select(string.Format(" odds_id={0} ", int.Parse(strArray[j]) + 0x31));
                            dictionary2.Add(int.Parse(strArray[j]), rowArray[0]["is_open"].ToString());
                            dictionary2.Add(int.Parse(strArray[j]) + 0x31, rowArray2[0]["is_open"].ToString());
                        }
                        bool flag = false;
                        foreach (KeyValuePair<int, string> pair in dictionary2)
                        {
                            if (pair.Value.Equals("0"))
                            {
                                flag = true;
                                break;
                            }
                        }
                        if (!flag)
                        {
                            DataTable oddsTableByOddsIds = CallBLL.cz_odds_six_bll.GetOddsTableByOddsIds(str13);
                            Dictionary<int, double> dictionary3 = new Dictionary<int, double>();
                            Dictionary<int, string> dictionary4 = new Dictionary<int, string>();
                            Dictionary<int, double> dictionary5 = new Dictionary<int, double>();
                            DataTable table4 = CallBLL.cz_bet_six_bll.GetSZZTByTMABZJ(str11, "91001,91002", model.get_u_name(), str13, str9);
                            for (int k = 0; k < strArray.Length; k++)
                            {
                                int num4 = int.Parse(strArray[k]);
                                int num5 = int.Parse(strArray[k]) + 0x31;
                                if (num4 <= 0x16791)
                                {
                                    DataRow[] rowArray3 = table4.Select(string.Format(" odds_id={0} ", num4));
                                    if (dictionary2[num4].ToString().Equals("1"))
                                    {
                                        if ((rowArray3 != null) && (rowArray3.Length > 0))
                                        {
                                            nullable = null;
                                            double num6 = Math.Floor(double.Parse(Utils.GetMathRound(double.Parse(rowArray3[0]["szzt"].ToString()), nullable)));
                                            if (num6 >= 1.0)
                                            {
                                                dictionary5.Add(num4, num6);
                                            }
                                            else
                                            {
                                                dictionary5.Add(num4, 0.0);
                                            }
                                        }
                                        else
                                        {
                                            dictionary5.Add(num4, 0.0);
                                        }
                                    }
                                    else
                                    {
                                        dictionary5.Add(num4, 0.0);
                                    }
                                    DataRow[] rowArray4 = table4.Select(string.Format(" odds_id={0} ", num5));
                                    if (dictionary2[num5].ToString().Equals("1"))
                                    {
                                        if ((rowArray4 != null) && (rowArray4.Length > 0))
                                        {
                                            nullable = null;
                                            double num7 = Math.Floor(double.Parse(Utils.GetMathRound(double.Parse(rowArray4[0]["szzt"].ToString()), nullable)));
                                            if (num7 >= 1.0)
                                            {
                                                dictionary5.Add(num5, num7);
                                            }
                                            else
                                            {
                                                dictionary5.Add(num5, 0.0);
                                            }
                                        }
                                        else
                                        {
                                            dictionary5.Add(num5, 0.0);
                                        }
                                    }
                                    else
                                    {
                                        dictionary5.Add(num5, 0.0);
                                    }
                                }
                            }
                            if ((dictionary5 != null) && (dictionary5.Count > 0))
                            {
                                int num8 = 0;
                                foreach (KeyValuePair<int, double> pair2 in dictionary5)
                                {
                                    int key = pair2.Key;
                                    double num10 = 0.0;
                                    if (key <= 0x16791)
                                    {
                                        double num11 = 0.0;
                                        double num12 = 0.0;
                                        for (int m = 0; m < strArray.Length; m++)
                                        {
                                            if (key.ToString().Equals(strArray[m]))
                                            {
                                                num11 = double.Parse(strArray2[m]);
                                                num12 = double.Parse(strArray3[m]);
                                            }
                                        }
                                        int num14 = pair2.Key + 0x31;
                                        num10 = pair2.Value + dictionary5[num14];
                                        double num15 = pair2.Value;
                                        double num16 = dictionary5[num14];
                                        num10 = num15 + num16;
                                        string str14 = dictionary2[key];
                                        string str15 = dictionary2[num14];
                                        double num17 = num10;
                                        if (str14.Equals("0"))
                                        {
                                            num17 -= num15;
                                        }
                                        if (str15.Equals("0"))
                                        {
                                            num17 -= num16;
                                        }
                                        if (num11 > num17)
                                        {
                                            DataRow[] rowArray5 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", key));
                                            string str16 = rowArray5[0]["play_name"].ToString();
                                            string str17 = rowArray5[0]["put_amount"].ToString();
                                            dictionary4.Add(key, string.Concat(new object[] { str16, ",", str16.Replace('A', 'B'), "|", str17, "|", num12, "|補貨超量！" }));
                                        }
                                        else
                                        {
                                            double num18 = 0.0;
                                            double num19 = 0.0;
                                            if (str14.Equals("1") && (num15 > 0.0))
                                            {
                                                if (num11 > num10)
                                                {
                                                    num18 = num10;
                                                }
                                                else if (num11 > num15)
                                                {
                                                    num18 = num15;
                                                }
                                                else
                                                {
                                                    num18 = num11;
                                                }
                                            }
                                            else
                                            {
                                                DataRow[] rowArray6 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", key));
                                                rowArray6[0]["play_name"].ToString();
                                                rowArray6[0]["put_amount"].ToString();
                                                num12.ToString();
                                            }
                                            if (str15.Equals("1") && (num16 > 0.0))
                                            {
                                                if ((num11 - num18) > num10)
                                                {
                                                    num19 = num10;
                                                }
                                                else if ((num11 - num18) > num16)
                                                {
                                                    num19 = num16;
                                                }
                                                else
                                                {
                                                    num19 = num11 - num18;
                                                }
                                            }
                                            else
                                            {
                                                DataRow[] rowArray7 = oddsTableByOddsIds.Select(string.Format(" odds_id={0} ", num14));
                                                rowArray7[0]["play_name"].ToString();
                                                rowArray7[0]["put_amount"].ToString();
                                                num12.ToString();
                                            }
                                            if ((num18 > 0.0) || (num19 > 0.0))
                                            {
                                                double num20 = num18 + num19;
                                                dictionary3.Add(key, num20);
                                            }
                                            num8++;
                                        }
                                    }
                                }
                            }
                            else
                            {
                                result.set_tipinfo(string.Format(PageBase.GetMessageByCache("u100041", "MessageHint"), currentPhase.get_phase().ToString()));
                                result.set_success(400);
                                context.Session["JeuValidate"] = base.get_JeuValidate();
                                dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                                result.set_data(dictionary);
                                strResult = JsonHandle.ObjectToJson(result);
                                return;
                            }
                            foreach (KeyValuePair<int, double> pair3 in dictionary3)
                            {
                                DataTable table5 = CallBLL.cz_odds_six_bll.GetOddsByID(pair3.Key.ToString()).Tables[0];
                                int num21 = int.Parse(table5.Rows[0]["play_id"].ToString());
                                string str18 = table5.Rows[0]["play_name"].ToString();
                                string str19 = table5.Rows[0]["put_amount"].ToString();
                                double num22 = pair3.Value;
                                double num23 = 0.0;
                                for (int n = 0; n < strArray.Length; n++)
                                {
                                    if ((pair3.Key > 0x16791) && (pair3.Key <= 0x167c2))
                                    {
                                        int num27 = pair3.Key - 0x31;
                                        if (num27.ToString().Equals(strArray[n]))
                                        {
                                            num23 = double.Parse(strArray3[n]);
                                        }
                                    }
                                    else if (pair3.Key.ToString().Equals(strArray[n]))
                                    {
                                        num23 = double.Parse(strArray3[n]);
                                    }
                                }
                                cz_drawback_six drawback = CallBLL.cz_drawback_six_bll.GetDrawback(Convert.ToInt32(num21), user.get_u_name());
                                string str20 = "";
                                string str21 = "";
                                string str22 = "";
                                string str23 = "";
                                string s = "0";
                                string str25 = "0";
                                string str26 = "0";
                                string str27 = "0";
                                string str28 = "0";
                                string str29 = "0";
                                string str32 = str9.ToUpper();
                                if (str32 != null)
                                {
                                    if (!(str32 == "A"))
                                    {
                                        if (str32 == "B")
                                        {
                                            goto Label_118E;
                                        }
                                        if (str32 == "C")
                                        {
                                            goto Label_11C0;
                                        }
                                    }
                                    else
                                    {
                                        s = drawback.get_a_drawback().ToString();
                                        str25 = drawback.get_a_drawback().ToString();
                                    }
                                }
                                goto Label_11F0;
                            Label_118E:
                                s = drawback.get_b_drawback().ToString();
                                str25 = drawback.get_b_drawback().ToString();
                                goto Label_11F0;
                            Label_11C0:
                                s = drawback.get_c_drawback().ToString();
                                str25 = drawback.get_c_drawback().ToString();
                            Label_11F0:
                                str20 = str;
                                string orderNumber = Utils.GetOrderNumber();
                                cz_bet_six _six4 = new cz_bet_six();
                                _six4.set_order_num(orderNumber);
                                _six4.set_u_name(user.get_u_name());
                                _six4.set_u_nicker(user.get_u_nicker());
                                _six4.set_phase_id(new int?(int.Parse(str11)));
                                _six4.set_phase(str10);
                                _six4.set_bet_time(new DateTime?(DateTime.Now));
                                _six4.set_checkcode(str8);
                                _six4.set_odds_id(new int?(int.Parse(pair3.Key.ToString())));
                                _six4.set_category(table5.Rows[0]["category"].ToString());
                                _six4.set_play_id(new int?(int.Parse(table5.Rows[0]["play_id"].ToString())));
                                _six4.set_play_name(table5.Rows[0]["o_play_name"].ToString());
                                _six4.set_bet_val(table5.Rows[0]["put_amount"].ToString());
                                _six4.set_odds(num23.ToString());
                                _six4.set_amount(new decimal?(decimal.Parse(num22.ToString())));
                                _six4.set_profit(0);
                                _six4.set_isLM(0);
                                _six4.set_hy_drawback(new decimal?(decimal.Parse(str29)));
                                _six4.set_dl_drawback(new decimal?(decimal.Parse(str28)));
                                _six4.set_zd_drawback(new decimal?(decimal.Parse(str27)));
                                _six4.set_gd_drawback(new decimal?(decimal.Parse(str26)));
                                _six4.set_fgs_drawback(new decimal?(decimal.Parse(str25)));
                                _six4.set_zj_drawback(new decimal?(decimal.Parse(s)));
                                _six4.set_dl_rate(0f);
                                _six4.set_zd_rate(0f);
                                _six4.set_gd_rate(0f);
                                _six4.set_fgs_rate(0f);
                                _six4.set_zj_rate(0f);
                                _six4.set_is_payment(0);
                                _six4.set_dl_name(str23);
                                _six4.set_zd_name(str22);
                                _six4.set_gd_name(str21);
                                _six4.set_fgs_name(str20);
                                _six4.set_sale_type(1);
                                _six4.set_m_type(-2);
                                _six4.set_kind(str9.ToUpper());
                                _six4.set_ip(LSRequest.GetIP());
                                _six4.set_lottery_type(100);
                                _six4.set_lottery_name(base.GetGameNameByID(_six4.get_lottery_type().ToString()));
                                _six4.set_ordervalidcode(Utils.GetOrderValidCode(_six4.get_u_name(), _six4.get_order_num(), _six4.get_bet_val(), _six4.get_odds(), _six4.get_kind(), Convert.ToInt32(_six4.get_phase_id()), Convert.ToInt32(_six4.get_odds_id()), Convert.ToDouble(_six4.get_amount())));
                                _six4.set_odds_zj(num23.ToString());
                                int num25 = 0;
                                CallBLL.cz_bet_six_bll.AddBHBetByZJ(_six4, ref num25);
                                FastSale item = new FastSale();
                                item.set_success("1");
                                item.set_ordernum(orderNumber);
                                item.set_playname(str18);
                                item.set_putamount(str19);
                                string str31 = "";
                                str31 = (double.Parse(pair3.Value.ToString()) * (num23 - 1.0)).ToString();
                                item.set_ky(str31);
                                item.set_islm("0");
                                item.set_pl(num23.ToString());
                                item.set_amount(pair3.Value.ToString());
                                item.set_oddsid(pair3.Key.ToString());
                                item.set_message("");
                                list.Add(item);
                            }
                            if (dictionary4.Count > 0)
                            {
                                foreach (KeyValuePair<int, string> pair4 in dictionary4)
                                {
                                    FastSale sale2 = new FastSale();
                                    sale2.set_success("0");
                                    sale2.set_ordernum("補貨失敗");
                                    sale2.set_playname(pair4.Value.ToString().Split(new char[] { '|' })[0]);
                                    sale2.set_putamount(pair4.Value.ToString().Split(new char[] { '|' })[1]);
                                    sale2.set_ky("0");
                                    sale2.set_islm("0");
                                    sale2.set_pl(pair4.Value.ToString().Split(new char[] { '|' })[2]);
                                    sale2.set_amount("0");
                                    sale2.set_oddsid(pair4.Key.ToString());
                                    sale2.set_message(pair4.Value.ToString().Split(new char[] { '|' })[3]);
                                    list.Add(sale2);
                                }
                            }
                            dictionary.Add("bhdata", list);
                            new Dictionary<string, object>();
                            context.Session["JeuValidate"] = base.get_JeuValidate();
                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                            result.set_data(dictionary);
                            result.set_success(200);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                        else
                        {
                            result.set_tipinfo("補貨失敗,特碼A或特碼B存在停盤的玩法，請到具體對應的特碼A或特碼B頁面操作");
                            result.set_success(400);
                            context.Session["JeuValidate"] = base.get_JeuValidate();
                            dictionary.Add("jeucode", context.Session["JeuValidate"].ToString());
                            result.set_data(dictionary);
                            strResult = JsonHandle.ObjectToJson(result);
                        }
                    }
                }
            }
        }

        public bool IsReusable
        {
            get
            {
                return false;
            }
        }
    }
}

